"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.beforeDestroy=exports.mounted=exports.methods=exports.computed=exports.watch=exports.data=void 0;const lodash_1=require("lodash");async function mounted(){await Promise.all([this.refreshPackagesConfigs(),this._queryDbStatus()]),Editor.Message.__protected__.addBroadcastListener("project:packages-changed",this.refreshPackagesConfigs)}function beforeDestroy(){Editor.Message.__protected__.removeBroadcastListener("project:packages-changed",this.refreshPackagesConfigs)}exports.data={tab:"project",subTab:"general",data:{},args:[],dbReady:!1},exports.watch={subTab(){this.handleCustomConfig()},dbReady(t){t&&this.handleCustomConfig()}},exports.computed={alignCustomPanelFollowContent(){const t=this;return!!((0,lodash_1.get)(t.data,[t.tab,"tabs",t.subTab,"content"])&&Object.keys((0,lodash_1.get)(t.data,[t.tab,"tabs",t.subTab,"content"])).length>0)},hasSlider(){return this.data&&Object.keys(this.data).length},hasContent(){const{data:t,tab:e,subTab:a}=this;return t&&t[e]&&t[e].tabs[a]&&(t[e].tabs[a].content||t[e].tabs[a].custom)}},exports.methods={changeTab(t,e){this.tab=t,this.subTab=e},getRenderText:(t,e)=>(t.attributes=t.attributes||{},t.attributes.path=e,JSON.stringify(t)),t:t=>"string"!=typeof t?"":(t=t.replace("i18n:",""),Editor.I18n.t(t)||t),popup(t,e,a){const s=this;s.tab&&Editor.Menu.popup({x:t,y:e,menu:[{label:Editor.I18n.t("project.menu.copyConfigKey"),click(){const t=`'${s.tab}', '${a}'`;Editor.Clipboard.write("text",t)}},{label:Editor.I18n.t("project.menu.copyTabKey"),click(){const t=`'${s.tab}', '${s.subTab}'`;Editor.Clipboard.write("text",t)}}]})},async refreshPackagesConfigs(){const t=this;t.data=await Editor.Message.request("project","query-project-configs"),t.data&&t.data[t.tab]&&t.data[t.tab].tabs[t.subTab]||(t.tab="project",t.subTab="general")},handleCustomConfig(){const t=this;if((0,lodash_1.get)(t.data,[t.tab,"tabs",t.subTab,"custom"])){const e=Editor.Module.__protected__.requireFile((0,lodash_1.get)(t.data,[t.tab,"tabs",t.subTab,"custom"])),a=document.createElement("ui-panel"),s={};e&&(Object.keys(e).forEach(t=>{s[t]=e[t]}),e.ready&&(s.ready=(()=>(a.ready=!0,e.ready.call(a.panelObject,...t.args))))),a.config=s,t.$nextTick(()=>{const e=t.$refs[`${t.tab}-${t.subTab}`];e&&(e.innerHTML="",e.appendChild(a))})}},async _queryDbStatus(){await Editor.Message.request("asset-db","query-ready")&&(this.dbReady=!0)}},exports.mounted=mounted,exports.beforeDestroy=beforeDestroy;