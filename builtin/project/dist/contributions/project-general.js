"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.importConfig=exports.exportConfig=exports.methods=exports.template=exports.$=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js");exports.style="\n.general > ui-prop { --left-width: 40%; padding: 2px 0; }\n",exports.$={general:".general"},exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../static/contributions/project-general.html"),"utf8");const component={data:{renderPipeline:null,renderPipelines:[],defaultScene:""},methods:{async refresh(){const e=this;e.renderPipeline=await Editor.Profile.getProject("project","general.renderPipeline"),e.defaultScene=await Editor.Profile.getProject("scene","current-scene");const r=await Editor.Package.getPackages({name:"asset-db",enable:!0});r&&r[0]||await new Promise(e=>{setTimeout(e,1e4)});const t=await Editor.Profile.getConfig("engine","deferred_pipeline");let n=await Editor.Message.request("asset-db","query-assets",{pattern:"db://**/*.rpp"});Array.isArray(n)||(n=[]),t||(n=n.filter(e=>"5d45ba66-829a-46d3-948e-2ed3fa7ee421"!==e.uuid),"5d45ba66-829a-46d3-948e-2ed3fa7ee421"===e.renderPipeline&&(await Editor.Profile.removeProject("project","general.renderPipeline","project"),e.renderPipeline=await Editor.Profile.getProject("project","general.renderPipeline")));const i=await Promise.all(n.map(e=>new Promise(r=>{Editor.Message.request("asset-db","query-asset-meta",e.uuid).then(r).catch(()=>{r(null)})})));e.renderPipelines=n.map((e,r)=>{const t=i[r];return{uuid:e.uuid,name:e.name,contributed:t&&t.userData&&t.userData.contributed?t.userData.contributed:""}})},_onRenderPipelineChanged(e){Editor.Profile.setProject("project","general.renderPipeline",e.target.value)},_onDefaultSceneChanged(e){Editor.Profile.setProject("scene","current-scene",e.target.value)}}};async function exportConfig(){const e={};return e["general.renderPipeline"]=await Editor.Message.request("project","query-config","project","general.renderPipeline")||"",e}async function importConfig(e){e["general.renderPipeline"]&&await Editor.Message.request("project","set-config","project","general.renderPipeline",e["general.renderPipeline"])}function ready(){component.el=this.$.general,new Vue(component).refresh()}exports.methods={},exports.exportConfig=exportConfig,exports.importConfig=importConfig,exports.ready=ready;