"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.methods=exports.template=exports.$=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue");exports.style="\n.layer > ui-prop { margin-bottom: 4px; }\n.layer > ui-prop > ui-input { flex: 1; }\n",exports.$={layer:".layer"},exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/contributions/general-layer.html"),"utf8");const component={data:{layers:[],userLayers:[],builtinLayers:[]},methods:{async refresh(){const e=this;try{e.builtinLayers=await Editor.Message.request("scene","query-layer-builtin")}catch(r){console.error(r),e.builtinLayers=[]}let r=await Editor.Profile.getProject("project","layer");r&&Array.isArray(r)||(r=[]),e.userLayers=r;const t=e.userLayers.concat(e.builtinLayers),a=[];for(let e=0;e<32;e++){const r=1<<e;let s=t.find(e=>e.value===r);s||(s={name:"",value:r}),s.label=e>=20?`Builtin Layer ${e}`:`User Layer ${e}`,a[e]=s}e.layers=a,e.layers.sort((e,r)=>e.index-r.index)},_onSettingsChanged(e,r){const t=this;if(r>=20)return;const a=e.target.value.trim(),s=1<<r;if(a&&t.layers.find(e=>e.name===a))return void console.warn(`The name of the layer cannot be changed: Invalid name(${a})`);const n=parseInt(a);if("number"==typeof n&&!isNaN(n))for(let e=0;e<32;e++)if(n===1<<e)return void console.warn(`The name of the layer cannot be changed: Invalid name(${n})`);let o=t.userLayers.find(e=>e.value===s);const i=t.userLayers.findIndex(e=>e.value===s);if(a)o||(o={name:a,value:s},t.userLayers.push(o)),o.name=a;else{if(!o)return;t.userLayers.splice(i,1)}const l=t.userLayers.map(e=>({name:e.name,value:e.value}));Editor.Profile.setProject("project","layer",l)},_onSettingsConfirm(){Editor.Message.broadcast("project:setting-change","layers")}}};function ready(){component.el=this.$.layer,new Vue(component).refresh()}exports.methods={},exports.ready=ready;