"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.methods=exports.template=exports.$=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue");exports.style="\n.layer > ui-prop { margin-bottom: 4px; }\n.layer > ui-prop > ui-input { flex: 1; }\n",exports.$={layer:".layer"},exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/contributions/general-layer.html"),"utf8");const component={data:{layers:[],userLayers:[],builtinLayers:[]},methods:{async refresh(){const e=this;try{e.builtinLayers=await Editor.Message.request("scene","query-layer-builtin")}catch(r){console.error(r),e.builtinLayers=[]}let r=await Editor.Profile.getProject("project","layer");r&&Array.isArray(r)||(r=[]),e.userLayers=r;const t=e.userLayers.concat(e.builtinLayers),s=[];for(let e=0;e<32;e++){const r=1<<e;let a=t.find(e=>e.value===r);a||(a={name:"",value:r}),a.label=e>=20?`Builtin Layer ${e}`:`User Layer ${e}`,s[e]=a}e.layers=s,e.layers.sort((e,r)=>e.index-r.index)},_onSettingsChanged(e,r){const t=this;if(r>=20)return;const s=e.target.value.trim(),a=1<<r;if(s&&t.layers.find(e=>e.name===s))return;let n=t.userLayers.find(e=>e.value===a);const o=t.userLayers.findIndex(e=>e.value===a);if(s)n||(n={name:s,value:a},t.userLayers.push(n)),n.name=s;else{if(!n)return;t.userLayers.splice(o,1)}const i=t.userLayers.map(e=>({name:e.name,value:e.value}));Editor.Profile.setProject("project","layer",i),Editor.Message.broadcast("project:setting-change","layers")}}};function ready(){component.el=this.$.layer,new Vue(component).refresh()}exports.methods={},exports.ready=ready;