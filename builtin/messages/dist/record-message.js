"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLocalTimeStr=exports.transMessageItem=exports.appendMessage=exports.saveMessageLog=exports.DefaultMessageLogFile=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path");async function saveMessageLog(e,t){try{const s=t||exports.DefaultMessageLogFile;if((0,fs_extra_1.existsSync)(s)||await(0,fs_extra_1.outputFile)(s,"process, type, name, message, source, timestamp, time, args, id, loading"),!e)return;await(0,fs_extra_1.outputFile)(s,e.map(e=>transMessageItem(e)).join("\n"))}catch(e){console.warn(e)}}async function appendMessage(e){try{e.timestamp&&(e.localTime=getLocalTimeStr(e.timestamp)),await(0,fs_extra_1.appendFile)(exports.DefaultMessageLogFile,transMessageItem(e)+"\n")}catch(e){console.warn(e)}}function transMessageItem(e){return Object.values(e).map(e=>JSON.stringify(e)).join(", ")}function getLocalTimeStr(e){const t=new Date(e);return t.toLocaleDateString().replace(/\//g,"-")+" "+t.toTimeString().slice(0,8)}exports.DefaultMessageLogFile=(0,path_1.join)(Editor.Project.path,"temp","message.log"),exports.saveMessageLog=saveMessageLog,exports.appendMessage=appendMessage,exports.transMessageItem=transMessageItem,exports.getLocalTimeStr=getLocalTimeStr;