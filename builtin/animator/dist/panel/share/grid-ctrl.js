"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.syncAxisY=exports.syncAxisX=exports.gridCtrl=void 0;const utils_1=require("../utils"),grid_1=require("../vm/grid");class GridCtrl{_gridCanvas=null;_grid=null;startOffset=10;$left=null;$right=null;get grid(){return this._grid}get gridCanvas(){return this._gridCanvas}get scale(){return this.grid?.xAxisScale??100}init(t){var{$canvas:e,$left:i,$right:r,$xAxis:s,showType:a}=t,i=(e.width=r.offsetWidth,e.height=r.offsetHeight,this._gridCanvas=e,this.$left=i,this.$right=r,e.getContext("2d"));this._grid=new grid_1.Grid({context:i,lineWidth:.5,showType:a||"time",color:"#333846",axis:{container:{x:s},startOffset:this.startOffset,lods:[10,2],minScale:t.minScale||1,maxScale:t.maxScale||50,sample:60},hformat:utils_1.transFrameByTypeInGrid}),this._grid.xAxisScaleAt(this.$left.offsetWidth,20)}getFrameRang(){var t;return this.grid&&this.gridCanvas?(t=this.gridCanvas.width,{start:Math.ceil(this.grid.pixelToValueH(this.startOffset+this.grid.xAxisScale/2)),end:Math.floor(this.grid.pixelToValueH(this.startOffset+t-this.grid.xAxisScale/2))}):{start:0,end:0}}checkOverFlow(t){var e=this.getFrameRang();return e?t>e.end?t-e.end:t<e.start?t-e.start:0:0}pageToFrame(t){var e;return this.grid?(t=t-this.$left.getBoundingClientRect().right,e=Math.round(this.grid.pixelToValueH(Math.abs(t))),0<t?e:-e):0}pageToCtrl(t,e){return{x:t-=this.$left.getBoundingClientRect().right,y:e-=this.$left.getBoundingClientRect().top}}frameToCanvas(t){let e=0;return this.grid&&(e=this.grid.valueToPixelH(t)-this.grid.xAxisOffset),Number(e)}canvasToFrame(t){return this.grid?Math.max(0,Math.round(this.grid.pixelToValueH(t+this.grid.xAxisOffset))):0}}exports.gridCtrl=new GridCtrl;var grid_2=require("../vm/grid");Object.defineProperty(exports,"syncAxisX",{enumerable:!0,get:function(){return grid_2.syncAxisX}}),Object.defineProperty(exports,"syncAxisY",{enumerable:!0,get:function(){return grid_2.syncAxisY}});