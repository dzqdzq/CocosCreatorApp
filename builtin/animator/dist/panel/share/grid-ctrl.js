"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.syncAxisY=exports.syncAxisX=exports.gridCtrl=void 0;const utils_1=require("../utils"),grid_1=require("../vm/grid");class GridCtrl{constructor(){this._gridCanvas=null,this._grid=null,this.startOffset=10,this.$left=null,this.$right=null}get grid(){return this._grid}get gridCanvas(){return this._gridCanvas}get scale(){var t,i;return null!==(i=null===(t=this.grid)||void 0===t?void 0:t.xAxisScale)&&void 0!==i?i:100}init(t){const{$canvas:i,$left:e,$right:r,$xAxis:s,showType:n}=t;i.width=r.offsetWidth,i.height=r.offsetHeight,this._gridCanvas=i,this.$left=e,this.$right=r;const a=i.getContext("2d");this._grid=new grid_1.Grid({context:a,lineWidth:.5,showType:n||"time",color:"#333846",axis:{container:{x:s},startOffset:this.startOffset,lods:[10,2],minScale:t.minScale||1,maxScale:t.maxScale||50,sample:60},hformat:utils_1.transFrameByTypeInGrid}),this._grid.xAxisScaleAt(this.$left.offsetWidth,20)}getFrameRang(){if(!this.grid||!this.gridCanvas)return{start:0,end:0};const t=this.gridCanvas.width;return{start:Math.ceil(this.grid.pixelToValueH(this.startOffset+this.grid.xAxisScale/2)),end:Math.floor(this.grid.pixelToValueH(this.startOffset+t-this.grid.xAxisScale/2))}}checkOverFlow(t){const i=this.getFrameRang();return i?t>i.end?t-i.end:t<i.start?t-i.start:0:0}pageToFrame(t){if(!this.grid)return 0;const i=t-this.$left.getBoundingClientRect().right,e=Math.round(this.grid.pixelToValueH(Math.abs(i)));return i>0?e:-e}pageToCtrl(t,i){return{x:t-=this.$left.getBoundingClientRect().right,y:i-=this.$left.getBoundingClientRect().top}}frameToCanvas(t){let i=0;return this.grid&&(i=this.grid.valueToPixelH(t)-this.grid.xAxisOffset),Number(i)}canvasToFrame(t){return this.grid?Math.max(0,Math.round(this.grid.pixelToValueH(t+this.grid.xAxisOffset))):0}}exports.gridCtrl=new GridCtrl;var grid_2=require("../vm/grid");Object.defineProperty(exports,"syncAxisX",{enumerable:!0,get:function(){return grid_2.syncAxisX}}),Object.defineProperty(exports,"syncAxisY",{enumerable:!0,get:function(){return grid_2.syncAxisY}});