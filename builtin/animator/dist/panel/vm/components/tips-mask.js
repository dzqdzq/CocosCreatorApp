"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.methods=exports.components=exports.computed=exports.watch=exports.data=exports.props=exports.template=void 0;const path_1=require("path"),animation_ctrl_1=require("../../share/animation-ctrl"),animation_editor_1=require("../../share/animation-editor");exports.template='\n<section class="mask tips-mask"\n    @confirm="onConfirm"\n>\n    <div v-if="!root" class="tips clip">\n        <ui-label class="message" value="i18n:animator.mask.need_select_node"></ui-label>\n    </div>\n    <div v-else-if="root && active === false" class="tips comp">\n        <ui-label value="i18n:animator.mask.node_active_false"></ui-label>\n    </div>\n    <ui-drag-area v-else droppable="cc.AnimationClip" @drop="onDrop">\n        <div v-if="currentState === \'enterAniMode\'" class="tips animationMode">\n            <ui-button name="enter_animation_mode">\n                <ui-label value="i18n:animator.mask.enter_animation_mode"></ui-label>\n            </ui-button>\n        </div>\n        <div v-if="currentState === \'needAniComponent\'" class="tips comp">\n            <ui-label value="i18n:animator.mask.need_animation_component"></ui-label>\n            <ui-link @click="onConfirm($event, \'add_animation_component\')">\n                <ui-label value="i18n:animator.mask.add_animation_component"></ui-label>\n            </ui-link>\n        </div>\n        <div v-if="currentState === \'needAniClip\'" class="tips clip">\n            <ui-label value="i18n:animator.mask.need_animation_clip"></ui-label>\n            <ui-label v-if="aniComp === \'cc.animation.AnimationController\'" value="i18n:animator.mask.editInAnimationControl"></ui-label>\n            <template v-else>\n                <ui-link @click="onConfirm">\n                    <ui-label name="create_animation_clip" value="i18n:animator.mask.create_animation_clip"></ui-label>\n                </ui-link>\n                <ui-label value="i18n:animator.mask.or"></ui-label>\n                <ui-link @click="onConfirm">\n                    <ui-label name="select_animation_clip" value="i18n:animator.tips.select_animation_clip"></ui-label>\n                </ui-link>\n            </template>\n        </div>\n        <div v-if="aniComp !== \'cc.animation.AnimationController\'">\n            (<ui-label value="i18n:animator.mask.create_from_clip"></ui-label>)\n        </div>\n    </ui-drag-area>\n</section>\n';const ASSET_DB="db://assets",ASSET_Dir=(0,path_1.join)(Editor.Project.path,"assets");function data(){return{}}function mounted(){}exports.props=["root","aniComp","currentClip","animationMode","active"],exports.data=data,exports.watch={},exports.computed={currentState(){const{active:n,root:i,currentClip:a,aniComp:t,animationMode:e}=this;return i?!1===n?"needActiveNode":t||a?a?"enterAniMode":"needAniClip":"needAniComponent":"needSelectNode"}},exports.components={},exports.methods={t:n=>Editor.I18n.t(`animator.mask.${n}`),async onConfirm(n,i){const a=this;switch(i=i||n.target.getAttribute("name")){case"enter_animation_mode":animation_ctrl_1.animationCtrl.enter(a.currentClip);break;case"add_animation_component":animation_ctrl_1.animationCtrl.addAnimationComponent();break;case"create_animation_clip":if(!animation_ctrl_1.animationCtrl.isCreatingAniClip){const n=await animation_ctrl_1.animationCtrl.createAniClip();n&&await animation_ctrl_1.animationCtrl.enter(n)}break;case"select_animation_clip":Editor.Panel.__protected__.openKit("ui-kit.searcher",{elem:n.target,params:[{type:"asset",value:"",droppable:"cc.AnimationClip"}],listeners:{confirm:async n=>{if(!n)return;await animation_ctrl_1.animationCtrl.addClipFromAsset([{value:n.value,name:n.info.name}])?await animation_ctrl_1.animationCtrl.enter(n.value):console.debug(`addClipFromAsset ${n.value} falied!`)}}})}},async onDrop(n){const i=Editor.UI.__protected__.DragArea.currentDragInfo;if("cc.AnimationClip"!==i.type)return;const a=this,t=i.additional.filter(n=>"cc.AnimationClip"===n.type);if(!t.length)return;const e=t.map(n=>n.value);if("needAniComponent"===a.currentState)await animation_ctrl_1.animationCtrl.createAniCompFromAsset(t);else{if("cc.animation.AnimationController"===a.aniComp)return void animation_editor_1.animationEditor.showToast("i18n:animator.mask.editInAnimationControl",2e3);await animation_ctrl_1.animationCtrl.addClipFromAsset(t)}await animation_ctrl_1.animationCtrl.enter(e[0])}},exports.mounted=mounted;