"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.methods=exports.components=exports.computed=exports.watch=exports.data=exports.name=exports.props=exports.template=void 0;const animation_editor_1=require("../../share/animation-editor"),animation_ctrl_1=require("../../share/animation-ctrl"),{join:join}=require("path"),{readFileSync:readFileSync}=require("fs-extra");function data(){return{hoving:!1}}function mounted(){}exports.template=readFileSync(join(__dirname,"./../../../../static/template/components/node-tree.html"),"utf-8"),exports.props=["dumps","selectPath","movePath","lock","selectedIds","index"],exports.name="node-tree",exports.data=data,exports.watch={},exports.computed={disabled(){if(this.lock||!this.dumps.uuid||this.dumps.disabled)return!0},nodeStyle(){return{"padding-left":`${4*this.dumps.indent}px`}},nodeClass(){let t="";t=this.index%2==0?"dark":"light";const e=this.dumps.disabled?"disabled":"";return this.movePath&&this.movePath===this.dumps.path?`content-item moving ${t} ${e}`:`content-item ${t} ${e}`},movingProperty(){return this.movePath&&!this.dumps.uuid?"missing":!(!this.movePath||!this.dumps.uuid)}},exports.components={},exports.methods={t:(t,e="node.")=>Editor.I18n.t(`animator.${e}${t}`),async onMouseDown(t,e){const a=this;if(a.movePath){if(!a.dumps.uuid||a.movePath===a.dumps.path)return;await a.checkMoveData()?animation_ctrl_1.animationCtrl.moveNodeData(e):animation_editor_1.animationEditor.cancelMoveNode()}else if("showPopMenu"!==t.target.getAttribute("name")&&2!==t.button)a.selectPath!==e&&animation_editor_1.animationEditor.selectNode(e,t.ctrlKey);else{let o=!(a.lock||a.dumps.disabled||!animation_ctrl_1.animationCtrl.copyNodeInfo);Editor.Menu.popup({x:t.pageX,y:t.pageY,menu:[{label:a.t("clear_data"),click(){animation_ctrl_1.animationCtrl.clearNodeKeys(e)},enabled:!a.lock&&!a.dumps.disabled},{label:a.t("move_data"),click(){animation_editor_1.animationEditor.startMoveNode(e)},enabled:!a.lock&&!a.dumps.disabled},{label:a.t("copy_data"),click(){animation_ctrl_1.animationCtrl.copyNodeData([e])},enabled:!a.lock&&!a.dumps.disabled,accelerator:"CmdOrCtrl+C"},{label:a.t("paste_data"),click(){animation_ctrl_1.animationCtrl.pasteNodeData(e)},enabled:o,accelerator:"CmdOrCtrl+V"}]})}},onDragStart(){animation_editor_1.animationEditor.setMovePath(this.dumps.path)},onDragEnd(){animation_editor_1.animationEditor.cancelMoveNode()},onDragOver(t){this.movePath&&this.dumps.uuid&&this.dumps.path!==this.movePath&&(this.hoving=!0,t.preventDefault())},onDragLeave(){this.hoving=!1},onDrop(){animation_ctrl_1.animationCtrl.moveNodeData(this.dumps.path)},async checkMoveData(){const t=this,e=e=>t.t("",e);if(1===(await Editor.Dialog.warn(e("is_move_data_message"),{title:e("is_move_data"),buttons:[e("cancel"),e("move")],default:0,cancel:0})).response)return!0}},exports.mounted=mounted;