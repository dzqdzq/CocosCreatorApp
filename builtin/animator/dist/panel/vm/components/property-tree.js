"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.methods=exports.components=exports.computed=exports.watch=exports.data=exports.props=exports.template=void 0;const animation_ctrl_1=require("../../share/animation-ctrl"),animation_editor_1=require("../../share/animation-editor");function data(){return{}}exports.template='\n<div :class="propertyClass"\n    v-if="dumps"\n    :missing="dumps.missing"\n    :selected="selected"\n    @mousedown="onMouseDown"\n>\n    <div class="property-content" :part="dumps.isPart">\n        <ui-icon class="arrow" :expand="isExpand" value="arrow-triangle" v-if="typeof(isExpand) === \'boolean\'" @click.stop="onExpandClick($event)"></ui-icon>\n        <span v-if="dumps.isPart" style="padding-left: 12px;"></span>\n        <span class="name" :tooltip="dumps.displayName">{{dumps.displayName}}{{dumps.missing ? \'(missing)\' : \'\'}}</span>\n        <ani-prop\n            v-if="value && dumps.isPart"\n            :value="value.value"\n            :type="value.type"\n            :extend-arr="value.extends"\n        ></ani-prop>\n    </div>\n    <div class="right">\n        <ui-icon v-if="color && lightCurve" class="curve" value="line" :style="{ \'color\': color }"></ui-icon>\n        <ui-icon v-else-if="color" class="curve" value="line"></ui-icon>\n        <span class="operate">\n            <i class="key"\n                name="key"\n                :empty="isEmpty"\n                :tooltip="operateTitle"\n            ></i>\n        </span>\n    </div>\n</div>\n',exports.props=["keyFrames","frame","prop","type","nodePath","select","lock","index","isExpand","value","color"],exports.data=data,exports.watch={},exports.computed={dumps(){if(!this.nodePath)return;const e=animation_ctrl_1.animationCtrl.getPropData(this.nodePath,this.prop);return e?{displayName:e.displayName,isPart:void 0!==e.parentPropKey,missing:e.missing,curve:e.curve}:void 0},propertyClass(){let e="";return`content-item property ${e=this.index%2==0?"dark":"light"}`},selected(){return this.select&&this.nodePath===this.select.nodePath&&this.select.prop===this.prop},lightCurve(){if(!this.select)return!1;const{nodePath:e,prop:t}=this.select,a=animation_ctrl_1.animationCtrl.clipsDump.pathsDump[e][t];return t===this.prop&&!a.partKeys||!(!a.partKeys||!a.partKeys.includes(this.prop))},operateTitle(){const e=this;return e.isEmpty?e.t("create_key"):e.t("remove_key")},isEmpty(){const e=this;return!e.keyFrames||e.keyFrames.length<1||!e.keyFrames.find(t=>t.frame===e.frame)},params(){return{prop:this.prop,nodePath:this.nodePath,type:this.type}},disabled(){if(this.lock||this.dumps.missing)return!0}},exports.components={"ani-prop":require("./ani-prop")},exports.methods={t:e=>Editor.I18n.t(`animator.property.${e}`),createPopMenuData(e,t,a,r,n){return{label:this.t(e),click(){animation_ctrl_1.animationCtrl[t](a)},enabled:r,accelerator:n?n.accelerator:void 0}},onMouseDown(e){if(!e.target)return;const t=this,a=e.target.getAttribute("name");if("showPopMenu"===a||2===e.button){const a=[];return t.dumps.isPart||a.push(this.createPopMenuData("remove_prop","removeProp",t.params,!t.lock,{accelerator:"Delete"})),a.push(this.createPopMenuData("clear_keys","clearPropKeys",t.params,!t.disabled)),a.push(this.createPopMenuData("copy_prop","copyProp",{nodePath:t.nodePath,prop:t.prop,type:t.type},!t.disabled,{accelerator:"CmdOrCtrl+C"})),t.canPaste()&&a.push(this.createPopMenuData("paste_prop","pasteProp",t.params,!t.disabled,{accelerator:"CmdOrCtrl+V"})),void Editor.Menu.popup({x:e.pageX,y:e.pageY,menu:a})}"key"===a?t.disabled||(t.isEmpty?animation_ctrl_1.animationCtrl.createKey({nodePath:t.nodePath,prop:t.prop}):animation_ctrl_1.animationCtrl.removeKey({nodePath:t.nodePath,prop:t.prop},!0)):animation_editor_1.animationEditor.updateSelectProperty({nodePath:t.nodePath,prop:t.prop,missing:t.dumps.missing,clipUuid:animation_ctrl_1.animationCtrl.clipsDump.uuid,curve:t.dumps.curve})},onExpandClick(){animation_editor_1.animationEditor.updatePropExpandState(this.prop,!this.isExpand)},canPaste(){const e=this,t=animation_ctrl_1.animationCtrl.copyPropInfo;if(!t||!e.type)return!1;for(const a of t.curvesDump)if(a.type.value===e.type.value)return!0;return!1}};