"use strict";const{join:join}=require("path"),{writeFileSync:writeFileSync,readFileSync:readFileSync,readdirSync:readdirSync,statSync:statSync,outputFileSync:outputFileSync}=require("fs-extra");function readDirRecurse(e,n,t=""){const s=readdirSync(e);for(const r of s){const s=join(e,r),c=statSync(s),i=join(t,r);c.isFile()?n(i):readDirRecurse(s,n,i)}}exports.tsc=function(){return["./","./source/editor-extends"]},exports.lessc=function(){return[{source:"./source/contributions/project/modules/project-modules.less",dist:"./dist/contributions/project/modules/project-modules.css"},{source:"./source/contributions/preferences/engine.less",dist:"./dist/contributions/preferences/engine.css"}]},exports.file=function(e){const n=join(__dirname,"./static/cc-template.d.ts"),t=join(__dirname,"./modules/cc/cc.d.ts"),s=join(e.enginePath,"./bin/.declarations/cc.d.ts"),r=join(e.enginePath,"./bin/.declarations/cc.editor.d.ts");writeFileSync(t,`\n/// <reference path="${s}"/>\n\n/// <reference path="${r}"/>\n\n${readFileSync(n)}\n\n`.replace(/\\/g,"\\\\"));const c=join(__dirname,"./modules/cc/editor");var i;return readDirRecurse(join(e.enginePath,"editor","exports"),e=>{const n=e.endsWith(".ts")?e.substr(0,e.length-3):e,t=join(c,`${n}.js`),s=`\nconst modsMgr = require('cc/mods-mgr');\nmodule.exports = modsMgr.syncImport('${`cc/editor/${((e=e).endsWith(".ts")?e.substr(0,e.length-3):e).replace(/\\/g,"\\\\")}`}');\n`;outputFileSync(t,s,{encoding:"utf8"})}),[{source:"./source",dist:"./dist",filter:e=>/\.html$/.test(e)},{source:"./modules/cc",dist:"../../node_modules/cc"}]},exports.npm=function(){return[{message:"安装编译原生引擎插件依赖的模块",params:["install","--production","--no-save"],path:join(__dirname,"./static/engine-unpacked"),detail:"安装编译原生引擎插件依赖的模块失败"}]};