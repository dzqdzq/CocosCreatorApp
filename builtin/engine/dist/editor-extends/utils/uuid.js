"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.uuid=exports.getUuidFromLibPath=exports.isUuid=exports.decompressUuid=exports.compressHex=exports.compressUuid=exports.NonUuidMark=void 0,globalThis.AppModulePath&&module.paths.push(AppModulePath);const tempWindow=window;globalThis.AppModulePath&&isSceneNative&&(window=void 0);const Uuid=require("node-uuid");globalThis.AppModulePath&&isSceneNative&&(window=tempWindow);const Base64KeyChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",AsciiTo64=new Array(128);for(let e=0;e<128;++e)AsciiTo64[e]=0;for(let e=0;e<64;++e)AsciiTo64[Base64KeyChars.charCodeAt(e)]=e;const Reg_Dash=/-/g,Reg_Uuid=/^[0-9a-fA-F-]{36}$/,Reg_NormalizedUuid=/^[0-9a-fA-F]{32}$/,Reg_CompressedUuid=/^[0-9a-zA-Z+/]{22,23}$/,Reg_CompressedSubAssetUuid=/^([0-9a-zA-Z+/]{22,23})(@.{5})$/,Reg_subAssetUuid=/([^@]{32,36})(@.{5})$/,Reg_UuidInLibPath=/.*[/\\][0-9a-fA-F]{2}[/\\]([0-9a-fA-F-@]{8,}).*/;function compressUuid(e,s){const o=e.match(Reg_subAssetUuid);return o?compressNormalUuid(e=o[1],s)+o[2]:compressNormalUuid(e,s)}function compressNormalUuid(e,s){if(Reg_Uuid.test(e))e=e.replace(Reg_Dash,"");else if(!Reg_NormalizedUuid.test(e))return e;return compressHex(e,!0===s?2:5)}function compressHex(e,s){const o=e.length;let i;i=void 0!==s?s:o%3;const t=e.slice(0,i),r=[];for(;i<o;){const s=parseInt(e[i],16),o=parseInt(e[i+1],16),t=parseInt(e[i+2],16);r.push(Base64KeyChars[s<<2|o>>2]),r.push(Base64KeyChars[(3&o)<<4|t]),i+=3}return t+r.join("")}function decompressUuid(e){const s=e.match(Reg_CompressedSubAssetUuid);return s?decompressNormalUuid(e=s[1])+s[2]:decompressNormalUuid(e)}function decompressNormalUuid(e){if(23===e.length){const s=[];for(let o=5;o<23;o+=2){const i=AsciiTo64[e.charCodeAt(o)],t=AsciiTo64[e.charCodeAt(o+1)];s.push((i>>2).toString(16)),s.push(((3&i)<<2|t>>4).toString(16)),s.push((15&t).toString(16))}e=e.slice(0,5)+s.join("")}else{if(22!==e.length)return e;{const s=[];for(let o=2;o<22;o+=2){const i=AsciiTo64[e.charCodeAt(o)],t=AsciiTo64[e.charCodeAt(o+1)];s.push((i>>2).toString(16)),s.push(((3&i)<<2|t>>4).toString(16)),s.push((15&t).toString(16))}e=e.slice(0,2)+s.join("")}}return[e.slice(0,8),e.slice(8,12),e.slice(12,16),e.slice(16,20),e.slice(20)].join("-")}function isUuid(e){return Reg_CompressedUuid.test(e)||Reg_NormalizedUuid.test(e)||Reg_Uuid.test(e)||Reg_subAssetUuid.test(e)}function getUuidFromLibPath(e){const s=e.match(Reg_UuidInLibPath);return s?encodeURI(s[1]):""}function uuid(){return compressUuid(Uuid.v4(),!0)}exports.NonUuidMark=".",exports.compressUuid=compressUuid,exports.compressHex=compressHex,exports.decompressUuid=decompressUuid,exports.isUuid=isUuid,exports.getUuidFromLibPath=getUuidFromLibPath,exports.uuid=uuid;