"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.data=exports.watch=exports.methods=exports.template=exports.style=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path");exports.style=fs_extra_1.readFileSync(path_1.join(__dirname,"./style.css"),"utf8");const DERACTIONS=["-X","+X","+Y","-Y","+Z","-Z"],KEYS=["left","right","top","bottom","front","back"];function data(){return{meta:null,info:null,readonly:{value:!0},KEYS:KEYS,DERACTIONS:DERACTIONS,size:40,isUnlegalWrapModeS:!1,isUnlegalWrapModeT:!1}}function mounted(){this.info=this.infos[0],this.meta=this.metas[0]}exports.template='\n<section class="asset-texture-cube">\n    <template\n        v-if="metas.length === 1 && meta"\n    >\n        <div class="ins-prop" \n            v-for="(name, index) in KEYS" \n            :key="name + index"\n        >\n            <div class="name">\n                <span\n                    :title="name"\n                >{{name}} ( {{DERACTIONS[index]}} ) </span>\n            </div>\n            <div class="content">\n                <ui-asset\n                    droppable="cc.ImageAsset"\n                    :value="meta.userData && meta.userData[name]"\n                    @change="updateMeta(name, $event.target.value)"\n                ></ui-asset>\n            </div>\n        </div>\n        <div class="texture-cube-preview" ref="preview">\n            <div class="center">\n                <ui-drag-item\n                    v-for="(name, index) in KEYS"\n                    :key="name + index"\n                    :draggable="meta.userData[name]"\n                    type="cc.ImageAsset"\n                    @dragstart="onImageDragStart($event, name, meta.userData[name])"\n                >\n                    <ui-image class="info"\n                        droppable="cc.ImageAsset"\n                        :key="meta.userData[name] + name"\n                        :placeholder="name"\n                        :value="meta.userData && meta.userData[name]"\n                        @change="updateMeta(name, $event.target.value)"\n                        @drop="onImageDrop"\n                        :class="name"\n                        :tooltip="name"\n                        additional="true"\n                    ></ui-image>\n                </ui-drag-item>\n            </div>\n        </div>\n        <section class="asset-texture">\n            <div class="content"\n                v-if="meta"\n            >\n                <ui-prop>\n                    <ui-label slot="label" tooltip="Anisotropy">Anisotropy</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-num-input slot="content"\n                        :invalid="getInvalid(\'anisotropy\')"\n                        :value="meta.userData.anisotropy"\n                        @change="_onChangeData($event, \'anisotropy\')"\n                    ></ui-num-input>\n                </ui-prop>\n                <ui-prop>\n                    <ui-label slot="label" tooltip="Min Filter">Min Filter</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-select slot="content"\n                        :invalid="getInvalid(\'minfilter\')"\n                        :value="meta.userData.minfilter"\n                        @change="_onChangeData($event, \'minfilter\')"\n                    >\n                        <option\n                            v-for="item in [\'nearest\' , \'linear\']"\n                            :value="item"\n                        >{{item}}</option>\n                    </ui-select>\n                </ui-prop>\n                <ui-prop>\n                    <ui-label slot="label" tooltip="Mag Filter">Mag Filter</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-select slot="content"\n                        :invalid="getInvalid(\'magfilter\')"\n                        :value="meta.userData.magfilter"\n                        @change="_onChangeData($event, \'magfilter\')"\n                    >\n                        <option\n                            v-for="item in [\'nearest\' , \'linear\']"\n                            :value="item"\n                        >{{item}}</option>\n                    </ui-select>\n                </ui-prop>\n                <ui-prop>\n                    <ui-label slot="label" tooltip="Mip Filter">Mip Filter</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-select slot="content"\n                        :invalid="getInvalid(\'mipfilter\')"\n                        :value="meta.userData.mipfilter"\n                        @change="_onChangeData($event, \'mipfilter\')"\n                    >\n                        <option\n                            v-for="item in [\'none\', \'nearest\' , \'linear\']"\n                            :value="item"\n                        >{{item}}</option>\n                    </ui-select>\n                </ui-prop>\n                <ui-prop\n                    :class="isUnlegalWrapModeS?\'warn\':undefined"\n                >\n                    <ui-label slot="label" tooltip="Wrap Mode S">Wrap Mode S</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-select slot="content"\n                        :invalid="getInvalid(\'wrapModeS\')"\n                        :value="meta.userData.wrapModeS"\n                        @change="_onChangeData($event, \'wrapModeS\')"\n                    >\n                        <option\n                            v-for="item in [\'repeat\', \'clamp-to-edge\', \'mirrored-repeat\']"\n                            :value="item"\n                        >{{item}}</option>\n                    </ui-select>\n                </ui-prop>\n                <ui-prop\n                    :class="isUnlegalWrapModeT?\'warn\':undefined"\n                >\n                    <ui-label slot="label" tooltip="Wrap Mode T">Wrap Mode T</ui-label>\n                    <ui-icon value="lock" slot="label"\n                        v-if="readonly.value"\n                    ></ui-icon>\n                    <ui-select slot="content"\n                        :invalid="getInvalid(\'wrapModeT\')"\n                        :value="meta.userData.wrapModeT"\n                        @change="_onChangeData($event, \'wrapModeT\')"\n                    >\n                        <option\n                            v-for="item in [\'repeat\', \'clamp-to-edge\', \'mirrored-repeat\']"\n                            :value="item"\n                        >{{item}}</option>\n                    </ui-select>\n                </ui-prop>\n                <div class="warn-words">\n                    <ui-label i18n\n                        v-if="isUnlegalWrapModeT || isUnlegalWrapModeS"\n                    >inspector.asset.texture.modeWarn</ui-label>\n                </div>\n            </div>\n        </section>\n    </template>\n</section>\n',exports.methods={getInvalid(e){const n=this.metas[0].userData[e];return!this.metas.every(a=>n===a.userData[e])},calcSize(){const e=this;if(!e.$refs.preview)return;const{clientWidth:n,clientHeight:a}=e.$refs.preview;e.size=Math.round(Math.min((n-40)/4,(a-40)/3)),e.$refs.preview.style.setProperty("--size",e.size+"px")},updateMeta(e,n){const a=this;void 0!==n&&a.meta&&a.$set(a.meta.userData,e,n),setTimeout(()=>{a.checkWrapMode()},100)},_onChangeData(e,n){const a=this;a.metas.forEach(t=>{a.$set(t.userData,n,e.target.value)}),a.checkWrapMode()},checkWrapMode(){const e=this,{wrapModeT:n,wrapModeS:a}=e.meta.userData;e.isUnlegalWrapModeT=!1,e.isUnlegalWrapModeS=!1,e.$el.querySelectorAll("ui-image").forEach(t=>{if(t.$img.src){const i=new Image;i.src=t.$img.src;const{width:l,height:o}=i,r=l&l-1||o&o-1,s=r&&"repeat"===n,u=r&&"repeat"===a;s&&(e.isUnlegalWrapModeT=s),u&&(e.isUnlegalWrapModeS=u)}})},onImageDragStart(e,n,a){n&&a&&(e.dataTransfer.setData("value",a),e.dataTransfer.setData("name",n),e.dataTransfer.setData("from","texture-cube-image"))},onImageDrop(e){if("texture-cube-image"!==e.dataTransfer.getData("from"))return;const n=e.dataTransfer.getData("name");this.updateMeta(n,null)}},exports.watch={width(){this.calcSize()},infos(){this.info=this.infos[0]},info(){this.readonly.value=this.info&&this.info.readonly},metas(){this.meta=this.metas[0]},meta(){const e=this;requestAnimationFrame(()=>{e.calcSize()})}},exports.data=data,exports.mounted=mounted;