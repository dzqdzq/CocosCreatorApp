"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(){var o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[r.length]=t);return r})(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),n=0;n<r.length;n++)"default"!==r[n]&&__createBinding(t,e,r[n]);return __setModuleDefault(t,e),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerMacroConfig=registerMacroConfig;const path_1=require("path"),ts=__importStar(require("typescript")),fs_1=require("fs"),type2UI={string:"ui-input",number:"ui-num-input",boolean:"ui-checkbox"},ReadonlyKeyList=["SUPPORT_TEXTURE_FORMATS","KEY","RAD","DEG","FLT_EPSILON","ORIENTATION_PORTRAIT","ORIENTATION_PORTRAIT_UPSIDE_DOWN","ORIENTATION_LANDSCAPE","ORIENTATION_LANDSCAPE_LEFT","ORIENTATION_LANDSCAPE_RIGHT","ORIENTATION_AUTO","REPEAT_FOREVER","CUSTOM_PIPELINE_NAME"];async function registerMacroConfig(e){const n=(await Promise.resolve().then(()=>__importStar(require("cc/editor/macro"))))["macro"];var t=Editor.Package.getPackages({name:"engine"});if(!(t.length<=0)){t=t[0];if(t.info.contributions){var r,e=(0,path_1.join)(e,"cocos/core/platform/macro.ts");const o={},i={},a={};try{(0,fs_1.existsSync)(e)&&((r=ts.createSourceFile(e,(0,fs_1.readFileSync)(e).toString(),ts.ScriptTarget.Latest,!0).statements.find(e=>ts.isInterfaceDeclaration(e)&&"Macro"===e.name.escapedText))&&r.members.filter(e=>e.jsDoc?.length&&["en","zh"].every(t=>e.jsDoc[0].tags.some(e=>e.tagName.escapedText===t))).forEach(e=>{var t=e.jsDoc[0].tags;o[e.name.escapedText]={en:t.find(e=>"en"===e.tagName.escapedText).comment,zh:t.find(e=>"zh"===e.tagName.escapedText).comment},i[e.name.escapedText]=o[e.name.escapedText].en,a[e.name.escapedText]=o[e.name.escapedText].zh}),Editor.I18n.__protected__.register("en","engine_macro",i),Editor.I18n.__protected__.register("zh","engine_macro",a))}catch(e){console.error(e)}const c=t.info.contributions.project.macroConfig,s=(c.content={},{}),f={};Object.keys(n).forEach(e=>{var t,r;ReadonlyKeyList.includes(e)||(t=n[e],["string","number","boolean"].includes(r=typeof t)&&(s["macroConfig."+e]={label:e,default:t,description:"i18n:engine_macro."+e},f[e]=t,c.content["macroConfig."+e]={ui:type2UI[r]}))}),await Editor.Profile.setProject("engine","macroConfig",f,"default"),t.info.contributions.profile.project||(t.info.contributions.profile.project={}),Object.assign(t.info.contributions.profile.project,s),t.info.contributions.project.macroConfig=c}}}