"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerMacroConfig=void 0;const path_1=require("path"),ts=__importStar(require("typescript")),fs_1=require("fs"),type2UI={string:"ui-input",number:"ui-num-input",boolean:"ui-checkbox"},ReadonlyKeyList=["SUPPORT_TEXTURE_FORMATS","KEY","RAD","DEG","FLT_EPSILON","ORIENTATION_PORTRAIT","ORIENTATION_LANDSCAPE","ORIENTATION_AUTO","REPEAT_FOREVER"];async function registerMacroConfig(e){const{macro:t}=await Promise.resolve().then(()=>__importStar(require("cc/editor/macro"))),r=Editor.Package.getPackages({name:"engine"});if(r.length<=0)return;const n=r[0];if(!n.info.contributions)return;const o=(0,path_1.join)(e,"cocos/core/platform/macro.ts"),i={},c={},a={};try{if((0,fs_1.existsSync)(o)){const e=ts.createSourceFile(o,(0,fs_1.readFileSync)(o).toString(),ts.ScriptTarget.Latest,!0).statements.find(e=>ts.isInterfaceDeclaration(e)&&"Macro"===e.name.escapedText);e&&e.members.filter(e=>{var t;return(null===(t=e.jsDoc)||void 0===t?void 0:t.length)&&["en","zh"].every(t=>e.jsDoc[0].tags.some(e=>e.tagName.escapedText===t))}).forEach(e=>{const t=e.jsDoc[0].tags;i[e.name.escapedText]={en:t.find(e=>"en"===e.tagName.escapedText).comment,zh:t.find(e=>"zh"===e.tagName.escapedText).comment},c[e.name.escapedText]=i[e.name.escapedText].en,a[e.name.escapedText]=i[e.name.escapedText].zh}),Editor.I18n.__protected__.register("en","engine_macro",c),Editor.I18n.__protected__.register("zh","engine_macro",a)}}catch(e){console.error(e)}const s=n.info.contributions.project.macroConfig;s.content={};const f={},u={};Object.keys(t).forEach(e=>{if(ReadonlyKeyList.includes(e))return;const r=t[e],n=typeof r;["string","number","boolean"].includes(n)&&(f[`macroConfig.${e}`]={label:e,default:r,description:`i18n:engine_macro.${e}`},u[e]=r,s.content[`macroConfig.${e}`]={ui:type2UI[n]})}),await Editor.Profile.setProject("engine","macroConfig",u,"default"),n.info.contributions.profile.project||(n.info.contributions.profile.project={}),Object.assign(n.info.contributions.profile.project,f),n.info.contributions.project.macroConfig=s}exports.registerMacroConfig=registerMacroConfig;