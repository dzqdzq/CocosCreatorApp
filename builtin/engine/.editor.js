"use strict";const{join:join,extname:extname,relative:relative}=require("path"),{writeFileSync:writeFileSync,readdirSync:readdirSync,existsSync:existsSync,statSync:statSync}=require("fs-extra"),{pseudoRandomBytes:pseudoRandomBytes}=require("crypto");exports.js=function(){return["./"]},exports.css=function(){const e=[];return(()=>{const n=join(__dirname,"./source/contributions/inspector/assets"),o=join(__dirname,"./dist/contributions/inspector/assets");readdirSync(n).forEach(t=>{const s=join(n,t);existsSync(s)&&statSync(s).isDirectory()&&readdirSync(s).filter(e=>".less"===extname(e)).forEach(n=>{e.push({source:relative(__dirname,join(s,n)),dist:relative(__dirname,join(o,t,n)).replace(/\.less$/,".css")})})})})(),(()=>{const n=join(__dirname,"./source/contributions/inspector/components"),o=join(__dirname,"./dist/contributions/inspector/components");readdirSync(n).forEach(t=>{const s=join(n,t);existsSync(s)&&statSync(s).isDirectory()&&readdirSync(s).filter(e=>".less"===extname(e)).forEach(n=>{e.push({source:relative(__dirname,join(s,n)),dist:relative(__dirname,join(o,t,n)).replace(/\.less$/,".css")})})})})(),e.push({source:"./source/contributions/project/modules/project-modules.less",dist:"./dist/contributions/project/modules/project-modules.css"}),e},exports.module=function(e){(e=e||{}).user=e.user||{},e.PATH=e.PATH||{RESOURCES:join(__dirname,"../../../resources")};const n=join(__dirname,"./modules/cc/cc.d.ts"),o=e.user&&e.user.customJavascriptEngine?join(e.user.customJavascriptEngine,"./bin/.declarations/cc.d.ts"):join(e.PATH.RESOURCES,"./3d/engine/bin/.declarations/cc.d.ts");return writeFileSync(n,`/// <reference path="${o}"/>\ndeclare const CC_BUILD: boolean;\ndeclare const CC_TEST: boolean;\ndeclare const CC_EDITOR: boolean;\ndeclare const CC_PREVIEW: boolean;\ndeclare const CC_DEV: boolean;\ndeclare const CC_DEBUG: boolean;\ndeclare const CC_JSB: boolean;\ndeclare const CC_WECHAT: boolean;\ndeclare const CC_ALIPAY: boolean;\ndeclare const CC_XIAOMI: boolean;\ndeclare const CC_BAIDU: boolean;\ndeclare const CC_COCOSPLAY: boolean;\ndeclare const CC_MINIGAME: boolean;\ndeclare const CC_RUNTIME_BASED: boolean;\ndeclare const CC_SUPPORT_JIT: boolean;\ndeclare const CC_PHYSICS_CANNON: boolean;\ndeclare const CC_PHYSICS_AMMO: boolean;\ndeclare const CC_PHYSICS_BUILTIN: boolean;\ndeclare const cc: any;\n\n// polyfills for editor\ndeclare module 'cc' {\n    interface CCObject {\n        isRealValid: boolean;\n    }\n    interface BaseNode {\n        // restore the PrefabInstance Node when this node is the mounted child node of it.\n        _mountedRoot?: Node;\n    }\n    interface Component {\n        // restore the PrefabInstance Node when this component is the mounted component under it.\n        _mountedRoot?: Node\n    }\n}\n`.replace(/\\/g,"\\\\")),["./modules/cc"]},exports["simulate-node-module"]=(()=>{return exports.module().map(e=>join(__dirname,e))}),exports.file=function(){return[{src:"./source",dist:"./dist",filter:/\.html$/}]},exports.generate=async function(){global.Editor={Profile:{load(){}},App:{dev:!0},Project:{}};const{compileEngine:e}=require("./dist/browser/utils"),n=join(__dirname,"../../../resources","3d","engine");await e(n,!0)};