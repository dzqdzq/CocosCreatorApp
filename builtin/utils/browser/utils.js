"use strict";const{join:join,basename:basename,relative:relative}=require("path"),{copy:copy,readdir:readdir,existsSync:existsSync,readFile:readFile,outputFile:outputFile,stat:stat}=require("fs-extra"),exclude=["browser","browser.d.ts","renderer","renderer.d.ts","private","private.d.ts"];exports.exportEditorDTS=async function(e){const t=join(Editor.App.path,"@types");await exports.recursiveFile(t,async(i,a)=>{if(a.isDirectory())return;const r=relative(t,i),s=join(e,r),o=await readFile(i);await outputFile(s,o)});const i=join(e,"message.d.ts");let a=await readFile(i,"utf8");a=a.replace(/'\.\.\/builtin\/([^\/]+)\/@types\//g,(e,t)=>`'./packages/${t}/@types/`),await outputFile(i,a);const r=join(e,"editor.d.ts");let s=await readFile(r,"utf8");s="/// <reference path='./electron.d.ts'/>\n\n"+s,await outputFile(r,s)},exports.exportPackageDTS=async function(e){const t=join(Editor.App.path,"builtin"),i=await readdir(t);for(let a of i){const i=join(t,a,"@types");if(!existsSync(i))continue;const r=join(e,"packages",a,"@types");await exports.recursiveFile(i,async(e,t)=>{if(t.isDirectory())return;const a=relative(i,e),s=join(r,a),o=await readFile(e);await outputFile(s,o)})}},exports.recursiveFile=async function(e,t){await async function e(i){const a=await readdir(i);for(let r of a){if(exclude.includes(r))continue;const a=join(i,r),s=await stat(a);await t(a,s),s.isDirectory()&&await e(a)}}(e)};