"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assetDump=void 0;const{promisify:promisify}=require("util");class AssetDump{encode(e,s,u){const t=e&&e._uuid||"";s.value={uuid:t.startsWith("pm_")?"":t}}async decode(e,s,u,t){if(Array.isArray(u.value)){const t=[];for(let e=0;e<u.value.length;e++){const s=u.value[e];if(s&&s.value.uuid&&!s.value.uuid.startsWith("ui-")){const a=await new Promise(e=>{cc.assetManager.loadAny(s.value.uuid,(u,t)=>{u?(console.error(`asset can't be load:${s.value.uuid}`),e(null)):e(t)})});if(a)t[e]=a;else{const s=EditorExtends.serialize.asAsset(u.value.uuid,cc.js.getClassById(u.type));s.initDefault(),t[e]=s}}else t[e]=null}e[s.key]=t}else if(u.value&&u.value.uuid&&!u.value.uuid.startsWith("ui-")){const t=await new Promise(e=>{cc.assetManager.loadAny(u.value.uuid,(s,t)=>{s?(console.error(`asset can't be load:${u.value.uuid}`),e(null)):e(t)})});if(t)e[s.key]=t;else{const t=EditorExtends.serialize.asAsset(u.value.uuid,cc.js.getClassById(u.type));t.initDefault(),e[s.key]=t}}else e[s.key]=null}}exports.assetDump=new AssetDump;