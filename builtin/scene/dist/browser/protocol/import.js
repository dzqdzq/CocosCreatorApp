"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handler=exports.type=void 0;const path_1=require("path");async function handler(r,t){const e=require("fs");r=require("url").parse(decodeURIComponent(r.url));const a=(0,path_1.join)(r.hostname,r.pathname);t({path:(await queryOtherLibraryPath()).map(r=>(0,path_1.join)(r,a)).find(r=>e.existsSync(r))||(0,path_1.join)(Editor.Project.path,"library",a)})}exports.type="registerFileProtocol",exports.handler=handler;let otherLibraryPath=null;async function queryOtherLibraryPath(){if(!otherLibraryPath)try{var r=await Editor.Message.request("asset-db","query-db-infos");otherLibraryPath=r.map(r=>r.library)}catch(r){console.debug(r),otherLibraryPath=[(0,path_1.join)(Editor.App.temp,"asset-db/library")]}return otherLibraryPath}