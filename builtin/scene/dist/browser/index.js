"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unload=exports.load=exports.methods=void 0;const ElectronModule=require("@base/electron-module"),path_1=require("path"),scene_cache_1=require("./scene-cache"),electron=require("electron");async function load(){const e={import:require("./protocol/import")};ElectronModule.register("PreviewExtends",path_1.join(__dirname,"../preview-extends/index")),Object.keys(e).forEach(a=>{const n=e[a];require("electron").protocol[n.type](a,n.handler)}),exports.methods.updateCreateNodeTemplate("");try{await scene_cache_1.sceneCacheManager.init()}catch(e){console.error(e)}require("@base/electron-base-ipc").on("scene:check-ipc",e=>!0)}async function unload(){}electron.ipcMain.on("fire-web-contents",e=>{e.sender.on("new-window",(e,a,n,s,c,d)=>{e.preventDefault(),Object.assign(c,{autoHideMenuBar:!0});const r=new electron.BrowserWindow(c);e.newGuest=r})}),exports.methods={open(){Editor.Panel.open("scene")},updateCreateNodeTemplate(e){const a=[{label:"i18n:scene.menu.newNodeEmpty",target:"scene",params:[{name:"Node"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Node"})}},{label:"i18n:scene.menu.new3dObject",submenu:[{label:"i18n:scene.menu.new3dCube",target:"scene",params:[{name:"Cube",assetUuid:"30da77a1-f02d-4ede-aa56-403452ee7fde"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Cube",assetUuid:"30da77a1-f02d-4ede-aa56-403452ee7fde",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dCylinder",target:"scene",params:[{name:"Cylinder",assetUuid:"ab3e16f9-671e-48a7-90b7-d0884d9cbb85"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Cylinder",assetUuid:"ab3e16f9-671e-48a7-90b7-d0884d9cbb85",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dSphere",target:"scene",params:[{name:"Sphere",assetUuid:"655c9519-1a37-472b-bae6-29fefac0b550"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Sphere",assetUuid:"655c9519-1a37-472b-bae6-29fefac0b550",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dCapsule",target:"scene",params:[{name:"Capsule",assetUuid:"73ce1f7f-d1f4-4942-ad93-66ca3b3041ab"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Capsule",assetUuid:"73ce1f7f-d1f4-4942-ad93-66ca3b3041ab",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dCone",target:"scene",params:[{name:"Cone",assetUuid:"6350d660-e888-4acf-a552-f3b719ae9110"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Cone",assetUuid:"6350d660-e888-4acf-a552-f3b719ae9110",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dTorus",target:"scene",params:[{name:"Torus",assetUuid:"d47f5d5e-c931-4ff4-987b-cc818a728b82"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Torus",assetUuid:"d47f5d5e-c931-4ff4-987b-cc818a728b82",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dPlane",target:"scene",params:[{name:"Plane",assetUuid:"40563723-f8fc-4216-99ea-a81636435c10"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Plane",assetUuid:"40563723-f8fc-4216-99ea-a81636435c10",unlinkPrefab:!0})}},{label:"i18n:scene.menu.new3dQuad",target:"scene",params:[{name:"Quad",assetUuid:"34a07346-9f62-4a84-90ae-cb83f7a426c1"}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Quad",assetUuid:"34a07346-9f62-4a84-90ae-cb83f7a426c1",unlinkPrefab:!0})}}].sort((e,a)=>e.params[0].name.localeCompare(a.params[0].name))},{label:"i18n:scene.menu.newRenderUI",submenu:[{label:"i18n:scene.menu.newUISprite",target:"scene",params:[{name:"Sprite",assetUuid:"9db8cd0b-cbe4-42e7-96a9-a239620c0a9d",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Sprite",assetUuid:"9db8cd0b-cbe4-42e7-96a9-a239620c0a9d",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUISpriteSplash",target:"scene",params:[{name:"SpriteSplash",assetUuid:"e5f21aad-3a69-4011-ac62-b74352ac025e",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"SpriteSplash",assetUuid:"e5f21aad-3a69-4011-ac62-b74352ac025e",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUILabel",target:"scene",params:[{name:"Label",assetUuid:"36008810-7ad3-47c0-8112-e30aee089e45",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Label",assetUuid:"36008810-7ad3-47c0-8112-e30aee089e45",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUITiledMap",target:"scene",params:[{name:"TiledMap",assetUuid:"3139fa4f-8c42-4ce6-98be-15e848d9734c",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"TiledMap",assetUuid:"3139fa4f-8c42-4ce6-98be-15e848d9734c",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIMask",target:"scene",params:[{name:"Mask",assetUuid:"7fa63aed-f3e2-46a5-8a7c-c1a1adf6cea6",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Mask",assetUuid:"7fa63aed-f3e2-46a5-8a7c-c1a1adf6cea6",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIParticle2D",target:"scene",params:[{name:"Particle2D",assetUuid:"f396261e-3e06-41ec-bdd6-9a8b6d99026f",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Particle2D",assetUuid:"f396261e-3e06-41ec-bdd6-9a8b6d99026f",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIGraphics",target:"scene",params:[{name:"Graphics",assetUuid:"c96e159e-43ea-4a16-8279-05bc39119d1a",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Graphics",assetUuid:"c96e159e-43ea-4a16-8279-05bc39119d1a",canvasRequired:!0,unlinkPrefab:!0})}}].sort((e,a)=>e.params[0].name.localeCompare(a.params[0].name))},{label:"i18n:scene.menu.newUI",submenu:[{label:"i18n:scene.menu.newUILayout",target:"scene",params:[{name:"Layout",assetUuid:"a9ef7dfc-ea8b-4cf8-918e-36da948c4de0",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Layout",assetUuid:"a9ef7dfc-ea8b-4cf8-918e-36da948c4de0",canvasRequired:!0})}},{label:"i18n:scene.menu.newUICanvas",target:"scene",params:[{name:"Canvas",assetUuid:"f773db21-62b8-4540-956a-29bacf5ddbf5",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Canvas",assetUuid:"f773db21-62b8-4540-956a-29bacf5ddbf5",unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIButton",target:"scene",params:[{name:"Button",assetUuid:"90bdd2a9-2838-4888-b66c-e94c8b7a5169",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Button",assetUuid:"90bdd2a9-2838-4888-b66c-e94c8b7a5169",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIRichText",target:"scene",params:[{name:"RichText",assetUuid:"fc6bfcfa-8086-4326-809b-0ba1226bac7d",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"RichText",assetUuid:"fc6bfcfa-8086-4326-809b-0ba1226bac7d",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIToggle",target:"scene",params:[{name:"Toggle",assetUuid:"0e89afe7-56de-4f99-96a1-cba8a75bedd2",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Toggle",assetUuid:"0e89afe7-56de-4f99-96a1-cba8a75bedd2",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIToggleGroup",target:"scene",params:[{name:"ToggleGroup",assetUuid:"2af73429-41d1-4346-9062-7798e42945dd",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"ToggleGroup",assetUuid:"2af73429-41d1-4346-9062-7798e42945dd",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUISlider",target:"scene",params:[{name:"Slider",assetUuid:"2bd7e5b6-cd8c-41a1-8136-ddb8efbf6326",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Slider",assetUuid:"2bd7e5b6-cd8c-41a1-8136-ddb8efbf6326",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIProgressBar",target:"scene",params:[{name:"ProgressBar",assetUuid:"0d9353c4-6fb9-49bb-bc62-77f1750078c2",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"ProgressBar",assetUuid:"0d9353c4-6fb9-49bb-bc62-77f1750078c2",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIWidget",target:"scene",params:[{name:"Widget",assetUuid:"36ed4422-3542-4cc4-bf02-dc4bfc590836",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Widget",assetUuid:"36ed4422-3542-4cc4-bf02-dc4bfc590836",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIEditBox",target:"scene",params:[{name:"EditBox",assetUuid:"05e79121-8675-4551-9ad7-1b901a4025db",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"EditBox",assetUuid:"05e79121-8675-4551-9ad7-1b901a4025db",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIScrollView",target:"scene",params:[{name:"ScrollView",assetUuid:"c1baa707-78d6-4b89-8d5d-0b7fdf0c39bc",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"ScrollView",assetUuid:"c1baa707-78d6-4b89-8d5d-0b7fdf0c39bc",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIVideoPlayer",target:"scene",params:[{name:"VideoPlayer",assetUuid:"7e089eaf-fa97-40d7-8a20-741a152585df",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"VideoPlayer",assetUuid:"7e089eaf-fa97-40d7-8a20-741a152585df",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIWebView",target:"scene",params:[{name:"WebView",assetUuid:"9c541fa2-1dc8-4d8b-813a-aec89133f5b1",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"WebView",assetUuid:"9c541fa2-1dc8-4d8b-813a-aec89133f5b1",canvasRequired:!0,unlinkPrefab:!0})}},{label:"i18n:scene.menu.newUIPageView",target:"scene",params:[{name:"PageView",assetUuid:"20a5d8cb-ccad-4543-a937-fccd98c9f3de",canvasRequired:!0,unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"PageView",assetUuid:"20a5d8cb-ccad-4543-a937-fccd98c9f3de",canvasRequired:!0,unlinkPrefab:!0})}}].sort((e,a)=>e.params[0].name.localeCompare(a.params[0].name))},{label:"i18n:scene.menu.newLightObject",submenu:[{label:"i18n:scene.menu.newLightDirectional",target:"scene",params:[{name:"Directional Light",assetUuid:"a0e9756d-9128-4f49-8097-e041c8b733b8",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Directional Light",assetUuid:"a0e9756d-9128-4f49-8097-e041c8b733b8",unlinkPrefab:!0})}},{label:"i18n:scene.menu.newLightSphere",target:"scene",params:[{name:"Sphere Light",assetUuid:"4182ee46-ffa0-4de2-b66b-c93cc6c7e9b8",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Sphere Light",assetUuid:"4182ee46-ffa0-4de2-b66b-c93cc6c7e9b8",unlinkPrefab:!0})}},{label:"i18n:scene.menu.newLightSpot",target:"scene",params:[{name:"Spot Light",assetUuid:"7a49aa24-bd7a-40a8-b31a-b2a9da85abcd",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Spot Light",assetUuid:"7a49aa24-bd7a-40a8-b31a-b2a9da85abcd",unlinkPrefab:!0})}}]},{label:"i18n:scene.menu.newEffects",submenu:[{label:"i18n:scene.menu.newEffectsParticle",target:"scene",params:[{name:"Particle",assetUuid:"f09a0597-10e6-49e5-8759-a148b5e85395",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Particle",assetUuid:"f09a0597-10e6-49e5-8759-a148b5e85395",unlinkPrefab:!0})}}]},{label:"i18n:scene.menu.newCameraObject",target:"scene",params:[{name:"Camera",assetUuid:"bb0a6472-cd67-4afb-a031-94fca8f4cc92",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Camera",assetUuid:"bb0a6472-cd67-4afb-a031-94fca8f4cc92",unlinkPrefab:!0})}}];a.push({label:"i18n:scene.menu.newTerrain",target:"scene",params:[{name:"Terrain",assetUuid:"90e8b0d4-12dc-412d-9156-ea1fdb18c15b",unlinkPrefab:!0}],click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","create-node",{name:"Terrain",assetUuid:"90e8b0d4-12dc-412d-9156-ea1fdb18c15b",unlinkPrefab:!0})}}),Editor.Menu.registerTemplate("create-node",a)},async queryLatestCache(e){try{return await scene_cache_1.sceneCacheManager.queryLatestCache(e)}catch(e){console.error(e)}},async clearSceneCache(){try{return await scene_cache_1.sceneCacheManager.clearSceneCache()}catch(e){console.error(e)}},async saveSceneCacheToFile(){try{return await scene_cache_1.sceneCacheManager.save()}catch(e){console.error(e)}},updateCacheConfig(){scene_cache_1.sceneCacheManager.updateConfig()}},exports.load=load,exports.unload=unload;