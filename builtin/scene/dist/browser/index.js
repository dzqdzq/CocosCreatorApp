"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unload=exports.load=exports.methods=void 0;const ElectronModule=require("@base/electron-module"),path_1=require("path"),scene_cache_1=require("./scene-cache"),electron=require("electron");async function load(){const e={import:require("./protocol/import")};ElectronModule.register("PreviewExtends",path_1.join(__dirname,"../preview-extends/index")),Object.keys(e).forEach(c=>{const n=e[c];require("electron").protocol[n.type](c,n.handler)});try{await scene_cache_1.sceneCacheManager.init()}catch(e){console.error(e)}require("@base/electron-base-ipc").on("scene:check-ipc",e=>!0)}async function unload(){await scene_cache_1.sceneCacheManager.save()}electron.ipcMain.on("fire-web-contents",e=>{e.sender.on("new-window",(e,c,n,a,r,o)=>{e.preventDefault(),Object.assign(r,{autoHideMenuBar:!0});const t=new electron.BrowserWindow(r);e.newGuest=t})}),exports.methods={open(){Editor.Panel.open("scene")},async queryLatestCache(e){try{return await scene_cache_1.sceneCacheManager.queryLatestCache(e)}catch(e){console.error(e)}},async clearSceneCache(e){try{return await scene_cache_1.sceneCacheManager.clearSceneCache(e)}catch(e){console.error(e)}},async saveSceneCacheToFile(){try{return await scene_cache_1.sceneCacheManager.save()}catch(e){console.error(e)}},updateCacheConfig(){scene_cache_1.sceneCacheManager.updateConfig()},onSceneReady(e){scene_cache_1.sceneCacheManager.onSceneReady(e)},onSceneClosed(){scene_cache_1.sceneCacheManager.onSceneClosed()}},exports.load=load,exports.unload=unload;