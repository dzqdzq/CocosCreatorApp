"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.methods=exports.listeners=exports.fonts=exports.$=exports.template=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),message_1=require("./message"),engine_view_1=__importDefault(require("../script/engine-view"));window.customElements.define("engine-view",engine_view_1.default);let panel=null;function attach(e){if(e.invalid)return;if(!e.info.contributions||!e.info.contributions.scene)return;const t=e.info.contributions.scene;try{if(t.custom){const n=require(path_1.join(e.path,t.custom));n.floatWindows&&panel.$.scene.attachFloatWindow(e.name,n.floatWindows),n.toolbars&&panel.$.scene.attachToolbar(e.name,n.toolbars),n.infobars&&panel.$.scene.attachInfobar(e.name,n.infobars)}}catch(e){console.log(e)}}function detach(e){panel.$.scene.detachFloatWindow(e.name),panel.$.scene.detachToolbar(e.name),panel.$.scene.detachInfobar(e.name)}async function ready(){panel=this,message_1.init(panel),await panel.$.scene.init(),Editor.Package.getPackages({enable:!0}).forEach(attach),Editor.Package.on("enable",attach),Editor.Package.on("disable",detach),await panel.$.scene.callSceneMethod("changeSceneViewVisible",[!panel.hidden])}async function beforeClose(){if(!panel.$.scene)return!0;const e=await panel.$.scene.callSceneMethod("beforeClose",[],!0,!1);return await Editor.Message.request("scene","save-scene-cache-to-file"),e}async function close(){Editor.Package.removeListener("enable",attach),Editor.Package.removeListener("disable",detach)}exports.style=fs_1.readFileSync(path_1.join(__dirname,"../../dist/index.css"),"utf8"),exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static","/template/index.html"),"utf8"),exports.$={loading:".loading",content:".content",scene:".scene",gizmos:".gizmos",uiTools:".ui-tools"},exports.fonts=[{name:"scene"}],exports.listeners={resize(){window.app&&window.app.resize()},show(){panel.$.scene.callSceneMethod("changeSceneViewVisible",[!0])},hide(){panel.$.scene.callSceneMethod("changeSceneViewVisible",[!1])}},exports.methods=message_1.apply(),exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;