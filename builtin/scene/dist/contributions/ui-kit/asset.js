"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.element=void 0;const path_1=require("path");class element extends Editor.UI.__protected__.DragObject{constructor(){if(super(),this.missStateShowText="Missing Asset",this.selectIconValue="drag-asset",this.shadowRoot){this.shadowRoot.querySelector("#custom-style").innerHTML=".type ui-icon { color: var(--color-primary-fill-normal); }"}}get filter(){try{return JSON.parse(this.getAttribute("filter"))}catch(e){console.error(e)}return null}set filter(e){"object"==typeof e?this.setAttribute("filter",JSON.stringify(e)):this.setAttribute("filter",e)}_onAreaClick(){Editor.Message.broadcast("ui-kit:touch-asset",this.$root.value)}_onSelectClick(){if(this.$root.disabled||this.$root.readonly)return;Date.now();const e=this.$root.filter;Editor.Panel.__protected__.openKit("ui-kit.searcher",{elem:this.$root,params:[{type:"asset",value:this.$root.value,droppable:e?void 0:this.$root.droppable,assetFilter:e}],listeners:{confirm:e=>{e&&(this.$root.value=e.value,this.$root.dispatch("confirm"))},change:e=>{e&&(this.$root.value=e.value,this.$root.dispatch("change"))},preview:e=>{e&&this.$root.dispatch("preview",{detail:e})}}})}async _onTranslationName(e){let t=null,s=!0;if(e){const r=await Editor.Message.request("asset-db","query-asset-info",e);if(r){t=r.source?(0,path_1.basename)(r.source):r.displayName?r.displayName:r.name;const e=this._droppable.split(",").filter(Boolean);s=e.includes(r.type),r.extends&&r.extends.length&&e.forEach(e=>{r.extends&&r.extends.includes(e)&&(s=!0)})}}return s?this.removeAttribute("error"):this.setAttribute("error",!0),t}}exports.element=element;