"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.element=void 0;const path_1=require("path");class element extends Editor.UI.DragObject{constructor(){if(super(),this.shadowRoot){this.shadowRoot.querySelector("#custom-style").innerHTML=".type ui-icon { color: var(--color-primary-fill-normal); }"}}get filter(){try{return JSON.parse(this.getAttribute("filter"))}catch(t){console.error(t)}return null}set filter(t){"object"==typeof t?this.setAttribute("filter",JSON.stringify(t)):this.setAttribute("filter",t)}_onAreaClick(){Editor.Message.broadcast("ui-kit:touch-asset",this.$root.value)}_onSelectClick(){if(this.$root.disabled||this.$root.readonly)return;const t=Date.now(),e=this.$root.filter;Editor.Panel._kitControl.open({$kit:this.$root,name:"ui-kit.searcher",value:this.$root.value,droppable:e?void 0:this.$root.droppable,type:"asset",assetFilter:e,timestamp:t,events:{confirm:t=>{this.$root.value=t,this.$root.dispatch("confirm")},change:t=>{this.$root.value=t,this.$root.dispatch("change")}}})}async _onTranslationName(t){let e="";if(t&&"string"==typeof t){const r=await Editor.Message.request("asset-db","query-asset-info",t);if(r){e=r.source?path_1.basename(r.source):r.displayName?r.displayName:r.name;const t=this._droppable.split(",").filter(Boolean);let s=t.includes(r.type);r.extends&&r.extends.length&&t.forEach(t=>{r.extends&&r.extends.includes(t)&&(s=!0)}),s?(this.removeAttribute("error"),this.removeAttribute("state")):this.setAttribute("error",!0)}e?this.removeAttribute("missing"):(this.setAttribute("missing",!0),e="Missing Asset")}else this.removeAttribute("missing"),this.removeAttribute("error");return e}}exports.element=element;