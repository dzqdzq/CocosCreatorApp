"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validatePasteEnable=exports.PROPERTY_CLIPBOARD_HANDLE=exports.setVecInput=exports.setElementReadonly=exports.setElementInvalid=exports.getNameByDump=exports.getDocsURL=exports.isI18nValid=exports.isI18nPrefix=void 0;const render_1=require("@editor/sentry/render"),i18nPrefix="i18n:",isI18nPrefix=e=>e.startsWith(i18nPrefix),isI18nValid=(exports.isI18nPrefix=isI18nPrefix,e=>{return!!(0,exports.isI18nPrefix)(e)&&(e=e.substring(i18nPrefix.length),!!Editor.I18n.t(e))}),getDocsURL=(exports.isI18nValid=isI18nValid,e=>{var t=e.displayName&&e.displayName.match(/(?<=(cc|sp)\.\s*)(\w+)/)||e.type&&e.type.match(/(?<=cc\.\s*)(\w+)/),t=t&&0<t.length?t[0]:"";return t?Editor.App.urls.api+`/class/${t}?id=`+e.name:""}),getNameByDump=(exports.getDocsURL=getDocsURL,e=>{if(e.displayName&&"string"==typeof e.displayName){var t=e.displayName.trim();if(t&&!(0,exports.isI18nPrefix)(t))return t;var r=t.substring(i18nPrefix.length);if(Editor.I18n.t(r))return t}let s=e.name||"";return(s=(s=(s=(s=s.trim().replace(/^\S/,e=>e.toUpperCase())).replace(/_/g," ")).replace(/ \S/g,e=>" "+e.toUpperCase())).replace(/([a-z])([A-Z])/g,"$1 $2")).trim()}),setElementInvalid=(exports.getNameByDump=getNameByDump,(e,t)=>{let r=e.value;const s=null!==e.value&&"object"==typeof e.value;s&&(r=JSON.stringify(e.value)),e.values&&e.values.some(e=>s?JSON.stringify(e)!==r:e!==r)?t.setAttribute("invalid",""):t.removeAttribute("invalid")}),vecAttrs=(exports.setElementInvalid=setElementInvalid,["min","max","step"]),setElementReadonly=(e,t)=>{e&&e.readonly?t.setAttribute("readonly",""):t.removeAttribute("readonly")},setVecInput=(exports.setElementReadonly=setElementReadonly,(t,r)=>{const s=r.getAttribute("local"),i=t.value;var e,a=t.values;s&&i&&void 0!==i[s]&&(null===i[s]?(e=new Error(`the ${s} of ${i} is null in `+t.name),render_1.sentry.captureException(e)):(r.setAttribute("value",i[s].toString()),a&&a.some(e=>e[s]!==i[s])?r.setAttribute("invalid",""):r.removeAttribute("invalid"),vecAttrs.forEach(e=>{e in t?r.setAttribute(e,t[e]):r.removeAttribute(e)}),(0,exports.setElementReadonly)(t,r),r.removeAttribute("warn"),r.removeAttribute("hidden"),t.lock&&(e=t.lock[s])&&(r.setAttribute("warn",""),e.default===i[s]&&r.setAttribute("hidden",""),e.message)&&r.setAttribute("tooltip",e.message)))}),validatePasteEnable=(exports.setVecInput=setVecInput,exports.PROPERTY_CLIPBOARD_HANDLE="PROPERTY_CLIPBOARD_HANDLE",(r,e)=>{if(!e)return!1;try{var t=JSON.parse(e);const{type:s,value:i,enumList:a=[],bitmaskList:n=[]}=t;if(void 0===s||void 0===i)return!1;if(s!==r.type||Boolean(r.isArray)!==Array.isArray(i)||r.readonly)return!1;switch(s){case"BitMask":return n.length===r.bitmaskList?.length&&n.every((e,t)=>e.name===r.bitmaskList?.[t].name&&e.value===r.bitmaskList?.[t].value);case"Enum":return a.length===r.enumList?.length&&a.every((e,t)=>e.name===r.enumList?.[t].name&&e.value===r.enumList?.[t].value)&&a.some(e=>e.value===i);default:return!0}}catch(e){return!1}});exports.validatePasteEnable=validatePasteEnable;