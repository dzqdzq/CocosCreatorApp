"use strict";function update(e){const t=this;t._dump=e;const n=t.$this,r=t.$.label;n.setLabel(r,e);const o=e.value,a=t.$.num;if(a.value=o.length,e.values&&e.values.length>1)return a.invalid=!0,void(t.$.content.innerHTML='<div style="padding-left: 10px;">Arrays do not support multiple selections</div>');a.invalid&&(t.$.content.innerHTML=""),a.invalid=!1,n.setReadonly(e,a);const l=t.$.content,i=Array.from(l.children);for(;i.length>o.length;){const e=i.pop();e&&l.removeChild(e)}for(let r=0;r<o.length;r++){let a=i[r];if(!a){(a=i[r]=i[r]=document.createElement("div")).setAttribute("style","display: flex; padding: 0 6px 0 14px; position: relative; border-top: 2px solid transparent; border-bottom: 2px solid transparent;"),a.addEventListener("dragover",e=>{e.preventDefault();const n=t._dump.path||`${t._dump.type}-${t._dump.name}`,o=r,a=Editor.UI.DragItem._dump_array_;if(!a||n!==a.path)return;if(n===a.path&&o===a.index)return;const l=e.currentTarget,i=l.getBoundingClientRect(),d=i.height/2;e.clientY-i.top<=d?(l.style.borderTopColor="var(--color-focus-fill-weaker)",l.style.borderBottomColor="transparent"):i.bottom-e.clientY<=d&&(l.style.borderTopColor="transparent",l.style.borderBottomColor="var(--color-focus-fill-weaker)")}),a.addEventListener("dragleave",e=>{const t=e.currentTarget;t.style.borderTopColor="transparent",t.style.borderBottomColor="transparent"}),a.addEventListener("drop",e=>{var n;const r=e.currentTarget,o=Array.from(r.parentElement.children),a=r.getBoundingClientRect();let l=o.indexOf(r);const i=a.height/2;e.clientY-a.top<=i||a.bottom-e.clientY<=i&&(l+=1);const d=Number(null===(n=e.dataTransfer)||void 0===n?void 0:n.getData("_dump_array_drag_index_"));if(l>d){const e=t._dump.value[d];t._dump.value.splice(d,1),t._dump.value.splice(l-1,0,e),t.$this.dispatch("change"),t.$this.dispatch("confirm")}else if(l<d){const e=t._dump.value[d];t._dump.value.splice(d,1),t._dump.value.splice(l,0,e),t.$this.dispatch("change"),t.$this.dispatch("confirm")}r.style.borderTopColor="transparent",r.style.borderBottomColor="transparent"});const o=document.createElement("span");o.setAttribute("style","width: 6px; position: absolute; left: 0; top: 5px; bottom: 0; cursor: move; background: linear-gradient(45deg, var(--color-normal-border) 25%, var(--color-normal-fill) 0, var(--color-normal-fill) 50%, var(--color-normal-border) 0, var(--color-normal-border) 75%, var(--color-normal-fill) 0); background-size: 6px 6px;"),o.setAttribute("draggable","true"),n.setReadonly(e,o),a.appendChild(o),o.addEventListener("dragstart",n=>{e.readonly||(n.stopPropagation(),n.dataTransfer.setData("_dump_array_drag_index_",r.toString()),Editor.UI.DragItem._dump_array_={path:t._dump.path||`${t._dump.type}-${t._dump.name}`,index:r})});const d=document.createElement("ui-prop");d.setAttribute("style","flex: 1;"),a.appendChild(d);const p=document.createElement("div");p.setAttribute("style","position: relative; width: 1em; padding-left: 4px;");const s=document.createElement("ui-icon");s.setAttribute("value","del"),s.setAttribute("color",""),s.setAttribute("style","position: absolute; top: calc(50% - 5px); cursor: pointer;"),p.appendChild(s),n.setReadonly(e,s),a.appendChild(p),p.addEventListener("click",n=>{if(e.readonly)return;const r=n.target.parentElement.parentElement,o=Array.from(r.parentElement.children).indexOf(r);t._dump.value.splice(o,1),t.$this.dispatch("change"),t.$this.dispatch("confirm"),t.$this.render()}),l.appendChild(a)}a.children[1].setAttribute("type","dump"),a.children[1].render(o[r])}0===o.length?t.$.content.setAttribute("empty",""):t.$.content.removeAttribute("empty"),n.setReadonly(e,t.$.content)}function ready(){const e=this;e.$.num.addEventListener("change",e=>{e.stopPropagation(),e.preventDefault()}),e.$.num.addEventListener("confirm",t=>{const n=e.$.num.value;if(Array.isArray(e._dump.value)||(e._dump.value=[]),e._dump.elementTypeData)for(;e._dump.value.length<n;){const t=JSON.parse(JSON.stringify(e._dump.elementTypeData));t.name=e._dump.value.length.toString(),e._dump.value.push(t)}else for(;e._dump.value.length<n;)e._dump.value.push(null);e._dump.value.length=n,update.call(e,e._dump),e.$this.dispatch("change"),e.$this.dispatch("confirm")}),e.$.icon.addEventListener("click",()=>{e.$.icon.toggleAttribute("expand"),e.$.content.toggleAttribute("expand")}),e.$.label.addEventListener("click",()=>{e.$.icon.toggleAttribute("expand"),e.$.content.toggleAttribute("expand")})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.template=exports.style=void 0,exports.style="\n::slotted(.fold) {\n    font-size: 8px;\n    width: 12px;\n    max-height: 24px;\n    text-align: center;\n}\n::slotted(.fold[expand]) {\n    transform: rotate(90deg);\n}\n::slotted(.name) {\n    padding-left: 4px;\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: pre;\n}\n::slotted(.array-content) {\n    display: none;\n    flex: 1;\n    flex-direction: column;\n    margin: 5px 0 5px 6px;\n    padding: 2px 0 5px 0;\n    border: 1px rgba(136, 136, 136, 0.35) dashed;\n    border-radius: calc(var(--size-normal-radius) * 1px);\n}\n::slotted(.array-content[expand]) {\n    display: block;\n}\n::slotted(.array-content[empty]) {\n    display: none;\n}\n::slotted(.array-content[disabled]) {\n    opacity: 0.8;\n}\n",exports.template='\n<ui-icon class="fold" slot="label" value="play"></ui-icon>\n<ui-label class="name" slot="label"></ui-label>\n<ui-num-input slot="content" step="1" min="0"></ui-num-input>\n<section class="array-content"></section>\n',exports.$={icon:"ui-icon",label:"ui-label",num:"ui-num-input",content:".array-content"},exports.update=update,exports.ready=ready;