"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.methods=exports.$=exports.template=void 0;const modeTransformMap={"0 -> 3":["constant","constantMin"],"3 -> 0":["constantMin","constant"],"1 -> 2":["spline","splineMin"],"2 -> 1":["splineMin","spline"]},ChangeToCurveRange="change-to-curve-range";function update(e){this._dump=e;const t=this.$this,a=this.$.label;t.setLabel(a,e),this.updateProps()}function ready(){const e=this;e.$.mode.addEventListener("click",()=>{Editor.Menu.popup({menu:e._dump.value.mode.enumList.map(t=>({label:t.name,type:"radio",enabled:!e._dump.readonly,checked:t.value===e._dump.value.mode.value,click(){const a=modeTransformMap[`${e._dump.value.mode.value} -> ${t.value}`];e._dump.value.mode.value=t.value,a&&(e._dump.value[a[1]].value=e._dump.value[a[0]].value),"values"in e._dump&&(e._dump.values.forEach(e=>{e.mode.value=t.value,a&&(e[a[1]].value=e[a[0]].value)}),e._dump.value.mode.values=e._dump.value.mode.values.map(e=>t.value)),e.$.mode.dump=e._dump.value.mode,e.updateProps();const n=document.createEvent("HTMLEvents");if(n.initEvent("change-dump",!0,!0),a){Array.from(e.$.section.querySelectorAll("ui-prop"))[0].dispatchEvent(n)}e.$.mode.dispatchEvent(n)}}))})})}exports.template='\n<ui-label slot="label"></ui-label>\n<section slot="content" style="--ui-prop-label-width-min: 90px;"></section>\n<ui-icon value="arrow-triangle" slot="content" style="flex: none;"></ui-icon>\n',exports.$={label:"ui-label",section:"section",mode:"ui-icon"},exports.methods={updateProps(){var e,t;const a=this,n=a._dump;if(n.values&&n.values.some(e=>e.mode.value!==n.value.mode.value))return void(a.$.section.innerText="Cannot edit different types");const l={min:n.min,max:n.max,radian:n.radian,multiplier:n.value.multiplier.value},i={multiplier:n.value.multiplier.value,min:null!==(e=n.min)&&void 0!==e?e:Number.NEGATIVE_INFINITY,max:null!==(t=n.max)&&void 0!==t?t:Number.POSITIVE_INFINITY,radian:n.radian},s=Array.from(a.$.section.children);s.length||(a.$.section.innerText="");const u=n.path&&n.path.match(/^__comps__\.[0-9]*\.(.*)/);u?u[1]:n.path||n.name;switch(n.value.mode.value){case 0:Object.assign(n.value.constant,i),a.renderPropData(n.value.constant,s[0],!1),s[1]&&a.$.section.removeChild(s[1]);break;case 1:{Object.assign(n.value.spline.value,l,{multiplier:n.value.multiplier.value,type:"curve"});const e=a.renderPropData(n.value.spline,s[0],!1);this.bindEventListener(e,n.value.spline.path),s[1]&&a.$.section.removeChild(s[1])}break;case 2:{Object.assign(n.value.splineMin.value,l),Object.assign(n.value.splineMax.value,l);const e=a.renderPropData(n.value.splineMin,s[0],!0),t=a.renderPropData(n.value.splineMax,s[1],!0);t.style.marginTop="4px",this.bindEventListener(e,n.value.splineMin.path),this.bindEventListener(t,n.value.splineMax.path)}break;case 3:Object.assign(n.value.constantMin,i),Object.assign(n.value.constantMax,i),a.renderPropData(n.value.constantMin,s[0],!0),a.renderPropData(n.value.constantMax,s[1],!0).style.marginTop="4px"}},bindEventListener(e,t){if(e.__bind)return;const a=this.$this;e.addEventListener(ChangeToCurveRange,e=>{const{value:t,path:n,type:l}=e.detail,i=this._dump;i.value.multiplier.value=t.multiplier,i.values&&i.values.forEach((e,t)=>{0!==t&&(i.values[t]=JSON.parse(JSON.stringify(i.value)))}),e.stopPropagation(),e.preventDefault(),a.dispatch("change")}),e.__bind=!0},renderPropData(e,t,a){const n=this;return t||((t=document.createElement("ui-prop")).setAttribute("type","dump"),t.setAttribute(ChangeToCurveRange,""),n.$.section.appendChild(t)),a?t.removeAttribute("no-label"):t.setAttribute("no-label",""),t.render(e),t}},exports.update=update,exports.ready=ready;