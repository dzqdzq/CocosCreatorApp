"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.methods=exports.$=exports.template=void 0;const modeTransformMap={"0 -> 3":["constant","constantMin"],"3 -> 0":["constantMin","constant"],"1 -> 2":["spline","splineMin"],"2 -> 1":["splineMin","spline"]};function update(e){this._dump=e;const a=this.$this,t=this.$.label;a.setLabel(t,e),this.updateProps()}function ready(){const e=this;e.$.mode.addEventListener("click",()=>{Editor.Menu.popup({menu:e._dump.value.mode.enumList.map(a=>({label:a.name,type:"radio",enabled:!e._dump.readonly,checked:a.value===e._dump.value.mode.value,click(){const t=modeTransformMap[`${e._dump.value.mode.value} -> ${a.value}`];e._dump.value.mode.value=a.value,t&&(e._dump.value[t[1]].value=e._dump.value[t[0]].value),"values"in e._dump&&(e._dump.values.forEach(e=>{e.mode.value=a.value,t&&(e[t[1]].value=e[t[0]].value)}),e._dump.value.mode.values=e._dump.value.mode.values.map(e=>a.value)),e.$.mode.dump=e._dump.value.mode,e.updateProps();const n=document.createEvent("HTMLEvents");if(n.initEvent("change-dump",!0,!0),t){Array.from(e.$.section.querySelectorAll("ui-prop"))[0].dispatchEvent(n)}e.$.mode.dispatchEvent(n)}}))})})}exports.template='\n<ui-label slot="label"></ui-label>\n<section slot="content"></section>\n<ui-icon value="arrow-triangle" slot="content" style="flex: none;"></ui-icon>\n',exports.$={label:"ui-label",section:"section",mode:"ui-icon"},exports.methods={updateProps(){const e=this,a=e._dump;if(a.values&&a.values.some(e=>e.mode.value!==a.value.mode.value))return void(e.$.section.innerText="Cannot edit different types");const t={min:a.min,max:a.max,radian:a.radian,multiplier:a.value.multiplier.value},n={multiplier:a.value.multiplier.value,min:0===a.min?0:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY,radian:a.radian},l=Array.from(e.$.section.children);l.length||(e.$.section.innerText="");const i=a.path&&a.path.match(/^__comps__\.[0-9]*\.(.*)/),s=i?i[1]:a.path||a.name;switch(a.value.mode.value){case 0:Object.assign(a.value.constant,n),e.renderPropData(a.value.constant,l[0]),l[1]&&e.$.section.removeChild(l[1]);break;case 1:{Object.assign(a.value.spline.value,t,{multiplier:a.value.multiplier.value,type:"curve"}),a.value.spline.displayName=`${s}.${a.value.spline.name}`;const n=e.renderPropData(a.value.spline,l[0]);this.bindEventListener(n,a.value.spline.path),l[1]&&e.$.section.removeChild(l[1])}break;case 2:{a.value.splineMin.displayName=`${s}.${a.value.splineMin.name}`,a.value.splineMax.displayName=`${s}.${a.value.splineMax.name}`,Object.assign(a.value.splineMin.value,t),Object.assign(a.value.splineMax.value,t);const n=e.renderPropData(a.value.splineMin,l[0],"splineMin"),i=e.renderPropData(a.value.splineMax,l[1],"splineMax");this.bindEventListener(n,a.value.splineMin.path),this.bindEventListener(i,a.value.splineMax.path)}break;case 3:Object.assign(a.value.constantMin,n),Object.assign(a.value.constantMax,n),e.renderPropData(a.value.constantMin,l[0],"constantMin"),e.renderPropData(a.value.constantMax,l[1],"constantMax")}},bindEventListener(e,a){if(e.__bind)return;const t=this.$this;e.addEventListener("animation-curve-change",e=>{const{value:a,path:n,type:l}=e.detail,i=this._dump;i.value.multiplier.value=a.multiplier,i.values&&i.values.forEach((e,a)=>{0!==a&&(i.values[a]=JSON.parse(JSON.stringify(i.value)))}),e.stopPropagation(),e.preventDefault(),t.dispatch("change")}),e.__bind=!0},renderPropData(e,a,t){const n=this;return a||((a=document.createElement("ui-prop")).setAttribute("type","dump"),n.$.section.appendChild(a)),t?(a.removeAttribute("no-label"),a.setAttribute("label",t)):(a.setAttribute("no-label",""),a.removeAttribute("label")),a.render(e),a}},exports.update=update,exports.ready=ready;