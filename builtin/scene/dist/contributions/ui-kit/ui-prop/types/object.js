"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.ready=exports.update=exports.methods=exports.$=exports.style=exports.template=void 0;const i18nPrefix="i18n:";function update(e){const t=this,r=t.$this;let s="root",n=r.parentElement;for(;n;){if(n.hasAttribute("cache-expand")){s=n.getAttribute("cache-expand");break}n=n.parentElement}const a=e.path||`${e.name}:${e.type}`;t.$.container.setAttribute("cache-expand",`${s}-${a}`),r.hasAttribute("ui-section-config")&&t.$.container.setAttribute("class","config");const o=t.$.label;r.setLabel(o,e);const p=t.$.help;e.help&&(p.value=e.help,p.style.display="flex"),r.setAttribute("no-label","");const i=Object.keys(t.$propList),l=[];Object.keys(e.value).forEach((s,n)=>{var a,o;const p=e.value[s];if(!p.visible)return;l.push(s);let i=t.$propList[s];if(i){if(!i.isConnected||!i.parentElement)if(p.group&&e.groups){const{id:e="default",name:r}=p.group;t.appendChildByDisplayOrder(t.$groups[e].names[r],i)}else t.appendChildByDisplayOrder(t.$.container,i)}else{(i=document.createElement("ui-prop")).setAttribute("type","dump"),t.$propList[s]=i;const r=null!==(o=null===(a=p.group)||void 0===a?void 0:a.displayOrder)&&void 0!==o?o:p.displayOrder;if(i.displayOrder=void 0===r?n:Number(r),p.group&&e.groups){const{id:r="default",name:s}=p.group;!t.$groups[r]&&e.groups[r]&&("tab"===e.groups[r].style?t.$groups[r]=t.createTabGroup(e.groups[r]):"section"===e.groups[r].style&&(t.$groups[r]=t.createGroup(e.groups[r]))),t.$groups[r]&&(t.$groups[r].isConnected||t.appendChildByDisplayOrder(t.$.container,t.$groups[r]),"tab"===e.groups[r].style?t.appendToTabGroup(t.$groups[r],s):"section"===e.groups[r].style&&t.appendToGroup(t.$groups[r],s)),"tab"===e.groups[r].style?t.appendChildByDisplayOrder(t.$groups[r].tabs[s],i):"section"===e.groups[r].style&&t.appendChildByDisplayOrder(t.$groups[r].names[s],i)}else t.appendChildByDisplayOrder(t.$.container,i)}i.render(p),r.setReadonly(p,i)});for(const e of i)if(!l.includes(e)){const r=t.$propList[e];r&&r.parentElement&&r.parentElement.removeChild(r)}t.toggleGroup(t.$groups)}function ready(){this.$propList={},this.$groups={},this.$.help.addEventListener("click",e=>{e.stopPropagation()})}function close(){const e=this;for(const t in e.$groups)e.$groups[t].remove();e.$groups={}}exports.template='\n<ui-section expand>\n    <div slot="header">\n        <ui-label style="white-space: nowrap;"></ui-label>\n        <ui-link style="display: none" tooltip="i18n:scene.menu.help_url">\n            <ui-icon value="help"><ui-icon>\n        </ui-link>\n    </div>\n</ui-section>\n',exports.style="\n:host { margin-left: 0; }\n",exports.$={container:"ui-section",label:"ui-label",help:"ui-link"},exports.methods={createGroup(e){const t=document.createElement("div");return t.setAttribute("class","ui-prop-group"),t.dump=e,t.names={},t.displayOrder=e.displayOrder,t},createTabGroup(e){const t=document.createElement("div");function r(e){const r=Object.keys(t.tabs)[e];t.childNodes.forEach(e=>{e.classList.contains("tab-content")&&(e.getAttribute("name")===r?e.style.display="block":e.style.display="none")})}return t.setAttribute("class","tab-group"),t.dump=e,t.tabs={},t.displayOrder=e.displayOrder,t.$header=document.createElement("ui-tab"),t.$header.setAttribute("class","tab-header"),t.appendChild(t.$header),t.$header.addEventListener("change",e=>{r(e.target.value)}),setTimeout(()=>{r(0)}),t},appendToGroup(e,t){if(e.names[t])return;const r=document.createElement("ui-section");r.setAttribute("class","ui-prop-group-content"),r.setAttribute("expand","");let s="ui-prop-group-content",n=e;for(;n;){if(n.hasAttribute("cache-expand")){s=n.getAttribute("cache-expand");break}n=n.parentElement}r.setAttribute("cache-expand",`${s}-${t}`);const a=document.createElement("ui-label");a.setAttribute("slot","header");let o=t;o=o.startsWith("i18n:")?this.getName({displayName:t}):this.getName({name:t}),a.setAttribute("value",o),r.appendChild(a),e.appendChild(r),e.names[t]=r},appendToTabGroup(e,t){if(e.tabs[t])return;const r=document.createElement("div");e.tabs[t]=r,r.setAttribute("class","tab-content"),r.setAttribute("name",t),e.appendChild(r);const s=document.createElement("ui-label");let n=t;n=n.startsWith("i18n:")?this.getName({displayName:t}):this.getName({name:t}),s.setAttribute("value",n);const a=document.createElement("ui-button");a.setAttribute("name",t),a.appendChild(s),e.$header.appendChild(a)},appendChildByDisplayOrder(e,t){const r=t.displayOrder||0,s=Array.from(e.children).find(e=>e.dump&&e.displayOrder>r?e:null);s?s.before(t):e.appendChild(t)},toggleGroup(e){for(const t in e){if("section"===e[t].dump.style){e[t].querySelectorAll(".ui-prop-group-content").forEach(e=>{Array.from(e.querySelectorAll(":scope > ui-prop")).some(e=>"none"!==getComputedStyle(e).display)?e.removeAttribute("hidden"):e.setAttribute("hidden","")})}if("tab"===e[t].dump.style){Array.from(e[t].querySelectorAll(".tab-content > ui-prop")).some(e=>"none"!==getComputedStyle(e).display)?e[t].removeAttribute("hidden"):e[t].setAttribute("hidden","")}}},getName(e){if(!e)return"";if(e.displayName){if(!e.displayName.startsWith("i18n:"))return e.displayName;{const t=e.displayName.substring("i18n:".length);if(Editor.I18n.t(t))return e.displayName}}let t=e.name||"";return(t=(t=(t=(t=t.trim().replace(/^\S/,e=>e.toUpperCase())).replace(/_/g," ")).replace(/ \S/g,e=>` ${e.toUpperCase()}`)).replace(/([a-z])([A-Z])/g,"$1 $2")).trim()}},exports.update=update,exports.ready=ready,exports.close=close;