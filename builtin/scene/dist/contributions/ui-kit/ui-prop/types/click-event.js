"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.methods=exports.$=exports.style=exports.template=exports.listeners=void 0;const utils_1=require("../../utils");function update(e){const t=this;t._dump=e;const n=t.$this.renderInfo.panel;let a="root",l=t.$this.parentElement;for(;l;){if(l.hasAttribute("cache-expand")){a=l.getAttribute("cache-expand")||"";break}l=l.parentElement}const o=e.path||`${e.name}:${e.type}`;t.$.container.setAttribute("cache-expand",`${a}-${o}`);const u=t.$.label;if(n.setLabel(e,u),e.values&&e.values.length>1)return void(t.$.content.innerHTML='<div style="padding-left: 10px;">EventHandler do not support multiple selections</div>');if(n.setReadonly(e,t.$.node),n.setReadonly(e,t.$.select[0]),n.setReadonly(e,t.$.select[1]),n.setReadonly(e,t.$.input),!e.value)return void requestAnimationFrame(()=>{t.$this.dispatch("reset")});t.$.node.value=e.value.target.value.uuid,t.$.select[0].value=e.value._componentId.value,t.$.select[1].value=e.value.handler.value,t.$.input.value=e.value.customEventData.value;const i=e.value.target.value.uuid;t.updateComponentList(i)}function ready(){const e=this;e.$.button.addEventListener("click",async()=>{e.updateComponentList(e.$.node.value)})}exports.listeners={change(e){const t=this,n=e.target.getAttribute("local"),a=e.target.value;switch(n){case"node":t._dump.value.target.value.uuid=a,"values"in t._dump&&t._dump.values.forEach(e=>{e.target.value.uuid=a}),t.updateComponentList(a);break;case"component":t._dump.value._componentId.value=a,"values"in t._dump&&t._dump.values.forEach(e=>{e._componentId.value=a}),t.updateComponentList(t._dump.value.target.value.uuid);break;case"function":t._dump.value.handler.value=a,"values"in t._dump&&t._dump.values.forEach(e=>{e.handler.value=a});break;case"param":t._dump.value.customEventData.value=a,"values"in t._dump&&t._dump.values.forEach(e=>{e.customEventData.value=a})}}},exports.template='\n<style>\n.click-event-line { display: flex; margin-top: 4px; }\n.click-event-line > * { flex: 1; margin-right: 4px; }\n.click-event-line > *:last-child { flex: 1; margin-right: 0; }\n.click-event-line >  ui-button.transparent { flex: none; }\n.click-event-line > span { flex: none; }\n</style>\n<ui-section expand>\n    <ui-label slot="header"></ui-label>\n    <section class="content">\n        <div class="click-event-line click-event-top">\n            <ui-node droppable="cc.Node" local="node"></ui-node>\n            <ui-select local="component"></ui-select>\n            <ui-select local="function"></ui-select>\n            <ui-button class="transparent" tooltip="Refresh Methods">\n                <ui-icon value="refresh"></ui-icon>\n            </ui-button>\n        </div>\n        <div class="click-event-line">\n            <span>CustomEventData</span>\n            <ui-input local="param"></ui-input>\n        </div>\n    </section>\n</ui-section>\n',exports.style="\n:host { margin-left: 0; }\n",exports.$={container:"ui-section",label:"ui-label",content:".content",node:"ui-node",select:"ui-select",input:"ui-input",button:"ui-button"},exports.methods={async updateComponentList(e){const t=this,n=e?await Editor.Message.request((0,utils_1.getMessageProtocolScene)(t.$this),"query-node",e):null;if(!n)return t.$.select[0].innerHTML="",void(t.$.select[1].innerHTML="");let a="",l="";n.__comps__.forEach(e=>{a+=`<option value="${e.cid}">${e.type}</option>`,e.cid===t._dump.value._componentId.value&&(l=e.type)}),t.$.select[0].innerHTML=a;const o=e?await Editor.Message.request((0,utils_1.getMessageProtocolScene)(t.$this),"query-component-function-of-node",e):null;if(!o||!l)return void(t.$.select[1].innerHTML="");let u="";o[l]&&o[l].forEach(e=>{u+=`<option value="${e}">${e}</option>`}),t.$.select[1].innerHTML=u}},exports.update=update,exports.ready=ready;