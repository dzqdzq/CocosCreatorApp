"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DebugViewComponent=void 0;const Vue=require("vue/dist/vue.js");var DebugViewSingleType,DebugViewCompositeType;Vue.config.productionTip=!1,Vue.config.devtools=!1,function(e){e[e.NONE=0]="NONE",e[e.VERTEX_COLOR=1]="VERTEX_COLOR",e[e.VERTEX_NORMAL=2]="VERTEX_NORMAL",e[e.VERTEX_TANGENT=3]="VERTEX_TANGENT",e[e.WORLD_POS=4]="WORLD_POS",e[e.VERTEX_MIRROR=5]="VERTEX_MIRROR",e[e.FACE_SIDE=6]="FACE_SIDE",e[e.UV0=7]="UV0",e[e.UV1=8]="UV1",e[e.UV_LIGHTMAP=9]="UV_LIGHTMAP",e[e.PROJ_DEPTH=10]="PROJ_DEPTH",e[e.LINEAR_DEPTH=11]="LINEAR_DEPTH",e[e.FRAGMENT_NORMAL=12]="FRAGMENT_NORMAL",e[e.FRAGMENT_TANGENT=13]="FRAGMENT_TANGENT",e[e.FRAGMENT_BINORMAL=14]="FRAGMENT_BINORMAL",e[e.BASE_COLOR=15]="BASE_COLOR",e[e.DIFFUSE_COLOR=16]="DIFFUSE_COLOR",e[e.SPECULAR_COLOR=17]="SPECULAR_COLOR",e[e.TRANSPARENCY=18]="TRANSPARENCY",e[e.METALLIC=19]="METALLIC",e[e.ROUGHNESS=20]="ROUGHNESS",e[e.SPECULAR_INTENSITY=21]="SPECULAR_INTENSITY",e[e.IOR=22]="IOR",e[e.DIRECT_DIFFUSE=23]="DIRECT_DIFFUSE",e[e.DIRECT_SPECULAR=24]="DIRECT_SPECULAR",e[e.DIRECT_ALL=25]="DIRECT_ALL",e[e.ENV_DIFFUSE=26]="ENV_DIFFUSE",e[e.ENV_SPECULAR=27]="ENV_SPECULAR",e[e.ENV_ALL=28]="ENV_ALL",e[e.EMISSIVE=29]="EMISSIVE",e[e.LIGHT_MAP=30]="LIGHT_MAP",e[e.SHADOW=31]="SHADOW",e[e.AO=32]="AO",e[e.FRESNEL=33]="FRESNEL",e[e.DIRECT_TRANSMIT_DIFFUSE=34]="DIRECT_TRANSMIT_DIFFUSE",e[e.DIRECT_TRANSMIT_SPECULAR=35]="DIRECT_TRANSMIT_SPECULAR",e[e.ENV_TRANSMIT_DIFFUSE=36]="ENV_TRANSMIT_DIFFUSE",e[e.ENV_TRANSMIT_SPECULAR=37]="ENV_TRANSMIT_SPECULAR",e[e.TRANSMIT_ALL=38]="TRANSMIT_ALL",e[e.DIRECT_TRT=39]="DIRECT_TRT",e[e.ENV_TRT=40]="ENV_TRT",e[e.TRT_ALL=41]="TRT_ALL",e[e.FOG=42]="FOG"}(DebugViewSingleType||(DebugViewSingleType={})),function(e){e[e.DIRECT_DIFFUSE=0]="DIRECT_DIFFUSE",e[e.DIRECT_SPECULAR=1]="DIRECT_SPECULAR",e[e.ENV_DIFFUSE=2]="ENV_DIFFUSE",e[e.ENV_SPECULAR=3]="ENV_SPECULAR",e[e.EMISSIVE=4]="EMISSIVE",e[e.LIGHT_MAP=5]="LIGHT_MAP",e[e.SHADOW=6]="SHADOW",e[e.AO=7]="AO",e[e.NORMAL_MAP=8]="NORMAL_MAP",e[e.FOG=9]="FOG",e[e.TONE_MAPPING=10]="TONE_MAPPING",e[e.GAMMA_CORRECTION=11]="GAMMA_CORRECTION",e[e.FRESNEL=12]="FRESNEL",e[e.TRANSMIT_DIFFUSE=13]="TRANSMIT_DIFFUSE",e[e.TRANSMIT_SPECULAR=14]="TRANSMIT_SPECULAR",e[e.TRT=15]="TRT",e[e.TT=16]="TT",e[e.MAX_BIT_COUNT=17]="MAX_BIT_COUNT",e[e.ALL=1e4]="ALL"}(DebugViewCompositeType||(DebugViewCompositeType={})),exports.DebugViewComponent=Vue.extend({name:"DebugViewComponent",props:{children:{type:Array,default:function(){return[]}},tickShow:{type:Boolean,default:!1}},data:()=>({show:!1,showTimeId:null,showChildren:!1,disabledAllSingleOps:!0}),watch:{show(e){const t=this,o=t.$el;if(o.style.display=e?"block":" none",e){if(t.$el.classList.contains("inner")){const e=this.$root;e&&(o.style.height=`${e.getFitHeight()}px`)}}else t.$children.forEach(t=>{t.show=e})},tickShow(e){const t=this;t.showTimeId=setTimeout(()=>{t.show=e},100)}},methods:{mouseEnter(){clearTimeout(this.showTimeId)},nextTitleMouseEnter(e){e.stopPropagation(),clearTimeout(this.showTimeId),this.showChildren=!0},nextTitleMouseLeave(e){e.stopPropagation(),this.showChildren=!1},radioGroupChange(e){const t=this,o=e.target,s=e.currentTarget;if(!o||!s)return;s.value=o.value;let l=s.dataset.label;const i=t.$parent;if(i){const e=i.$el.querySelector(".shaded");l&&!l.startsWith("i18n:")&&(l=s.value),t.checkBaseShaded()?(l="i18n:scene.debug_view.shaded",e.checked=!0):e.checked=!1}const r=t.$root;r&&r.changeSelectText(l)},radioChange(e,t){const o=this,s=e.target;if(!s)return;const l=s.getAttribute("type");if(!l)return;const i=s.value,r=DebugViewSingleType[i];Editor.Message.send("scene","debug-view",{type:l,value:r}),"single"===l&&"NONE"===i?(o.disabledAllSingleOps=!0,o.allChecked("composite","ALL",!0)):o.disabledAllSingleOps=!1;const n=o.$el.querySelector(".rendering-single-group");n&&n.setAttribute("data-label",t.label)},checkboxChange(e){const t=this,o=e.target;if(!o)return;const s=o.getAttribute("type");if(!s)return;if("composite"===s){const e=o.getAttribute("key");if(!e)return;const l=o.value;if("ALL"===e)t.allChecked(s,e,l);else{const o={key:DebugViewCompositeType[e],value:l};Editor.Message.send("scene","debug-view",{type:s,value:o});const i=t.$el.querySelector(".checkbox-group");if(i){const e=t.checkCompositeAllChecked(i),o=i.querySelector(".check_all_composite");o&&(o.value=e)}}}else{const e=o.value;Editor.Message.send("scene","debug-view",{type:s,value:e})}let l="i18n:scene.debug_view.rendering_composite_options";const i=t.$parent;if(i){const e=i.$el.querySelector(".shaded");t.checkBaseShaded()?(l="i18n:scene.debug_view.shaded",e.checked=!0):e.checked=!1}const r=t.$root;r&&r.changeSelectText(l)},checkCompositeAllChecked(e){for(const t of e.childNodes)if(t&&"UI-CHECKBOX"===t.tagName&&!t.classList.contains("check_all_composite")&&!t.value)return!1;return!0},checkBaseShaded(){const e=this,t=e.$el.querySelector(".lighting-with-base-color"),o=e.$el.querySelector(".csm-layer-coloration"),s=e.$el.querySelector(".rendering-single-group"),l=e.$el.querySelector(".check_all_composite");return t.value&&!o.value&&"NONE"===s.value&&l.value},allChecked(e,t,o){const s={key:DebugViewCompositeType[t],value:o};Editor.Message.send("scene","debug-view",{type:e,value:s});const l=this.$el.querySelector(".checkbox-group");l&&l.childNodes.forEach(e=>{e&&"UI-CHECKBOX"===e.tagName&&(e.value=o)})},renderElement(e,t){const o=this;switch(e.el){case"ui-checkbox":return t(e.el,{class:{column:!0,check_all_composite:"composite"===e.type&&"ALL"===e.key,"lighting-with-base-color":"LIGHTING_WITH_BASE_COLOR"===e.type,"csm-layer-coloration":"CSM_LAYER_COLORATION"===e.type},attrs:{type:e.type,value:e.value,key:e.key,disabled:"LIGHTING_WITH_BASE_COLOR"!==e.type&&!o.disabledAllSingleOps},on:{change:o.checkboxChange}},[t("ui-label",{attrs:{value:e.label}})]);case"ui-radio":return t(e.el,{class:{column:!0,shaded:"SHADED"===e.value},attrs:{type:e.type,value:e.value,disabled:"SHADED"===e.value},on:{change:t=>{o.radioChange(t,e)}}},[t("ui-label",{attrs:{value:e.label}})]);case"ui-label":return t(e.el,{class:"column label",attrs:{value:e.label}})}},renderPanel(e,t){return[t("div",{class:"title next",on:{mouseenter:this.nextTitleMouseEnter,mouseleave:this.nextTitleMouseLeave}},[t(e.el,{attrs:{value:e.label}}),t("ui-icon",{attrs:{value:"arrow-right"}})]),t("debug-view-component",{props:{children:e.children,tickShow:this.showChildren},class:"inner"})]},renderGroup(e,t){const o=this,s=[];switch(s.push(t(e.el,{class:"title",attrs:{value:e.label}})),e.group){case"radio":s.push(t("ui-radio-group",{class:{group:!0,"radio-group":!0,"rendering-single-group":"radio"===e.group&&"NONE"===e.value},attrs:{"default-value":e.value},on:{change:e=>{o.radioGroupChange(e)}}},e.children.map(e=>o.renderElement(e,t))));break;case"checkbox":s.push(t("div",{class:"group checkbox-group"},e.children.map(e=>o.renderElement(e,t))))}return s},renderChildren(e,t){const o=this;return e.nextPanel?o.renderPanel(e,t):e.group?o.renderGroup(e,t):[o.renderElement(e,t)]}},render(e){const t=this;return e("div",{class:"panel",on:{mouseenter:t.mouseEnter,click:e=>{e.stopPropagation()}}},t.children.map(o=>e("div",{class:"list"},t.renderChildren(o,e))))}});