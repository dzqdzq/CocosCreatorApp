"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Texture=void 0;const utils_1=require("./utils"),terrain_1=__importDefault(require("../../public/terrain")),Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1,exports.Texture=Vue.extend({props:{layer:{type:Object,required:!0},index:{type:Number,required:!0}},data:()=>({src:"",isBusy:!1}),watch:{layer(e){this.update()}},mounted(){this.update()},methods:{async update(){if(!this.layer||!this.layer.uuid)return void(this.src="");if(this.isBusy)return;this.isBusy=!0;const e=this.layer.uuid,t=await Editor.Message.request("asset-db","query-asset-meta",e);this.src=t?await(0,utils_1.getImageLikeAssetSource)(t):"",this.isBusy=!1},_onImgClick(){this.$parent&&this.$parent.$emit("select-layer",this.index)},_onDrop(e){var t;e.stopPropagation();const r=null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("additional");if(r)try{const e=JSON.parse(r);if(!Array.isArray(e)||!e[0])return;const t=e[0].value;if(!t||-1===t.indexOf("@")||-1===t.indexOf("@6c48a"))return void console.warn("Terrain Layer need cc.Texture2D asset, and can't recognize texture without entity, which maybe from FBX or GLTF.");const i=this.index;terrain_1.default.setLayer(i,t)}catch(e){console.error(e)}}},template:'\n        <ui-drag-area droppable="cc.Texture2D"\n            @drop="_onDrop($event)"\n        >\n            <img v-if="src"\n            :src="src" \n            @click="_onImgClick()"\n            >\n        </ui-drag-area>\n'});