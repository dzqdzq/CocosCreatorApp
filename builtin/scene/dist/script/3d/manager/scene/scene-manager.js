"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const ElectronModule=require("@base/electron-module"),EditorExtends=ElectronModule.require("EditorExtends"),EventEmitter_1=__importDefault(require("../../../public/EventEmitter")),utils_1=require("../../manager/prefab/utils");class SceneManager extends EventEmitter_1.default{constructor(){super(),this.ignore=!1}queryNodeTree(e){const t=e=>{if(e.objFlags&cc.Object.Flags.HideInHierarchy)return null;const n=e.children.map(t).filter(Boolean),r=utils_1.prefabUtils.getPrefabStateInfo(e),c="Scene"===e.constructor.name;return{name:!e.name&&c?"Scene":e.name,active:e.active,locked:Boolean(e.objFlags&cc.Object.Flags.LockedInEditor),type:"cc."+e.constructor.name,uuid:e.uuid,children:n.length?n:[],prefab:r,parent:e.parent&&e.parent.uuid||"",isScene:c,readonly:!1,components:e.components.map(e=>({type:cc.js.getClassName(e.constructor),value:e.uuid,extends:cc.Class.getInheritanceChain(e.constructor).map(e=>cc.js.getClassName(e)).filter(Boolean)}))}};if(e){const n=cce.Node.query(e);return n?t(n):null}return cc.director._scene?t(cc.director._scene):null}queryComponents(){return EditorExtends.Component.getMenus().map(e=>{e.menuPath.indexOf("i18n:menu.custom_script");return{name:cc.js.getClassName(e.component),path:e.menuPath}})}queryComponentHasScript(e){return EditorExtends.Component.getMenus().map(e=>{if(e.menuPath.startsWith("i18n:menu.custom_script"))return e.component.name}).filter(Boolean).includes(e)}queryLayerBuiltin(){let e=Object.keys(cc.Layers.Enum).map((e,t)=>({name:e,value:cc.Layers.Enum[e]}));return e=e.filter(e=>0!==e.value&&4294967295!==e.value)}}exports.default=SceneManager;