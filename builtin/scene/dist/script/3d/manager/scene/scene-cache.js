"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatTime=exports.sceneCacheManager=void 0;const fs_extra_1=require("fs-extra");class SceneCacheManager{constructor(){this.useSceneCache=!0}async init(){const e=await Editor.Profile.getConfig("scene","scene_cache");this.useSceneCache=e.use,e.use||console.log("The scene instant cache function is turned off")}async queryLatestCache(e){if(!this.useSceneCache)return;const t=await Editor.Message.request("scene","query-latest-cache",e);if(t&&0===(await Editor.Dialog.info(Editor.I18n.t("scene.messages.scene_cache.use_latest_scene",{time:formatTime(t.time),url:t.url}),{buttons:[Editor.I18n.t("scene.messages.scene_cache.apply"),Editor.I18n.t("scene.messages.scene_cache.no")],default:1,cancel:1})).response)try{return t.data||fs_extra_1.readJSONSync(t.file)}catch(e){console.error(e)}}async queryLastCacheInfo(e){const t=await Editor.Message.request("scene","query-last-cache",e);if(t)try{return{time:t.time,json:t.data||fs_extra_1.readJSONSync(t.file)}}catch(e){console.error(e)}}}function formatTime(e){return new Date(e).toLocaleString()}exports.sceneCacheManager=new SceneCacheManager,exports.formatTime=formatTime;