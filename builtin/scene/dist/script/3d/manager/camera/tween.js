"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tweenPosition=tweenPosition,exports.tweenRotation=tweenRotation,exports.tweenNumber=tweenNumber;const cc_1=require("cc"),animations=[],frame=1e3/60;let time=0;function step(e){0===time||0===animations.length?stopAnim():setTimeout(()=>{var t=time;time=Date.now();for(let t=0;t<animations.length;)!1===animations[t]._step(e)?animations.splice(t,1):t++;step(time-t)})}function startAnim(){0===time&&(time=Date.now(),step(frame))}function stopAnim(){time=0}class PositionAnimation{target=cc.v3();func=null;start=new cc_1.Vec3;end=new cc_1.Vec3;travel=0;time=0;constructor(t,e,i){this.start=t,this.end=e,this.time=i}_step(t){this.travel+=t;t=Math.min(this.travel/this.time,1);return cc.Vec3.lerp(this.target,this.start,this.end,t),this.func&&this.func(this.target),t<1}step(t){this.func=t}}class RotationAnimation{target=cc.quat();func=null;start=new cc_1.Quat;end=new cc_1.Quat;travel=0;time=0;constructor(t,e,i){this.start=t,this.end=e,this.time=i}_step(t){this.travel+=t;t=Math.min(this.travel/this.time,1);return cc_1.Quat.slerp(this.target,this.start,this.end,t),this.func&&this.func(this.target),t<1}step(t){this.func=t}}class NumberAnimation{target=0;func=null;start=0;end=0;travel=0;time=0;constructor(t,e,i){this.target=0,this.func=null,this.start=t,this.end=e,this.travel=0,this.time=i}_step(t){this.travel+=t;t=Math.min(this.travel/this.time,1);return this.target=(1-t)*this.start+t*this.end,this.func&&this.func(this.target),t<1}step(t){this.func=t}}function tweenPosition(t,e,i=300){t=new PositionAnimation(t,e,i);return animations.push(t),startAnim(),t}function tweenRotation(t,e,i){t=new RotationAnimation(t,e,i);return animations.push(t),startAnim(),t}function tweenNumber(t,e,i){t=new NumberAnimation(t,e,i);return animations.push(t),startAnim(),t}exports.position=tweenPosition,exports.rotation=tweenRotation,exports.number=tweenNumber;