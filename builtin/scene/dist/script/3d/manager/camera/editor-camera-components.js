"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),CAMERA_EDITOR_GIZMO_MASK=cc_1.Layers.Enum.GIZMOS;class EditorCameraComponent extends cc_1.Camera{constructor(){super(...arguments),this._uiEditorCamera=null,this._uiEditorGizmoCamera=null}set projection(e){super.projection=e,this._uiEditorCamera&&(this._uiEditorCamera.projectionType=e)}get projection(){return super.projection}set fov(e){super.fov=e,this._uiEditorCamera&&(this._uiEditorCamera.fov=(0,cc_1.toRadian)(e))}get fov(){return super.fov}set orthoHeight(e){super.orthoHeight=e,this._uiEditorCamera&&(this._uiEditorCamera.orthoHeight=e)}get orthoHeight(){return super.orthoHeight}set near(e){super.near=e,this._uiEditorCamera&&(this._uiEditorCamera.nearClip=e)}get near(){return super.near}set far(e){super.far=e,this._uiEditorCamera&&(this._uiEditorCamera.farClip=e)}get far(){return super.far}set clearColor(e){super.clearColor=e,this._uiEditorCamera&&(this._uiEditorCamera.clearColor=e)}get clearColor(){return super.clearColor}set clearDepth(e){super.clearDepth=e,this._uiEditorCamera&&(this._uiEditorCamera.clearDepth=e)}get clearDepth(){return super.clearDepth}set clearStencil(e){super.clearStencil=e,this._uiEditorCamera&&(this._uiEditorCamera.clearStencil=e)}get clearStencil(){return super.clearStencil}set clearFlags(e){super.clearFlags=e,this._uiEditorCamera&&(this._uiEditorCamera.clearFlag=e)}set rect(e){super.rect=e,this._uiEditorCamera&&this._uiEditorCamera.setViewportInOrientedSpace(e)}set screenScale(e){super.screenScale=e,this._uiEditorCamera&&(this._uiEditorCamera.screenScale=e)}onLoad(){super.onLoad(),this._inEditorMode=!0,this.camera.initGeometryRenderer(),cce.Engine.getGeometryRenderer().renderer=this.camera.geometryRenderer}onEnable(){super.onEnable();const e=this._getRenderScene();this._uiEditorCamera&&(e.addCamera(this._uiEditorCamera),this._uiEditorCamera.enabled=!0),this._uiEditorGizmoCamera&&(e.addCamera(this._uiEditorGizmoCamera),this._uiEditorGizmoCamera.enabled=!0)}onDisable(){super.onDisable(),this._uiEditorCamera&&this._uiEditorCamera.scene&&this._uiEditorCamera.scene.removeCamera(this._uiEditorCamera),this._uiEditorGizmoCamera&&this._uiEditorGizmoCamera.scene&&this._uiEditorGizmoCamera.scene.removeCamera(this._uiEditorGizmoCamera)}onDestroy(){super.onDestroy(),this._uiEditorCamera&&(this._uiEditorCamera.detachCamera(),this._uiEditorCamera=null),this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null)}_createCamera(){const e=this._camera;if(super._createCamera(),this._camera!==e&&this._camera){this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null),this._uiEditorGizmoCamera=cc.director.root.createCamera(),this._uiEditorGizmoCamera.initialize({name:"Editor UIGizmoCamera",node:this._camera.node,projection:this._projection,window:cc.director.root.mainWindow,priority:this._priority+2}),this._uiEditorGizmoCamera.enabled=!0,this._uiEditorGizmoCamera.visibility=CAMERA_EDITOR_GIZMO_MASK,this._uiEditorGizmoCamera.setViewportInOrientedSpace(this._camera.viewport),this._uiEditorGizmoCamera.fov=this._camera.fov,this._uiEditorGizmoCamera.nearClip=this._camera.nearClip,this._uiEditorGizmoCamera.farClip=this._camera.farClip;const e=this._camera.clearColor;this._uiEditorGizmoCamera.clearColor=new cc_1.Color(e.x,e.y,e.z,0),this._uiEditorGizmoCamera.clearDepth=this._camera.clearDepth,this._uiEditorGizmoCamera.clearStencil=this._camera.clearStencil,this._uiEditorGizmoCamera.clearFlag=cc_1.gfx.ClearFlagBit.NONE,this._uiEditorGizmoCamera.update=(()=>{this._uiEditorGizmoCamera.syncCameraEditor(this.camera)})}}}exports.default=EditorCameraComponent;