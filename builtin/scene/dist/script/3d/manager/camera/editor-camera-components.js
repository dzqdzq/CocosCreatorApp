"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),CAMERA_EDITOR_MASK=cc_1.Layers.makeMaskExclude([cc_1.Layers.BitMask.PROFILER,cc_1.Layers.BitMask.GIZMOS,cc_1.Layers.Enum.SCENE_GIZMO]),CAMERA_EDITOR_GIZMO_MASK=cc_1.Layers.Enum.GIZMOS;class EditorCameraComponent extends cc_1.Camera{constructor(){super(...arguments),this._uiEditorCamera=null,this._uiEditorGizmoCamera=null}set projection(i){super.projection=i,this._uiEditorCamera&&(this._uiEditorCamera.projectionType=i)}get projection(){return super.projection}set fov(i){super.fov=i,this._uiEditorCamera&&(this._uiEditorCamera.fov=cc_1.toRadian(i))}get fov(){return super.fov}set orthoHeight(i){super.orthoHeight=i,this._uiEditorCamera&&(this._uiEditorCamera.orthoHeight=i)}get orthoHeight(){return super.orthoHeight}set near(i){super.near=i,this._uiEditorCamera&&(this._uiEditorCamera.nearClip=i)}get near(){return super.near}set far(i){super.far=i,this._uiEditorCamera&&(this._uiEditorCamera.farClip=i)}get far(){return super.far}set clearColor(i){super.clearColor=i,this._uiEditorCamera&&(this._uiEditorCamera.clearColor=i)}get clearColor(){return super.clearColor}set clearDepth(i){super.clearDepth=i,this._uiEditorCamera&&(this._uiEditorCamera.clearDepth=i)}get clearDepth(){return super.clearDepth}set clearStencil(i){super.clearStencil=i,this._uiEditorCamera&&(this._uiEditorCamera.clearStencil=i)}get clearStencil(){return super.clearStencil}set clearFlags(i){super.clearFlags=i,this._uiEditorCamera&&(this._uiEditorCamera.clearFlag=i)}set rect(i){super.rect=i,this._uiEditorCamera&&(this._uiEditorCamera.viewport=i)}set screenScale(i){super.screenScale=i,this._uiEditorCamera&&(this._uiEditorCamera.screenScale=i)}onLoad(){super.onLoad(),this._inEditorMode=!0}onEnable(){super.onEnable();const i=this._getRenderScene();this._uiEditorCamera&&(i.addCamera(this._uiEditorCamera),this._uiEditorCamera.enabled=!0),this._uiEditorGizmoCamera&&(i.addCamera(this._uiEditorGizmoCamera),this._uiEditorGizmoCamera.enabled=!0)}onDisable(){super.onDisable(),this._uiEditorCamera&&this._uiEditorCamera.scene&&this._uiEditorCamera.scene.removeCamera(this._uiEditorCamera),this._uiEditorGizmoCamera&&this._uiEditorGizmoCamera.scene&&this._uiEditorGizmoCamera.scene.removeCamera(this._uiEditorGizmoCamera)}onDestroy(){super.onDestroy(),this._uiEditorCamera&&(this._uiEditorCamera.detachCamera(),this._uiEditorCamera=null),this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null)}_createCamera(){const i=this._camera;if(super._createCamera(),this._camera!==i&&this._camera){this._uiEditorCamera&&(this._uiEditorCamera.detachCamera(),this._uiEditorCamera=null),this._uiEditorCamera=cc.director.root.createCamera(),this._uiEditorCamera.initialize({name:"Editor UICamera",node:this._camera.node,projection:this._projection,window:cc.director.root.mainWindow,priority:this._priority+1}),this._uiEditorCamera.enabled=!0,this._uiEditorCamera.visibility=CAMERA_EDITOR_MASK,this._uiEditorCamera.viewport=this._camera.viewport,this._uiEditorCamera.fov=this._camera.fov,this._uiEditorCamera.nearClip=this._camera.nearClip,this._uiEditorCamera.farClip=this._camera.farClip,this._uiEditorCamera.clearColor=this._camera.clearColor,this._uiEditorCamera.clearDepth=this._camera.clearDepth,this._uiEditorCamera.clearStencil=this._camera.clearStencil,this._uiEditorCamera.clearFlag=cc_1.gfx.ClearFlagBit.DEPTH_STENCIL,this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null),this._uiEditorGizmoCamera=cc.director.root.createCamera(),this._uiEditorGizmoCamera.initialize({name:"Editor UIGizmoCamera",node:this._camera.node,projection:this._projection,window:cc.director.root.mainWindow,priority:this._priority+2}),this._uiEditorGizmoCamera.enabled=!0,this._uiEditorGizmoCamera.visibility=CAMERA_EDITOR_GIZMO_MASK,this._uiEditorGizmoCamera.viewport=this._camera.viewport,this._uiEditorGizmoCamera.fov=this._camera.fov,this._uiEditorGizmoCamera.nearClip=this._camera.nearClip,this._uiEditorGizmoCamera.farClip=this._camera.farClip,this._uiEditorGizmoCamera.clearColor=this._camera.clearColor,this._uiEditorGizmoCamera.clearDepth=this._camera.clearDepth,this._uiEditorGizmoCamera.clearStencil=this._camera.clearStencil,this._uiEditorGizmoCamera.clearFlag=cc_1.gfx.ClearFlagBit.NONE;this._uiEditorGizmoCamera.update.bind(this._uiEditorGizmoCamera);this._uiEditorGizmoCamera.update=(()=>{this._uiEditorGizmoCamera.matView=this._uiEditorCamera.matView,this._uiEditorGizmoCamera.position=this._uiEditorCamera.position,this._uiEditorGizmoCamera.forward=this._uiEditorCamera.forward,this._uiEditorGizmoCamera.matProj=this._uiEditorCamera.matProj,this._uiEditorGizmoCamera.matProjInv=this._uiEditorCamera.matProjInv,this._uiEditorGizmoCamera.matViewProj=this._uiEditorCamera.matViewProj})}}}exports.default=EditorCameraComponent;