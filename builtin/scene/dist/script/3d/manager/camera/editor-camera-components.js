"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),CAMERA_EDITOR_GIZMO_MASK=cc_1.Layers.Enum.GIZMOS;class EditorCameraComponent extends cc_1.Camera{constructor(){super(...arguments),this._uiEditorCamera=null,this._uiEditorGizmoCamera=null}set projection(r){super.projection=r,this._uiEditorCamera&&(this._uiEditorCamera.projectionType=r)}get projection(){return super.projection}set fov(r){super.fov=r,this._uiEditorCamera&&(this._uiEditorCamera.fov=cc_1.toRadian(r))}get fov(){return super.fov}set orthoHeight(r){super.orthoHeight=r,this._uiEditorCamera&&(this._uiEditorCamera.orthoHeight=r)}get orthoHeight(){return super.orthoHeight}set near(r){super.near=r,this._uiEditorCamera&&(this._uiEditorCamera.nearClip=r)}get near(){return super.near}set far(r){super.far=r,this._uiEditorCamera&&(this._uiEditorCamera.farClip=r)}get far(){return super.far}set clearColor(r){super.clearColor=r,this._uiEditorCamera&&(this._uiEditorCamera.clearColor=r)}get clearColor(){return super.clearColor}set clearDepth(r){super.clearDepth=r,this._uiEditorCamera&&(this._uiEditorCamera.clearDepth=r)}get clearDepth(){return super.clearDepth}set clearStencil(r){super.clearStencil=r,this._uiEditorCamera&&(this._uiEditorCamera.clearStencil=r)}get clearStencil(){return super.clearStencil}set clearFlags(r){super.clearFlags=r,this._uiEditorCamera&&(this._uiEditorCamera.clearFlag=r)}set rect(r){super.rect=r,this._uiEditorCamera&&this._uiEditorCamera.setViewportInOrientedSpace(r)}set screenScale(r){super.screenScale=r,this._uiEditorCamera&&(this._uiEditorCamera.screenScale=r)}onLoad(){super.onLoad(),this._inEditorMode=!0}onEnable(){super.onEnable();const r=this._getRenderScene();this._uiEditorCamera&&(r.addCamera(this._uiEditorCamera),this._uiEditorCamera.enabled=!0),this._uiEditorGizmoCamera&&(r.addCamera(this._uiEditorGizmoCamera),this._uiEditorGizmoCamera.enabled=!0)}onDisable(){super.onDisable(),this._uiEditorCamera&&this._uiEditorCamera.scene&&this._uiEditorCamera.scene.removeCamera(this._uiEditorCamera),this._uiEditorGizmoCamera&&this._uiEditorGizmoCamera.scene&&this._uiEditorGizmoCamera.scene.removeCamera(this._uiEditorGizmoCamera)}onDestroy(){super.onDestroy(),this._uiEditorCamera&&(this._uiEditorCamera.detachCamera(),this._uiEditorCamera=null),this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null)}_createCamera(){const r=this._camera;if(super._createCamera(),this._camera!==r&&this._camera){this._uiEditorGizmoCamera&&(this._uiEditorGizmoCamera.detachCamera(),this._uiEditorGizmoCamera=null),this._uiEditorGizmoCamera=cc.director.root.createCamera(),this._uiEditorGizmoCamera.initialize({name:"Editor UIGizmoCamera",node:this._camera.node,projection:this._projection,window:cc.director.root.mainWindow,priority:this._priority+2}),this._uiEditorGizmoCamera.enabled=!0,this._uiEditorGizmoCamera.visibility=CAMERA_EDITOR_GIZMO_MASK,this._uiEditorGizmoCamera.setViewportInOrientedSpace(this._camera.viewport),this._uiEditorGizmoCamera.fov=this._camera.fov,this._uiEditorGizmoCamera.nearClip=this._camera.nearClip,this._uiEditorGizmoCamera.farClip=this._camera.farClip;const r=this._camera.clearColor;this._uiEditorGizmoCamera.clearColor=new cc_1.Color(r.x,r.y,r.z,0),this._uiEditorGizmoCamera.clearDepth=this._camera.clearDepth,this._uiEditorGizmoCamera.clearStencil=this._camera.clearStencil,this._uiEditorGizmoCamera.clearFlag=cc_1.gfx.ClearFlagBit.NONE,this._uiEditorGizmoCamera.update=(()=>{this._uiEditorGizmoCamera.syncCameraEditor(this.camera)})}}}exports.default=EditorCameraComponent;