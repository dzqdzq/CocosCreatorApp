"use strict";var __importDefault=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(exports,"__esModule",{value:!0});const math_1=__importDefault(require("../../../../utils/math"));class LinearTicks{ticks=[];tickLods=[];tickRatios=[];minScale=.1;maxScale=1e3;minValueScale=1;maxValueScale=1;minValue=-500;maxValue=500;pixelRange=500;minSpacing=10;maxSpacing=80;minTickLevel=0;maxTickLevel=0;constructor(){}initTicks(i,t,s){(s=s<=0?1:s)<(t=t<=0?1:t)&&(s=t),this.tickLods=i,this.minScale=t,this.maxScale=s,this.ticks=[];let e=1,a=0;this.ticks.push(e);var h=t,c=s;let l=1,n=1;for(;e*this.tickLods[a]<=c;)e*=this.tickLods[a],a=a+1>this.tickLods.length-1?0:a+1,this.ticks.push(e),l=e;for(this.minValueScale=1/l*100,a=this.tickLods.length-1,e=1;e/this.tickLods[a]>=h;)e/=this.tickLods[a],a=a-1<0?this.tickLods.length-1:a-1,this.ticks.unshift(e),n=e;return this.maxValueScale=1/n*100,this}spacing(i,t){return this.minSpacing=i,this.maxSpacing=t,this}range(i,t,s){this.minValue=Math.fround(Math.min(i,t)),this.maxValue=Math.fround(Math.max(i,t)),this.pixelRange=s,this.minTickLevel=0,this.maxTickLevel=this.ticks.length-1;for(let i=this.ticks.length-1;0<=i;i--){var e=this.ticks[i]*this.pixelRange/(this.maxValue-this.minValue);if(this.tickRatios[i]=(e-this.minSpacing)/(this.maxSpacing-this.minSpacing),1<=this.tickRatios[i]&&(this.maxTickLevel=i),e<=this.minSpacing){this.minTickLevel=i;break}}for(let i=this.minTickLevel;i<=this.maxTickLevel;i++)this.tickRatios[i]=math_1.default.clamp01(this.tickRatios[i]);return this}ticksAtLevel(t,s){var e=[],a=this.ticks[t],h=Math.floor(this.minValue/a),c=Math.ceil(this.maxValue/a);for(let i=h;i<=c;i++)(!s||t>=this.maxTickLevel||i%Math.round(this.ticks[t+1]/a)!=0)&&e.push(i*a);return e}levelForStep(t){for(let i=0;i<this.ticks.length;i++)if(t<=this.ticks[i]*this.pixelRange/(this.maxValue-this.minValue))return i;return-1}}exports.default=LinearTicks;