"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),ipc_1=__importDefault(require("./ipc"));class EffectManager{constructor(){this._uuidSet=new Set}async init(){const e=(await ipc_1.default.send("query-effects")).map(e=>this.registerEffect(e));await Promise.all(e)}registerEffects(e){e.forEach(e=>{this.registerEffect(e)})}registerEffect(e){return new Promise(t=>{cc_1.assetManager.loadAny(e,(c,r)=>{if(c)return console.error(c),t();this._uuidSet.add(e),Editor.Message.broadcast("scene:effect-update",e),t()})})}removeEffect(e){return!!this._uuidSet.has(e)&&(cc_1.EffectAsset&&cc_1.EffectAsset.remove?(this._uuidSet.delete(e),cc_1.EffectAsset.remove(e),ipc_1.default.send("broadcast","scene:effect-update",e),!0):(console.warn("cannot call method cc.EffectAsset.remove"),!1))}removeEffects(e){e.map(e=>{this.removeEffect(e)})}}exports.default=new EffectManager;