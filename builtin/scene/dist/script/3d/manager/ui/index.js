"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const selection_1=__importDefault(require("../../../public/selection")),node_1=__importDefault(require("../node")),node_2=__importDefault(require("../../../utils/node")),cc_1=require("cc"),vec3_1=require("../../../utils/math/vec3");let v3_a=new cc_1.Vec3;class UIManager{alignSelection(e){let t=selection_1.default.query();if(t.length<=1)return;let n=t.map(e=>node_1.default.query(e)),c=1e10,a=1e10,r=-1e10,o=-1e10,s=(n=n.filter(e=>{let t=e.parent;for(;t;){if(-1!==n.indexOf(t))return!1;t=t.parent}return!0})).map(e=>{let t=node_2.default.getWorldBounds(e);return c=Math.min(c,t.x),a=Math.min(a,t.y),r=Math.max(r,t.xMax),o=Math.max(o,t.yMax),{node:e,bounds:t}}),d=new cc_1.Rect(c,a,r-c,o-a);cce.SceneFacadeManager.snapshot(),s.forEach(t=>{let n,c=t.node;switch(e){case"top":n=new cc_1.Vec3(0,d.yMax-t.bounds.yMax,0);break;case"v-center":n=new cc_1.Vec3(0,d.center.y-t.bounds.center.y,0);break;case"bottom":n=new cc_1.Vec3(0,d.y-t.bounds.y,0);break;case"left":n=new cc_1.Vec3(d.x-t.bounds.x,0,0);break;case"h-center":n=new cc_1.Vec3(d.center.x-t.bounds.center.x,0,0);break;case"right":n=new cc_1.Vec3(d.xMax-t.bounds.xMax,0,0);break;default:n=new cc_1.Vec3}let a=node_2.default.getWorldPosition(c);node_2.default.setWorldPosition(c,vec3_1.MVec3.add(v3_a,a,n))})}distributeSelection(e){let t=selection_1.default.query();if(t.length<=1)return;let n=t.map(e=>node_1.default.query(e)),c=(n=n.filter(e=>{let t=e.parent;for(;t;){if(-1!==n.indexOf(t))return!1;t=t.parent}return!0})).map(e=>{return{node:e,bounds:node_2.default.getWorldBounds(e)}});c.sort((t,n)=>{let c=1;switch(e){case"top":c=t.bounds.yMax-n.bounds.yMax;break;case"v-center":c=t.bounds.center.y-n.bounds.center.y;break;case"bottom":c=t.bounds.y-n.bounds.y;break;case"left":c=t.bounds.x-n.bounds.x;break;case"h-center":c=t.bounds.center.x-n.bounds.center.x;break;case"right":c=t.bounds.xMax-n.bounds.xMax}return c});let a=c.length-1,r=c[0].bounds,o=c[a].bounds;cce.SceneFacadeManager.snapshot(),c.forEach((t,n)=>{let c,s=t.node,d=t.bounds;switch(e){case"top":c=new cc_1.Vec3(0,r.yMax+(o.yMax-r.yMax)*n/a-d.yMax,0);break;case"v-center":c=new cc_1.Vec3(0,r.center.y+(o.center.y-r.center.y)*n/a-d.center.y,0);break;case"bottom":c=new cc_1.Vec3(0,r.y+(o.y-r.y)*n/a-d.y,0);break;case"left":c=new cc_1.Vec3(r.x+(o.x-r.x)*n/a-d.x,0,0);break;case"h-center":c=new cc_1.Vec3(r.center.x+(o.center.x-r.center.x)*n/a-d.center.x,0);break;case"right":c=new cc_1.Vec3(r.xMax+(o.xMax-r.xMax)*n/a-d.xMax,0,0);break;default:c=new cc_1.Vec3(0,0,0)}let u=node_2.default.getWorldPosition(s);node_2.default.setWorldPosition(s,vec3_1.MVec3.add(v3_a,u,c))})}}exports.default=new UIManager;