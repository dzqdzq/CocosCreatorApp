"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const selection_1=__importDefault(require("../../../public/selection")),node_1=__importDefault(require("../node")),node_2=__importDefault(require("../../../utils/node")),cc_1=require("cc"),vec3_1=require("../../../utils/math/vec3"),v3_a=new cc_1.Vec3;class UIManager{alignSelection(e){const c=selection_1.default.query();if(c.length<=1)return;let t=c.map(e=>node_1.default.query(e)),n=1e10,a=1e10,r=-1e10,o=-1e10;const s=(t=t.filter(e=>{let c=e.parent;for(;c;){if(-1!==t.indexOf(c))return!1;c=c.parent}return!0})).map(e=>{const c=node_2.default.getWorldBounds(e);return n=Math.min(n,c.x),a=Math.min(a,c.y),r=Math.max(r,c.xMax),o=Math.max(o,c.yMax),{node:e,bounds:c}}),d=new cc_1.Rect(n,a,r-n,o-a);cce.SceneFacadeManager.snapshot(),s.forEach(c=>{const t=c.node;let n;switch(e){case"top":n=new cc_1.Vec3(0,d.yMax-c.bounds.yMax,0);break;case"v-center":n=new cc_1.Vec3(0,d.center.y-c.bounds.center.y,0);break;case"bottom":n=new cc_1.Vec3(0,d.y-c.bounds.y,0);break;case"left":n=new cc_1.Vec3(d.x-c.bounds.x,0,0);break;case"h-center":n=new cc_1.Vec3(d.center.x-c.bounds.center.x,0,0);break;case"right":n=new cc_1.Vec3(d.xMax-c.bounds.xMax,0,0);break;default:n=new cc_1.Vec3}const a=node_2.default.getWorldPosition(t);node_2.default.setWorldPosition(t,vec3_1.MVec3.add(v3_a,a,n))}),cce.SceneFacadeManager.snapshot()}distributeSelection(e){const c=selection_1.default.query();if(c.length<=1)return;let t=c.map(e=>node_1.default.query(e));const n=(t=t.filter(e=>{let c=e.parent;for(;c;){if(-1!==t.indexOf(c))return!1;c=c.parent}return!0})).map(e=>{return{node:e,bounds:node_2.default.getWorldBounds(e)}});n.sort((c,t)=>{let n=1;switch(e){case"top":n=c.bounds.yMax-t.bounds.yMax;break;case"v-center":n=c.bounds.center.y-t.bounds.center.y;break;case"bottom":n=c.bounds.y-t.bounds.y;break;case"left":n=c.bounds.x-t.bounds.x;break;case"h-center":n=c.bounds.center.x-t.bounds.center.x;break;case"right":n=c.bounds.xMax-t.bounds.xMax}return n});const a=n.length-1,r=n[0].bounds,o=n[a].bounds;cce.SceneFacadeManager.snapshot(),n.forEach((c,t)=>{const n=c.node,s=c.bounds;let d;switch(e){case"top":d=new cc_1.Vec3(0,r.yMax+(o.yMax-r.yMax)*t/a-s.yMax,0);break;case"v-center":d=new cc_1.Vec3(0,r.center.y+(o.center.y-r.center.y)*t/a-s.center.y,0);break;case"bottom":d=new cc_1.Vec3(0,r.y+(o.y-r.y)*t/a-s.y,0);break;case"left":d=new cc_1.Vec3(r.x+(o.x-r.x)*t/a-s.x,0,0);break;case"h-center":d=new cc_1.Vec3(r.center.x+(o.center.x-r.center.x)*t/a-s.center.x,0);break;case"right":d=new cc_1.Vec3(r.xMax+(o.xMax-r.xMax)*t/a-s.xMax,0,0);break;default:d=new cc_1.Vec3(0,0,0)}const u=node_2.default.getWorldPosition(n);node_2.default.setWorldPosition(n,vec3_1.MVec3.add(v3_a,u,d))}),cce.SceneFacadeManager.snapshot()}}exports.default=new UIManager;