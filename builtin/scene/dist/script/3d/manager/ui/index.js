"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UIManager=void 0;const selection_1=__importDefault(require("../../../public/selection")),node_1=__importDefault(require("../node")),node_2=__importDefault(require("../../../utils/node")),cc_1=require("cc"),vec3_1=require("../../../utils/math/vec3"),v3_a=new cc_1.Vec3;class UIManager{alignSelection(e){const n=selection_1.default.query();if(n.length<=1)return;let t=n.map(e=>node_1.default.query(e)).filter(Boolean),c=1e10,a=1e10,r=-1e10,o=-1e10;const s=(t=t.filter(e=>{let n=e.parent;for(;n;){if(-1!==t.indexOf(n))return!1;n=n.parent}return!0})).map(e=>{const n=node_2.default.getWorldBounds(e);return c=Math.min(c,n.x),a=Math.min(a,n.y),r=Math.max(r,n.xMax),o=Math.max(o,n.yMax),{node:e,bounds:n}}),d=new cc_1.Rect(c,a,r-c,o-a);cce.SceneFacadeManager.snapshot(),s.forEach(n=>{const t=n.node;let c;switch(e){case"top":c=new cc_1.Vec3(0,d.yMax-n.bounds.yMax,0);break;case"v-center":c=new cc_1.Vec3(0,d.center.y-n.bounds.center.y,0);break;case"bottom":c=new cc_1.Vec3(0,d.y-n.bounds.y,0);break;case"left":c=new cc_1.Vec3(d.x-n.bounds.x,0,0);break;case"h-center":c=new cc_1.Vec3(d.center.x-n.bounds.center.x,0,0);break;case"right":c=new cc_1.Vec3(d.xMax-n.bounds.xMax,0,0);break;default:c=new cc_1.Vec3}const a=node_2.default.getWorldPosition(t);node_2.default.setWorldPosition(t,vec3_1.MVec3.add(v3_a,a,c))}),cce.SceneFacadeManager.snapshot()}distributeSelection(e){const n=selection_1.default.query();if(n.length<=1)return;let t=n.map(e=>node_1.default.query(e)).filter(Boolean);const c=(t=t.filter(e=>{let n=e.parent;for(;n;){if(-1!==t.indexOf(n))return!1;n=n.parent}return!0})).map(e=>{return{node:e,bounds:node_2.default.getWorldBounds(e)}});c.sort((n,t)=>{let c=1;switch(e){case"top":c=n.bounds.yMax-t.bounds.yMax;break;case"v-center":c=n.bounds.center.y-t.bounds.center.y;break;case"bottom":c=n.bounds.y-t.bounds.y;break;case"left":c=n.bounds.x-t.bounds.x;break;case"h-center":c=n.bounds.center.x-t.bounds.center.x;break;case"right":c=n.bounds.xMax-t.bounds.xMax}return c});const a=c.length-1,r=c[0].bounds,o=c[a].bounds;cce.SceneFacadeManager.snapshot(),c.forEach((n,t)=>{const c=n.node,s=n.bounds;let d;switch(e){case"top":d=new cc_1.Vec3(0,r.yMax+(o.yMax-r.yMax)*t/a-s.yMax,0);break;case"v-center":d=new cc_1.Vec3(0,r.center.y+(o.center.y-r.center.y)*t/a-s.center.y,0);break;case"bottom":d=new cc_1.Vec3(0,r.y+(o.y-r.y)*t/a-s.y,0);break;case"left":d=new cc_1.Vec3(r.x+(o.x-r.x)*t/a-s.x,0,0);break;case"h-center":d=new cc_1.Vec3(r.center.x+(o.center.x-r.center.x)*t/a-s.center.x,0);break;case"right":d=new cc_1.Vec3(r.xMax+(o.xMax-r.xMax)*t/a-s.xMax,0,0);break;default:d=new cc_1.Vec3(0,0,0)}const u=node_2.default.getWorldPosition(c);node_2.default.setWorldPosition(c,vec3_1.MVec3.add(v3_a,u,d))}),cce.SceneFacadeManager.snapshot()}}exports.UIManager=UIManager,exports.default=new UIManager;