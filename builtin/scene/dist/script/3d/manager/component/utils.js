"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),physics_2d_1=__importDefault(require("../physics-2d"));function getBoundingBox(e){let t=e.getComponent(cc_1.MeshRenderer);return t&&t.mesh?{minPosition:t.mesh.minPosition,maxPosition:t.mesh.maxPosition}:{minPosition:cc_1.Vec3.ZERO,maxPosition:cc_1.Vec3.ZERO}}function getSize(e){const t=new cc_1.Vec3;return cc_1.Vec3.subtract(t,e.maxPosition,e.minPosition),t}function getCenter(e){const t=getSize(e),n=new cc_1.Vec3;return cc_1.Vec3.scaleAndAdd(n,e.minPosition,t,.5),n}function maxComponent(e){return Math.max(e.x,Math.max(e.y,e.z))}class ComponentUtils{constructor(){this.addComponentMap={SphereCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),i=getSize(n);cc_1.Vec3.strictEquals(i,cc_1.Vec3.ZERO)||(e.radius=maxComponent(i)/2,e.center=getCenter(n))},BoxCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),i=getSize(n);cc_1.Vec3.strictEquals(i,cc_1.Vec3.ZERO)||(i.x=0===i.x?.001:i.x,i.y=0===i.y?.001:i.y,i.z=0===i.z?.001:i.z,e.size=i,e.center=getCenter(n))},ConeCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),i=getSize(n);if(!cc_1.Vec3.strictEquals(i,cc_1.Vec3.ZERO)){const t=Math.max(i.x,i.z)/2,c=i.y;t>0&&(e.radius=t),c>0&&(e.height=c),e.center=getCenter(n)}},CylinderCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),i=getSize(n);if(!cc_1.Vec3.strictEquals(i,cc_1.Vec3.ZERO)){const t=Math.max(i.x,i.z)/2,c=i.y;t>0&&(e.radius=t),c>0&&(e.height=c),e.center=getCenter(n)}},CapsuleCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),i=getSize(n);if(!cc_1.Vec3.strictEquals(i,cc_1.Vec3.ZERO)){const t=Math.max(i.x,i.z)/2,c=i.y-2*t;t>0&&(e.radius=t,e.cylinderHeight=c>0?c:0),e.center=getCenter(n)}},MeshCollider(e,t){if(t._prefab)return;const n=t.getComponent(cc_1.MeshRenderer);n&&n.mesh&&(e.mesh=n.mesh)},TerrainCollider(e,t){if(t._prefab)return;const n=t.getComponent(cc_1.Terrain);n&&n._asset&&(e.terrain=n._asset)},BoxCollider2D(e,t){let n=e.getComponent(cc_1.UITransformComponent);if(!n)return;let i=n.contentSize;0!==i.width&&0!==i.height&&(e.size=cc.size(i),e.offset.x=(.5-n.anchorX)*i.width,e.offset.y=(.5-n.anchorY)*i.height)},CircleCollider2D(e,t){let n=e.getComponent(cc_1.UITransformComponent);if(!n)return;let i=n.contentSize,c=Math.max(i.width,i.height)/2;0!==c&&(e.radius=c)},PolygonCollider2D(e,t){physics_2d_1.default.resetPoints(e)}}}}exports.default=new ComponentUtils;