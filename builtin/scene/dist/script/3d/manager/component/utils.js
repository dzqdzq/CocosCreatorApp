"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),physics_2d_1=__importDefault(require("../physics-2d"));function getBoundingBox(e){const t=e.getComponent(cc_1.MeshRenderer);return t&&t.mesh?{minPosition:t.mesh.minPosition,maxPosition:t.mesh.maxPosition}:{minPosition:cc_1.Vec3.ZERO,maxPosition:cc_1.Vec3.ZERO}}function getSize(e){const t=new cc_1.Vec3;return cc_1.Vec3.subtract(t,e.maxPosition,e.minPosition),t}function getCenter(e){const t=getSize(e),n=new cc_1.Vec3;return cc_1.Vec3.scaleAndAdd(n,e.minPosition,t,.5),n}function maxComponent(e){return Math.max(e.x,Math.max(e.y,e.z))}class ComponentUtils{constructor(){this.addComponentMap={SphereCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),c=getSize(n);cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO)||(e.radius=maxComponent(c)/2,e.center=getCenter(n))},BoxCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),c=getSize(n);cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO)||(c.x=0===c.x?.001:c.x,c.y=0===c.y?.001:c.y,c.z=0===c.z?.001:c.z,e.size=c,e.center=getCenter(n))},ConeCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),c=getSize(n);if(!cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO)){const t=Math.max(c.x,c.z)/2,o=c.y;t>0&&(e.radius=t),o>0&&(e.height=o),e.center=getCenter(n)}},CylinderCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),c=getSize(n);if(!cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO)){const t=Math.max(c.x,c.z)/2,o=c.y;t>0&&(e.radius=t),o>0&&(e.height=o),e.center=getCenter(n)}},CapsuleCollider(e,t){if(t._prefab)return;const n=getBoundingBox(t),c=getSize(n);if(!cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO)){const t=Math.max(c.x,c.z)/2,o=c.y-2*t;t>0&&(e.radius=t,e.cylinderHeight=o>0?o:0),e.center=getCenter(n)}},MeshCollider(e,t){if(t._prefab)return;const n=t.getComponent(cc_1.MeshRenderer);n&&n.mesh&&(e.mesh=n.mesh)},TerrainCollider(e,t){if(t._prefab)return;const n=t.getComponent(cc_1.Terrain);n&&n._asset&&(e.terrain=n._asset)},BoxCollider2D(e,t){const n=e.getComponent(cc_1.UITransformComponent);if(!n)return;const c=n.contentSize;0!==c.width&&0!==c.height&&(e.size=cc.size(c),e.offset.x=(.5-n.anchorX)*c.width,e.offset.y=(.5-n.anchorY)*c.height)},CircleCollider2D(e,t){const n=e.getComponent(cc_1.UITransformComponent);if(!n)return;const c=n.contentSize,o=Math.max(c.width,c.height)/2;0!==o&&(e.radius=o)},PolygonCollider2D(e,t){physics_2d_1.default.resetPoints(e)}}}}exports.default=new ComponentUtils;