"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),external_1=__importDefault(require("../../utils/external")),base_1=require("../base"),point_1=__importDefault(require("../../controller/point")),line_1=__importDefault(require("../../controller/line")),triangle_1=__importDefault(require("../../controller/triangle")),tetrahedron_1=__importDefault(require("../../controller/tetrahedron")),NodeUtils=external_1.default.NodeUtils,tempVec3_a=new cc_1.Vec3,tempVec3_b=new cc_1.Vec3,tempVec3_c=new cc_1.Vec3,tempVec3_d=new cc_1.Vec3,tempQuat_a=new cc_1.Quat;class SimplexColliderGizmo extends base_1.SelectGizmo{_shapeControllers={};_activeController=null;init(){}createControllerByShape(e){var t=this.getGizmoRoot();let r=null;switch(e){case cc_1.SimplexCollider.ESimplexType.VERTEX:r=new point_1.default(t);break;case cc_1.SimplexCollider.ESimplexType.LINE:r=new line_1.default(t);break;case cc_1.SimplexCollider.ESimplexType.TRIANGLE:r=new triangle_1.default(t);break;case cc_1.SimplexCollider.ESimplexType.TETRAHEDRON:r=new tetrahedron_1.default(t);break;default:console.error("Invalid Type:",e)}return r&&r.setColor(cc_1.Color.GREEN),r}getControllerByShape(e){let t=this._shapeControllers[e];return t||(t=this.createControllerByShape(e),this._shapeControllers[e]=t),t}onShow(){this.updateControllerData()}onHide(){this._activeController&&this._activeController.hide()}updateControllerData(){if(this._isInitialized&&null!==this.target&&this.target instanceof cc_1.SimplexCollider){var e=this.target.node,t=this.target,r=(this._activeController?.hide(),this._activeController=this.getControllerByShape(t.shapeType),NodeUtils.getWorldScale3D(e)),l=NodeUtils.getWorldPosition3D(e),c=tempQuat_a;switch(NodeUtils.getWorldRotation3D(e,c),this._activeController?.setScale(r),this._activeController?.setPosition(l),this._activeController?.setRotation(c),t.shapeType){case cc_1.SimplexCollider.ESimplexType.VERTEX:cc_1.Vec3.add(tempVec3_a,t.center,t.vertex0),this._activeController.updateData(tempVec3_a);break;case cc_1.SimplexCollider.ESimplexType.LINE:cc_1.Vec3.add(tempVec3_a,t.center,t.vertex0),cc_1.Vec3.add(tempVec3_b,t.center,t.vertex1),this._activeController.updateData(tempVec3_a,tempVec3_b);break;case cc_1.SimplexCollider.ESimplexType.TRIANGLE:cc_1.Vec3.add(tempVec3_a,t.center,t.vertex0),cc_1.Vec3.add(tempVec3_b,t.center,t.vertex1),cc_1.Vec3.add(tempVec3_c,t.center,t.vertex2),this._activeController.updateData(tempVec3_a,tempVec3_b,tempVec3_c);break;case cc_1.SimplexCollider.ESimplexType.TETRAHEDRON:cc_1.Vec3.add(tempVec3_a,t.center,t.vertex0),cc_1.Vec3.add(tempVec3_b,t.center,t.vertex1),cc_1.Vec3.add(tempVec3_c,t.center,t.vertex2),cc_1.Vec3.add(tempVec3_d,t.center,t.vertex3),this._activeController.updateData(tempVec3_a,tempVec3_b,tempVec3_c,tempVec3_d)}this._activeController?.show()}}onTargetUpdate(){this.updateControllerData()}onNodeChanged(){this.updateControllerData()}}exports.default=SimplexColliderGizmo;