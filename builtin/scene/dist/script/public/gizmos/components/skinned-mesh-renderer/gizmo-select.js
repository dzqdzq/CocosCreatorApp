"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),index_1=__importDefault(require("../../utils/engine/index")),base_1=require("../base"),box_1=__importDefault(require("../../controller/box")),controller_light_probe_tetrahedron_1=__importDefault(require("../light-probe-group/controller-light-probe-tetrahedron")),manager_1=require("../light-probe-group/manager"),types_1=require("../light-probe-group/types"),{getBoundingBox,getRootBoneNode}=index_1.default;class SkinningModelComponentGizmo extends base_1.SelectGizmo{init(){this.createController(),this._isInitialized=!0,manager_1.eventEmitter.addListener(types_1.LightProbeManagerEvent.MODE_CHANGED,()=>{this.tetrahedronController.updateController()})}onShow(){this._controller.show(),this.tetrahedronController.show(),this.updateControllerTransform()}onHide(){this._controller.hide(),this.tetrahedronController.hide()}createController(){var e=this.getGizmoRoot();this._controller=new box_1.default(e),this._controller.setOpacity(150),this.tetrahedronController=new controller_light_probe_tetrahedron_1.default(e,this)}updateControllerTransform(){this.updateControllerData()}updateControllerData(){var e,t,r;this._isInitialized&&null!=this.target&&(getRootBoneNode(this.target)&&(e=getBoundingBox(this.target))?(t=cc.v3(),cc_1.Vec3.multiplyScalar(t,e.halfExtents,2),r=cc.v3(),cc_1.Vec3.copy(r,e.center),this._controller.updateSize(r,t)):this._controller.hide())}onTargetUpdate(){var e;this.updateControllerData(),null!=(e=this.tetrahedronController)&&e.updateController()}onNodeChanged(){var e;this.updateControllerData(),null!=(e=this.tetrahedronController)&&e.updateController()}onUpdate(){var e;this.updateControllerData(),null!=(e=this.tetrahedronController)&&e.updateController()}}exports.default=SkinningModelComponentGizmo;