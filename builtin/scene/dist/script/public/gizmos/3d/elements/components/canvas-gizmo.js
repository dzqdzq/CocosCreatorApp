"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const gizmo_base_1=__importDefault(require("../gizmo-base")),rectangle_controller_1=require("../controller/rectangle-controller"),external_1=__importDefault(require("../../../utils/external")),cc_1=require("cc"),utils_1=__importDefault(require("../../../utils")),NodeUtils=external_1.default.NodeUtils,tempQuat_a=new cc_1.Quat;class CanvasGizmo extends gizmo_base_1.default{init(){this.createController()}onShow(){this._controller.show(),this.updateController()}onHide(){this._controller.hide()}createController(){const t=this.getGizmoRoot();this._controller=new rectangle_controller_1.RectangleController(t),this._controller.onControllerMouseDown=this.onControllerMouseDown.bind(this),this._controller.onControllerMouseMove=this.onControllerMouseMove.bind(this),this._controller.onControllerMouseUp=this.onControllerMouseUp.bind(this)}onControllerMouseDown(){}onControllerMouseMove(){}onControllerMouseUp(){this.node&&utils_1.default.select(this.node.uuid)}updateControllerData(){if(this._isInited&&this.target&&this.target instanceof cc_1.Canvas){const t=this.node.getComponent(cc_1.UITransform);if(t){const e=t.contentSize;this._controller.show(),this._controller.updateSize(cc.v3(),cc.v2(e.width,e.height))}}}updateControllerTransform(){if(!this._isInited||null===this.target)return;const t=this.node,e=NodeUtils.getWorldPosition3D(t),o=tempQuat_a;NodeUtils.getWorldRotation3D(t,o),this._controller.setPosition(e),this._controller.setRotation(o)}updateController(){this.updateControllerData(),this.updateControllerTransform()}onTargetUpdate(){this.updateController()}onNodeChanged(){this.updateController()}}exports.default=CanvasGizmo;