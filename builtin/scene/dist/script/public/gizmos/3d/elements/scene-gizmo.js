"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const external_1=__importDefault(require("../../utils/external")),NodeUtils=external_1.default.NodeUtils,gizmo_base_1=__importDefault(require("./gizmo-base")),box_controller_1=__importDefault(require("./controller/box-controller")),cc_1=require("cc");class SceneGizmo extends gizmo_base_1.default{constructor(){super(...arguments),this._controller=null,this._octreeBoundingBox=new cc_1.geometry.AABB,this._octreeBBSize=new cc_1.Vec3}init(){this.createController(),this._isInited=!0}onShow(){this._controller.show(),this.updateControllerTransform()}onHide(){this._controller.hide()}createController(){const e=this.getGizmoRoot();this._controller=new box_controller_1.default(e),this._controller.setOpacity(150)}updateControllerTransform(){this.updateControllerData()}updateControllerData(){if(!this._isInited||null===this.target)return void this._controller.hide();const e=this.target.globals.octree;e&&e.enabled?(cc_1.geometry.AABB.fromPoints(this._octreeBoundingBox,e.minPos,e.maxPos),cc_1.Vec3.multiplyScalar(this._octreeBBSize,this._octreeBoundingBox.halfExtents,2),this._controller.updateSize(this._octreeBoundingBox.center,this._octreeBBSize),cce.Engine.repaintInEditMode()):this._controller.hide()}onTargetUpdate(){this.updateControllerData()}onNodeChanged(){this.updateControllerData()}}exports.default=SceneGizmo;