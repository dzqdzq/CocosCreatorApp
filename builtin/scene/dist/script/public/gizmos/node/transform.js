"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const gizmo_select_1=__importDefault(require("../components/base/gizmo-select")),position_1=__importDefault(require("./position")),rotation_1=__importDefault(require("./rotation")),scale_1=__importDefault(require("./scale")),rectangle_1=__importDefault(require("./rectangle")),view_1=__importDefault(require("./view")),gizmoMap={view:new view_1.default(null),position:new position_1.default(null),rotation:new rotation_1.default(null),scale:new scale_1.default(null),rect:new rectangle_1.default(null)};class TransformGizmo extends gizmo_select_1.default{constructor(){super(...arguments),this._gizmo=gizmoMap[cce.Gizmo.transformToolData.toolName],this._eventMap={toolNameChanged:()=>{this.changeTool(cce.Gizmo.transformToolData.toolName)}}}get nodes(){return this._gizmo.nodes}set target(e){this._gizmo.target=e,super.target=e}get target(){return this._gizmo.target}changeTool(e){var o=this._gizmo.target,e=(this._gizmo.hide(),this._gizmo.target=null,gizmoMap[e]);this._gizmo.constructor!==e.constructor&&this._gizmo.onHide(),this._gizmo=e,this._gizmo.target=this._gizmo.target||o,this._gizmo.show()}onVertexSnapMove(e){if(this._gizmo.onVertexSnapMove)return this._gizmo.onVertexSnapMove(e)}init(){this._gizmo.init()}show(){super.show(),this._gizmo.show()}hide(){super.hide(),this._gizmo.hide()}onShow(){var e;super.onShow&&super.onShow(),this.changeTool(cce.Gizmo.transformToolData.toolName),this._eventMap.toolNameChanged=()=>{this.changeTool(cce.Gizmo.transformToolData.toolName)},this._eventMap.viewModeChanged=()=>{cce.Engine.repaintInEditMode()},this._eventMap.pivotChanged=()=>{this._gizmo.updateControllerTransform&&this._gizmo.updateControllerTransform(),cce.Engine.repaintInEditMode()},this._eventMap.coordinateChanged=()=>{this._gizmo.updateControllerTransform&&this._gizmo.updateControllerTransform(),cce.Engine.repaintInEditMode()},null!=(e=cce.Gizmo.transformToolData)&&e.addListener("tool-name-changed",this._eventMap.toolNameChanged),null!=(e=cce.Gizmo.transformToolData)&&e.addListener("view-mode-changed",this._eventMap.viewModeChanged),null!=(e=cce.Gizmo.transformToolData)&&e.addListener("pivot-changed",this._eventMap.pivotChanged),null!=(e=cce.Gizmo.transformToolData)&&e.addListener("coordinate-changed",this._eventMap.coordinateChanged),this._gizmo.onShow()}onHide(){var e;super.onHide&&super.onHide(),null!=(e=cce.Gizmo.transformToolData)&&e.removeListener("tool-name-changed",this._eventMap.toolNameChanged),null!=(e=cce.Gizmo.transformToolData)&&e.removeListener("view-mode-changed",this._eventMap.viewModeChanged),null!=(e=cce.Gizmo.transformToolData)&&e.removeListener("pivot-changed",this._eventMap.pivotChanged),null!=(e=cce.Gizmo.transformToolData)&&e.removeListener("coordinate-changed",this._eventMap.coordinateChanged),this._gizmo.onHide()}onUpdate(e){this._gizmo.onUpdate&&this._gizmo.onUpdate(e)}onDestroy(){this._gizmo.onDestroy&&this._gizmo.onDestroy()}onNodeChanged(e){this._gizmo.onNodeChanged&&this._gizmo.onNodeChanged(e)}onKeyDown(e){return this._gizmo.onKeyDown&&this._gizmo.onKeyDown(e)}onKeyUp(e){return this._gizmo.onKeyUp&&this._gizmo.onKeyUp(e)}onCameraControlModeChanged(e){return this._gizmo.onCameraControlModeChanged&&this._gizmo.onCameraControlModeChanged(e)}}exports.default=TransformGizmo;