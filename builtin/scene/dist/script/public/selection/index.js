"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const{EventEmitter:EventEmitter}=require("events"),uuid_array_1=__importDefault(require("./uuid-array"));class Selection extends EventEmitter{constructor(){super(),this.selectUuids=new uuid_array_1.default,this.unselectUuids=new uuid_array_1.default,this.uuids=new uuid_array_1.default,this.noticeTimer=null,this._hover=void 0}isSelect(e){return-1!==this.uuids.indexOf(e)}query(){return this.uuids.uuids.slice()}select(e){if(!this.uuids.add(e))return this.uuids.remove(e),this.emit("unselect",e,this.uuids.uuids.slice()),this.uuids.add(e),void this.emit("select",e,this.uuids.uuids.slice());this.selectUuids.add(e),this.unselectUuids.remove(e),this.notice(),this.emit("select",e,this.uuids.uuids.slice())}unselect(e){this.uuids.remove(e)&&(this.selectUuids.remove(e),this.unselectUuids.add(e),this.notice(),this.emit("unselect",e,this.uuids.uuids.slice()))}clear(){this.uuids.forEach(e=>{this.selectUuids.remove(e),this.unselectUuids.add(e),this.emit("unselect",e)}),this.uuids.clear(),this.notice()}notice(){clearTimeout(this.noticeTimer),this.noticeTimer=setTimeout(()=>{cce.Ipc.send("unselect-nodes",this.unselectUuids.uuids),cce.Ipc.send("select-nodes",this.selectUuids.uuids),this.selectUuids.clear(),this.unselectUuids.clear()},100)}_select(e){this.uuids.add(e)&&(this.selectUuids.add(e),this.unselectUuids.remove(e),this.emit("select",e,this.uuids.uuids.slice()))}_unselect(e){this.uuids.remove(e)&&(this.selectUuids.remove(e),this.unselectUuids.add(e),this.emit("unselect",e,this.uuids.uuids.slice()))}}exports.default=new Selection;