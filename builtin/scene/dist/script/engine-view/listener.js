"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=exports.start=exports.stop=exports.status=void 0;let leftButton=!1,middleButton=!1,rightButton=!1;const utils={createMouseEvent:(e,t)=>({ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,x:e.pageX-t.x,y:e.pageY-t.y,deltaX:e.deltaX||0,deltaY:e.deltaY||0,wheelDeltaX:e.wheelDeltaX||0,wheelDeltaY:e.wheelDeltaY||0,moveDeltaX:e.movementX||0,moveDeltaY:e.movementY||0,leftButton:leftButton,middleButton:middleButton,rightButton:rightButton}),createKeyboardEvent:e=>({ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,key:e.key,keyCode:e.keyCode}),createDragEvent(e,t){const{type:n,value:o,name:u,additional:a}=Editor.UI.DragArea.currentDragInfo||{},s=utils.createMouseEvent(e,t);s.name=u,s.type=n,s.value=o,s.values=[];let r=[];return Array.isArray(a)&&(s.values=a,r=s.values.map(e=>e.value)),o&&!r.includes(o)&&s.values.push({value:o,type:n,name:u}),s},createConfirmEvent:e=>({path:e.target.getAttribute("path"),value:e.target.value})};function stop(){exports.status="pause"}function start(){exports.status="ready"}function checkMouseButtonState(e,t){leftButton=0===e.button?t:leftButton,middleButton=1===e.button?t:middleButton,rightButton=2===e.button?t:rightButton}function init(e){e.addEventListener("mousedown",t=>{if("pause"===exports.status)return;const n=e.getBoundingClientRect();function o(t){const n=e.getBoundingClientRect();0===t.movementX&&0===t.movementY||e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["mousemove",utils.createMouseEvent(t,n)],queue:!1,timeout:!0})}document.body.style.pointerEvents="none",checkMouseButtonState(t,!0),e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["mousedown",utils.createMouseEvent(t,n)],queue:!1,timeout:!0}),document.addEventListener("mouseup",function t(n){const u=e.getBoundingClientRect();document.body.style.pointerEvents="",e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["mouseup",utils.createMouseEvent(n,u)],queue:!1,timeout:!0}),checkMouseButtonState(n,!1),document.removeEventListener("mouseup",t),document.removeEventListener("mousemove",o)}),document.addEventListener("mousemove",o)}),e.addEventListener("mousemove",t=>{if("pause"===exports.status)return;const n=e.getBoundingClientRect();0===t.movementX&&0===t.movementY||e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["mousemove",utils.createMouseEvent(t,n)],queue:!1,timeout:!0})}),e.addEventListener("wheel",t=>{if("pause"===exports.status)return;const n=e.getBoundingClientRect();e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["wheel",utils.createMouseEvent(t,n)],queue:!1,timeout:!0})}),e.addEventListener("keydown",t=>{"pause"!==exports.status&&e.ipc.send("call-method",{module:"Operation",handler:"_emit",params:["keydown",utils.createKeyboardEvent(t)],queue:!1,timeout:!0})}),e.addEventListener("keyup",t=>{"pause"!==exports.status&&e.ipc.send("call-method",{module:"Operation",handler:"_emit",params:["keyup",utils.createKeyboardEvent(t)],queue:!1,timeout:!0})}),e.addEventListener("dragover",t=>{if("pause"===exports.status)return;const n=e.getBoundingClientRect(),o=utils.createDragEvent(t,n);t.preventDefault(),e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["onDragOver",o],queue:!1,timeout:!0})}),e.addEventListener("drop",t=>{if("pause"===exports.status)return;t.preventDefault();const n=e.getBoundingClientRect();e.ipc.send("call-method",{module:"Operation",handler:"_emitMouseEvent",params:["onDrop",utils.createDragEvent(t,n)],queue:!1,timeout:!0})})}exports.status="pause",exports.stop=stop,exports.start=start,exports.init=init;