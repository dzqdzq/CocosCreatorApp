"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.title=void 0;const path_1=__importDefault(require("path")),project_scripts_1=require("./project-scripts"),build_time_constants_1=require("./build-time-constants"),engine_1=require("./engine"),polyfill_1=require("./polyfill"),system_js_1=require("./system-js"),utils_1=require("../../utils");async function handle(t,i,e){const r=this;Editor.Metrics.trackTimeStart("builder:build-script-total"),await(0,polyfill_1.buildPolyfillsX)(t,i),await(0,system_js_1.buildSystemJsX)(t,i),await async function(){const s=path_1.default.join(i.paths.dir,"src");t.buildEngineParam.flags=t.buildScriptParam.flags;const l=await(0,build_time_constants_1.getBuildTimeConstants)(t.buildEngineParam);r.updateProcess(`${Editor.I18n.t("builder.tasks.build_project_script")} start...`),console.debug((0,utils_1.getMemorySize)()),Editor.Metrics.trackTimeStart("builder:build-project-script"),await(0,project_scripts_1.buildProjectScriptsX)(t,i,e,l);const a=Editor.Metrics.trackTimeEnd("builder:build-project-script");r.updateProcess(`${Editor.I18n.t("builder.tasks.build_project_script")} in (${a} ms) √`),r.updateProcess(`${Editor.I18n.t("builder.tasks.build_engine")} start...`),console.debug((0,utils_1.getMemorySize)()),Editor.Metrics.trackTimeStart("builder:build-engine"),await(0,engine_1.buildEngineX)(t,i,e,i.importMap,s,l);const d=Editor.Metrics.trackTimeEnd("builder:build-engine");r.updateProcess(`${Editor.I18n.t("builder.tasks.build_engine")} in (${d} ms) √`)}(),Editor.Metrics.trackTimeEnd("builder:build-script-total")}exports.title="i18n:builder.tasks.build_script",exports.handle=handle;