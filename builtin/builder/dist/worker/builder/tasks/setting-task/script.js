"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.title=void 0;const sort_plugin_scripts_1=require("@editor/lib-programming/dist/executor/sort-plugin-scripts"),path_1=require("path"),utils_1=require("../../utils");async function handle(t,s,e){const i=s.settings;i.scripting.scriptPackages=s.scriptPackages.map(t=>Build.Utils.relativeUrl(s.paths.engineDir,t));const r=[],n={};this.bundleManager.bundles.forEach(i=>{for(const p of i.pluginScript){const i=e.getAssetInfo(p);let a=(0,utils_1.removeDbHeader)(i.url);r.push([p,(0,sort_plugin_scripts_1.getPluginScriptDependencies)(i.meta.userData)]),t.md5Cache&&s.paths.plugins[p]&&(a=a.replace(/[^\/]*$/,()=>(0,path_1.basename)(s.paths.plugins[p]))),n[p]=a}});const p=(0,sort_plugin_scripts_1.sortPluginScripts)(r);i.plugins.jsList=p.map(t=>n[t])}exports.title="i18n:builder.tasks.settings.script",exports.handle=handle;