"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.name=exports.title=void 0;const path_1=require("path"),script_1=require("../../asset-handler/script");async function handle(t,s,a){if(!t.md5Cache)return;let p=0;for(const t of Object.keys(s.paths.plugins)){const a=s.paths.plugins[t],i=await Build.Utils.appendMd5ToPaths([a]);i&&(p++,s.paths.plugins[t]=i.paths[0])}for(const t of Object.keys(s.importMap.imports)){const a=(0,path_1.dirname)(s.paths.importMap),p=s.importMap.imports[t];if(!p.startsWith("."))continue;const i=(0,path_1.join)(a,p),e=await Build.Utils.appendMd5ToPaths([i]);e&&(s.importMap.imports[t]=`./${Build.Utils.relativeUrl(a,e.paths[0])}`)}await script_1.ScriptBuilder.outputImportMap(s.importMap,{dest:s.paths.importMap,importMapFormat:t.buildScriptParam.importMapFormat,debug:t.debug}),s.paths.importMap=(await Build.Utils.appendMd5ToPaths([s.paths.importMap])).paths[0],s.paths.polyfillsJs&&(s.paths.polyfillsJs=(await Build.Utils.appendMd5ToPaths([s.paths.polyfillsJs])).paths[0]),s.paths.systemJs&&(s.paths.systemJs=(await Build.Utils.appendMd5ToPaths([s.paths.systemJs])).paths[0]);for(let t=0;t<s.scriptPackages.length;t++){const a=s.scriptPackages[t],p=await Build.Utils.appendMd5ToPaths([a]);p&&(s.scriptPackages[t]=p.paths[0])}console.debug(`add suffix to assets(${p}) success!`)}exports.title="i18n:builder.tasks.build_suffix",exports.name="build-task/suffix",exports.handle=handle;