"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.title=void 0;const compressUuid=EditorExtends.UuidUtils.compressUuid;async function handle(s,t,e){if(!s.debug){for(const s of t.bundles){const t=s.config,e=o(t),n=t.paths,c=t.paths={},r=t.types=[];for(const s in n){const t=n[s],o=e[s];let i=r.indexOf(t[1]);-1===i&&(i=r.length,r.push(t[1])),t[1]=i,c[o]=t}const i=t.scenes;for(const s in i){const t=e[i[s]];i[s]=Number(t)}const u=t.packs;for(const s in u){const t=u[s];for(let s=0;s<t.length;++s){const o=e[t[s]];t[s]=o}}const f=t.versions;for(const s of Object.values(f))for(let t=0;t<s.length;t+=2){const o=e[s[t]];s[t]=Number(o)}const d=t.redirect;for(let s=0;s<d.length;s+=2){const t=e[d[s]];d[s]=Number(t)}}s.debug||(t.settings.renderPipeline=compressUuid(t.settings.renderPipeline,!0))}function o(s){const t={},e={};function o(s){const o=(t[s]||0)+1;t[s]=o,s in e||(e[s]=s)}const n=s.paths;for(const s in n)o(s);const c=s.scenes;for(const s in c)o(c[s]);const r=s.packs,i=Object.keys(r).sort();for(const s of i)r[s].forEach(o);const u=s.versions;for(const s of Object.values(u))for(let t=0;t<s.length;t+=2)o(s[t]);const f=s.redirect;for(let s=0;s<f.length;s+=2)o(f[s]);return s.uuids.sort((s,e)=>t[e]-t[s]),s.uuids.forEach((s,t)=>e[s]=String(t)),s.uuids=s.uuids.map(s=>compressUuid(s,!0)),e}}exports.title="i18n:tasks.postprocess.compress",exports.handle=handle;