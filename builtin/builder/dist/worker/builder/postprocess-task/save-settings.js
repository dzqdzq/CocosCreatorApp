"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.title=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),crypto_1=require("crypto"),bundle_utils_1=require("../../../share/bundle-utils");async function handle(e,s,t){const n=s.settings;if(e.md5Cache){s.bundles.sort((e,s)=>e.name.localeCompare(s.name));for(const e of s.bundles)n.assets.bundleVers[e.name]=e.version;const e=(0,crypto_1.createHash)("md5");e.update(JSON.stringify(s.settings)),s.paths.settings=(0,path_1.join)((0,path_1.dirname)(s.paths.settings),`settings.${e.digest("hex").slice(0,5)}.json`)}s.settings.engine.builtinAssets=Array.from(s.bundleMap[bundle_utils_1.BuiltinBundleName.INTERNAL]._rootAssets),s.settings.assets.projectBundles=s.bundles.map(e=>e.name);const i=JSON.stringify(s.settings,null,e.debug?4:0);(0,fs_extra_1.outputFileSync)(s.paths.settings,i,"utf8")}exports.title="i18n:builder.tasks.postprocess.save_settings",exports.handle=handle;