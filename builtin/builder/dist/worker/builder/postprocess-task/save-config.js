"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=exports.title=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),crypto_1=require("crypto");async function handle(t,e,s){for(const s of e.bundles){let e=path_1.join(s.dest,(s.configOutPutName||path_1.parse(Build.CONFIG_NAME).name)+".json");if(t.md5Cache){const t=crypto_1.createHash("md5");t.update(JSON.stringify(s.config));const a=fs_extra_1.readFileSync(s.scriptDest);t.update(a);const n=t.digest("hex").slice(0,5);if(!s.isSubpackage){const t=path_1.join(path_1.dirname(s.scriptDest),`${path_1.parse(s.scriptDest).name}.${n}${path_1.extname(s.scriptDest)}`);fs_extra_1.renameSync(s.scriptDest,t),s.scriptDest=t}e=path_1.join(s.dest,`${s.configOutPutName||path_1.parse(Build.CONFIG_NAME).name}.${n}.json`),s.version=n}const a=JSON.stringify(s.config,null,t.debug?4:0);fs_extra_1.outputFileSync(e,a,"utf8")}}exports.title="i18n:tasks.postprocess.save_config",exports.handle=handle;