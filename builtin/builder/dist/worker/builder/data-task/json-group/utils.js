"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasGroups=exports.walk=exports.splitGroups=void 0;const _=require("lodash");function splitGroups(e,t=!1){if(e.length<2)return e;const n=[e[0]];e:for(let t=1;t<e.length;t++){let r=e[t];const s=n.length;for(let e=0;e<s;e++){let t=n[e];const s=_.intersection(t,r),o=t.length,i=r.length,u=s.length;if(0!==u)if(u===o){if(o===i)continue e;r=_.difference(r,s)}else{if(u===i){o!==i&&(t=_.difference(t,s),n[e]=t,n.push(s));continue e}r=_.difference(r,s),t=_.difference(t,s),n[e]=t,n.push(s)}}n.push(r)}if(t){const t=_.flatten(n),r=_.uniq(t);if(r.length<t.length)return console.warn("Internal error: SizeMinimized.transformGroups: res not unique, transform canceled"),e;{const t=_.flatten(e);if(_.difference(t,r).length>0)return console.warn("Internal error: SizeMinimized.transformGroups: not have the same members, transform canceled"),e}}return n}async function walk(e,t,n){const r=[];return await async function e(s){if(n.getRedirect(s.uuid))return;if(r.includes(s.uuid))return;s.library[".json"]&&r.push(s.uuid);const o=(await t.getDependUuids(s.uuid)||[]).filter(e=>{const n=t.getAssetInfo(e);return!(!n||!n.type)&&"cc.Texture2D"!==n.type&&cc.js.getClassByName(n.type)});for(let n=0;n<o.length;n++){const r=o[n];await e(t.getAssetInfo(r))}}(e),!r||r.length<1?e.library[".json"]?[e.uuid]:[]:(!r.includes(e.uuid)&&e.library[".json"]&&r.push(e.uuid),[...new Set(r)])}function hasGroups(e,t){for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<r.length;t++)if(r[t]===e)return!0}return!1}exports.splitGroups=splitGroups,exports.walk=walk,exports.hasGroups=hasGroups;