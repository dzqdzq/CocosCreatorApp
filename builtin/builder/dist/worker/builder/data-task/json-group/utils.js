"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasGroups=exports.walk=exports.splitGroups=void 0;var _=require("lodash");function splitGroups(e,r=!1){if(e.length<2)return e;var t=[e[0]];e:for(var n=1;n<e.length;n++){for(var s=e[n],i=t.length,u=0;u<i;u++){var o=t[u],a=_.intersection(o,s),f=o.length,l=s.length,c=a.length;if(0!==c)if(c===f){if(f===l)continue e;s=_.difference(s,a)}else{if(c===l){f!==l&&(o=_.difference(o,a),t[u]=o,t.push(a));continue e}s=_.difference(s,a),o=_.difference(o,a),t[u]=o,t.push(a)}}t.push(s)}if(r){var p=_.flatten(t),d=_.uniq(p);if(d.length<p.length)return console.warn("Internal error: SizeMinimized.transformGroups: res not unique, transform canceled"),e;var h=_.flatten(e);if(_.difference(h,d).length>0)return console.warn("Internal error: SizeMinimized.transformGroups: not have the same members, transform canceled"),e}return t}async function walk(e,r,t){const n=[];return await async function e(s){if(t.getRedirect(s.uuid))return;if(n.includes(s.uuid))return;if(!s.library[".json"])return;n.push(s.uuid);const i=(await r.getDependUuids(s.uuid)||[]).filter(e=>{const t=r.getAssetInfo(e);return!(!t||!t.type)&&"cc.Texture2D"!==t.type&&cc.js.getClassByName(t.type)});for(let t=0;t<i.length;t++){const n=i[t];await e(r.getAssetInfo(n))}}(e),!n||n.length<1?[e.uuid]:(n.includes(e.uuid)||n.push(e.uuid),[...new Set(n)])}function hasGroups(e,r){for(let t=0;t<r.length;t++){const n=r[t];for(let r=0;r<n.length;r++)if(n[r]===e)return!0}return!1}exports.splitGroups=splitGroups,exports.walk=walk,exports.hasGroups=hasGroups;