"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,n)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&__createBinding(t,e,o);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.methods=exports.$=exports.style=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),custom_render_1=require("./custom-render");let panel=null;const Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1;const VmConfig=__importStar(require("./vm"));async function ready(e,t,o){console.debug("ready",e,t,o),panel=this;const r=await Editor.Message.request("builder","query-platform-config"),n={},a=[],s={},i={};r.order.forEach(e=>{const t=r.config[e];if(!(t&&t.name&&t.supportRun&&t.supportRun))return;if(n[e]={},i[e]={requireCompile:t.requireCompile,supportRun:t.supportRun},a.push({label:translateName(t.name),value:e}),!t.debugConfig)return;const o=(0,custom_render_1.getVueComponentFromConfig)(t.debugConfig,e);for(const e of o)s[e.name]=e;i[e].compNames=o.map(e=>e.name)});const u=await Editor.Message.request("builder","query-tasks");Object.values(u).forEach(e=>{if(!e.options)return;const{platform:t,buildPath:o,outputName:r}=e.options;if(!n[t]||!o||!r)return;const a=(0,path_1.join)(Editor.UI.__protected__.File.resolveToRaw(o),r);n[t][a]={name:r,path:a}}),panel.vm=new Vue(Object.assign({el:panel.$.container,components:s,data:()=>({platforms:a,currentPlatform:e||"vivo-mini-game",currentProjectPath:t||"",projectList:n,platformConfigMap:i,processState:{},selectProject:"",consoleInfo:{}})},VmConfig)),o&&panel.vm.executeCompMethod(o)}async function beforeClose(){}async function close(){}function translateName(e){return e?(e=e.replace("i18n:",""),Editor.I18n.t(e)||e):""}function getCurrentTime(){const e=new Date;return e.toLocaleDateString()+" "+e.toTimeString().slice(0,5)}exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../static/template/platform-debug-tools.html")),exports.style=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../dist/platform-debug-tools.css")),exports.$={container:".platform-debug-tools"},exports.methods={initState(e,t,o){e&&(panel.vm.platform=e),t&&(panel.vm.packagePath=t),o&&panel.vm.executeCompMethod(o)},updateCompileProcess(e,t){panel.vm.$set(panel.vm.processState,e,t)},updateConsole(e,t,o){if(!e||!o||!t)return;const r=panel.vm.consoleInfo[e];Array.isArray(r)?r.push({type:t,message:o}):panel.vm.$set(panel.vm.consoleInfo,e,[{type:t,message:o}])}},exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;