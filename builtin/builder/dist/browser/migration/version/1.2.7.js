"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.migrateProject=exports.migrateLocal=void 0;const path_1=require("path"),sharp_1=__importDefault(require("sharp")),utils_1=require("../../../share/utils");function getNewBuildPath(t){let e=utils_1.getBuildDist(t);return Editor.Utils.Path.contains(Editor.Project.path,e)&&(e="project://"+path_1.relative(Editor.Project.path,e)),e}function migrateLocal(t){t.common&&t.common.buildPath&&(t.common.buildPath=getNewBuildPath(t.common.buildPath)),t.BuildTaskManager&&t.BuildTaskManager.taskMap&&Object.values(t.BuildTaskManager.taskMap).forEach(t=>{t.options&&t.options.buildPath&&(t.options.buildPath=getNewBuildPath(t.options.buildPath))})}async function migrateProject(t){const e=t["splash-setting"];if(!e||!e.base64src)return;const a=Buffer.from(e.base64src.split(",")[1],"base64");delete e.base64src,e.url="project://settings/splash-settings.png",await sharp_1.default(a).toFile(path_1.join(Editor.Project.path,"settings","splash-settings.png"))}exports.migrateLocal=migrateLocal,exports.migrateProject=migrateProject;