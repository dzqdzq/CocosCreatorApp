"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,r,t,o){void 0===o&&(o=t),Object.defineProperty(e,o,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,o){void 0===o&&(o=t),e[o]=r[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParamsFromCommand=exports.checkHasError=exports.changeToLocalTime=exports.getCurrentTime=exports.checkCompressOptions=exports.getBuildDist=exports.getPreviewUrl=void 0;const path_1=require("path"),textureCompressConfig=__importStar(require("../share/texture-compress"));async function getPreviewUrl(){const e=await Editor.Message.request("server","query-port");return`http://${await Editor.Message.request("preview","get-preview-ip")}:${e}/build`}function getBuildDist(e){return path_1.isAbsolute(e)?e:path_1.join(Editor.Project.path,e)}function checkCompressOptions(e){if(!e||"object"!=typeof e||Array.isArray(e))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.require_object")),!1;const r=Object.keys(textureCompressConfig.configGroups);for(const t of Object.keys(e)){const o=e[t];if(!o||"object"!=typeof o)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.xx_require_object",{name:`${t}(${o})`})),!1;if(!o.name)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.require_name")),!1;if(!o.options||"object"!=typeof o.options||Array.isArray(o))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.xx_require_object",{name:"options"})),!1;for(const e of Object.keys(o.options)){if(!r.includes(e))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.platform_err",{name:"options",supportPlatforms:r.toString()})),!1;const t=o.options[e];for(const e of Object.keys(t));}}return!0}function getCurrentTime(){return changeToLocalTime(Date.now())}function changeToLocalTime(e){const r=new Date(Number(e));return r.toLocaleDateString().replace(/\//g,"-")+" "+r.toTimeString().slice(0,5)}function checkHasError(e){if(!e)return!1;if("object"!=typeof e||Array.isArray(e)){if("string"==typeof e)return!0}else for(const r of Object.keys(e)){if(checkHasError(e[r]))return!0}return!1}function getParamsFromCommand(e){if(!e)return[];const r=e.match(/\$\{([^${}]*)}/g);return r?r.map(e=>e.replace("${","").replace("}","")):[]}exports.getPreviewUrl=getPreviewUrl,exports.getBuildDist=getBuildDist,exports.checkCompressOptions=checkCompressOptions,exports.getCurrentTime=getCurrentTime,exports.changeToLocalTime=changeToLocalTime,exports.checkHasError=checkHasError,exports.getParamsFromCommand=getParamsFromCommand;