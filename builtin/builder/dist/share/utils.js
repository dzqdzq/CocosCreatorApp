"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkHasError=exports.changeToLocalTime=exports.getCurrentTime=exports.pathToUrl=exports.urlToPath=exports.checkCompressOptions=exports.getBuildDist=exports.getPreviewUrl=void 0;const path_1=require("path"),textureCompressConfig=__importStar(require("../share/texture-compress"));async function getPreviewUrl(){const e=await Editor.Message.request("server","query-port");return`http://${await Editor.Message.request("preview","get-preview-ip")}:${e}/build`}function getBuildDist(e){return path_1.isAbsolute(e)?e:path_1.join(Editor.Project.path,e)}function checkCompressOptions(e){if(!e||"object"!=typeof e||Array.isArray(e))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.require_object")),!1;const t=Object.keys(textureCompressConfig.configGroups);for(const r of Object.keys(e)){const o=e[r];if(!o||"object"!=typeof o)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.xx_require_object",{name:`${r}(${o})`})),!1;if(!o.name)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.require_name")),!1;if(!o.options||"object"!=typeof o.options||Array.isArray(o))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.xx_require_object",{name:"options"})),!1;for(const e of Object.keys(o.options)){if(!t.includes(e))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.platform_err",{name:"options",supportPlatforms:t.toString()})),!1;const r=o.options[e];for(const e of Object.keys(r)){const t=textureCompressConfig.formatsInfo[e];if(!t)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.texture_type_err",{format:e,supportFormats:Object.keys(textureCompressConfig.formatsInfo).toString()})),!1;const o=textureCompressConfig.qualityOptions[t.qualityType],i=r[e];if("number"!==t.qualityType){if(!Object.keys(o.options).includes(i))return console.error(Editor.I18n.t("builder.project.texture_compress.tips.options_quality_type_err",{userQualityType:i,qualityType:t.qualityType,qualityTypeOptions:Object.keys(o.options).toString()})),!1}else if("number"!=typeof i||i<o.min||i>o.max)return console.error(Editor.I18n.t("builder.project.texture_compress.tips.options_quality_type_err",{userQualityType:i,min:o.min,max:o.max})),!1}}}return!0}exports.getPreviewUrl=getPreviewUrl,exports.getBuildDist=getBuildDist,exports.checkCompressOptions=checkCompressOptions;const pathMap={"project:":Editor.Project.path,"editor:":Editor.App.path};function urlToPath(e){const t=new URL(e);if(pathMap[t.protocol])return path_1.join(pathMap[t.protocol],t.pathname)}function pathToUrl(e,t){const r="editor"===t?Editor.App.path:Editor.Project.path;return Editor.Utils.Path.contains(r,e)?`${t}:${path_1.relative(r,e)}`:e}function getCurrentTime(){return changeToLocalTime(Date.now())}function changeToLocalTime(e){const t=new Date(Number(e));return t.toLocaleDateString().replace(/\//g,"-")+" "+t.toTimeString().slice(0,5)}function checkHasError(e){if(!e)return!1;if("object"!=typeof e||Array.isArray(e)){if("string"==typeof e)return!0}else for(const t of Object.keys(e)){if(checkHasError(e[t]))return!0}return!1}exports.urlToPath=urlToPath,exports.pathToUrl=pathToUrl,exports.getCurrentTime=getCurrentTime,exports.changeToLocalTime=changeToLocalTime,exports.checkHasError=checkHasError;