"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validatorManager=exports.validator=void 0;const fs_extra_1=require("fs-extra");class Validator{pathExist(e){return!!this.string(e)&&(e=Editor.UI.File.resolveToRaw(e),fs_extra_1.existsSync(e))}valid(e){return null!==e&&void 0!==e}required(e){return null!==e&&void 0!==e&&""!==e}normalName(e){return/^[a-zA-Z0-9_-]*$/.test(e)}noChinese(e){return!/.*[\u4e00-\u9fa5]+.*$/.test(e)}array(e){return Array.isArray(e)}string(e){return"string"==typeof e}number(e){return"number"==typeof e}http(e){return!!this.string(e)&&e.startsWith("http")}has(e){return!!this[e]}check(e,t,...s){return!!this[e]&&(!!this[e]&&this[e](t,...s))}add(e,t){this[e]=t}}class RuleMessage{constructor(){this.pathExist="i18n:builder.warn.path_not_exist",this.http="i18n:builder.warn.http",this.required="i18n:builder.warn.required",this.noChinese="i18n:builder.warn.no_chinese"}addRuleMessage(e,t){this[e]=t}getRuleMessage(e){const t=this[e];return(t.startsWith("i18n:")?Editor.I18n.t(t.replace("i18n:","")):t)||""}}class ValidatorManager{constructor(){this.validators={},this.ruleMessages={},this.defaultValidator=new Validator,this.defaultRuleMessage=new RuleMessage}addRule(e,t,s){let r=this.defaultValidator;s&&(this.validators[s]=this.validators[s]||new Validator,r=this.validators[s]),r.add(e,t)}addMessage(e,t,s){let r=this.defaultRuleMessage;s&&(this.ruleMessages[s]=this.ruleMessages[s]||new RuleMessage,r=this.ruleMessages[s]),r.addRuleMessage(e,t)}check(e,t,s,r=""){if(!Array.isArray(s))return"";const a=this.validators[r]||this.defaultValidator,i=this.ruleMessages[r]||this.defaultRuleMessage;try{if(["",void 0,null].includes(e)&&!s.includes("required"))return"";for(const r of s){if(!a.has(r))return`Rule ${r} is not exist.`;if(!a.check(r,e,t))return i.getRuleMessage(r)||`Value ${e} is invalid.`}}catch(e){return e.message}return""}}exports.validator=new Validator,exports.validatorManager=new ValidatorManager;