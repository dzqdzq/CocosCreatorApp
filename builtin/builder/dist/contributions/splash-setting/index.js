"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.methods=exports.$=exports.template=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),axios_1=__importDefault(require("axios"));let vm,panel=null;const Vue=require("vue/dist/vue.js");async function ready(){vm=new Vue({el:(panel=this).$.splash,data:{settings:{url:Editor.App.icon,displayRatio:.4,totalTime:3e3,clearColor:{x:.88,y:.88,z:.88,w:1},displayWatermark:!0},imageSrc:"",clearColor:null,imgDragState:"",loadingImage:!1,hasSetSplash:!0,questionSrc:`http://creator-web.cocos.org/question3d?projectId=${Editor.Project.uuid}`,netStatus:"loading",tipsInfo:"Loading"},async mounted(){this.netStatus="success",await this.initData()},methods:{async onConfirm(t){let e=t.target.getAttribute("name");if(!e)return;let s=t.target.value;const i=this;switch(e){case"clearColor":s={x:s[0]/255,y:s[1]/255,z:s[2]/255,w:s[3]/255};break;case"image":if(e="url",(0,fs_1.existsSync)(s)){i.imageSrc=s;break}const t=await Editor.Message.request("asset-db","query-asset-info",s);if(!t)return void console.error(`Can't get asset info(${s}) from uuid`);i.imageSrc=t.file,s=Editor.UI.File.resolveToUrl(i.imageSrc,t.path.startsWith("db://internal")?"app":"project");break;case"image-url":e="url",i.imageSrc=Editor.UI.File.resolveToRaw(s)}i.settings[e]=s,i.saveSettings(e,s)},async saveSettings(t,e){await Editor.Profile.setProject("builder",`splash-setting.${t}`,e)},async getQuestionnaire(){const t=this;let e;try{e=await axios_1.default.get(`http://creator-web.cocos.org/api/question3D/getQuestionnaire?projectId=${Editor.Project.uuid}`)}catch(e){return console.error(e),t.tipsInfo=e.toString(),void(t.netStatus="failed")}200===e.status?("SUCCESS"===e.data.code&&(t.hasSetSplash=!0,Editor.Profile.setProject("builder","hasSetSplash",!0)),t.netStatus="success"):t.tipsInfo=e.toString()},async initData(){const t=this,e=await Editor.Profile.getProject("builder","splash-setting");t.settings=Object.assign(t.settings,e),t.imageSrc=Editor.UI.File.resolveToRaw(t.settings.url);const s=["x","y","z","w"].map(e=>255*t.settings.clearColor[e]);t.clearColor=JSON.stringify(s)}}})}Vue.config.productionTip=!1,Vue.config.devtools=!1,exports.style=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../dist/splash-setting.css"),"utf8"),exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../static/contributions/splash-setting.html"),"utf8"),exports.$={splash:".splash",webview:".webview"},exports.methods={},exports.ready=ready;