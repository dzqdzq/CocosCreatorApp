"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&__createBinding(t,e,s);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.components=exports.mounted=exports.methods=exports.computed=exports.data=exports.props=exports.template=void 0;const ConfigGroup=__importStar(require("../../compress-texture/config-group"));function data(){return{textureCompressConfig:null}}async function mounted(){await this.refreshCompressConfig()}exports.template='<div>\n    <ui-prop\n        v-if="meta && meta.userData"\n    >\n        <ui-label slot="label" tooltip="useCompressTexture">useCompressTexture</ui-label>\n        <ui-checkbox slot="content"\n            :value="meta.userData.compressSettings && meta.userData.compressSettings.useCompressTexture"\n            :disabled="readonly"\n            @confirm="_onCompressSettingsChanged($event, \'useCompressTexture\')"\n        ></ui-checkbox>\n    </ui-prop>\n    <ui-prop\n        v-if="textureCompressConfig && meta.userData && meta.userData.compressSettings && meta.userData.compressSettings.useCompressTexture "\n        :readonly="readonly"\n    >\n        <ui-label slot="label" tooltip="presetId">presetId</ui-label>\n        <div slot="content">\n            <ui-select\n                :disabled="readonly"\n                :value="meta.userData.compressSettings && meta.userData.compressSettings.presetId || \'default\'"\n                @confirm="_onCompressSettingsChanged($event, \'presetId\')"\n                @click="onSelectClick"\n            >\n                <option\n                    v-for="(config, id) in textureCompressConfig.userPreset"\n                    v-if="config"\n                    :value="id"\n                    :key="id"\n                >{{config.name}}</option>\n                <option\n                    v-for="(config, id) in textureCompressConfig.defaultConfig"\n                    v-if="config"\n                    :value="id"\n                    :key="id"\n                >{{config.name + \' (builtin)\'}}</option>\n            </ui-select>\n            <ui-button value="edit"\n                @confirm.stop="jumpToProjectSettings"\n                tooltip="i18n:builder.project.texture_compress.tips.jump_to_edit_config"\n            ><ui-label value="i18n:builder.assets.image.edit_preset"></ui-label></ui-button>\n        </div>\n    </ui-prop>\n\n    <config-group\n        class="platform-setting"\n        v-if="userTextureCompress"\n        :compress-info="textureCompressConfig"\n        :config="userTextureCompress.config.options"\n        :disabled="true"\n    >\n    </config-group>\n</div>',exports.props=["meta","metas","readonly"],exports.data=data,exports.computed={userTextureCompress(){const e=this.meta||this.metas[0];if(!(this.textureCompressConfig&&this.textureCompressConfig.userPreset&&e.userData.compressSettings&&e.userData.compressSettings.useCompressTexture))return null;const t=e.userData.compressSettings.presetId||"default",s=this.textureCompressConfig.userPreset[t]||this.textureCompressConfig.defaultConfig[t];return s?{name:t,config:s}:null}},exports.methods={jumpToProjectSettings(){Editor.Message.send("project","open-settings","builder","compress")},onSelectClick(e){const t=this;if(2===t.clickNum)return;t.clickNum=2,t.refreshCompressConfig();const s=e.target;setTimeout(()=>{s.click(),t.clickNum=1},30)},_onCompressSettingsChanged(e,t){const s=this;s.metas.forEach(o=>{const r=o.userData.compressSettings&&JSON.parse(JSON.stringify(o.userData.compressSettings))||{};r[t]=e.target.value,s.$set(o.userData,"compressSettings",r)}),s.$emit("change")},async refreshCompressConfig(){const e=this,{userPreset:t,defaultConfig:s}=await Editor.Profile.getProject("builder","textureCompressConfig");if(e.textureCompressConfig)e.$set(e.textureCompressConfig,"userPreset",t),e.$set(e.textureCompressConfig,"defaultConfig",s);else{const o=await Editor.Message.request("builder","query-compress-config");Object.assign(o,{userPreset:t,defaultConfig:s}),e.$set(e,"textureCompressConfig",o)}}},exports.mounted=mounted,exports.components={"config-group":ConfigGroup};