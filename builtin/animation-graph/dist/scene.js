"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.methods=exports.state=exports.beforeClose=exports.unload=exports.load=void 0;const scene_animation_graph_1=__importDefault(require("./scene-animation-graph")),SceneMotionPreview=cce.Preview.motionPreview,SceneTransitionPreview=cce.Preview.transitionPreview;function load(){}function unload(){}async function beforeClose(){if(exports.state.closing)return!0;if(exports.state.closing=!0,scene_animation_graph_1.default.dirtyData.isDirty()){const e=await scene_animation_graph_1.default.dialog();if(0===e)await scene_animation_graph_1.default.apply();else if(1===e)scene_animation_graph_1.default.reset();else if(2===e)return exports.state.closing=!1,!1}return scene_animation_graph_1.default.unselect(),exports.state.closing=!1,!0}exports.load=load,exports.unload=unload,exports.beforeClose=beforeClose,exports.state={closing:!1},exports.methods={beforeClose:async()=>await beforeClose(),edit:async e=>!exports.state.closing&&(exports.state.closing=!0,await scene_animation_graph_1.default.edit(e),SceneTransitionPreview.reset(),SceneMotionPreview.reset(),exports.state.closing=!1,!0),query:()=>scene_animation_graph_1.default.query(),apply(){scene_animation_graph_1.default.apply()},reset(){scene_animation_graph_1.default.reset()},viewport(e){scene_animation_graph_1.default.viewport(e)},bestViewport(e){scene_animation_graph_1.default.bestViewport(e)},async changeView(e,n,a){scene_animation_graph_1.default.changeView(e,n,a),Array.isArray(a)&&await this.showMotionPreview()},crumbView(e){scene_animation_graph_1.default.crumbView(e)},addLayer(e){scene_animation_graph_1.default.addLayer(e)},removeLayer(e){scene_animation_graph_1.default.removeLayer(e)},crumbLayer(e){scene_animation_graph_1.default.crumbLayer(e)},renameLayer(e,n){scene_animation_graph_1.default.renameLayer(e,n)},changeLayer(e,n,a){scene_animation_graph_1.default.changeLayer(e,n,a)},crumbStateMachine(e){scene_animation_graph_1.default.crumbStateMachine(e)},addState(e){scene_animation_graph_1.default.addState(e)},removeState(e){scene_animation_graph_1.default.removeState(e)},crumbState(e){scene_animation_graph_1.default.crumbState(e)},moveState(e,n){scene_animation_graph_1.default.moveState(e,n)},renameState(e,n){scene_animation_graph_1.default.renameState(e,n)},changeState(e,n,a){scene_animation_graph_1.default.changeState(e,n,a)},addMotionToState(e,n){scene_animation_graph_1.default.addMotionToState(e,n)},removeMotion(e){scene_animation_graph_1.default.removeMotion(e)},crumbMotion(e){scene_animation_graph_1.default.crumbMotion(e)},crumbMotionInMotion(e){scene_animation_graph_1.default.crumbMotionInMotion(e)},changeClipMotion(e,n){scene_animation_graph_1.default.changeClipMotion(e,n)},moveMotion(e,n){scene_animation_graph_1.default.moveMotion(e,n)},addMotionToMotion(e,n){scene_animation_graph_1.default.addMotionToMotion(e,n)},renameMotionInMotion(e,n){scene_animation_graph_1.default.renameMotionInMotion(e,n)},removeMotionInMotion(e){scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.hide(),scene_animation_graph_1.default.removeMotionInMotion(e)},changeMotionAutoThreshold(e,n){scene_animation_graph_1.default.changeMotionAutoThreshold(e,n),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeMotionThreshold1D(e,n,a){scene_animation_graph_1.default.changeMotionThreshold1D(e,n,a),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeMotionThreshold2D(e,n,a,i){scene_animation_graph_1.default.changeMotionThreshold2D(e,n,a,i),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeClipMotionInMotion(e,n){scene_animation_graph_1.default.changeClipMotionInMotion(e,n),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeAnimationBlend1DInMotion(e,n,a){scene_animation_graph_1.default.changeAnimationBlend1DInMotion(e,n,a),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeAnimationBlend2DInMotion(e,n,a,i){scene_animation_graph_1.default.changeAnimationBlend2DInMotion(e,n,a,i),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},hideMotionPreview(){SceneMotionPreview.hide()},async showMotionPreview(){if(!SceneMotionPreview.hasModel()){const e=await scene_animation_graph_1.default.queryPreviewModel();e&&await SceneMotionPreview.setModel(e)}return SceneMotionPreview.show(scene_animation_graph_1.default.getCurrentMotion(),scene_animation_graph_1.default.animationGraph)},playMotionPreview(){SceneMotionPreview.play()},pauseMotionPreview(){SceneMotionPreview.pause()},stopMotionPreview(){SceneMotionPreview.stop()},setTimeMotionPreview(e){SceneMotionPreview.setTime(e)},addComponent(e,n){scene_animation_graph_1.default.addComponent(e,n)},removeComponent(e,n){scene_animation_graph_1.default.removeComponent(e,n)},changeComponent(e,n,a){scene_animation_graph_1.default.changeComponent(e,n,a)},addTransition(e,n){const a=scene_animation_graph_1.default.addTransition(e,n);a&&SceneTransitionPreview.show(a,scene_animation_graph_1.default.animationGraph)},viewTransition(e){scene_animation_graph_1.default.viewTransition(e);const n=scene_animation_graph_1.default.getTransition(e);SceneTransitionPreview.transition&&n===SceneTransitionPreview.transition||SceneTransitionPreview.show(n,scene_animation_graph_1.default.animationGraph)},removeTransition(e,n){scene_animation_graph_1.default.getTransition(e)===SceneTransitionPreview.transition&&SceneTransitionPreview.hide(),scene_animation_graph_1.default.removeTransition(e,n)},changeTransitionProp(e,n,a){scene_animation_graph_1.default.changeTransitionProp(e,n,a),scene_animation_graph_1.default.getTransition(e)===SceneTransitionPreview.transition&&SceneTransitionPreview.setProp()},adjustTransitionPriority(e,n){scene_animation_graph_1.default.adjustTransitionPriority(e,n)},hideTransitionPreview(){SceneTransitionPreview.hide()},async showTransitionPreview(e){if(!SceneTransitionPreview.hasModel()){const e=await scene_animation_graph_1.default.queryPreviewModel();e&&await SceneTransitionPreview.setModel(e)}const n=scene_animation_graph_1.default.getTransition(e);return SceneTransitionPreview.show(n,scene_animation_graph_1.default.animationGraph)},playTransitionPreview(){SceneTransitionPreview.play()},pauseTransitionPreview(){SceneTransitionPreview.pause()},stopTransitionPreview(){SceneTransitionPreview.stop()},setTimeTransitionPreview(e){SceneTransitionPreview.setTime(e)},addCondition(e,n){scene_animation_graph_1.default.addCondition(e,n)},changeCondition(e,n,a){scene_animation_graph_1.default.changeCondition(e,n,a)},removeCondition(e,n){scene_animation_graph_1.default.removeCondition(e,n)},addVariable:(e,n)=>scene_animation_graph_1.default.addVariable(e,n),renameVariable(e,n){scene_animation_graph_1.default.renameVariable(e,n)},changeVariable(e,n,a){scene_animation_graph_1.default.changeVariable(e,n,a)},removeVariable(e){scene_animation_graph_1.default.removeVariable(e)},async setPreviewModel(e){await scene_animation_graph_1.default.setPreviewModel(e),await SceneTransitionPreview.setModel(e),await SceneMotionPreview.setModel(e)},updatePreviewVariable(e){SceneTransitionPreview.active&&SceneTransitionPreview.updateVariable(e),SceneMotionPreview.active&&SceneMotionPreview.updateVariable(e)}};