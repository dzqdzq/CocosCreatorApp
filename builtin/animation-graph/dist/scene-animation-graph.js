"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(e,i);a&&("get"in a?e.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,a)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),__decorate=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(o<3?a(s):o>3?a(e,i,s):a(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(e,t,i);return __setModuleDefault(e,t),e},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),scene_state_component_1=__importDefault(require("./scene-state-component")),animationApi=__importStar(require("cc/editor/new-gen-anim")),env_type_1=require("./env-type"),make_life_easier_utils_1=require("./make-life-easier-utils"),binaryConditionOperatorI18n={EQUAL_TO:"=",NOT_EQUAL_TO:"≠",LESS_THAN:"<",LESS_THAN_OR_EQUAL_TO:"≤",GREATER_THAN:">",GREATER_THAN_OR_EQUAL_TO:"≥"},unaryConditionOperatorI18n={TRUTHY:"true",FALSY:"false"},Utils={editorDataCloneMethod(t){let e;return t instanceof animationApi.MotionState&&t.motion instanceof animationApi.ClipMotion&&(e=""),Object.assign(Object.assign({},this),{name:e,id:Utils.produceEditorDataId(),clone:Utils.editorDataCloneMethod})},produceEditorDataId:()=>Date.now()+Math.random().toString(),checkEditorData:t=>(t&&(t.id||(t.id=Utils.produceEditorDataId()),t.clone||(t.clone=Utils.editorDataCloneMethod)),t),getStateType(t,e){switch(t){case e.entryState:return env_type_1.EnvType.entryState;case e.anyState:return env_type_1.EnvType.anyState;case e.exitState:return env_type_1.EnvType.exitState;default:if(t instanceof animationApi.MotionState)return env_type_1.EnvType.MotionState;if(t instanceof animationApi.EmptyState)return env_type_1.EnvType.EmptyState;if(t instanceof animationApi.SubStateMachine)return env_type_1.EnvType.SubStateMachine}return""},getMotionType(t){let e="";return t instanceof animationApi.ClipMotion?e=env_type_1.EnvType.ClipMotion:t instanceof animationApi.AnimationBlend1D?e=env_type_1.EnvType.AnimationBlend1D:t instanceof animationApi.AnimationBlend2D&&(e=env_type_1.EnvType.AnimationBlend2D),e},getMotionValue(t){let e=null;return t instanceof animationApi.ClipMotion&&(e={uuid:t.clip?t.clip._uuid:""}),t instanceof animationApi.AnimationBlend1D&&(e={variable:t.param.variable,value:t.param.value}),t instanceof animationApi.AnimationBlend2D&&(e=[{variable:t.paramX.variable,value:t.paramX.value},{variable:t.paramY.variable,value:t.paramY.value}]),e},getMotionName(t,e){let i="";if(e){const t=e[cc_1.editorExtrasTag];if(t&&t.name)return t.name}return t instanceof animationApi.ClipMotion?i=t.clip?t.clip.name:env_type_1.EnvType.clipMotionName:t instanceof animationApi.AnimationBlend1D?i=t.name||env_type_1.EnvType.animationBlend1DName:t instanceof animationApi.AnimationBlend2D&&(i=t.name||env_type_1.EnvType.animationBlend2DName),i},getInitialEditorData:(t={})=>Object.assign(Utils.checkEditorData({name:""}),t),getDefaultCrumbData:()=>({type:"",value:0,name:""}),getDefaultMotionLevel:()=>[0],getLastCrumb(t,e){let i=t[t.length-1];return(e||i.type===env_type_1.EnvType.layer||i.type===env_type_1.EnvType.SubStateMachine||"motionBlend"===i.type)&&(i=Utils.getDefaultCrumbData(),t.push(i)),i},getTransitionType(t){let e="";return e=t?animationApi.isAnimationTransition(t)?env_type_1.EnvType.AnimationTransition:t instanceof animationApi.EmptyStateTransition?env_type_1.EnvType.EmptyStateTransition:env_type_1.EnvType.Transition:""},getTransitionName(t){let e="";return e=t?`${t.from.name} , ${t.to.name}`:""},hasSubStateMachineCrumb(t){for(const e of t)if(e.type===env_type_1.EnvType.SubStateMachine)return!0;return!1},getValidName(t,e){const i=Array.from(e.states()).filter(t=>t!==e.anyState&&t!==e.entryState&&t!==e.exitState).map(t=>t&&t.name||"");for(;i.includes(t);)isFinite(Number(t))&&(t+="-"),/(\d+)$/.test(t)?t=t.replace(/(\d+)$/,(t,e)=>{let i=parseInt(e,10);return(i+=1).toString().padStart(e.length,"0")}):(t.endsWith("-")||(t+="-"),t+="001");return t}},DefaultValue={minThreshold:0,maxThreshold:1};class SceneAnimationGraph{constructor(){this.assetUuid="",this.animationGraph=null,this.crumbs=[],this.layerIndex=-1,this.layer=null,this.stateMachine=null,this.stateIndex=-1,this.state=null,this.motion=null,this.motionLevel=[],this.transitionIndex=-1,this.transition=null,this.dirtyData={origin:"",realtime:"",isDirty(){return this.origin!==this.realtime}},this.queryDataTemplate={assetInfo:null,isDirty:!1,canPasteState:!1,canPasteStateWithTransition:!1,envType:env_type_1.EnvType,view:{stateMachine:{states:[],transitions:[]},crumbs:[],layerIndex:-1,stateIndex:-1,transitionIndex:-1,motion:void 0,motionLevel:[]},layers:[],variables:{},variableType:animationApi.VariableType,previewState:cce.Preview.motionPreview.PreviewState,conditionVariableType:[env_type_1.EnvType.conditionVariable,env_type_1.EnvType.conditionConstant],unaryConditionOperator:animationApi.UnaryCondition.Operator,binaryConditionOperator:animationApi.BinaryCondition.Operator,binaryConditionOperatorI18n:binaryConditionOperatorI18n,unaryConditionOperatorI18n:unaryConditionOperatorI18n,cannotAddMotionStateType:[env_type_1.EnvType.entryState,env_type_1.EnvType.anyState,env_type_1.EnvType.exitState,env_type_1.EnvType.EmptyState,env_type_1.EnvType.SubStateMachine],cannotAddComponentStateType:[env_type_1.EnvType.entryState,env_type_1.EnvType.anyState,env_type_1.EnvType.exitState,env_type_1.EnvType.EmptyState],cannotRemoveStateType:[env_type_1.EnvType.entryState,env_type_1.EnvType.anyState,env_type_1.EnvType.exitState],motionType:[env_type_1.EnvType.ClipMotion,env_type_1.EnvType.AnimationBlend1D,env_type_1.EnvType.AnimationBlend2D],animationBlendType:[env_type_1.EnvType.AnimationBlend1D,env_type_1.EnvType.AnimationBlend2D]},this.clipBoard={stateMachine:null,state:null},this.userDefinedPreviewModelUuid={},this.resetData()}get variables(){return this.animationGraph?Array.from(this.animationGraph.variables):[]}async init(t){if(t)try{if(await this.resetData(),this.assetUuid=t,this.queryData.assetInfo=await Editor.Message.request("asset-db","query-asset-info",t),!this.queryData.assetInfo)return;cc_1.assetManager.releaseAsset(cc_1.assetManager.assets.get(t)),await new Promise((e,i)=>{cc_1.assetManager.loadAny(t,(t,n)=>{t?i(t):(this.ensureEditorData(n),this.animationGraph=n,this.crumbLayer(0),e())})})}catch(t){console.error(t)}}ensureEditorData(t){for(const e of animationApi.visitAnimationGraphEditorExtras(t))e[cc_1.editorExtrasTag]?Utils.checkEditorData(e[cc_1.editorExtrasTag]):e[cc_1.editorExtrasTag]=Utils.getInitialEditorData()}async dialog(){return await Editor.Message.request("animation-graph","dialog-warn")}async edit(t){if(this.dirtyData.isDirty()){const t=await this.dialog();if(0===t)await this.apply();else if(2===t)return}await this.init(t)}async reset(){if(this.assetUuid){if(await Editor.Message.request("asset-db","query-asset-info",this.assetUuid))await this.init(this.assetUuid);else{let t=Editor.I18n.t("animation-graph.resetError");t=t.replace("${uuid}",this.assetUuid),console.error(t)}}else await this.resetData(),this.refresh()}async resetData(){this.assetUuid="",this.animationGraph=null,this.layer=null,this.stateMachine=null,this.state=null,this.motion=null,this.transition=null,this.clipBoard.stateMachine=null,this.clipBoard.state=null;const t=await Editor.Profile.getTemp("animation-graph","preview-model");t&&(this.userDefinedPreviewModelUuid=t),this.queryData=JSON.parse(JSON.stringify(this.queryDataTemplate)),this.dirtyData.origin=this.dirtyData.realtime="",this.resetViewData(),this.unselect()}viewport(t){if(this.motion){if(this.motion instanceof animationApi.AnimationBlend1D||this.motion instanceof animationApi.AnimationBlend2D){const e=this.motion[cc_1.editorExtrasTag];e?e.viewport?Object.assign(e.viewport,t):e.viewport=t:this.motion[cc_1.editorExtrasTag]={viewport:t}}}else if(this.stateMachine){const e=this.stateMachine[cc_1.editorExtrasTag];e?e.viewport?Object.assign(e.viewport,t):e.viewport=t:this.stateMachine[cc_1.editorExtrasTag]={viewport:t}}}bestViewport(t){if(this.viewport(t.graph),t.states)for(const e of t.states){const t=this.getState(e.index);t&&e.editorData&&(t[cc_1.editorExtrasTag]=Object.assign(t[cc_1.editorExtrasTag]||{},e.editorData))}if(t.motions)for(const e of t.motions){const t=this.getMotionByLevel(e.level);t&&e.editorData&&(t[cc_1.editorExtrasTag]=Object.assign(t[cc_1.editorExtrasTag]||{},e.editorData))}this.refresh()}query(){return this.queryLayers(),this.queryVariables(),this.queryView(),this.queryData}async apply(){if(!this.animationGraph)return;const t=cce.Utils.serialize(this.animationGraph);if(!this.queryData.assetInfo)return;const{uuid:e,url:i}=this.queryData.assetInfo,n=await Editor.Message.request("asset-db","query-asset-info",e);if(n)await cce.Ipc.send("save-asset",n.uuid,t);else{const e=await Editor.Message.request("asset-db","create-asset",i,t);e&&(this.assetUuid=e.uuid,this.queryData.assetInfo=e)}this.dirtyData.origin="",this.refresh()}refresh(){this.dirtyData.realtime=cce.Utils.serialize(this.animationGraph),this.dirtyData.origin||(this.dirtyData.origin=this.dirtyData.realtime),this.queryData.isDirty=this.dirtyData.isDirty(),this.queryData.canPasteState=!!this.clipBoard.state,this.queryData.canPasteStateWithTransition=this.clipBoard.stateMachine===this.stateMachine,Editor.Message.broadcast("animation-graph:changed")}unselect(){Editor.Selection.clear("animation-graph")}reselect(){Editor.Selection.clear("animation-graph"),Editor.Selection.select("animation-graph",this.assetUuid)}queryView(){this.queryData.view.crumbs=this.crumbs,this.queryData.view.layerIndex=this.layerIndex,this.queryData.view.stateIndex=this.stateIndex,this.queryData.view.motionLevel=this.motionLevel,this.queryData.view.transitionIndex=this.transitionIndex,this.queryData.view.stateMachine=void 0,this.queryData.view.motion=void 0,this.stateMachine&&(this.queryData.view.stateMachine=this.queryStateMachine(this.stateMachine)),this.motion&&(this.queryData.view.motion=this.queryMotion(Utils.getDefaultMotionLevel(),this.motion))}changeView(t,e,i){switch(t){case env_type_1.EnvType.layer:this.crumbLayer(e);break;case env_type_1.EnvType.entryState:case env_type_1.EnvType.anyState:case env_type_1.EnvType.exitState:case env_type_1.EnvType.MotionState:case env_type_1.EnvType.SubStateMachine:case env_type_1.EnvType.EmptyState:this.viewState(e);break;case env_type_1.EnvType.Transition:case env_type_1.EnvType.AnimationTransition:case env_type_1.EnvType.EmptyStateTransition:this.viewTransition(e);break;case env_type_1.EnvType.ClipMotion:case env_type_1.EnvType.AnimationBlend1D:case env_type_1.EnvType.AnimationBlend2D:this.viewMotion(i);break;default:this.crumbView()}}crumbView(t){let e,i;if(void 0!==t)this.crumbs.splice(t+1),e=this.crumbs.length-1,i=this.crumbs[e];else{e=this.crumbs.length-1,i=this.crumbs[e];const t=[env_type_1.EnvType.layer,env_type_1.EnvType.SubStateMachine,env_type_1.EnvType.MotionState];for(;i&&!t.includes(i.type);)e--,i=this.crumbs[e],this.crumbs.pop()}if(this.resetViewData(),this.layer){this.stateMachine=this.layer.stateMachine;for(let t=1;t<this.crumbs.length;t++){const e=this.crumbs[t];if(e.type===env_type_1.EnvType.SubStateMachine){const t=Array.from(this.stateMachine.states());this.stateIndex=e.value,this.state=t[this.stateIndex],this.state instanceof animationApi.SubStateMachine&&(this.stateMachine=this.state.stateMachine)}if(e.type===env_type_1.EnvType.state){const t=Array.from(this.stateMachine.states());this.stateIndex=e.value,this.state=t[this.stateIndex]}if(e.type===env_type_1.EnvType.transition){const t=Array.from(this.stateMachine.transitions());this.transitionIndex=e.value,this.transition=t[this.transitionIndex]}if(e.type===env_type_1.EnvType.MotionState)if(this.stateIndex=-1,this.transitionIndex=-1,this.motion){if(this.motion instanceof animationApi.AnimationBlend1D){const t=Array.from(this.motion.items);t.length&&(this.motion=t[e.value].motion)}if(this.motion instanceof animationApi.AnimationBlend2D){const t=Array.from(this.motion.items);t.length&&(this.motion=t[e.value].motion)}}else this.state instanceof animationApi.MotionState&&(this.motion=this.state.motion,this.motionLevel=Utils.getDefaultMotionLevel(),i.name=Utils.getMotionName(this.motion,this.state),this.motion&&(this.motion instanceof animationApi.AnimationBlend1D||this.motion instanceof animationApi.AnimationBlend2D)&&(this.motion.name=this.state.name))}}this.reselect(),this.refresh()}resetViewData(){this.stateIndex=-1,this.state=null,this.transitionIndex=-1,this.transition=null,this.motion=null,this.motionLevel.length=0}queryLayers(){this.animationGraph&&(this.queryData.layers=this.animationGraph.layers.map((t,e)=>{var i;return{index:e,name:t.name||env_type_1.EnvType.layer,props:{mask:{uuid:null===(i=t.mask)||void 0===i?void 0:i._uuid},weight:void 0===t.weight?1:t.weight}}}))}addLayer(t){if(!this.animationGraph)return;const e=this.animationGraph.addLayer();t&&(e.name=t),this.ensureEditorData(this.animationGraph),Metric("A100008"),this.crumbLayer(this.animationGraph.layers.length-1)}removeLayer(t){if(this.animationGraph&&!(t<0))if(this.animationGraph.removeLayer(t),t===this.layerIndex){const e=0===t?0:t-1;this.crumbLayer(e)}else this.refresh()}crumbLayer(t){var e,i;if(!this.animationGraph)return;this.resetViewData(),this.layerIndex=t,this.layer=this.animationGraph.layers[this.layerIndex],this.stateMachine=null!==(i=null===(e=this.layer)||void 0===e?void 0:e.stateMachine)&&void 0!==i?i:null;const n=Utils.getDefaultCrumbData();n.type=env_type_1.EnvType.layer,n.value=t,n.name=this.layer.name,this.crumbs=[n],this.reselect(),this.refresh()}renameLayer(t,e){if(!this.animationGraph)return;const i=this.animationGraph.layers[t];if(!i)return;i.name=e;const n=this.crumbs[0];n&&n.value===t&&(n.name=e),this.refresh()}async changeLayer(t,e,i){if(!this.animationGraph)return;const n=this.animationGraph.layers[t];if(n){if("mask"===e){const t=i;t?(cc_1.assetManager.releaseAsset(cc_1.assetManager.assets.get(t)),await new Promise((e,i)=>{cc_1.assetManager.loadAny(t,(t,a)=>{t?i(t):(n.mask=a,e())})})):n.mask=null}else"weight"===e&&(n.weight=i);this.reselect(),this.refresh()}}queryStateMachine(t,e=Utils.hasSubStateMachineCrumb(this.crumbs)){const i=Array.from(t.states()),n=Array.from(t.transitions());return{states:i.map((i,a)=>{const o=i.name,s=Utils.getStateType(i,t),r=Array.from(t.getOutgoings(i)).map(t=>n.findIndex(e=>e===t)),l=Array.from(t.getIncomings(i)).map(t=>n.findIndex(e=>e===t)),c=i[cc_1.editorExtrasTag];Utils.checkEditorData(c);const h=void 0===c.centerX,p={index:a,name:o,type:s,outGoings:r,inComings:l,editorData:c};switch(s){case env_type_1.EnvType.entryState:h&&(p.editorData.centerX=-125,p.editorData.centerY=0);break;case env_type_1.EnvType.exitState:h&&(p.editorData.centerX=125,p.editorData.centerY=0);break;case env_type_1.EnvType.anyState:h&&(p.editorData.centerX=e?0:125,p.editorData.centerY=e?75:0);break;default:if(h&&(p.editorData.centerX=0,p.editorData.centerY=0),i instanceof animationApi.MotionState?p.props={speed:i.speed,speedMultiplier:i.speedMultiplier,speedMultiplierEnabled:i.speedMultiplierEnabled,motion:{type:Utils.getMotionType(i.motion),name:Utils.getMotionName(i.motion,i),level:Utils.getDefaultMotionLevel(),value:Utils.getMotionValue(i.motion),min:[],max:[]}}:i instanceof animationApi.SubStateMachine&&(p.stateMachine=this.queryStateMachine(i.stateMachine,!0)),i instanceof animationApi.MotionState||i instanceof animationApi.SubStateMachine){const t=this.getComponents(i);p.components=t.map((t,e)=>({name:t.constructor.name,index:e,value:scene_state_component_1.default.encode(t)}))}}return p}),transitions:n.map((e,n)=>{const a=[];for(const t of e.conditions)t instanceof animationApi.BinaryCondition&&a.push({type:env_type_1.EnvType.BinaryCondition,operator:t.operator,lhs:{type:env_type_1.EnvType.conditionVariable,value:{variable:t.lhs.variable,constant:t.lhs.value}},rhs:{type:env_type_1.EnvType.conditionConstant,value:{variable:t.rhs.variable,constant:t.rhs.value}}}),t instanceof animationApi.UnaryCondition&&a.push({type:env_type_1.EnvType.UnaryCondition,operator:t.operator,lhs:{type:env_type_1.EnvType.conditionVariable,value:{variable:t.operand.variable}}}),t instanceof animationApi.TriggerCondition&&a.push({type:env_type_1.EnvType.TriggerCondition,lhs:{type:env_type_1.EnvType.conditionVariable,value:{variable:t.trigger}}});const o=i.findIndex(t=>t===e.from),s=i.findIndex(t=>t===e.to),r={type:Utils.getTransitionType(e),index:n,priority:Array.from(t.getOutgoings(e.from)).findIndex(t=>t===e),from:{index:o,name:e.from.name,type:Utils.getStateType(e.from,t)},to:{index:s,name:e.to.name,type:Utils.getStateType(e.to,t)},removable:!0,duration:-1,relativeDuration:!1,exitConditionEnabled:void 0,interruptible:void 0,exitCondition:0,destinationStart:void 0,relativeDestinationStart:!1,editorData:e[cc_1.editorExtrasTag]||{},conditions:a};return animationApi.isAnimationTransition(e)?(r.duration=e.duration,r.relativeDuration=e.relativeDuration,e.to instanceof animationApi.EmptyState||(r.interruptible=e.interruptible),r.exitConditionEnabled=e.exitConditionEnabled,r.exitCondition=e.exitCondition):e instanceof animationApi.EmptyStateTransition&&(r.duration=e.duration),(e instanceof animationApi.EmptyStateTransition||animationApi.isAnimationTransition(e))&&e.to instanceof animationApi.MotionState&&(r.destinationStart=e.destinationStart,r.relativeDestinationStart=e.relativeDestinationStart),r}).sort((t,e)=>t.priority-e.priority),editorData:t[cc_1.editorExtrasTag]}}crumbStateMachine(t){this.resetViewData(),this.state=this.getState(t),this.state&&this.state instanceof animationApi.SubStateMachine&&(this.stateMachine=this.state.stateMachine);const e=Utils.getLastCrumb(this.crumbs);e.type=env_type_1.EnvType.SubStateMachine,e.value=t,e.name=this.state.name,this.reselect(),this.refresh()}getStates(){return this.stateMachine?Array.from(this.stateMachine.states()):[]}getState(t){return this.getStates()[t]||null}async addState(t){if(!this.animationGraph||!this.stateMachine)return;t||(t={type:env_type_1.EnvType.MotionState,editorData:{centerX:0,centerY:0}});const e=this.getStates().length;let i;switch(t.type){case env_type_1.EnvType.SubStateMachine:(i=this.stateMachine.addSubStateMachine()).name=env_type_1.EnvType.subStateMachineName;break;case env_type_1.EnvType.EmptyState:(i=this.stateMachine.addEmpty()).name=env_type_1.EnvType.EmptyStateName;break;default:(i=await this.stateMachine.addMotion()).name=env_type_1.EnvType.stateName}if(i[cc_1.editorExtrasTag]=Utils.getInitialEditorData(t.editorData),t.type===env_type_1.EnvType.MotionState&&t.motion){switch(t.motion.type){case env_type_1.EnvType.AnimationBlend1D:case env_type_1.EnvType.AnimationBlend2D:t.motion.editorData={centerX:0,centerY:0}}this.addMotionToState(e,t.motion)}else this.ensureEditorData(this.animationGraph),this.viewState(e)}removeState(t){if(!this.stateMachine)return;const e=this.getState(t);e&&(this.stateMachine.remove(e),this.crumbView())}crumbState(t){if(!this.stateMachine)return;const e=this.getState(t);e instanceof animationApi.SubStateMachine?this.crumbStateMachine(t):e instanceof animationApi.MotionState&&(e.motion instanceof animationApi.AnimationBlend1D||e.motion instanceof animationApi.AnimationBlend2D)&&this.crumbMotion(t)}viewState(t){if(!this.stateMachine)return;this.stateIndex=t,this.state=this.getState(t);const e=Utils.getLastCrumb(this.crumbs);e.type=env_type_1.EnvType.state,e.value=t,e.name=this.state.name,this.transitionIndex=-1,this.transition=null,this.motion=null,this.motionLevel.length=0,this.reselect(),this.refresh()}moveState(t,e){const i=this.getState(t);i&&(e.editorData&&(i[cc_1.editorExtrasTag]=Object.assign(i[cc_1.editorExtrasTag]||{},e.editorData)),this.refresh())}renameState(t,e){const i=this.getState(t);i&&(i.name=e,i[cc_1.editorExtrasTag].name=e,Metric("A100012"),this.refresh())}changeState(t,e,i){const n=this.getState(t);if(n){if(n[e]instanceof animationApi.BindableNumber)n[e].value=i;else if(n instanceof animationApi.MotionState)switch(e){case"speed":n.speed=Number(i);break;case"speedMultiplier":n.speedMultiplier=i.toString();break;case"speedMultiplierEnabled":n.speedMultiplierEnabled=!!i}else n[e]=i;this.refresh()}}copyState(t){if(!this.stateMachine)return;const e=this.getState(t);e&&(e instanceof animationApi.MotionState||e instanceof animationApi.SubStateMachine||e instanceof animationApi.EmptyState)&&(this.clipBoard.stateMachine=this.stateMachine,this.clipBoard.state=e,this.refresh())}duplicateState(t){if(!this.stateMachine)return;const e=this.getState(t);if(!e)return;if(!(e instanceof animationApi.MotionState||e instanceof animationApi.SubStateMachine||e instanceof animationApi.EmptyState))return;const i=this.getStates().length,n=animationApi.cloneState(this.stateMachine,e,!0);n instanceof animationApi.MotionState&&n.motion instanceof animationApi.ClipMotion&&(n.name=Utils.getValidName(n.name,this.stateMachine));const a=n[cc_1.editorExtrasTag];a.centerX+=20,a.centerY+=20,this.viewState(i)}pasteState(t,e){if(!this.animationGraph||!this.stateMachine)return;const i=this.clipBoard.stateMachine,n=this.clipBoard.state;if(!(n instanceof animationApi.MotionState||n instanceof animationApi.SubStateMachine||n instanceof animationApi.EmptyState))return;let a;const o=this.getStates().length;let s=n.name;if(n instanceof animationApi.MotionState&&n.motion instanceof animationApi.ClipMotion&&(s=Utils.getValidName(n.name,this.stateMachine)),i===this.stateMachine){if(!e){const t=n[cc_1.editorExtrasTag];e={centerX:t.centerX+20,centerY:t.centerY+20}}a=animationApi.cloneState(i,n,t)}else i&&(e||(e={centerX:0,centerY:0}),a=animationApi.cloneState(i,n,this.stateMachine));a&&(a.name=s,Object.assign(a[cc_1.editorExtrasTag],e)),this.ensureEditorData(this.animationGraph),this.viewState(o)}turnMotionStateIntoSubStateMachine(t){if(!this.stateMachine)return;const e=this.getState(t);e&&e instanceof animationApi.MotionState&&(animationApi.turnMotionStateIntoSubStateMachine(this.stateMachine,e),this.refresh())}async addMotion(t){let e,i=null;switch(t.type){case env_type_1.EnvType.ClipMotion:if(i=new animationApi.ClipMotion,t.uuid){const e=t.uuid;cc_1.assetManager.releaseAsset(cc_1.assetManager.assets.get(t.uuid)),await new Promise((t,n)=>{cc_1.assetManager.loadAny(e,(e,a)=>{e?n(e):(i instanceof animationApi.ClipMotion&&(i.clip=a),t())})})}i[cc_1.editorExtrasTag]=Object.assign(Utils.getInitialEditorData(),t.editorData),Metric("A100002");break;case env_type_1.EnvType.AnimationBlend1D:i=new animationApi.AnimationBlend1D,(e=this.getFirstNumberVariable())&&(i.param.variable=e[0]),i[cc_1.editorExtrasTag]=Object.assign(Utils.getInitialEditorData({autoThreshold:!0}),t.editorData),Metric("A100003");break;case env_type_1.EnvType.AnimationBlend2D:i=new animationApi.AnimationBlend2D,(e=this.getFirstNumberVariable())&&(i.paramX.variable=e[0],i.paramY.variable=e[0]),i[cc_1.editorExtrasTag]=Object.assign(Utils.getInitialEditorData(),t.editorData),Metric("A100004")}return i}async addMotionToState(t,e){if(!this.animationGraph||!this.stateMachine)return;const i=this.getState(t);if(!(i&&i instanceof animationApi.MotionState))return;let n=env_type_1.EnvType.stateName;const a=await this.addMotion(e);switch(i.motion=a,e.type){case env_type_1.EnvType.ClipMotion:n=env_type_1.EnvType.clipMotionName,a&&(n=Utils.getMotionName(a,i)),n=Utils.getValidName(n,this.stateMachine);break;case env_type_1.EnvType.AnimationBlend1D:n=env_type_1.EnvType.animationBlend1DName;break;case env_type_1.EnvType.AnimationBlend2D:n=env_type_1.EnvType.animationBlend2DName}i.name=n,this.ensureEditorData(this.animationGraph),this.viewState(t)}async changeClipMotion(t,e){const i=this.getState(t);i&&(e?(cc_1.assetManager.releaseAsset(cc_1.assetManager.assets.get(e)),await new Promise((t,n)=>{cc_1.assetManager.loadAny(e,(e,a)=>{e?n(e):(i instanceof animationApi.MotionState&&i.motion instanceof animationApi.ClipMotion&&(i.motion.clip=a),t())})})):i instanceof animationApi.MotionState&&i.motion instanceof animationApi.ClipMotion&&(i.motion.clip=null),this.reselect(),this.refresh())}crumbMotion(t){if(!this.stateMachine)return;if(this.motion){if(this.motion instanceof animationApi.AnimationBlend1D){const e=Array.from(this.motion.items);e.length&&(this.motion=e[t].motion)}if(this.motion instanceof animationApi.AnimationBlend2D){const e=Array.from(this.motion.items);e.length&&(this.motion=e[t].motion)}}else{const e=this.getState(t);if(!(e&&e instanceof animationApi.MotionState))return;if(!e.motion||e.motion instanceof animationApi.ClipMotion)return;this.motion=e.motion,this.motion&&(this.motion instanceof animationApi.AnimationBlend1D||this.motion instanceof animationApi.AnimationBlend2D)&&(this.motion.name=e.name)}this.motionLevel=Utils.getDefaultMotionLevel();const e=Utils.getLastCrumb(this.crumbs,!0);e.type=env_type_1.EnvType.MotionState,e.name=Utils.getMotionName(this.motion,null),e.value=this.motionLevel,this.stateIndex=-1,this.state=null,this.transitionIndex=-1,this.transition=null,this.reselect(),this.refresh()}crumbMotionInMotion(t){if(!this.motion)return;let e=this.motion;for(let i=1;i<t.length;i++){const n=t[i];if(e instanceof animationApi.AnimationBlend1D){const t=Array.from(e.items);t[n]&&(e=t[n].motion)}else if(e instanceof animationApi.AnimationBlend2D){const t=Array.from(e.items);t[n]&&(e=t[n].motion)}if(!e)break;const a=Utils.getLastCrumb(this.crumbs,!0);a.type=env_type_1.EnvType.MotionState,a.name=Utils.getMotionName(e,null),a.value=n}this.motion!==e&&(this.motion=e,this.stateIndex=-1,this.state=null,this.transitionIndex=-1,this.transition=null,this.motionLevel.length=0,this.reselect(),this.refresh())}getMotionByLevel(t){let e=this.motion;for(let i=1;i<t.length;i++){const n=t[i];if(e instanceof animationApi.AnimationBlend1D){const t=Array.from(e.items);t[n]&&(e=t[n].motion)}else if(e instanceof animationApi.AnimationBlend2D){const t=Array.from(e.items);t[n]&&(e=t[n].motion)}}return e}getFirstNumberVariable(){if(!this.animationGraph)return null;let t=this.variables.find(t=>0===t[1]._type);return t||this.animationGraph.addFloat(this.uniqueVariableName("Blend"),0),t=this.variables.find(t=>0===t[1]._type)}removeMotion(t){const e=this.getState(t);e&&(e instanceof animationApi.MotionState&&(e.motion=null),this.reselect(),this.refresh())}getCurrentMotion(){return this.motionLevel.length?this.getMotionByLevel(this.motionLevel):this.state instanceof animationApi.MotionState?this.state.motion:null}viewMotion(t){const e=this.getMotionByLevel(t);if(!e)return;this.motionLevel=t;const i=Utils.getLastCrumb(this.crumbs);i.name=Utils.getMotionName(e,null),i.value=t,this.reselect(),this.refresh()}moveMotion(t,e){const i=this.getMotionByLevel(t);i&&e.editorData&&(i[cc_1.editorExtrasTag]=Object.assign(i[cc_1.editorExtrasTag]||{},e.editorData)),this.refresh()}queryMotion(t,e,i){const n={type:Utils.getMotionType(e),name:Utils.getMotionName(e,null),level:t,value:Utils.getMotionValue(e),threshold:i,min:[],max:[]};if(i instanceof cc_1.Vec2&&(n.threshold={x:i.x,y:i.y}),e instanceof animationApi.ClipMotion&&(n.editorData=e[cc_1.editorExtrasTag]),e instanceof animationApi.AnimationBlend1D){n.editorData=e[cc_1.editorExtrasTag];const i=Array.from(e.items);if(Array.isArray(i)){n.children=[];const e=[];for(let a=0;a<i.length;a++){const o=i[a];if(o&&o.motion){const i=t.slice();i.push(a),e.push(o.threshold);const s=this.queryMotion(i,o.motion,o.threshold);n.children.push(s)}}e.length&&(n.min[0]=Math.min(...e),n.max[0]=Math.max(...e))}}if(e instanceof animationApi.AnimationBlend2D){n.editorData=e[cc_1.editorExtrasTag];const i=Array.from(e.items);if(Array.isArray(i)){n.children=[];const e=[],a=[];for(let o=0;o<i.length;o++){const s=i[o];if(s&&s.motion){const i=t.slice();i.push(o),e.push(s.threshold.x),a.push(s.threshold.y);const r=this.queryMotion(i,s.motion,s.threshold);n.children.push(r)}}e.length&&(n.min=[Math.min(...e),Math.min(...a)],n.max=[Math.max(...e),Math.max(...a)])}}return n}async addMotionToMotion(t,e){if(!this.animationGraph)return;const i=this.getMotionByLevel(t);if(!i)return;const n=await this.addMotion(e);if(i instanceof animationApi.AnimationBlend1D){const e=new animationApi.AnimationBlend1D.Item;e.motion=n;const a=Array.from(i.items),o=a.length;if(0===o)e.threshold=DefaultValue.minThreshold;else if(1===o)e.threshold=DefaultValue.maxThreshold;else{const t=i[cc_1.editorExtrasTag],n=[];a.forEach(t=>{n.push(t.threshold)});const s=Math.min(...n),r=Math.max(...n),l=(r-s)/o;t&&!0===t.autoThreshold&&a.forEach((t,e)=>{t.threshold=s+l*e}),e.threshold=r}const s=Array.from(i.items);s.push(e),i.items=s,t.push(s.length-1)}else if(i instanceof animationApi.AnimationBlend2D){const e=Array.from(i.items),a=new animationApi.AnimationBlend2D.Item;a.motion=n,a.threshold=new cc_1.Vec2(0,0),e.push(a),i.items=e,t.push(e.length-1)}this.ensureEditorData(this.animationGraph),this.viewMotion(t)}renameMotionInMotion(t,e){const i=this.getMotionByLevel(t);(i instanceof animationApi.AnimationBlend1D||i instanceof animationApi.AnimationBlend2D)&&(i.name=e,this.refresh())}removeMotionInMotion(t){const e=t.pop();if(void 0===e||!t.length)return;const i=this.getMotionByLevel(t);if(i)if(i instanceof animationApi.AnimationBlend1D){const t=Array.from(i.items);t.splice(e,1);const n=t.length;if(n>2){const e=i[cc_1.editorExtrasTag],a=[];t.forEach(t=>{a.push(t.threshold)});const o=Math.min(...a),s=(Math.max(...a)-o)/(n-1);e&&!0===e.autoThreshold&&t.forEach((t,e)=>{t.threshold=o+s*e})}i.items=t}else if(i instanceof animationApi.AnimationBlend2D){const t=Array.from(i.items);t.splice(e,1),i.items=t}this.motionLevel.length=0,this.crumbView()}changeMotionAutoThreshold(t,e){const i=this.getMotionByLevel(t);i instanceof animationApi.AnimationBlend1D&&(i[cc_1.editorExtrasTag].autoThreshold=e,Metric("A100007"),this.refresh())}changeMotionThreshold1D(t,e,i){const n=this.getMotionByLevel(t);if(!(n instanceof animationApi.AnimationBlend1D))return;const a=Array.from(n.items),o=a[e];o&&(o.threshold=i,n.items=a,Metric("A100007"),this.refresh())}changeMotionThreshold2D(t,e,i){const n=this.getMotionByLevel(t);if(!(n instanceof animationApi.AnimationBlend2D))return;const a=Array.from(n.items)[e];if(a){for(const t in i)"x"!==t&&"y"!==t||(a.threshold[t]=i[t]);Metric("A100007"),this.refresh()}}async changeClipMotionInMotion(t,e){const i=this.getMotionByLevel(t);i instanceof animationApi.ClipMotion&&(e?(cc_1.assetManager.releaseAsset(cc_1.assetManager.assets.get(e)),await new Promise((t,n)=>{cc_1.assetManager.loadAny(e,(e,a)=>{e?n(e):(i.clip=a,t())})})):i.clip=null,Metric("A100007"),this.refresh())}changeAnimationBlend1DInMotion(t,e,i){const n=this.getMotionByLevel(t);n instanceof animationApi.AnimationBlend1D&&(e===env_type_1.EnvType.animationBlendVariable&&(n.param.variable=i),e===env_type_1.EnvType.animationBlendValue&&(n.param.value=i),Metric("A100007"),this.refresh())}changeAnimationBlend2DInMotion(t,e,i,n){const a=this.getMotionByLevel(t);if(!(a instanceof animationApi.AnimationBlend2D))return;const o=1===e?a.paramY:a.paramX;i===env_type_1.EnvType.animationBlendVariable&&(o.variable=n),i===env_type_1.EnvType.animationBlendValue&&(o.value=n),Metric("A100007"),this.refresh()}updateMotionEditData(t,e){if(this.motion){if(this.motion instanceof animationApi.AnimationBlend1D||this.motion instanceof animationApi.AnimationBlend2D){let i=this.motion[cc_1.editorExtrasTag];i||(i=this.motion[cc_1.editorExtrasTag]={}),"threshold"===t&&(i[t]=e)}this.refresh()}}getComponents(t){return(t instanceof animationApi.MotionState||t instanceof animationApi.SubStateMachine)&&t.components?Array.from(t.components):[]}getComponent(t,e=this.state){return this.getComponents(e)[t]||null}addComponent(t,e){const i=this.getState(t);if(i instanceof animationApi.MotionState||i instanceof animationApi.SubStateMachine){const t=cc_1.js.getClassByName(e.name);t&&i.addComponent(t),this.refresh()}}removeComponent(t,e){const i=this.getState(t);if(i instanceof animationApi.MotionState||i instanceof animationApi.SubStateMachine){const t=this.getComponent(e,i);i.removeComponent(t)}this.refresh()}async changeComponent(t,e,i){const n=this.getState(t);if(n instanceof animationApi.MotionState||n instanceof animationApi.SubStateMachine){const t=this.getComponent(e,n);await scene_state_component_1.default.change(t,i)}this.refresh()}getTransitions(){return this.stateMachine?Array.from(this.stateMachine.transitions()):[]}getTransition(t){return this.getTransitions()[t]||null}addTransition(t,e){if(!this.stateMachine)return null;const i=this.getStates(),n=i[t],a=i[e];if(a===this.stateMachine.anyState)return console.warn(Editor.I18n.t("animation-graph.transition.toAnyIsInvalid")),null;const o=this.getTransitions().length;return this.stateMachine.connect(n,a),Metric("A100005"),this.viewTransition(o),this.getTransition(o)}removeTransition(t,e){if(!this.stateMachine)return;const i=this.getTransition(t);if(!i)return;e?this.stateMachine.disconnect(i.from,i.to):this.stateMachine.removeTransition(i);const n=this.getTransitions();for(let t=0;t<n.length;t++)if(n[t].from===i.from&&n[t].to===i.to)return void this.viewTransition(t);this.crumbView()}viewTransition(t){this.transition=this.getTransition(t),this.transitionIndex=t;const e=Utils.getLastCrumb(this.crumbs);e.type=env_type_1.EnvType.transition,e.value=t,e.name=Utils.getTransitionName(this.transition),this.stateIndex=-1,this.state=null,this.motion=null,this.motionLevel.length=0,this.reselect(),this.refresh()}changeTransitionProp(t,e,i){const n=this.getTransition(t);n&&("relativeDuration"===e&&animationApi.isAnimationTransition(n)?n.relativeDuration=!n.relativeDuration:"relativeDestinationStart"===e&&animationApi.isAnimationTransition(n)?n.relativeDestinationStart=!n.relativeDestinationStart:n[e]=i,Metric("A100006"),this.refresh())}adjustTransitionPriority(t,e){const i=this.getTransition(t);this.stateMachine&&i&&(this.stateMachine.adjustTransitionPriority(i,e),this.refresh())}addCondition(t,e){const i=`add${e.type}`;i in this&&this[i](t,e),this.refresh()}addBinaryCondition(t,e){const i=this.getTransition(t);if(!i)return;const n=i.conditions.length,a=new animationApi.BinaryCondition;i.conditions.push(a),e&&a&&(a[cc_1.editorExtrasTag]=Object.assign(a[cc_1.editorExtrasTag]||{},e),this.changeBinaryCondition(t,n,e))}addUnaryCondition(t,e){const i=this.getTransition(t);if(!i)return;const n=i.conditions.length,a=new animationApi.UnaryCondition;i.conditions.push(a),e&&a&&(a[cc_1.editorExtrasTag]=Object.assign(a[cc_1.editorExtrasTag]||{},e),this.changeUnaryCondition(t,n,e))}addTriggerCondition(t,e){const i=this.getTransition(t);if(!i)return;const n=i.conditions.length,a=new animationApi.TriggerCondition;i.conditions.push(a),e&&a&&(a[cc_1.editorExtrasTag]=Object.assign(a[cc_1.editorExtrasTag]||{},e),this.changeTriggerCondition(t,n,e))}getCondition(t,e){const i=this.getTransition(t);return i&&i.conditions[e]||null}removeCondition(t,e){const i=this.getTransition(t);i&&(i.conditions.splice(e,1),this.refresh())}changeCondition(t,e,i){const n=`change${i.type}`;n in this&&this[n](t,e,i),this.refresh()}changeBinaryCondition(t,e,i){const n=this.getCondition(t,e);n&&i&&n instanceof animationApi.BinaryCondition&&(i.lhs&&(i.lhs.type===env_type_1.EnvType.conditionVariable?n.lhs.variable=i.lhs.value.variable:i.lhs.type===env_type_1.EnvType.conditionConstant&&(n.lhs.value=i.lhs.value.constant)),i.rhs&&(i.rhs.type===env_type_1.EnvType.conditionVariable?n.rhs.variable=i.rhs.value.variable:i.rhs.type===env_type_1.EnvType.conditionConstant&&(n.rhs.value=i.rhs.value.constant)),void 0!==i.operator&&(n.operator=i.operator-0))}changeUnaryCondition(t,e,i){const n=this.getCondition(t,e);n&&i&&n instanceof animationApi.UnaryCondition&&(i.lhs&&i.lhs.type===env_type_1.EnvType.conditionVariable&&(n.operand.variable=i.lhs.value.variable),void 0!==i.operator&&(n.operator=i.operator-0))}changeTriggerCondition(t,e,i){const n=this.getCondition(t,e);n&&i&&n instanceof animationApi.TriggerCondition&&i.lhs&&i.lhs.type===env_type_1.EnvType.conditionVariable&&(n.trigger=i.lhs.value.variable)}queryVariables(){if(this.animationGraph){this.queryData.variables={};for(const t of this.variables){const[e,i]=t;this.queryData.variables[e]={type:animationApi.VariableType[i.type],value:i.value},i.type===animationApi.VariableType.TRIGGER&&(this.queryData.variables[e].resetMode=i.resetMode)}}}addVariable(t,e){if(this.animationGraph){switch(t=this.uniqueVariableName(t),parseInt(e)){case animationApi.VariableType.FLOAT:this.animationGraph.addFloat(t);break;case animationApi.VariableType.BOOLEAN:this.animationGraph.addBoolean(t);break;case animationApi.VariableType.TRIGGER:this.animationGraph.addTrigger(t);break;case animationApi.VariableType.INTEGER:this.animationGraph.addInteger(t)}return Metric("A100009"),this.refresh(),t}}renameVariable(t,e){if(this.animationGraph){this.animationGraph.renameVariable(t,e);for(const i of animationApi.viewVariableBindings(this.animationGraph))i.name===t&&i.rebind(e);Metric("A100013"),this.refresh()}}changeVariable(t,e,i){if(!this.animationGraph)return;const n=this.animationGraph.getVariable(t);n&&(n.type===animationApi.VariableType.TRIGGER&&"resetMode"===i?n.resetMode=e?animationApi.TriggerResetMode.NEXT_FRAME_OR_AFTER_CONSUMED:animationApi.TriggerResetMode.AFTER_CONSUMED:n.value=e,this.refresh())}async removeVariable(t){if(this.animationGraph){if(this.checkVariableIsUsed(this.animationGraph,t)){if(0!==(await Editor.Dialog.warn(Editor.I18n.t("animation-graph.variable.removeUsedTip",{variableName:t}),{buttons:[Editor.I18n.t("animation-graph.ok"),Editor.I18n.t("animation-graph.cancel")],default:1,cancel:1})).response)return}this.animationGraph.removeVariable(t),this.refresh()}}uniqueVariableName(t){const e=[];for(const t of this.variables)e.push(t[0]);for(;t&&e.includes(t);)/(\d+)$/.test(t)?t=t.replace(/(\d+)$/,(t,e)=>{let i=parseInt(e,10);return(i+=1).toString()}):t+="1";return t}checkVariableIsUsed(t,e){for(const i of animationApi.viewVariableBindings(t))if(i.name===e)return!0;return!1}queryPreviewMotion(){let t=this.motion;return t||this.state instanceof animationApi.MotionState&&(t=this.state.motion),t}async setPreviewModel(t){this.userDefinedPreviewModelUuid[this.assetUuid]=t,await Editor.Profile.setTemp("animation-graph","preview-model",this.userDefinedPreviewModelUuid)}async queryPreviewModel(){if(this.userDefinedPreviewModelUuid[this.assetUuid])return this.userDefinedPreviewModelUuid[this.assetUuid];const{animationGraph:t}=this;if(!t)return"";for(const e of iterateAllAnimationClips(t)){const t=await queryPreviewModelOfAnimationClip(e);if(t)return t}return""}queryBlend2DThresholdsWeights(t,e){const i=new Array(t.length).fill(0);return animationApi.blendSimpleDirectional(i,t,e),i}}async function queryPreviewModelOfAnimationClip(t){const{_uuid:e}=t;if(!e)return"";let i="";const n=e.split("@");if(Array.isArray(n)&&(i=n[0]),!i)return"";const a=await Editor.Message.request("asset-db","query-asset-info",i);if(!a)return"";let o=!1,s="";for(const[t,e]of Object.entries(a.subAssets))if(e.type){const i=cc_1.js.getClassByName(e.type);if(!o&&cc_1.js.isChildClassOf(i,cc_1.Mesh)&&(o=!0),!s&&cc_1.js.isChildClassOf(i,cc_1.Prefab)&&(s=t),o&&s)break}return o&&s?a.subAssets[s].uuid:""}function*iterateAllAnimationClips(t){function*e(t){if(t instanceof animationApi.ClipMotion)t.clip&&(yield t.clip);else if(t instanceof animationApi.AnimationBlend1D||t instanceof animationApi.AnimationBlend2D||t instanceof animationApi.AnimationBlendDirect)for(const{motion:i}of t.items)i&&(yield*e(i))}function*i(t){for(const n of t.states())n instanceof animationApi.MotionState?n.motion&&(yield*e(n.motion)):n instanceof animationApi.SubStateMachine&&(yield*i(n.stateMachine))}for(const e of t.layers)yield*i(e.stateMachine)}function Metric(t,e){t&&Editor.Metrics._trackEventWithTimer({category:"animationStateMachine",id:t,value:1})}__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"reset",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"viewport",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"bestViewport",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"query",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"apply",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbView",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addLayer",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeLayer",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbLayer",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"renameLayer",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeLayer",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbStateMachine",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"moveState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"renameState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"copyState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"duplicateState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"pasteState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"turnMotionStateIntoSubStateMachine",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addMotionToState",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeClipMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"crumbMotionInMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"moveMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addMotionToMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"renameMotionInMotion",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"updateMotionEditData",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addComponent",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeComponent",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeComponent",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"adjustTransitionPriority",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addCondition",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeCondition",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeCondition",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"addVariable",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"renameVariable",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"changeVariable",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"removeVariable",null),__decorate([(0,make_life_easier_utils_1.bindIPC)()],SceneAnimationGraph.prototype,"queryBlend2DThresholdsWeights",null),exports.default=new SceneAnimationGraph;