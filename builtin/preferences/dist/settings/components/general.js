"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.methods=exports.components=exports.computed=exports.watch=exports.data=exports.props=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),electron_profile_1=__importDefault(require("@base/electron-profile")),profile=electron_profile_1.default.load("global://editor/ui-kit.json");exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../static/settings/general.html"),"utf8"),exports.props=["language"];const defaultStep=.1;function data(){const e=profile.get("num-input.step")||defaultStep,t=Editor.Theme.getList();return t.splice(t.indexOf("light"),1),{settings:{language:Editor.I18n.getLanguage(),step:e<0?defaultStep:e,theme_color:Editor.Theme.use(),preview_ip:"127.0.0.1",server_port:7456,wheel_enable:!0},ipList:[],themeList:t}}async function mounted(){Editor.Startup.ready.package?await this._serviceSettingPrepare():Editor.Startup.once("package-ready",this._serviceSettingPrepare)}exports.data=data,exports.watch={},exports.computed={},exports.components={},exports.methods={_onSettingChanged(e,t){const r=e.target.value;if(this.settings[t]!==r)switch(this.settings[t]=r,t){case"language":Editor.I18n.select(r);break;case"step":r<=0?profile.set("num-input.step",defaultStep):profile.set("num-input.step",r),profile.save();break;case"theme_color":break;case"preview_ip":Editor.Message.send("preview","set-preview-ip",r);break;case"server_port":Editor.Profile.setConfig("server","server_port",r,"local");break;case"wheel_enable":profile.set("num-input.wheel_enable",r)}},async _serviceSettingPrepare(){this.ipList=await Editor.Message.request("server","query-sort-ip-list"),this.settings.preview_ip=await Editor.Message.request("preview","get-preview-ip"),this.settings.server_port=await Editor.Message.request("server","query-port")}},exports.mounted=mounted;