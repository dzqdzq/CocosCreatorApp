"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unload=exports.load=exports.methods=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra"),plugin_1=require("./plugin");async function load(){await plugin_1.pluginManager.init()}function unload(){plugin_1.pluginManager.destroy()}exports.methods={async openSettings(e,...n){await Editor.Panel.has("preferences.settings")?(Editor.Message.send("preferences","change-settings-tab",e,...n),Editor.Panel.open("preferences.settings")):Editor.Panel.open("preferences.settings",e,...n)},queryConfig:async(e,n,t)=>plugin_1.pluginManager.hasRegisterPackages.has(e)?await Editor.Profile.getConfig(e,n,t):null,async importConfig(){const e=await Editor.Dialog.select({title:Editor.I18n.t("preferences.menu.importConfig"),type:"file",multi:!1,filters:[{name:"JSON",extensions:["json"]}]});if(e.filePaths&&e.filePaths[0])try{let n;n=(0,fs_extra_1.readJSONSync)(e.filePaths[0]),await plugin_1.pluginManager.handleImportConfigs(n),console.log("Import preferences config success!Please refresh panel.")}catch(e){console.error("Import preferences config failed!",e)}},async exportConfig(){const e=await plugin_1.pluginManager.handleExportConfigs(),n=await Editor.Dialog.save({title:Editor.I18n.t("preferences.menu.exportConfig"),path:(0,path_1.join)(Editor.Project.path,"preferences-configs.json"),filters:[{name:"JSON",extensions:["json"]}]});if(n.filePath)try{(0,fs_extra_1.outputFileSync)(n.filePath,JSON.stringify(e,null,2)),console.log(`Preferences config has export in {link[${n.filePath}](${n.filePath})}`)}catch(e){console.error("Export preferences config failed!",e)}},queryPreferencesData:()=>plugin_1.pluginManager.configs},exports.load=load,exports.unload=unload;