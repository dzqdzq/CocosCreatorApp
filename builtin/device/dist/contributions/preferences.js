"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.$=exports.template=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue");let vm=null;exports.style=fs_1.readFileSync(path_1.join(__dirname,"./preferences.css"),"utf8"),exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/contributions/preferences.html"),"utf8"),exports.$={device:".device"};const component={data:{config:{builtin:[],custom:[],enable:[]},type:"",num:-1,device:{name:"",width:0,height:0,ratio:0}},watch:{type(){this.updateDevice()},num(){this.updateDevice()}},methods:{async refresh(){const e=this,i=await Editor.Profile.getConfig("device","devices","default");i&&(e.config.builtin=i);const t=await Editor.Profile.getConfig("device","custom","global");t&&(e.config.custom=t);const o=await Editor.Profile.getConfig("device","enable");o&&(e.config.enable=o)},updateDevice(){const e=this;void 0===e.timer&&(e.timer=requestAnimationFrame(()=>{if(e.timer=void 0,!e.config[e.type]||!e.config[e.type][e.num])return;const i=e.config[e.type][e.num];e.device.name=i.name,e.device.width=i.width,e.device.height=i.height,e.device.ratio=i.ratio}))},changeDevice(){const e=this;if("custom"!==e.type||!e.config[e.type][e.num])return;const i=e.config[e.type][e.num];e.device.name?e.config.builtin.some(i=>i.name===e.device.name)||e.config.custom.some(t=>t!==i&&t.name===e.device.name)?Editor.Dialog.warn(Editor.I18n.t("device.invalid.exists")):(i.name=e.device.name,i.width=e.device.width,i.height=e.device.height,i.ratio=e.device.ratio,Editor.Profile.setConfig("device","custom",e.config.custom,"global")):Editor.Dialog.warn(Editor.I18n.t("device.invalid.name"))},addDevice(){const e=this;e.device.name?e.config.builtin.some(i=>i.name===e.device.name)||e.config.custom.some(i=>i.name===e.device.name)?Editor.Dialog.warn(Editor.I18n.t("device.invalid.exists")):(e.config.custom.push(JSON.parse(JSON.stringify(e.device))),e.type="custom",e.num=e.config.custom.length-1,Editor.Profile.setConfig("device","custom",e.config.custom,"global")):Editor.Dialog.warn(Editor.I18n.t("device.invalid.name"))},deleteDevice(){const e=this;"custom"===e.type&&e.config[e.type][e.num]&&(e.config[e.type].splice(e.num,1),e.type="",e.num=-1,Editor.Profile.setConfig("device","custom",e.config.custom,"global"))},switchEnable(e,i){const t=this,o=t.config.enable.indexOf(i);e?-1===o&&(t.config.enable.push(i),Editor.Profile.setConfig("device","enable",t.config.enable,"global")):-1!==o&&(t.config.enable.splice(o,1),Editor.Profile.setConfig("device","enable",t.config.enable,"global"))}}};function ready(){component.el=this.$.device,(vm=new Vue(component)).refresh()}exports.ready=ready;