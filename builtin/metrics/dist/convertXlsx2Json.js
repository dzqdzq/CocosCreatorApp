"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const xlsx_1=__importDefault(require("xlsx")),fs_extra_1=require("fs-extra"),path_1=require("path");(()=>{function r(e,t){e=xlsx_1.default.utils.encode_cell({r:e-1,c:t-1}),t=a[e];return t?t.v:void 0}var e="cocos create数据需求表.xlsx",t=(0,path_1.join)(__dirname,"..","statics"),o=(0,path_1.join)(t,e),s=(0,path_1.join)(t,"googleG4Table.json");if(!(0,fs_extra_1.existsSync)(o))return console.error(new Error(`转换失败，需要把 ${e} 复制到 ${t} 文件夹下`));e=xlsx_1.default.readFile(o),t=e.SheetNames[9];const a=e.Sheets[t];const l={};for(let e=0;e<500;e++){var n=r(e,1);const _=r(e,7);var i=r(e,8);if(_&&i&&n&&"生效"===n&&"dashboard"!==_&&"other"!==_&&"projectId"!==i){const c=r(e,11);if(c&&"-"!==c){let t=r(e,12)||"";"-"===t?t="":"{0/1}"===t||"{1/2}"===t||"{labelName}"===t||"{processName}"===t||"{panelName}"===t?t="{*}":1<(n=t.split("_{")).length&&(t=n[0]+"_{*}");n=i.split("_");const f=n[0];if(1<n.length){i=n[1].split("/");if(1<i.length){i.forEach(e=>{e=(e=e.replace("{","")).replace("}",""),l[`${_}_${f}_`+e]={action:c,label:t}});continue}}l[_+"_"+f]={action:c,label:t}}}}console.log(l),(0,fs_extra_1.writeJsonSync)(s,l,{encoding:"utf8",spaces:4})})();