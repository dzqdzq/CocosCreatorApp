"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.listeners=exports.methods=exports.$=exports.fonts=exports.template=exports.style=void 0;const electron_1=require("electron"),fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1;const manager=require("./manager");let panel=null,vm=null;async function ready(){panel=this;const e=await Editor.Profile.getConfig("console","panel"),t=e.fontSize-0||12;vm=new Vue({el:panel.$["console-panel"],data:{change:!1,tabbar:{displayDate:e.displayDate,fontSize:t,lineHeight:2*t,filterType:"all",filterRegex:!1}},methods:{onHeaderChange(e){if(!e.target.getAttribute("path"))return;const t=e.target.value;switch(e.target.getAttribute("path")){case"clear":Editor.Logger.clear(),manager.clear();break;case"filterRegex":manager.setFilterRegex(t);break;case"filterText":manager.setFilterText(t);break;case"filterType":manager.setFilterType(t);break;case"openLog":electron_1.shell.openPath(manager.logPath)}},update(){this.change||(this.change=!0)},t(e){const t=`console.${e}`;return Editor.I18n.t(t)},async init(){await this.refresh(),manager.setUpdateFn(this.update.bind(this)),Editor.Logger.on("record",exports.methods.record)},async refresh(){manager.clear();const e=await Editor.Profile.getConfig("console","panel");this.tabbar.displayDate=e.displayDate,this.tabbar.fontSize=Number(e.fontSize),this.tabbar.lineHeight=2*this.tabbar.fontSize,manager.showDate(this.tabbar.displayDate),manager.setLineHeight(this.tabbar.lineHeight);const t=await Editor.Logger.query();manager.addItems(t)}},components:{"console-list":require("./components/list")},mounted(){this.init()}})}async function beforeClose(){}async function close(){manager.setUpdateFn(null),Editor.Logger.removeListener("record",exports.methods.record)}exports.style=fs_1.readFileSync(path_1.join(__dirname,"../dist/index.css"),"utf8"),exports.template=fs_1.readFileSync(path_1.join(__dirname,"../static","/template/index.html"),"utf8"),exports.fonts=[{name:"console"}],exports.$={"console-panel":".console-panel"},exports.methods={async record(e){manager.addItem(e)},refresh(){vm&&vm.refresh()}},exports.listeners={resize(){manager&&manager.update()},show(){manager.update()}},exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;