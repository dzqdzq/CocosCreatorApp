"use strict";const{expect:expect}=require("chai"),menu=require("@base/electron-menu");function wait(e){return new Promise(t=>{setTimeout(()=>{t()},e||200)})}describe("测试 Assets 面板上的 UI 元素",()=>{[{index:0,zh:"文件夹",en:"Folder"},{index:2,zh:"场景文件",en:"Scene"},{index:4,zh:"TypeScript",en:"TypeScript"},{index:6,zh:"JavaScript",en:"JavaScript"},{index:8,zh:"Material",en:"Material"},{index:9,zh:"CubeMap",en:"CubeMap"},{index:11,zh:"Effect",en:"Effect"},{index:13,zh:"Animation Clip",en:"Animation Clip"},{index:15,zh:"Auto Atlas",en:"Auto Atlas"}].forEach(e=>{describe(`选中第一个数据库并创建新的 ${e.en}`,async()=>{await Editor.Panel.open("assets");const t=`___00000000000.${e.index}`,a=Tester.Dom.selector("assets");a.find(".content").find("ui-drag-area").find("ui-drag-item").eq(0),after(async()=>{try{await Editor.Message.request("asset-db","delete-asset",`db://assets/${t}`)}catch(e){}}),it("点击元素，检查选中状态",async()=>{const e=await a.length();expect(e).not.equal(0),await a.click();const t=null!==await a.attr("active");expect(t).to.equal(!0)}),it("在创建菜单里点击文件夹",async()=>{const e=Tester.Dom.selector("assets");e.find(".header").find(".i-add").eq(0),await e.click(),menu.click("0"),await wait(1e3);const t=Tester.Dom.selector("assets");t.find(".content").find("ui-drag-area").eq(0).find("input"),await t.click(),await t.esc()}),it(`创建一个资源，然后改名成 ${t}`,async function(){this.timeout(15e3);const e=Tester.Dom.selector("assets");e.find(".header").find(".i-add").eq(0),await e.click(),menu.click("0"),await wait(1e3);const a=Tester.Dom.selector("assets");a.find(".content").find("ui-drag-area").eq(0).find("input"),await a.data("value",""),await a.input(t),await a.enter();const i=Tester.Dom.selector("assets");i.find(".content").find("ui-drag-area").find("ui-drag-item").eq(1);const n=await i.data("innerText");expect(n).to.equal(t)})})})});