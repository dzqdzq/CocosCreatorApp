"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&__createBinding(t,e,s);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.data=exports.methods=exports.components=void 0;const utils=__importStar(require("../../../components/utils"));let requestAnimationId;function data(){return{active:"",uuid:"",path:"",crumbs:[],list:{},prev:[],next:[]}}exports.components={thumbnail:require("../../../components/tree-node-icon")},exports.methods={async select(e){const t=this;t.crumbs=[],t.path="",t.uuid=e,t.list=[],window.cancelAnimationFrame(requestAnimationId);const s=await utils.getAssetForPreview(e);if(!s)return;const i=await utils.getChildrenForPreview(e);if(!i||!i.length)return;t.next[t.next.length-1]!==e&&t.prev[t.prev.length-1]!==e&&(t.prev.length>100&&t.prev.shift(),t.prev.push(e),t.next=[]),t.path=s.path,t.crumbs=s.url.substr(5).split("/");const r=i.length;if(r<200)return void(t.list=i);let n=0;requestAnimationId=window.requestAnimationFrame(function e(){if(n<r){for(let e=0;e<10;e++){if(!i[++n])return;t.list.push(i[n])}requestAnimationId=window.requestAnimationFrame(e)}})},async unselect(){this.path="",this.crumbs=[],this.list=[]},getAdditional(e){const t=[{type:e.type,value:e.uuid}];return e.redirect&&t.push({type:e.redirect.type,value:e.redirect.uuid}),e.extends&&e.extends.length>0&&e.extends.forEach(s=>{t.push({type:s,value:e.uuid})}),JSON.stringify(t)},dblClick(e){Editor.Selection.clear("asset"),Editor.Selection.select("asset",e.uuid),Editor.Message.send("assets","twinkle",e.uuid)},async crumbsClick(e){const t=this.crumbs.slice(0,e+1),s=await Editor.Message.request("asset-db","query-uuid",`db://${t.join("/")}`);Editor.Selection.clear("asset"),s&&(Editor.Selection.select("asset",s),Editor.Message.send("assets","twinkle",s))},async prevClick(){const e=this,t=e.prev.pop();if(!t)return;if(e.next[e.next.length-1]!==t&&e.next.push(t),0===e.prev.length)return;const s=e.prev[e.prev.length-1];await Editor.Message.request("asset-db","query-asset-info",s)?(Editor.Selection.clear("asset"),Editor.Selection.select("asset",s)):e.prevClick()},async nextClick(){const e=this,t=e.next.pop();t&&(await Editor.Message.request("asset-db","query-asset-info",t)?(e.prev[e.prev.length-1]!==t&&e.prev.push(t),Editor.Selection.clear("asset"),Editor.Selection.select("asset",t)):e.nextClick())}},exports.data=data;