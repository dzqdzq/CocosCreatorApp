System.register(["./ui.js","./app-globals.js","./main.js"],function(e,n){"use strict";var t,r,o,s=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,a)}c((r=r.apply(e,n||[])).next())})},i=this&&this.__generator||function(e,n){var t,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=this&&this.__spreadArray||function(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e};n&&n.id;return e("bootstrap",function(e){return s(this,void 0,void 0,function(){var c;return i(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(e){return s(this,void 0,void 0,function(){var c,u,l,f;return i(this,function(h){switch(h.label){case 0:return[4,function(){return s(this,void 0,void 0,function(){var e,t;return i(this,function(r){switch(r.label){case 0:return[4,n.import("/socket.io/socket.io.js")];case 1:return e=r.sent(),(t=e.default()).on("browser:reload",function(){window.location.reload()}),t.on("browser:disconnect",function(){window.location.reload()}),[2,t]}})})}()];case 1:c=h.sent(),u=new t.Ui({devices:e.devices,emit:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];c.emit.apply(c,a([e],n))}}),h.label=2;case 2:return h.trys.push([2,8,,9]),window.addEventListener("error",function(e){r.globals.error=!0;var n=[].toString.call(e,e);return console.error(e),"[object Event]"===n?(u.showError("load "+e.target.src+" failed"),e.stack&&u.showError(e.stack)):(u.showError(e.message+" in "+e.filename),e.stack&&u.showError(e.stack)),!0},!0),window.addEventListener("unhandledrejection",function(e){u.showError(e.type+": "+e.reason.message),u.showError(e.reason.stack)},!0),e.settings.engineModules.findIndex(function(e){return"physics-ammo"===e})>=0?[4,n.import("cce:/internal/x/cc-fu/wait-for-ammo-instantiation")]:[3,5];case 3:return[4,(0,h.sent().default)()];case 4:h.sent(),h.label=5;case 5:return[4,System.import("cc")];case 6:return l=h.sent(),u.bindEngine(l),[4,o.main(u,e)];case 7:return h.sent(),[3,9];case 8:return f=h.sent(),u.showError(f.message),u.showError(f.stack),[3,9];case 9:return[2]}})})}(e)];case 1:return u.sent(),[3,3];case 2:return c=u.sent(),console.error(c),[3,3];case 3:return[2]}})})}),{setters:[function(e){t=e},function(e){r=e},function(e){o=e}],execute:function(){}}});