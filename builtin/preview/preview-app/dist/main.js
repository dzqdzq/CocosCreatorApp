System.register([],function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}c((r=r.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};t&&t.id;return e("main",function(e,s){var i;return n(this,void 0,void 0,function(){var n,a,o,c,u,l,d,m,h,f,g,p,v,w,b,E,y,S,N,A;return r(this,function(L){switch(L.label){case 0:return[4,System.import("cc")];case 1:if((n=L.sent()).macro.ENABLE_WEBGL_ANTIALIAS=!0,s.settings.macros)for(a in s.settings.macros)n.macro[a]=s.settings.macros[a];if(window.CC_WECHATGAME=!1,o={importBase:"assets/general/import",nativeBase:"assets/general/native"},x=e.gameCanvas,P=x?x instanceof HTMLElement?x:document.querySelector(x)||document.querySelector("#"+x):null,!(c=P&&"CANVAS"===P.tagName?(_=P.width,M=P.height,B=P,R=document.createElement("div"),B&&B.parentNode&&B.parentNode.insertBefore(R,B),R.setAttribute("id","Cocos3dGameContainer"),R.appendChild(B),T=R.parentNode===document.body?document.documentElement:R.parentNode,function(e,t){(" "+e.className+" ").indexOf(" "+t+" ")>-1||(e.className&&(e.className+=" "),e.className+=t)}(B,"gameCanvas"),B.setAttribute("width",_||"480"),B.setAttribute("height",M||"320"),B.setAttribute("tabindex","99"),{frame:T,container:R,canvas:B}):null))throw new Error(n.getError(200));u=null!==(i=n.DebugMode[e.debugMode])&&void 0!==i?i:n.DebugMode.INFO,l={id:e.gameCanvas,showFPS:e.showFps,debugMode:u,frameRate:e.frameRate,groupList:s.settings.groupList,collisionMatrix:s.settings.collisionMatrix,adapter:c,renderPipeline:s.settings.renderPipeline,assetOptions:o,customJointTextureLayouts:s.settings.customJointTextureLayouts||[],physics:s.settings.physics},d=(s.settings.jsList||[]).map(function(e){return"/plugins/"+e}),m=function(t){return r(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n,r){var s;function i(e){e.filename===t&&(s=e.error)}window.addEventListener("error",i);var a=document.createElement("script");a.charset="utf-8",a.async=!0,a.crossOrigin="anonymous",a.addEventListener("error",function(){window.removeEventListener("error",i);var n=Error("Error loading "+t);e.showError(n.message),r(n)}),a.addEventListener("load",function(){window.removeEventListener("error",i),document.head.removeChild(a),s?r(s):n()}),a.src=t,document.head.appendChild(a)})];case 1:return n.sent(),[2]}})},h=0,f=d,L.label=2;case 2:return h<f.length?(g=f[h],[5,m(g)]):[3,5];case 3:L.sent(),L.label=4;case 4:return h++,[3,2];case 5:return[4,n.game.init(l)];case 6:return L.sent(),[4,t.import("cce:/internal/x/prerequisite-imports")];case 7:L.sent(),p=n.AssetManager.BuiltinBundleName,v=p.RESOURCES,w=p.MAIN,b=s.settings.hasResourcesBundle?[v,w]:[w],E=function(t){return r(this,function(r){switch(r.label){case 0:return[4,new Promise(function(r,s){n.assetManager.loadBundle(t,function(t){t?(e.showError(t.message),s(t)):r()})})];case 1:return r.sent(),[2]}})},y=0,S=b,L.label=8;case 8:return y<S.length?(N=S[y],[5,E(N)]):[3,11];case 9:L.sent(),L.label=10;case 10:return y++,[3,8];case 11:return[4,(C=s.settings.launchScene,new Promise(function(e,t){var n=new XMLHttpRequest;n.responseType="text",n.addEventListener("load",function(){200===n.status&&e(JSON.parse(n.response))}),n.open("GET","scene/"+C+".json",!0),n.send()}))];case 12:return A=L.sent(),[4,n.game.run(function(){n.game.canvas.setAttribute("tabindex",-1),n.game.canvas.style.backgroundColor="",n.director.once(n.Director.EVENT_AFTER_SCENE_LAUNCH,function(){e.hideSplash(),function(e){var t=e.director.getScene();if(t&&0!==t.children.length){if(t.children.length>1)return!1;var n=t.children[0];return!(n.children.length>0||n._components.length>1||n._components.length>0&&!(n.child0[0]instanceof e.Canvas))}return!0}(n)&&e.hintEmptyScene()}),n.view.enableRetina(!0),n.view.resizeWithBrowserSize(!0),n.view.enableAutoFullScreen(!1);var t=s.settings.designResolution,r=t.width,i=t.height,a=t.policy;n.view.setDesignResolutionSize(Number(r),Number(i),a||n.ResolutionPolicy.FIXED_HEIGHT),n.game.pause(),n.assetManager.loadWithJson(A,{assetId:s.settings.launchScene},function(t,n){var r=100*t/n*.6;e.reportLoadProgress(r)},function(t,r){if(t)return n.error(t.stack),void e.showError(t.message);var s=r.scene;s._name=r._name,n.director.runSceneImmediate(s,function(){n.game.resume()})})})];case 13:return L.sent(),[4,new Promise(function(e){setTimeout(e,100)})];case 14:return L.sent(),[2]}var C,x,_,M,T,R,B,P})})}),{setters:[],execute:function(){}}});