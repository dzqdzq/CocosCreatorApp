"use strict";const qrcode=require("qrcode");let previewIp="",previewPort="";exports.style="\n:host {\n    display: flex;\n}\n\n.preview-server {\n    display: flex;\n    margin: 0 5px;\n}\n\n.preview-server > div {\n    position: relative;\n    font-size: 13px;\n    color: var(--color-normal-contrast);\n    margin-right: 5px;\n}\n\n.preview-server > div > svg {\n    width: 12px;\n}\n\n.preview-server > div > div {\n    position: absolute;\n    background: white;\n    z-index: 999;\n    top: 30px;\n    border-radius: calc(var(--size-normal-radius) * 1px);;\n    flex-direction: column;\n    padding: 5px;\n    border: 1px solid var(--color-normal-border);\n    border-radius: calc(var(--size-normal-radius) * 1px);\n    opacity: 0;\n    transition: opacity 0.2s;\n    pointer-events: none;\n}\n\n.preview-server > div > div[active] {\n    opacity: 1;\n    pointer-events: all;\n}\n\n.preview-server > div > div > canvas {\n    width: 150px;\n    height: 150px;\n    margin: 5px;\n    margin-bottom: 2px;\n}\n\n@media all and (max-width: 860px) {\n    .preview-server > div > .address {\n        display: none;\n    }\n}\n",exports.template='\n<div class="preview-server">\n    <div class="content">\n        <span class="address"></span>\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M634.91 154.88C457.74-8.99 182.19-8.93 5.09 154.88c-6.66 6.16-6.79 16.59-.35 22.98l34.24 33.97c6.14 6.1 16.02 6.23 22.4.38 145.92-133.68 371.3-133.71 517.25 0 6.38 5.85 16.26 5.71 22.4-.38l34.24-33.97c6.43-6.39 6.3-16.82-.36-22.98zM320 352c-35.35 0-64 28.65-64 64s28.65 64 64 64 64-28.65 64-64-28.65-64-64-64zm202.67-83.59c-115.26-101.93-290.21-101.82-405.34 0-6.9 6.1-7.12 16.69-.57 23.15l34.44 33.99c6 5.92 15.66 6.32 22.05.8 83.95-72.57 209.74-72.41 293.49 0 6.39 5.52 16.05 5.13 22.05-.8l34.44-33.99c6.56-6.46 6.33-17.06-.56-23.15z"></path></svg>\n        <div class="qr">\n            <canvas class="canvas"></canvas>\n            <ui-label i18n>preview.scan</ui-label>\n        </div>\n    </div>\n</div>\n',exports.$={content:".content",address:".address",number:".number",canvas:".canvas",qr:".qr"},exports.methods={updateAddress(){this.address=`${previewIp}:${previewPort}`,this.$.address.innerHTML=this.address,qrcode.toCanvas(this.$.canvas,`http://${this.address}/`,{errorCorrectionLevel:"H",maskPattern:2,margin:1})},async updateIp(){previewPort=await Editor.Message.request("server","query-port"),previewIp=await Editor.Message.request("preview","get-preview-ip"),this.updateAddress()}},exports.ready=async function(){this.number=0,await this.updateIp(),this.$.content.addEventListener("mouseenter",async()=>{await this.updateIp(),this.$.qr.setAttribute("active","")}),this.$.content.addEventListener("mouseleave",()=>{this.$.qr.removeAttribute("active")}),Editor.Message.addBroadcastListener("preview:port-change",e=>{previewPort=e,this.updateAddress()}),Editor.Message.addBroadcastListener("preview:ip-change",e=>{previewIp=e,this.updateAddress()})};