import"systemjs-source/system.js";import"systemjs-source/extras/named-register.js";import{setResolutionDetailMap}from"../../../../node_modules/@cocos/creator-programming-quick-pack/runtime-lib/global-detail-resolver.js";import{systemJSPrototype}from"systemjs-source/system-core";const setResolutionDetailMapCallbackTag=Symbol("[[setResolutionDetailMapCallback]]");systemJSPrototype.setResolutionDetailMapCallback=function(t){this[setResolutionDetailMapCallbackTag]=t};let setupResolutionDetailMapPromise=null;const vendorPrepareImport=systemJSPrototype.prepareImport;systemJSPrototype.prepareImport=async function(){setupResolutionDetailMapPromise||(setupResolutionDetailMapPromise=(async()=>{try{await(async()=>{const{json:t,url:e}=await this[setResolutionDetailMapCallbackTag]();setResolutionDetailMap(t,e)})()}catch(t){console.debug(`Failed to load resolution detail map: ${t}`)}})()),await setupResolutionDetailMapPromise,vendorPrepareImport.apply(this,arguments)};const upvalueMap={},vendorCreateContext=systemJSPrototype.createContext;systemJSPrototype.createContext=function(t){const e={},o=vendorCreateContext.call(this,t);return upvalueMap[o.url]=e,{...o,upvalue:t=>(function(o){e[t]=o})}};