"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.importConfig=exports.exportConfig=exports.ready=exports.$=exports.template=exports.style=void 0;const Vue=require("vue/dist/vue.js"),lodash=require("lodash");let vm=null;exports.style="\n.preview > div { display: flex; }\n.preview ui-icon { visibility: hidden; cursor: pointer; }\n.preview ui-icon[type='local'] { color: var(--color-warn-fill); visibility: visible; }\n.preview ui-prop { --left-width: 40%; padding-left: 5px; margin-bottom: 4px; flex: 1; }\n.preview > div:hover ui-icon { visibility: visible; }\n.preview ui-prop[disabled] { pointer-events: none; opacity: 0.6; }\n.http > div.subtab { font-size: 10px; opacity: 0.5; }\n.http ui-prop { --left-width: 40%; padding-left: 5px; margin-bottom: 4px; flex: 1; }\n.http > div { display: flex; }\n.http > div > ui-setting { flex: 1; }\n.http > div > ui-icon { color: var(--color-warn-fill); }\n",exports.template='\n<div v-if="config.preview" class="preview" @confirm="onConfirm">\n    <div>\n        <ui-icon value="setting" tooltip="i18n:preferences.menu.position_info"\n            :type="types[\'preview.simulator_debugger\']"\n            @click.stop="onChangePosition($event.target.pageX, $event.target.pageY, \'preview.simulator_debugger\')">\n        </ui-icon>\n        <ui-prop>\n            <ui-label slot="label" value="i18n:preview.project.general.simulatorDebugger"></ui-label>\n            <ui-checkbox slot="content" path="preview.simulator_debugger"\n                :value="config.preview.simulator_debugger"\n            ></ui-checkbox>\n        </ui-prop>\n    </div>\n    <div>\n        <ui-icon value="setting" tooltip="i18n:preferences.menu.position_info"\n            :type="types[\'preview.wait_for_connect\']"\n            @click.stop="onChangePosition($event.target.pageX, $event.target.pageY, \'preview.wait_for_connect\')">\n        </ui-icon>\n        <ui-prop :tooltip="config.preview.simulator_debugger ? \'\' : \'i18n:preview.project.general.waitForConnectTips\'">\n            <ui-label slot="label" value="i18n:preview.project.general.waitForConnect"></ui-label>\n            <ui-checkbox slot="content" path="preview.wait_for_connect"\n                :value="config.preview.wait_for_connect"\n                :disabled="waitForConnectDisabled"\n            ></ui-checkbox>\n        </ui-prop>\n    </div>\n</div>\n<div class="http">\n\n    \x3c!-- 初始服务器端口号选择 --\x3e\n    <div class="subtab">Server HTTP</div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:preferences.general.server_port"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-num-input slot="content" path="server_port"\n                    step="1"\n                    preci="0"\n                    min="1024"\n                    max="65535"\n                ></ui-num-input>\n            </ui-prop>\n        </ui-setting>\n    </div>\n\n    <div class="subtab">Server HTTPS</div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:server.https.enable"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-checkbox slot="content" path="https.enable"></ui-checkbox>\n            </ui-prop>\n        </ui-setting>\n    </div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:server.https.port"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-num-input slot="content" path="https.port"\n                    step="1"\n                    preci="0"\n                    min="1024"\n                    max="65535"\n                ></ui-num-input>\n            </ui-prop>\n        </ui-setting>\n    </div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:server.https.key"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-file slot="content" path="https.key"></ui-file>\n            </ui-prop>\n        </ui-setting>\n    </div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:server.https.cert"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-file slot="content" path="https.cert"></ui-file>\n            </ui-prop>\n        </ui-setting>\n    </div>\n    <div>\n        \x3c!-- <ui-icon value="warn"></ui-icon> --\x3e\n        <ui-icon value="setting" class="server-port"\n            tooltip="i18n:preferences.menu.move_local"\n        ></ui-icon>\n        <ui-setting type="local" package="server">\n            <ui-prop>\n                <div slot="label">\n                    <ui-label value="i18n:server.https.ca"></ui-label>\n                    <ui-icon value="help" tooltip="i18n:preferences.general.serverPortHelpTips"></ui-icon>\n                </div>\n                <ui-file slot="content" path="https.ca"></ui-file>\n            </ui-prop>\n        </ui-setting>\n    </div>\n</div>\n',exports.$={preview:".preview"};const component={data:{config:{preview:null},types:{"preview.simulator_debugger":"global","preview.wait_for_connect":"global"},waitForConnectDisabled:!1},watch:{"config.preview.simulator_debugger":{async handler(e){const i=this;i.waitForConnectDisabled=!1,e||(i.waitForConnectDisabled=!0,lodash.set(i.config,"preview.wait_for_connect",!1),await Editor.Profile.setConfig("preview","preview.wait_for_connect",!1,i.types["preview.wait_for_connect"]))},deep:!0}},methods:{async refresh(e){const i=this,n=await Editor.Profile.getConfig("preview",e,"local");i.types[e]=void 0!==n&&null!==n?"local":"global"},async onConfirm(e){const i=e.target.value,n=e.target.getAttribute("path");lodash.set(this.config,n,i),await Editor.Profile.setConfig("preview",n,i,this.types[n])},onChangePosition(e,i,n){Editor.Menu.popup({x:e,y:i,menu:[{label:Editor.I18n.t("preferences.menu.move_local"),enabled:"global"===vm.types[n],async click(){const e=await Editor.Profile.getConfig("preview",n);await Editor.Profile.setConfig("preview",n,e),vm.refresh(n)}},{label:Editor.I18n.t("preferences.menu.move_global"),enabled:"local"===vm.types[n],async click(){const e=await Editor.Profile.getConfig("preview",n,"local");await Editor.Profile.setConfig("preview",n,e,"global"),await Editor.Profile.removeConfig("preview",n,vm.types[n]),vm.refresh(n)}}]})}}};async function ready(){component.el=this.$.preview,(vm=new Vue(component)).config.preview=Object.assign({},{simulator_debugger:await Editor.Profile.getConfig("preview","preview.simulator_debugger"),wait_for_connect:await Editor.Profile.getConfig("preview","preview.wait_for_connect")});for(const e of Object.keys(vm.types))await vm.refresh(e)}async function exportConfig(){const e={},i=["preview.simulator_debugger","preview.wait_for_connect"];for(const n of i){let i="global";const t=await Editor.Message.request("preferences","query-config","preview",n,"local");void 0!==t&&null!==t&&(i="local"),e[n]={type:i,value:await Editor.Message.request("preferences","query-config","preview",n)}}return e}async function importConfig(e){e["preview.simulator_debugger"]&&await Editor.Message.request("preferences","set-config","preview","preview.simulator_debugger",e["preview.simulator_debugger"].value,e["preview.simulator_debugger"].type),e["preview.wait_for_connect"]&&await Editor.Message.request("preferences","set-config","preview","preview.wait_for_connect",e["preview.wait_for_connect"].value,e["preview.wait_for_connect"].type)}exports.ready=ready,exports.exportConfig=exportConfig,exports.importConfig=importConfig;