"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0});const asset_db_1=require("@editor/asset-db"),cc=__importStar(require("cc")),load_asset_sync_1=require("./gltf/load-asset-sync"),texture_base_1=require("./texture-base");class TextureCubeImporter extends asset_db_1.Importer{get version(){return"1.0.3"}get name(){return"texture-cube"}get assetType(){return"cc.TextureCube"}get migrations(){return[{version:"1.0.3",migrate:texture_base_1.migrateAnisotropy}]}async import(e){0===Object.getOwnPropertyNames(e.userData).length&&e.assignUserData(texture_base_1.makeDefaultTextureBaseAssetUserData(),!0);const t=e.userData,r=["front","back","left","right","top","bottom"],a={};for(const s of r){let r=t[s];if(!r){const e=`db://internal/default_cubemap/${s}.jpg`,t=asset_db_1.queryUUID(e);if(!t)throw new Error(`[[internal-error]] Default face url ${e} doesn't exists.`);r=t}const n=load_asset_sync_1.loadAssetSync(r,cc.ImageAsset);if(!n)throw new Error(`Failed to load ${s} face of ${e.uuid}.`);a[s]=n}const s=new cc.TextureCube;return texture_base_1.applyTextureBaseAssetUserData(t,s),s._mipmaps=[a],await e.saveToLibrary(".json",EditorExtends.serialize(s)),!0}}exports.default=TextureCubeImporter;