"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const path_1=require("path"),ScriptModuleMap={};class PluginManager{async executeScript(t){if(!ScriptModuleMap[t.name])throw"Asset database scripts do not exist: "+t.name;if(ScriptModuleMap[t.name].methods&&ScriptModuleMap[t.name].methods[t.method])return await ScriptModuleMap[t.name].methods[t.method](...t.args||[])}}const attach=function(t){if(t.invalid)return;if(!t.info.contributions||!t.info.contributions["asset-db"])return;const e=t.info.contributions["asset-db"];if(e.script)try{if(e.script){const a=require(path_1.join(t.path,e.script));a.load&&a.load(),ScriptModuleMap[t.name]=a}}catch(t){console.log(t)}},detach=function(t){const e=t.info.contributions["asset-db"];if(ScriptModuleMap[t.name]){const a=ScriptModuleMap[t.name];delete ScriptModuleMap[t.name],a.unload&&a.unload(),delete require.cache[path_1.join(t.path,e.script)]}},pkgs=Editor.Package.getPackages({enable:!0});pkgs.forEach(attach),Editor.Package.on("enable",attach),Editor.Package.on("disable",detach),exports.default=new PluginManager;