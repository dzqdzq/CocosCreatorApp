"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const asset_db_1=require("@editor/asset-db"),cc_1=require("cc"),fs_extra_1=require("fs-extra"),path_1=require("path"),plist=require("plist");class ParticleImporter extends asset_db_1.Importer{get version(){return"1.0.0"}get name(){return"particle"}async validate(e){return void 0!==plist.parse(await fs_extra_1.readFile(e.source,"utf8")).maxParticles}async import(e){let t=!1;if(!await e.existsInLibrary(".json")){const r=plist.parse(await fs_extra_1.readFile(e.source,"utf8")),s=this.createParticle(e);if(r.textureFileName){let t=path_1.join(path_1.dirname(e.source),r.textureFileName);if(path_1.extname(r.textureFileName)||(t+=".png"),this.assetDB){const r=this.assetDB.pathToUuid[t];e.depend(t),r?s.texture=EditorExtends.serialize.asAsset(r,cc_1.Texture2D):console.warn("Can not find texture %s specified in %s",t,e.source)}}await e.saveToLibrary(".json",EditorExtends.serialize(s)),t=!0}return t}createParticle(e){const t=new cc.ParticleAsset;return t.name=e.basename,t._setRawAsset(e.extname),t}}exports.default=ParticleImporter;