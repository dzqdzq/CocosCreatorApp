"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unload=exports.load=exports.methods=void 0;const express_1=require("./express"),plugin_1=require("./plugin"),utils_1=require("./utils");async function load(){if(Editor.Package.getPackages({enable:!0}).forEach(plugin_1.attach),Editor.Package.__protected__.on("enable",plugin_1.attach),Editor.Package.__protected__.on("disable",plugin_1.detach),!await Editor.Profile.getConfig("server","server_port","local")){const e=await Editor.Profile.getConfig("server","server_port","global")||7456;await Editor.Profile.setConfig("server","server_port",e,"local")}(0,express_1.startup)()}function unload(){(0,express_1.stop)()}exports.methods={queryPort:()=>(0,express_1.getPort)(),queryIPList:()=>Editor.Network.queryIPList(),querySortIpList:()=>Editor.Network.queryIPList().sort((e,t)=>e.startsWith("192.168")?t.startsWith("192.168")?0:-1:t.startsWith("192.168")?1:0),scanLAN:async()=>(await(0,utils_1.scan)()).filter(Boolean),async"change-preview-port"(e,t){(0,express_1.getPort)()!==t&&Editor.Task.addNotice({title:Editor.I18n.t("server.server_port_change_tips"),source:"server"})},async"change-https-options"(e,t){("enable"===e||await Editor.Profile.getConfig("server","https.enable"))&&Editor.Task.addNotice({title:Editor.I18n.t("server.https.change_tips"),source:"server"})}},exports.load=load,exports.unload=unload;