"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.scan=void 0;const os_1=__importDefault(require("os"));function getIPAdress(){const t=[],e=os_1.default.networkInterfaces();for(const r in e){const s=e[r];if(s)for(let e=0;e<s.length;e++){const r=s[e];"IPv4"!==r.family||"127.0.0.1"===r.address||r.internal||t.push(r)}}return t}async function scan(){const t=getIPAdress().map(t=>{const e=t.netmask.split(".").map(t=>Number(t)),r=t.address.split(".").map(t=>Number(t));return e.map((t,e)=>{const s=t&r[e];return[s,s+(255-t)]})}),e=[[]];let r=0,s=!1;for(const n of t)for(let t=n[0][0];t<=n[0][1];t++)for(let o=n[1][0];o<=n[1][1];o++)for(let a=n[2][0];a<=n[2][1];a++)for(let c=n[3][0];c<=n[3][1];c++){if(!1===s){s=!0;continue}const n=e[r];n.push(new Promise(async e=>{setTimeout(()=>{e(null)},1e4);for(let r=7456;r<7460;r++)Editor.Network.get(`http://${t}.${o}.${a}.${c}:${r}/__server__/handshake`).then(s=>{if(s)try{const n=JSON.parse(s.toString());return n.ip=`${t}.${o}.${a}.${c}`,n.port=r,e(n)}catch(t){return}else e(null)})})),n.length>=100&&(e[++r]=[])}const n=[];for(const t of e)t&&t.length&&(await Promise.all(t)).forEach(t=>t&&n.push(t));return n}exports.scan=scan;