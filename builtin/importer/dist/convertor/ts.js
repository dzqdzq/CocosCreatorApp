"use strict";var __awaiter=this&&this.__awaiter||function(t,e,r,s){return new(r||(r=Promise))(function(i,o){function n(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(n,a)}c((s=s.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TSImporter=void 0;const base_1=require("../common/base"),utlis_1=require("../common/utlis"),parseCode_1=require("../common/parseCode");class TSImporter extends base_1.ImporterBase{constructor(){super(...arguments),this.type="script"}import(t){return __awaiter(this,void 0,void 0,function*(){try{this._3dMeta.ver="4.0.21",this._3dMeta.importer="typescript";let t=this.pathInfo.name;t=yield utlis_1.scriptName.getValidClassName(t);let e=this.readFileSync();if(e){let r="";e.trim().split("\n").forEach(t=>{r+="// "+t+"\n"});const s=yield parseCode_1.parseTSCode(t,this.sourceFsPath);this._2dTo3dSource=s.content,this._2dTo3dSource+="/**\n",this._2dTo3dSource+=` * ${Editor.I18n.t("importer.plugin_js_tips")}\n`,this._2dTo3dSource+=" */\n",this._2dTo3dSource+=r,utlis_1.scriptList.set(t,this.destFsPath)}return!0}catch(t){return console.error(t+",\n this file path: "+this.sourceFsPath),!1}})}}exports.TSImporter=TSImporter;