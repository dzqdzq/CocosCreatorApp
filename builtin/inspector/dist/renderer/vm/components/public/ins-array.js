"use strict";function data(){return{data:[]}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.data=exports.watch=exports.methods=exports.components=exports.props=exports.template=void 0,exports.template='\n<ui-drag-area class="ins-array"\n    v-if="dump"\n    :droppable="type"\n    @drop="onDrop()"\n>\n    <ui-section no-border ref="uiSection"\n        v-if="dump"\n        :expand="$root.expand(expandPrefix+name)"\n        :expand-key="expandPrefix+name"\n    >\n        <div class="header" slot="header">\n            <div class="prop-name"\n                v-if="name"\n            >\n                <ui-label\n                    :tooltip="title"\n                >{{name}}</ui-label>\n                <ui-icon value="lock"\n                    v-if="readonly || dump.readonly"\n                ></ui-icon>\n            </div>\n            <ins-resize-line></ins-resize-line>\n            <div class="prop-content">\n                <span\n                    v-if="dumps && dumps.length > 1"\n                >\n                    Unable to merge operations\n                </span>\n                <ui-num-input path="length" min="0" max="10000" step="1" ref="lengthInput"\n                    v-else\n                    :disabled="readonly || dump.readonly"\n                    :value="dump.value.length"\n                    @change.stop="expandArray"\n                ></ui-num-input>\n            </div>\n        </div>\n\n        \x3c!-- 以下判断中 !dumps && dump.value.length !== 0 是因为资源的格式化数据缺少 dumps  --\x3e\n        <div class="array"\n            v-if="(dumps && dumps.length === 1 && dump.value.length !== 0) || (!dumps && dump.value.length !== 0)"\n        >\n            <div class="array-item"\n                v-for="(item, index) in dump.value"\n                :key="index"\n                :index=\'index\'\n                @dragleave="onSortDragLeave"\n                @dragover="onSortDragOver"\n                @drop="onSortDrop"\n                @change.stop\n                @confirm.stop\n            >\n                <ins-prop auto="true"\n                    :expand-prefix="expandPrefix+name"\n                    :readonly="readonly || dump.readonly"\n                    :dump="item"\n                ></ins-prop>\n                <ui-icon class="ins-prop i-del" value="del" color="true"\n                    v-if="!(readonly || dump.readonly)"\n                    @click="onDelete(index)"\n                    tooltip="Remove"\n                ></ui-icon>\n                <span class="drag-handle" draggable="true" title="Drag to sort"\n                    :index=\'index\'\n                    @dragstart.stop="onSortDragStart"\n                ></span>\n            </div>\n        </div>\n    </ui-section>\n</ui-drag-area>\n',exports.props=["title","name","type","dump","dumps","readonly","expandPrefix"],exports.components={"ins-prop":require("./ins-prop"),"ins-resize-line":require("./ins-resize-line")},exports.methods={onDrop(){const e=this;if(!e.$el.hoving)return;const n=[],{additional:t,value:r}=JSON.parse(JSON.stringify(Editor.UI.DragArea.currentDragInfo))||{};if(t&&t.forEach(t=>{t.type===e.type&&n.push(t.value)}),r&&!n.includes(r)&&n.push(r),!n.length)return;const a=n.length+e.dump.value.length;e.$refs.lengthInput.value=a,e.$refs.lengthInput.dispatch("confirm"),e.dragUuids=n},onSortDragStart(e){e.stopPropagation();const n=e.target.getAttribute("index")||"";e.dataTransfer.setData("index",n);const t=this.dump.path||`${this.dump.type}-${this.dump.name}`;e.dataTransfer.setData("vertifyKey",t),this.$root._dataTransferVertifyKey=t},onSortDragOver(e){const n=this;if(e.preventDefault(),n.readonly||n.dump.readonly)return;if((n.dump.path||`${n.dump.type}-${n.dump.name}`)!==n.$root._dataTransferVertifyKey)return;if(-1===e.dataTransfer.types.indexOf("index"))return;const t=e.currentTarget,r=t.getBoundingClientRect();let a="after";e.clientY-r.top<=5?a="before":r.bottom-e.clientY<=5&&(a="after"),t.setAttribute("insert",a)},onSortDragLeave(e){e.currentTarget.removeAttribute("insert")},onSortDrop(e){const n=this;if(n.readonly||n.dump.readonly)return;if((n.dump.path||`${n.dump.type}-${n.dump.name}`)!==e.dataTransfer.getData("vertifyKey"))return;const t=e.currentTarget,r=t.getAttribute("insert");if(!r)return;const a=Number(e.dataTransfer.getData("index"));let i=Number(t.getAttribute("index"));"after"===r&&(i+=1),n.dump.value.splice(i,0,n.dump.value[a]),a>i?n.dump.value.splice(a+1,1):n.dump.value.splice(a,1),n.emitConfirm(),t.removeAttribute("insert")},onDelete(e){this.dump.value.splice(e,1),this.emitConfirm()},emitConfirm(){const e=document.createEvent("HTMLEvents");e.initEvent("confirm",!0,!0),this.$el.dispatchEvent(e)},expandArray(){this.$refs.uiSection.setAttribute("expand",!0)}},exports.watch={"dump.value"(){const e=this;if(e.$refs.lengthInput&&e.$refs.lengthInput.setAttribute("value",e.dump.value.length),e.dragUuids&&e.dragUuids.length){const{length:n}=e.dragUuids,t=e.dump.value.length-n;e.dragUuids.forEach((n,r)=>{e.dump.value[t+r].value.uuid=n}),e.dragUuids=null,e.emitConfirm()}}},exports.data=data;