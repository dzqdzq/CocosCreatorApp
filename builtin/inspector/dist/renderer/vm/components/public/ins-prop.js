"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.data=exports.watch=exports.methods=exports.components=exports.props=exports.template=void 0;const event_1=require("../../event"),utils_1=require("../../utils");function data(){return{snapshotTimer:null,snapshotLock:!1}}function mounted(){}exports.template=utils_1.readTemplate("./public/prop.html"),exports.props=["dump","dumps","auto","empty","expandPrefix","name","readonly","radian"],exports.components={"ins-resize-line":require("./ins-resize-line"),"ins-unknown":require("./ins-unknown"),"ins-array":require("./ins-array"),"ins-null":require("./ins-null"),"ins-number":require("./ins-number"),"ins-bool":require("./ins-bool"),"ins-string":require("./ins-string"),"ins-size":require("./ins-size"),"ins-vec2":require("./ins-vec2"),"ins-vec3":require("./ins-vec3"),"ins-vec4":require("./ins-vec4"),"ins-mat4":require("./ins-mat4"),"ins-enum":require("./ins-enum"),"ins-bit-mask":require("./ins-bit-mask"),"ins-color":require("./ins-color"),"ins-rect":require("./ins-rect"),"ins-node":require("./ins-node"),"ins-asset":require("./ins-asset"),"ins-component":require("./ins-component"),"ins-object":require("./ins-object"),"ins-depend":require("./ins-depend"),"ins-animation-curve":require("./ins-animation-curve"),"ins-curve-range":require("./ins-curve-range"),"ins-gradient":require("./ins-gradient"),"ins-gradient-range":require("./ins-gradient-range"),"ins-click-event":require("./ins-click-event"),"ins-render-flow":require("./ins-render-flow"),"ins-render-stage":require("./ins-render-stage"),"ins-skeletal-animation-socket":require("./ins-skeletal-animation-socket"),"ins-spine-animation-socket":require("./ins-spine-animation-socket"),"ins-dragonbones-animation-socket":require("./ins-dragonbones-animation-socket")},exports.methods={async _onChange(e){const n=this,t=n.dump;if(t&&!n.isDialoging){if(t.isRPP)return this.onRppArrayChange(e),e.stopPropagation(),void n.$root.$refs.asset._onConfirm();if(t.isMat)this.onMatInspectorArrayChange(e);else if(t.path){if(e.stopPropagation(),!1===n.snapshotLock&&(Editor.Message.send("scene","snapshot"),n.snapshotLock=!0),event_1.emit("commit"),"length"===e.target.path)return void n.$root.$emit("set-property",{path:t.path+".length",type:"Array",value:e.target.value});if("layer"===t.path){let i=1;const r=e.target.oldvalue;if(n.$root.$refs.node.dump.children.length>0){n.isDialoging=!0,i=(await Editor.Dialog.warn(Editor.I18n.t("inspector.node.layer.confirm_message"),{buttons:[Editor.I18n.t("inspector.node.layer.change_children"),Editor.I18n.t("inspector.node.layer.change_self"),"Cancel"],cancel:2})).response,n.isDialoging=!1}return void(2===i?void 0!==r&&n.$nextTick(()=>{t.value=r,n.dumps&&n.dumps.forEach(e=>{e.value=r})}):n.$root.$emit("set-property",{path:t.path,loopChild:0===i}))}n.$root.$emit("set-property",{path:t.path})}else;}},_onConfirm(e){this._onChange(e),clearTimeout(this.snapshotTimer),this.snapshotLock=!1},_onCancel(){this.snapshotLock=!1,Editor.Message.send("scene","snapshot-abort")},isType(e){const n=this;return!!n.dump.value&&(n.dump.type===e||!(!n.dump.extends||0===n.dump.extends.length)&&n.dump.extends.includes(e))},getName(e){if(!e)return"";if(e.displayName)return e.displayName;if(this.name)return this.name;let n=e.name||"";return(n=(n=(n=n.replace(/^\S/,e=>e.toUpperCase())).replace(/_/g,e=>" ")).replace(/ \S/g,e=>` ${e.toUpperCase()}`)).trim()},getTitle(e){if(e.tooltip){if(!e.tooltip.startsWith("i18n:"))return e.tooltip;const n=Editor.I18n.t("ENGINE."+e.tooltip.substr(5));return n&&n!==e.tooltip?n:Editor.I18n.t(e.tooltip.substr(5))||e.tooltip}return this.getName(e)},onMatInspectorArrayChange(e){const n=this.dump;if(n.isArray){const t=e.target.value;if(t<n.value.length)n.value.splice(t,n.value.length-t);else{const e=t-n.value.length;for(let t=0;t<e;t++){const e=JSON.parse(JSON.stringify(n.elementTypeData));e.name=""+n.value.length,e.displayName=""+n.value.length,n.value.push(e)}}}},onRppArrayChange(e){const n=this.dump;if(n.isArray){const t=e.target.value;if(t<n.value.length)n.value.splice(t,n.value.length-t);else{let e=null;switch(n.type){case"Float":case"number":case"Number":e=0;break;case"String":e=""}const i=t-n.value.length;for(let t=0;t<i;t++)n.value.push(e)}}}},exports.watch={},exports.data=data,exports.mounted=mounted;