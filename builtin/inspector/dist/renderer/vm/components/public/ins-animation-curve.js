"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.destroyed=exports.mounted=exports.data=exports.watch=exports.methods=exports.components=exports.props=exports.template=void 0;const manager_1=require("../../../../curve-editor/manager");function data(){return{style:{background:"linear-gradient(to right, #fff 0%,#fff 100%)"}}}function mounted(){this.refresh()}function destroyed(){manager_1.close(this)}exports.template='\n<div class="ins-animation-curve">\n\n    <template\n        v-if="dump"\n    >\n        <div class="prop-name"\n            v-if="name"\n        >\n            <ui-label\n                :tooltip="title"\n            >{{name}}</ui-label>\n            <ui-icon value="lock"\n                v-if="readonly || dump.readonly"\n            ></ui-icon>\n        </div>\n        <ins-resize-line></ins-resize-line>\n        <template\n            v-if="dumps && dumps.length > 1"\n        >\n            <div class="prop-content">\n                Unable to merge operations\n            </div>\n        </template>\n\n        <template\n            v-else\n        >\n            <div class="prop-content">\n                <div class="ins-curve"\n                    :disabled="readonly || dump.readonly"\n                    @click.right="reset(\'dump.value.curve\', 1)"\n                >\n                    <canvas ref="thumb"\n                        @click="showEditor(\'curve\')"\n                    ></canvas>\n                </div>\n            </div>\n        </template>\n    </template>\n</div>\n',exports.props=["title","name","dump","dumps","readonly"],exports.components={"ins-prop":require("./ins-prop"),"ins-resize-line":require("./ins-resize-line")},exports.methods={apply(e){const t=this;t.dump.value.keyFrames=e.keyFrames,t.dump.value[e.key].value.preWrapMode=e.preWrapMode,t.dump.value[e.key].value.postWrapMode=e.postWrapMode,this.emitChange(),this.emitConfirm(),process.nextTick(()=>{t.refresh()})},emitChange(){const e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!0),this.$el.dispatchEvent(e)},emitConfirm(){const e=document.createEvent("HTMLEvents");e.initEvent("confirm",!0,!0),this.$el.dispatchEvent(e)},refresh(){if(!this.dump.value)return;const e=this.getThumbCtx("thumb");e&&manager_1.drawCurve(this.dump.value.keyFrames,e,!1)},getThumbCtx(e){if(!this.$refs[e])return console.warn(`${e} is not exist!`),null;const t=this.$refs[e].getContext("2d");return t.canvas.width=t.canvas.offsetWidth,t.canvas.height=t.canvas.offsetHeight,t.strokeStyle="red",t},showEditor(){const e=this;if(e.readonly||e.dump.readonly)return;let t=!1;-1===e.dump.min&&(t=!0),manager_1.open(e.dump,e)},reset(e,t){const n=this;n.dump.value[e].default&&this.apply(Object.assign(Object.assign({},n.dump.value[e].default),{key:e,multiplier:n.dump.value.multiplier.default})),manager_1.update(Object.assign(Object.assign({},n.dump.value[e].default),{key:e,multiplier:n.dump.value.multiplier.default}),n)}},exports.watch={dump(){const e=this;process.nextTick(()=>{e.refresh()})}},exports.data=data,exports.mounted=mounted,exports.destroyed=destroyed;