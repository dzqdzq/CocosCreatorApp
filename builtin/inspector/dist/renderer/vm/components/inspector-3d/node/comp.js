"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.data=exports.computed=exports.watch=exports.methods=exports.components=exports.props=exports.template=void 0;const path_1=require("path"),utils_1=require("../../../utils");exports.template=utils_1.readTemplate("inspector-3d/node/comp.html"),exports.props=["dump","dumps","index","total","uuids"];const componentMap={};exports.components={"ins-prop":require("../../public/ins-prop")};const list=Editor.Package.getPackages({enable:!0});function data(){return{}}function mounted(){}list.forEach(e=>{if(!e||!e.info.contributions||!e.info.contributions.inspector)return;const n=path_1.join(e.path,e.info.contributions.inspector);try{const e=require(n);if(!e.components)return;Object.keys(e.components).forEach(n=>{const t=n.toLowerCase().replace(/\./g,"-");componentMap[n]=t,exports.components[t]=e.components[n],exports.components[t].props=["dump","dumps"];const o={"ins-resize-line":require("../../public/ins-resize-line"),"ins-prop":require("../../public/ins-prop"),"ins-unknown":require("../../public/ins-unknown"),"ins-array":require("../../public/ins-array"),"ins-null":require("../../public/ins-null"),"ins-number":require("../../public/ins-number"),"ins-bool":require("../../public/ins-bool"),"ins-string":require("../../public/ins-string"),"ins-size":require("../../public/ins-size"),"ins-vec2":require("../../public/ins-vec2"),"ins-vec3":require("../../public/ins-vec3"),"ins-vec4":require("../../public/ins-vec4"),"ins-mat4":require("../../public/ins-mat4"),"ins-enum":require("../../public/ins-enum"),"ins-color":require("../../public/ins-color"),"ins-rect":require("../../public/ins-rect"),"ins-node":require("../../public/ins-node"),"ins-asset":require("../../public/ins-asset"),"ins-component":require("../../public/ins-component"),"ins-object":require("../../public/ins-object"),"ins-depend":require("../../public/ins-depend"),"ins-animation-curve":require("../../public/ins-animation-curve"),"ins-curve-range":require("../../public/ins-curve-range"),"ins-gradient":require("../../public/ins-gradient"),"ins-gradient-range":require("../../public/ins-gradient-range"),"ins-click-event":require("../../public/ins-click-event"),"ins-skeletal-animation-socket":require("../../public/ins-skeletal-animation-socket"),"ins-spine-animation-socket":require("../../public/ins-spine-animation-socket"),"ins-dragonbones-animation-socket":require("../../public/ins-dragonbones-animation-socket")};Object.keys(o).forEach(e=>{exports.components[t].components=exports.components[t].components||{},exports.components[t].components[e]=o[e]})})}catch(e){console.error(e)}}),exports.methods={t:e=>Editor.I18n.t(`inspector.${e}`),_onClickComponentMenu(e){const n=this,t=n.uuids.length>1,{left:o,bottom:s}=e.target.getBoundingClientRect(),i=Math.round(o+5),r=Math.round(s+5),p=n.uuids[0],c=n.total,u=n.index;Editor.Menu.popup({x:i,y:r,menu:[{label:Editor.I18n.t("inspector.menu.reset_component"),click(){Editor.Message.send("scene","snapshot"),n.dumps.forEach(e=>{Editor.Message.send("scene","reset-component",{uuid:e.value.uuid.value})})}},{type:"separator"},{label:Editor.I18n.t("inspector.menu.remove_component"),click(){Editor.Message.send("scene","snapshot"),n.dumps.forEach((e,t)=>{const o=n.uuids[t],s=e.path.split(".").pop();Editor.Message.send("scene","remove-array-element",{uuid:o,path:"__comps__",index:s})})}},{label:Editor.I18n.t("inspector.menu.move_up_component"),enabled:!t&&0!==u,click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","move-array-element",{uuid:p,path:"__comps__",target:u,offset:-1})}},{label:Editor.I18n.t("inspector.menu.move_down_component"),enabled:!t&&u!==c-1,click(){Editor.Message.send("scene","snapshot"),Editor.Message.send("scene","move-array-element",{uuid:p,path:"__comps__",target:u,offset:1})}},{type:"separator"},{label:Editor.I18n.t("inspector.menu.copy_component"),enabled:!t,async click(){n.$root.copiedComponent.type=n.dump.type,n.$root.copiedComponent.dump=JSON.parse(JSON.stringify(n.dump))}},{label:Editor.I18n.t("inspector.menu.paste_component_values"),enabled:n.dump.type===n.$root.copiedComponent.type,async click(){Editor.Message.send("scene","snapshot");let e=0;for(const t of n.uuids)await Editor.Message.request("scene","set-property",{uuid:t,path:n.dumps[e].path,dump:n.$root.copiedComponent.dump}),e++}},{type:"separator"},{label:Editor.I18n.t("inspector.menu.paste_component"),enabled:!(!n.$root.copiedComponent.type||!n.$root.copiedComponent.dump),async click(){Editor.Message.send("scene","snapshot");for(const e of n.uuids){await Editor.Message.request("scene","create-component",{uuid:e,component:n.$root.copiedComponent.type});const t=await Editor.Message.request("scene","query-node",e),o=t.__comps__&&t.__comps__.length;if(o){const s=o-1,i=t.__comps__[s];i&&i.type===n.$root.copiedComponent.type&&await Editor.Message.request("scene","set-property",{uuid:e,path:`__comps__.${s}`,dump:n.$root.copiedComponent.dump})}}}}]})},_onDragStart(e){const n=this.dump.value;e.dataTransfer&&e.dataTransfer.setData("value",n.uuid.value)},getCustomComponent(e,n){if(componentMap[e])return componentMap[e];if(n)for(let e=0;e<n.length;e++)if(componentMap[n[e]])return componentMap[n[e]]},shortProp(e){const n=[],t=[];return Object.keys(e).forEach(o=>{const s=e[o];"displayOrder"in s?n.push({key:o,dump:s}):t.push({key:o,dump:s})}),n.sort((e,n)=>e.dump.displayOrder-n.dump.displayOrder),n.concat(t)}},exports.watch={},exports.computed={helpUrl(){const e=this.dump.editor.help;if(!e)return;if(!e.startsWith("i18n:"))return e;const n=e.substr(5),t=Editor.I18n.t("ENGINE.help."+n);return t||Editor.I18n.t(n)}},exports.data=data,exports.mounted=mounted;