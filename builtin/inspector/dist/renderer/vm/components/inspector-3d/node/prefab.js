"use strict";function data(){return{isLostAsset:!0,isSingle:!0,editMode:"",prefabState:0,isUnwrappable:!1,isRevertable:!1,isApplicable:!1}}async function mounted(){await this.checkState(),this.editMode=await Editor.Message.request("scene","query-scene-mode")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mounted=exports.data=exports.watch=exports.methods=exports.props=exports.template=void 0,exports.template='\n<div class="prefab"\n>\n    <ui-label class="title"\n        :lost-asset="isLostAsset"\n        :tooltip="isLostAsset?t(\'lost\'):t(\'exist\')"\n    >Prefab</ui-label>\n    <ui-button tooltip="i18n:inspector.prefab.unlink"\n        :disabled="!(isSingle && isUnwrappable)"\n        @confirm="unlink"\n    >\n        <ui-icon value="unlink"></ui-icon>    \n    </ui-button>\n\n    <ui-button tooltip="i18n:inspector.prefab.local"\n        :disabled="!(!isLostAsset && isSingle)"\n        @confirm="twinkle"\n    >\n        <ui-icon value="location"></ui-icon>\n    </ui-button>\n    <ui-button tooltip="i18n:inspector.prefab.reset"\n        :disabled="!(!isLostAsset && isSingle && isRevertable)"\n        @confirm="reset"\n    >\n        <ui-icon value="reset"></ui-icon>\n    </ui-button>\n    <ui-button tooltip="i18n:inspector.prefab.save"\n        :disabled="!(!isLostAsset && isSingle && isApplicable)"\n        @confirm="update"\n    >\n        <ui-icon value="save-o"></ui-icon>\n    </ui-button>\n</div>\n',exports.props=["dump","dumps"],exports.methods={t:e=>Editor.I18n.t(`inspector.prefab.${e}`),async twinkle(){const e=this.dumps;for(const t of e){if(!t.__prefab__||!t.__prefab__.uuid)continue;const e=t.__prefab__.uuid;await this.checkAssetExist(e)&&Editor.Message.send("assets","twinkle",e)}},async reset(){const e=this;Editor.Message.send("scene","snapshot");const t=e.dumps;for(const s of t){if(!s.__prefab__||!s.__prefab__.uuid)continue;const t=s.__prefab__.rootUuid,i=s.__prefab__.uuid;await e.checkAssetExist(i)&&await Editor.Message.request("scene","restore-prefab",t,i)}},async update(){const e=this,t=e.dumps;for(const s of t){if(!s.__prefab__||!s.__prefab__.uuid)continue;const t=s.__prefab__.rootUuid,i=s.__prefab__.uuid;if(await e.checkAssetExist(i)){await Editor.Message.request("scene","apply-prefab",t)}}},async unlink(){await Editor.Message.request("hierarchy","unlink-prefab")},async link(){await Editor.Message.request("hierarchy","link-prefab")},async checkState(){const e=this;e.isSingle=1===e.dumps.length;let t=!0;for(const s of e.dumps){if(!s.__prefab__)continue;const i=s.__prefab__.prefabStateInfo;(e.prefabState=i.state,e.isUnwrappable=i.isUnwrappable,e.isRevertable=i.isRevertable,e.isApplicable=i.isApplicable,s.__prefab__.uuid)&&(await Editor.Message.request("asset-db","query-asset-info",s.__prefab__.uuid)&&(t=!1))}e.isLostAsset=t},async checkAssetExist(e){const t=await Editor.Message.request("asset-db","query-asset-info",e);return t||(await Editor.Dialog.warn(this.t("lost"),{title:Editor.I18n.t("hierarchy.operate.dialogWarning")}),this.checkState(),null)}},exports.watch={dumps(){this.checkState()},dump(){this.checkState()}},exports.data=data,exports.mounted=mounted;