"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const asset_db_1=require("@editor/asset-db"),index_1=require("./scene/index"),migrates_1=require("./scene/migrates"),fs_extra_1=require("fs-extra");class PrefabImporter extends asset_db_1.Importer{get version(){return index_1.version}get name(){return"prefab"}get assetType(){return"cc.Prefab"}get migrations(){return migrates_1.migrations}get migrationHook(){return{async pre(e){e.getSwapSpace().json=await fs_extra_1.readJSON(e.source)},async post(e,s){const a=e.getSwapSpace();if(s>0){const s=JSON.stringify(a.json,null,2);await fs_extra_1.writeFile(e.source,s)}delete a.json}}}async import(e){const s=await fs_extra_1.readJSON(e.source),a=s[0].asyncLoadAssets!==!!e.userData.asyncLoadAssets||s[1]._name!==e.basename;a&&(s[1]._name=e.basename,s[0].asyncLoadAssets=!!e.userData.asyncLoadAssets);const r=JSON.stringify(s,void 0,2);return a&&await fs_extra_1.writeFile(e.source,r),await e.saveToLibrary(".json",r),e.userData.syncNodeName=e.basename,!0}}exports.default=PrefabImporter;