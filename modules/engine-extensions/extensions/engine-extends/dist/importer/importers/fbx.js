"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FbxImporter=void 0;const gltf_1=__importDefault(require("./gltf")),fbx_to_gltf_1=require("./gltf/fbx-to-gltf"),fbx_converter_1=require("./utils/fbx-converter"),model_convert_routine_1=require("./utils/model-convert-routine");class FbxImporter extends gltf_1.default{get version(){return super.version}get name(){return"fbx"}async getGltfFilePath(e){var t,r,i,o,a,l,n;const s=e.userData;let f;if(void 0===(null===(t=s.fbx)||void 0===t?void 0:t.smartMaterialEnabled)&&((null!==(r=s.fbx)&&void 0!==r?r:s.fbx={}).smartMaterialEnabled=await Editor.Profile.getProject("project","fbx.material.smart")),s.legacyFbxImporter)f=await fbx_to_gltf_1.fbxToGlTf(e,this.assetDB,this.version);else{const t={};t.unitConversion=null===(i=s.fbx)||void 0===i?void 0:i.unitConversion,t.animationBakeRate=null===(o=s.fbx)||void 0===o?void 0:o.animationBakeRate,t.preferLocalTimeSpan=null===(a=s.fbx)||void 0===a?void 0:a.preferLocalTimeSpan,t.smartMaterialEnabled=null!==(n=null===(l=s.fbx)||void 0===l?void 0:l.smartMaterialEnabled)&&void 0!==n&&n;const r=fbx_converter_1.createFbxConverter(t),u=await model_convert_routine_1.modelConvertRoutine("fbx.FBX-glTF-conv",e,this.assetDB,this.version,r);if(!u)throw new Error(`Failed to import ${e.source}`);f=u}return s.meshOptimizer&&s.meshOptimizer.enable?await this.getOptimizerPath(e,f,s.meshOptimizer):f}}exports.FbxImporter=FbxImporter;