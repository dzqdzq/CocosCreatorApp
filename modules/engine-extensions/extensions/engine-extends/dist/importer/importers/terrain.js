"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TerrainImporter=void 0;const fs=__importStar(require("fs-extra")),asset_db_1=require("@editor/asset-db"),index_1=require("./scene/index"),cc_1=require("cc"),utils_1=require("../utils");class TerrainImporter extends asset_db_1.Importer{get version(){return index_1.version}get name(){return"terrain"}get assetType(){return"cc.TerrainAsset"}async import(e){await e.copyToLibrary(".bin",e.source);const t=new cc_1.TerrainAsset;if(t._loadNativeData(fs.readFileSync(e.source))){t.layerInfos.length=t.layerBinaryInfos.length;for(let e=0;e<t.layerInfos.length;++e){const r=t.layerBinaryInfos[e],a=new cc_1.TerrainLayerInfo;a.slot=r.slot,a.tileSize=r.tileSize,r.detailMapId&&""!=r.detailMapId&&(a.detailMap=EditorExtends.serialize.asAsset(r.detailMapId,cc_1.Texture2D)),r.normalMapId&&""!=r.normalMapId&&(a.normalMap=EditorExtends.serialize.asAsset(r.normalMapId,cc_1.Texture2D)),a.metallic=r.metallic,a.roughness=r.roughness,t.layerInfos[e]=a}}t.name=e.basename,t._setRawAsset(".bin");const r=EditorExtends.serialize(t);await e.saveToLibrary(".json",r);const a=utils_1.getDependUUIDList(r);return e.setData("depends",a),!0}}exports.TerrainImporter=TerrainImporter;