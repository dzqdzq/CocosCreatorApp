"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.version=exports.SceneImporter=void 0;const asset_db_1=require("@editor/asset-db"),migrates_1=require("./migrates"),fs_extra_1=require("fs-extra"),path_1=require("path"),utils_1=require("../../utils");class SceneImporter extends asset_db_1.Importer{get version(){return exports.version}get name(){return"scene"}get assetType(){return"cc.SceneAsset"}get migrations(){return migrates_1.migrations}get migrationHook(){return migrates_1.migrationHook}async import(e){const t=await(0,fs_extra_1.readJSON)(e.source),r=(0,path_1.basename)(e.source,(0,path_1.extname)(e.source));let s=t[0]._name!==r;s&&(t[0]._name=r);try{s=s||(0,utils_1.removeNull)(t,e.uuid)}catch(e){console.debug(e)}if(t[1]._id!==e.uuid&&(s=!0,t[1]._id=e.uuid),s){const r=JSON.stringify(t,void 0,2);await(0,fs_extra_1.writeFile)(e.source,r)}const i=JSON.stringify(t,void 0,2);await e.saveToLibrary(".json",i);const o=(0,utils_1.getDependList)(i);return e.setData("depends",o.uuids),e.setData("dependScripts",o.dependScriptUuids),!0}}exports.SceneImporter=SceneImporter,exports.version="1.1.50";