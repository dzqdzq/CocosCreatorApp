"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zip=void 0;const asset_db_1=require("@editor/asset-db"),fs_extra_1=require("fs-extra"),path_1=require("path");class AssetImporter extends asset_db_1.Importer{get version(){return"1.0.0"}get name(){return"instantiation-asset"}get assetType(){return"cc.Asset"}async import(e){const t=(0,path_1.join)(e._assetDB.options.temp,e.uuid),r="darwin"===process.platform?"unzip":(0,path_1.join)(Editor.App.path,"../tools/unzip.exe");await Editor.Utils.Process.quickSpawn(r,[e.source,"-d",t]);const s=(0,fs_extra_1.readdirSync)(t);for(let r=0;r<s.length;r++){const a=s[r],o=(0,path_1.join)(t,a);await e.copyToLibrary("."+a,o)}return(0,fs_extra_1.existsSync)(t)&&(0,fs_extra_1.removeSync)(t),!0}}function zip(e,t){const r=require("archiver"),s=(0,fs_extra_1.createWriteStream)(e),a=r("zip");a.on("error",e=>{throw e}),a.pipe(s),t.forEach(e=>{const t=(0,path_1.parse)(e);a.append((0,fs_extra_1.createReadStream)(e),{name:t.ext.substr(1)})}),a.finalize()}exports.default=AssetImporter,exports.zip=zip;