import _UTIL from"../../util";let _rt=loadRuntime(),_listeners=[];if(ral.device=ral.device||{},_rt.offAccelerometerChange){if(1===_rt._compatibleMode){let e=_rt.getSystemInfoSync(),r="android"===e.platform.toLowerCase(),n=function(t){r?(t.x/=-10,t.y/=-10,t.z/=-10):(t.x/=10,t.y/=10,t.z/=10),_listeners.forEach(function(e){e(t)})},l=_rt.onAccelerometerChange.bind(_rt),o=(ral.onAccelerometerChange=function(t){if("function"==typeof t){var r=_listeners.length;for(let e=0;e<r;++e)if(t===_listeners[e])return;_listeners.push(t),1===_listeners.length&&l(n)}},_rt.offAccelerometerChange.bind(_rt));ral.offAccelerometerChange=function(t){var r=_listeners.length;for(let e=0;e<r;++e)if(t===_listeners[e]){_listeners.splice(e,1),0===_listeners.length&&o(n);break}}}else ral.onAccelerometerChange=_rt.onAccelerometerChange.bind(_rt),ral.offAccelerometerChange=_rt.offAccelerometerChange.bind(_rt);ral.stopAccelerometer=_rt.stopAccelerometer.bind(_rt);let t=_rt.startAccelerometer.bind(_rt);ral.startAccelerometer=function(e){return t(Object.assign({type:"accelerationIncludingGravity"},e))}}else{ral.onAccelerometerChange=function(t){if("function"==typeof t){var r=_listeners.length;for(let e=0;e<r;++e)if(t===_listeners[e])return;_listeners.push(t)}},ral.offAccelerometerChange=function(t){var r=_listeners.length;for(let e=0;e<r;++e)if(t===_listeners[e])return void _listeners.splice(e,1)};let e=_rt.getSystemInfoSync(),r="android"===e.platform.toLowerCase();jsb.device.dispatchDeviceMotionEvent=function(e){let t=Object.assign({},e._accelerationIncludingGravity);r?(t.x/=-10,t.y/=-10,t.z/=-10):(t.x/=10,t.y/=10,t.z/=10),_listeners.forEach(function(e){e({x:t.x,y:t.y,z:t.z})})},ral.stopAccelerometer=function(){jsb.device.setMotionEnabled(!1)},ral.startAccelerometer=function(){jsb.device.setMotionEnabled(!0)}}