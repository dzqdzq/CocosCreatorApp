let md5=require("../../lib/md5.min"),fileMgr=ral.getFileSystemManager(),cacheDir=ral.env.USER_DATA_PATH+"/fileCache/";class FileCache{constructor(){this._caches={}}getCache(e){e=FileCache._genDataKey(e);return e in this._caches?this._caches[e]:""}setCache(e,t){t=FileCache._genDataKey(t);this._caches[t]=e}setItem(e,t,a,i){a=a||FileCache._genDataKey(e);let c=this._caches;a in c?i&&i(c[a]):t||(t=cacheDir+a,fileMgr.writeFile({filePath:t,data:e,encoding:"binary",success(){c[a]=t,i&&i(t)},fail(){throw i&&i(),t+"writeFile fail!"}}))}getPath(e,t){var a=FileCache._genDataKey(e),i=this._caches;a in i?t(i[a]):this.setItem(e,void 0,a,t)}static _genDataKey(e){var t=new DataView(e),e=t.byteLength/4;let a=10;var i=e/a;let c="length:"+e;for(c=(c+="first:"+t.getInt32(0))+("last:"+t.getInt32(e-1));a--;)c+=a+":"+t.getInt32(Math.floor(i*a));return md5(c)}}try{fileMgr.accessSync(cacheDir),fileMgr.rmdirSync(cacheDir,!0)}catch(e){}fileMgr.mkdirSync(cacheDir,!0);export default new FileCache;