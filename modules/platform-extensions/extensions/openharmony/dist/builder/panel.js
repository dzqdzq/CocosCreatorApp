"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.template=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra"),options_1=require("./options"),lodash=require("lodash");let panel;exports.template=(0,fs_extra_1.readFileSync)((0,path_1.join)(__dirname,"../../static/builder/view.html"),"utf8");const methods={t(a,t){return Editor.I18n.t("openharony."+a,t)},getDefaultPackageName(){return options_1.defaultOptions.packageName},async onChange(a){var t=a.target.value,a=a.target.getAttribute("path");await this.onUpdateOptions(a,t)},async onUpdateOptions(a,t){var e;a&&(e=this,"apiLevel"===a&&(t=Number(t)),lodash.set(e.pkgOptions,a,t),t=await(0,options_1.verificationFunc)(a,t,panel.options),e.pkgErrorMap[a]=t.error,e.emitChange())},async onChangeJsEngine(){},async onChangeABI(a,t){var e=this,a=a.target.value;Array.isArray(e.pkgOptions.appABIs)||(e.pkgOptions.appABIs=[]),a?e.pkgOptions.appABIs.push(t):e.pkgOptions.appABIs.splice(e.pkgOptions.appABIs.indexOf(t),1),await e.onUpdateOptions("appABIs",e.pkgOptions.appABIs)},emitChange(){var a=this;panel.dispatch("update","packages."+a.pkgName,a.pkgOptions,a.pkgErrorMap)},async init(){var a=this;a.pkgOptions=lodash.get(panel.options,"packages."+panel.options.platform)||{};for(const e of Object.keys(options_1.defaultOptions)){var t=await(0,options_1.verificationFunc)(e,a.pkgOptions[e],panel.options);a.pkgErrorMap[e]=t.error}this.emitChange()}};async function update(a,t){panel=this,t&&!t.startsWith("packages."+panel.pkgName)||(panel.options=a,panel.vm.init())}function ready(a,t,e,p){panel=this;var o=BuildPanel.Vue;panel.options=a,panel.pkgName=e,panel.errorMap=p,panel.vm=new o({el:panel.$.root,data(){return{pkgName:e,type:t,pkgOptions:options_1.defaultOptions,pkgErrorMap:options_1.defaultOptions,appABIList:["armeabi-v7a","arm64-v8a"]}},async mounted(){var a=this;"check"===a.type?(a.pkgOptions=lodash.get(panel.options,"packages."+panel.pkgName)||{},a.pkgErrorMap={}):a.init()},methods:methods})}exports.$={root:".openharmony"},exports.update=update,exports.ready=ready;