"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.methods=exports.$=exports.template=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),migu_preview_cli_1=require("./migu-preview-cli"),fixPath=require("fix-path");let panel=null,vm;const Vue=require("vue/dist/vue.js");async function ready(e){panel=this,fixPath(),vm=new Vue({el:panel.$["migu-preview"],data:{previewUrl:"",rpkPath:e},computed:{tips(){return this.rpkPath?this.previewUrl?Editor.I18n.t("migu-mini-game.debug_tools.start_run_server"):Editor.I18n.t("migu-mini-game.debug_tools.waiting_to_run_server"):Editor.I18n.t("migu-mini-game.debug_tools.please_rebuild")}},methods:{async updateRpkPath(e){var i=this;!(0,fs_1.existsSync)(e)&&i.previewUrl?i.msg=Editor.I18n.t("migu-mini-game.debug_tools.please_rebuild"):i.previewUrl=await new Promise((r,t)=>{migu_preview_cli_1.previewManager.run(e,(e,i)=>{e?t(e):r(i)})})}}})}async function beforeClose(){}async function close(){migu_preview_cli_1.previewManager.kill()}Vue.config.productionTip=!1,Vue.config.devtools=!1,exports.style=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../dist/migu-preview.css"),"utf8"),exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../static/migu-preview.html"),"utf8"),exports.$={"migu-preview":".migu-preview",preview:".preview"},exports.methods={"update-rpk-path"(e){vm.updateRpkPath(e)}},exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;