"use strict";function checkPackageNameValidity(e){return/^[a-zA-Z]\w*(\.[a-zA-Z]\w*)+$/.test(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOptions=void 0,exports.checkPackageNameValidity=checkPackageNameValidity,exports.translate=translate,exports.verificationFunc=verificationFunc,exports.checkAndroidAPILevels=checkAndroidAPILevels,exports.getVerifyMap=getVerifyMap,exports.checkIsEmpty=checkIsEmpty;const MaxAspectRatioOptRegex=/^\s*(\d+(\.\d+)?)\s*(\(\s*(\d+)\s*:\s*(\d+)\s*\)\s*)?$/,MaxAspectRatioFractionRegex=/^\s*(\d+)\s*:\s*(\d+)\s*$/;function translate(e){return Editor.I18n.t("google-play."+e)}async function verificationFunc(e,t,a){const r={error:"",newValue:t,level:"error"};switch(e){case"packageName":checkIsEmpty(t)?(r.newValue=exports.defaultOptions.packageName,r.error=translate("tips.not_empty")):checkPackageNameValidity(t)||(r.newValue=exports.defaultOptions.packageName,r.error=translate("tips.package_name_error"));break;case"appABIs":if(t&&t.length)break;return r.error=translate("tips.at_least_one"),r;case"renderBackEnd":if(!t)return r.error=translate("tips.not_empty"),r;if(Object.keys(t).every(e=>!t[e]))return r.error=translate("tips.at_least_one"),r;break;case"apiLevel":return checkAndroidAPILevels(t,a);case"maxAspectRatio":if(a.packages["google-play"].resizeableActivity)break;if(t&&0!==t.trim().length){var s=t.match(MaxAspectRatioOptRegex),o=(e,t)=>{e=Number.parseInt(e),t=Number.parseInt(t);if(0===e||0===t||e/t<1.33)return r.error=translate("tips.mar_bad_value"),r};s?s[3]?(r.newValue=s[4]+":"+s[5],o(s[4],s[5])):(r.newValue=s[1],Number.parseFloat(r.newValue)<1.33&&(r.error=translate("tips.mar_bad_value"))):(s=t.match(MaxAspectRatioFractionRegex))?(r.newValue=s[1]+":"+s[2],o(s[1],s[2])):r.error=translate("tips.mar_format")}else r.error=translate("tips.mar_empty");return r;case"orientation":if(!t)return r.error=translate("tips.not_empty"),r;if(Object.keys(t).every(e=>!t[e]))return r.error=translate("tips.at_least_one"),r;break;case"keystorePath":a.packages["google-play"].useDebugKeystore||checkIsEmpty(t)&&(r.error=translate("KEYSTORE.error.keystore_path_empty"));break;case"keystorePassword":case"keystoreAlias":case"keystoreAliasPassword":a.packages["google-play"].useDebugKeystore||checkIsEmpty(t)&&(r.error=translate("tips.not_empty"));break;case"remoteUrl":if(!a.packages["google-play"].androidInstant||checkIsEmpty(t))return r;t.startsWith("http")||(r.error="remoteUrl  should start with http")}return r}async function checkAndroidAPILevels(e,t){var a={newValue:e,error:"",level:"error"};return checkIsEmpty(e)&&(a.error="API Level"+translate("tips.not_empty")),isNaN(e)?a.error="API Level"+translate("tips.not_empty"):(e=e,t.packages["google-play"].androidInstant&&e<23?(a.error=Editor.I18n.t("android.tips.when_enable_instant")+Editor.I18n.t("android.tips.apilevel_limit",{version:"23"}),a.newValue=23):"tbb"===t.packages.native.JobSystem&&e<21?(a.error=Editor.I18n.t("android.tips.when_enable_tbb")+Editor.I18n.t("android.tips.apilevel_limit",{version:"21"}),a.newValue=21):"5d45ba66-829a-46d3-948e-2ed3fa7ee421"===await Editor.Profile.getProject("project","general.renderPipeline")&&e<21?(a.error=Editor.I18n.t("android.tips.when_enable_deferred")+Editor.I18n.t("android.tips.apilevel_limit",{version:"21"}),a.newValue=21):e<19&&(a.error=Editor.I18n.t("android.tips.apilevel_limit",{version:"19"}),a.newValue=19)),a}function getVerifyMap(){const e={};return["packageName","apiLevel","keystorePath","keystorePassword","keystoreAlias","keystoreAliasPassword"].forEach(a=>{e[a]=(e,t)=>verificationFunc(a,e,t)}),e}function checkIsEmpty(e){return null==e||""===e}exports.defaultOptions={packageName:"",resizeableActivity:!0,maxAspectRatio:"2.4",orientation:{portrait:!1,upsideDown:!1,landscapeRight:!0,landscapeLeft:!0},apiLevel:26,appABIs:["arm64-v8a"],useDebugKeystore:!0,keystorePath:"",keystorePassword:"",keystoreAlias:"",keystoreAliasPassword:"",appBundle:!0,androidInstant:!1,googleBilling:!0,playGames:!0,inputSDK:!1,remoteUrl:"",sdkPath:"",ndkPath:"",javaHome:"",javaPath:"",renderBackEnd:{vulkan:!0,gles3:!1,gles2:!1},swappy:!1,adpf:!0,customIcon:"default"};