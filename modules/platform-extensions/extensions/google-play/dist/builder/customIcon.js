"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeCustomIcon=exports.getCustomIconInfo=exports.saveCustomIcon=exports.getDisplayCustomIcon=exports.ICON_DPI_LIST=void 0;const sharp_1=__importDefault(require("sharp")),fs_extra_1=require("fs-extra"),path_1=require("path"),SETTING_ROOT=(0,path_1.join)(Editor.Project.path,"settings/icons");function getCustomIconInfoImpl(t,o){let a="";switch(t){case"default":a=(0,path_1.join)(__dirname,"../../static/icons");break;case"custom":a=(0,path_1.join)(SETTING_ROOT,o)}let n="";var e=Object.keys(exports.ICON_DPI_LIST).map(t=>{var o=t,e="ic_launcher.png",s=(0,path_1.join)(a,o,e);return"mipmap-xxxhdpi"===t&&(n=s+"?timestamp="+Date.now()),{dirName:o,fileName:e,dpi:exports.ICON_DPI_LIST[t],path:s}});return{type:t,display:n,list:e}}function hasCustomIcon(t){return(0,fs_extra_1.existsSync)(t.list[0].path)}function getDisplayCustomIcon(t,o){t=getCustomIconInfoImpl(t,o);return(hasCustomIcon(t)?t:getCustomIconInfoImpl("default",o)).display}async function saveCustomIcon(t,o,e){o=getCustomIconInfoImpl(o,e);for(const s of o.list)await(0,fs_extra_1.ensureDir)((0,path_1.dirname)(s.path)),await(0,sharp_1.default)(t).resize(s.dpi,s.dpi,{fit:"inside"}).withMetadata({density:s.dpi}).toFile(s.path);return o.display}function getCustomIconInfo(t,o){t=getCustomIconInfoImpl(t,o);return hasCustomIcon(t)?t:getCustomIconInfoImpl("default",o)}async function removeCustomIcon(t,o){if("default"!==t)try{await(0,fs_extra_1.remove)((0,path_1.join)(SETTING_ROOT,o))}catch(t){}}exports.ICON_DPI_LIST={"mipmap-mdpi":48,"mipmap-hdpi":72,"mipmap-xhdpi":96,"mipmap-xxhdpi":144,"mipmap-xxxhdpi":192},exports.getDisplayCustomIcon=getDisplayCustomIcon,exports.saveCustomIcon=saveCustomIcon,exports.getCustomIconInfo=getCustomIconInfo,exports.removeCustomIcon=removeCustomIcon;