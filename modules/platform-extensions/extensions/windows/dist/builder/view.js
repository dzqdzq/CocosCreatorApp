"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.update=exports.ready=exports.$=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),lodash=require("lodash");let panel;const defaultOptions={renderBackEnd:{vulkan:!1,gles3:!0,gles2:!1}};function ready(e,t,n,a){panel=this;const r=BuildPanel.Vue;panel.options=e,panel.pkgName=n,panel.errorMap=a,panel.vm=new r({el:panel.$.root,data:()=>({pkgOptions:defaultOptions,pkgErrorMap:defaultOptions}),mounted(){this.init()},methods:{t:(e,t)=>Editor.I18n.t(`windows.${e}`,t),async init(){this.pkgOptions=lodash.get(panel.options,"packages.windows")||{};const e=await verificationFunc("renderBackEnd",this.pkgOptions.renderBackEnd);this.pkgErrorMap.renderBackEnd=e.error,this.emitChange()},async onRenderBackEnd(e){const t=this,n=e.target.value;t.pkgOptions.renderBackEnd=n?Object.assign(t.pkgOptions.renderBackEnd,{gles3:!0}):Object.assign(t.pkgOptions.renderBackEnd,{gles2:!1,gles3:!1});const a=await verificationFunc("renderBackEnd",t.pkgOptions.renderBackEnd);t.pkgErrorMap.renderBackEnd=a.error,panel.dispatch("update",`packages.${panel.pkgName}.renderBackEnd`,t.pkgOptions.renderBackEnd,a.error)},async onChange(e){const t=e.target.value,n=e.target.getAttribute("path");lodash.set(this.pkgOptions,n,t);const a=await verificationFunc(n,this.pkgOptions.renderBackEnd);this.pkgErrorMap.renderBackEnd=a.error,this.emitChange()},emitChange(){panel.dispatch("update",`packages.${panel.pkgName}`,this.pkgOptions,this.pkgErrorMap)}}})}function update(e,t){panel=this,t&&!t.startsWith(`packages.${panel.pkgName}`)||(panel.options=e,panel.vm.init())}async function verificationFunc(e,t){const n={error:"",newValue:t,level:!0};switch(e){case"renderBackEnd":Object.keys(t).every(e=>!t[e])&&(n.error=Editor.I18n.t("windows.tips.at_least_one"))}return n}exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/view.html"),"utf8"),exports.$={root:".windows"},exports.ready=ready,exports.update=update;