"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterInit=void 0;const fs_extra_1=require("fs-extra");async function onAfterInit(e,a,t){var s,r,i;const n=e.packages.windows.renderBackEnd;e.assetSerializeOptions["cc.EffectAsset"].glsl1=null===(s=n.gles2)||void 0===s||s,e.assetSerializeOptions["cc.EffectAsset"].glsl3=null===(r=n.gles3)||void 0===r||r,e.assetSerializeOptions["cc.EffectAsset"].glsl4=null===(i=n.vulkan)||void 0===i||i,e.buildScriptParam.flags.SERVER_MODE=!!e.packages.windows.serverMode;const o={packageName:e.name};t.__addStaticsInfo(o),Editor.Metrics.trackEvent({category:"Project",action:"Rendering Backend",label:"Vulkan",value:e.packages.windows.renderBackEnd.vulkan?100:0});const c=a.compileOptions;c.platformParams.targetPlatform="x64",c.cMakeConfig.USE_SERVER_MODE=`set(USE_SERVER_MODE ${e.packages.native.serverMode?"ON":"OFF"})`;const l=Number(e.packages.native.netMode);e.buildScriptParam.flags.SERVER_MODE=!!e.packages.native.serverMode,e.buildScriptParam.flags.NET_MODE=isNaN(l)||l>2||l<0?0:l,c.cMakeConfig.NET_MODE=`set(NET_MODE ${e.buildScriptParam.flags.NET_MODE})`,n&&Object.keys(n).forEach(e=>{c.cMakeConfig[`CC_USE_${e.toUpperCase()}`]=n[e]}),await fs_extra_1.outputJSON(a.paths.compileConfig,c)}exports.onAfterInit=onAfterInit;