"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterInit=exports.throwError=void 0;const fs_extra_1=require("fs-extra");async function onAfterInit(e,a,t){var s,o,r;const c=e.packages.mac.renderBackEnd={gles2:!1,gles3:!1,metal:!0};e.assetSerializeOptions["cc.EffectAsset"].glsl1=null===(s=c.gles2)||void 0===s||s,e.assetSerializeOptions["cc.EffectAsset"].glsl3=null===(o=c.gles3)||void 0===o||o,e.assetSerializeOptions["cc.EffectAsset"].glsl4=null===(r=c.metal)||void 0===r||r;const i=e.mainBundleIsRemote,n=e.server||"";i&&!n&&(console.warn(Editor.I18n.t("mac.options.main_bundle_is_remote_warning")),e.mainBundleIsRemote=!1);const E=e.packages.mac,l=a.compileOptions;l.cMakeConfig.TARGET_OSX_VERSION=`set(TARGET_OSX_VERSION ${E.targetVersion||"10.14"})`,l.cMakeConfig.CUSTOM_COPY_RESOURCE_HOOK=E.skipUpdateXcodeProject,l.cMakeConfig.MACOSX_BUNDLE_GUI_IDENTIFIER=`set(MACOSX_BUNDLE_GUI_IDENTIFIER ${E.packageName})`,l.platformParams.skipUpdateXcodeProject=E.skipUpdateXcodeProject,l.platformParams.bundleId=E.packageName,Object.keys(c).forEach(e=>{l.cMakeConfig[`CC_USE_${e.toUpperCase()}`]=c[e]}),l.cMakeConfig.USE_SERVER_MODE=`set(USE_SERVER_MODE ${e.packages.native.serverMode?"ON":"OFF"})`;const p=Number(e.packages.native.netMode);e.buildScriptParam.flags.SERVER_MODE=!!e.packages.native.serverMode,e.buildScriptParam.flags.NET_MODE=isNaN(p)||p>2||p<0?0:p,l.cMakeConfig.NET_MODE=`set(NET_MODE ${e.buildScriptParam.flags.NET_MODE})`,await fs_extra_1.outputJSON(a.paths.compileConfig,l);const _={packageName:e.packages.mac.packageName};t.__addStaticsInfo(_)}exports.throwError=!0,exports.onAfterInit=onAfterInit;