"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.modifyPackageName=exports.checkPackageNameValidity=exports.changePackageName=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra");async function changePackageName(e,a){let t=path_1.join(e,".cocos-project.json");if(!fs_extra_1.existsSync(t))return void console.error(`Can't find project json [${t}]`);let c=await fs_extra_1.readJSON(t);if(!checkPackageNameValidity(a=a||c.packageName))return void console.error("The package name is illegal(MAC). It can only contain these characters: [0-9], [a-z], [A-Z], [_].");let r=c.packageName;c.mac&&c.mac.packageName&&(r=c.mac.packageName);let i=r!==a;if(!i)return;let o=path_1.join(e,"cocos-project-template.json");if(!fs_extra_1.existsSync(o))return void console.error(`Can't find template json [${o}]`);let n,s=(await fs_extra_1.readJSON(o)).do_add_native_support;if(i){n=s.project_replace_mac_bundleid.files;for(let t of n){let c=path_1.join(e,t);if(!fs_extra_1.existsSync(c)){console.error(`Can't not find file [${t}], replace package name failed`);continue}let i=await fs_extra_1.readFile(c,"utf8");i=i.replace(new RegExp(r,"gm"),a),await fs_extra_1.writeFile(c,i)}}c.mac||(c.mac={}),c.mac.packageName=a,await fs_extra_1.writeFile(t,JSON.stringify(c,null,2))}function checkPackageNameValidity(e){return/^([a-zA-Z0-9-.])+$/.test(e)}function modifyPackageName(e){return e}exports.changePackageName=changePackageName,exports.checkPackageNameValidity=checkPackageNameValidity,exports.modifyPackageName=modifyPackageName;