"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterBundleInit=exports.onAfterInit=exports.throwError=void 0;const path_1=require("path");exports.throwError=!0;let nativePackToolManager=null;async function onAfterInit(e,a,t){const n=e.packages.linux.renderBackEnd={gles2:!1,gles3:!1,metal:!0},i=e.cocosParams;Object.keys(n).forEach(e=>{i.cMakeConfig["CC_USE_"+e.toUpperCase()]=n[e]}),i.cMakeConfig.USE_SERVER_MODE=`set(USE_SERVER_MODE ${e.packages.native.serverMode?"ON":"OFF"})`;var r=Number(e.packages.native.netMode);e.packages.native.netMode=isNaN(r)||2<r||r<0?0:r;i.cMakeConfig.NET_MODE=`set(NET_MODE ${e.buildScriptParam.flags.NET_MODE})`,await getNativePackToolMg(i.enginePath||e.engineInfo.typescript.path)}function onAfterBundleInit(e){var a=Number(e.packages.native.netMode),a=e.packages.native.netMode=isNaN(a)||2<a||a<0?0:a;e.buildScriptParam.flags.SERVER_MODE=!!e.packages.native.serverMode,e.buildScriptParam.flags.NET_MODE=a,e.buildScriptParam.platform="LINUX"}async function getNativePackToolMg(e=""){if(!nativePackToolManager){var a=require((0,path_1.join)(e,"scripts/native-pack-tool/dist/index")).NativePackTool,e=require((0,path_1.join)(e,"scripts/native-pack-tool/dist/index")).nativePackToolMg;class t extends a{async create(){return await this.copyCommonTemplate(),await this.copyPlatformTemplate(),await this.generateCMakeConfig(),await this.excuteCocosTemplateTask(),this.generateCMakeConfig(),await this.encrypteScripts(),!0}}a=new t;e.register("linux",a),nativePackToolManager=e}return nativePackToolManager}exports.onAfterInit=onAfterInit,exports.onAfterBundleInit=onAfterBundleInit;