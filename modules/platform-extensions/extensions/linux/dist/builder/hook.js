"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throwError=void 0,exports.onAfterInit=onAfterInit,exports.onAfterBundleInit=onAfterBundleInit;const path_1=require("path");exports.throwError=!0;let nativePackToolManager=null;async function onAfterInit(e,a,t){const n=e.packages.linux.renderBackEnd={gles2:!1,gles3:!1,metal:!0},i=e.cocosParams;Object.keys(n).forEach(e=>{i.cMakeConfig["CC_USE_"+e.toUpperCase()]=n[e]}),i.cMakeConfig.USE_SERVER_MODE=`set(USE_SERVER_MODE ${e.packages.native.serverMode?"ON":"OFF"})`;var o=Number(e.packages.native.netMode);e.packages.native.netMode=isNaN(o)||2<o||o<0?0:o;i.cMakeConfig.NET_MODE=`set(NET_MODE ${e.buildScriptParam.flags.NET_MODE})`,await getNativePackToolMg(i.enginePath||e.engineInfo.typescript.path)}function onAfterBundleInit(e){var a=Number(e.packages.native.netMode),a=e.packages.native.netMode=isNaN(a)||2<a||a<0?0:a;e.buildScriptParam.flags.SERVER_MODE=!!e.packages.native.serverMode,e.buildScriptParam.flags.NET_MODE=a}async function getNativePackToolMg(e=""){if(!nativePackToolManager){var a=require((0,path_1.join)(e,"scripts/native-pack-tool/dist/index")).NativePackTool,{NativePackToolManager:e,nativePackToolMg:t}=require((0,path_1.join)(e,"scripts/native-pack-tool/dist/index"));class n extends a{async create(){return await this.copyCommonTemplate(),await this.copyPlatformTemplate(),await this.generateCMakeConfig(),await this.executeCocosTemplateTask(),this.generateCMakeConfig(),await this.encryptScripts(),!0}}e.register("linux",n),nativePackToolManager=t}return nativePackToolManager}