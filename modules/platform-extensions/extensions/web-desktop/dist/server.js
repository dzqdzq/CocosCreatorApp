"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.get=void 0,exports.setRootPath=setRootPath,exports.removeServerRoot=removeServerRoot;const fs_extra_1=require("fs-extra"),path_1=require("path"),rootMap={};function setRootPath(t){rootMap[(0,path_1.basename)(t)]=t}function removeServerRoot(t){delete rootMap[(0,path_1.basename)(t)]}async function handle(t,e,s){var r=(0,path_1.join)(Editor.Project.path,"build-templates","web-desktop"),a=t.params[1],o=rootMap[t.params[0]];if(!o)return e.status(503).send(t.params[0]+" 未启动服务");let n=(0,path_1.join)(r,a);if((0,fs_extra_1.existsSync)(n)){const i=(0,fs_extra_1.statSync)(n);i.isDirectory()&&(n=(0,path_1.join)(n,"index.html"),(0,fs_extra_1.existsSync)(n))&&e.sendFile(n)}if(n=(0,path_1.join)(o,a),!(0,fs_extra_1.existsSync)(n))return e.status(404).send(t.params[0]+" 资源不存在");const i=(0,fs_extra_1.statSync)(n);if(i.isDirectory()&&(n=(0,path_1.join)(n,"index.html"),!(0,fs_extra_1.existsSync)(n)))return e.status(404).send(t.params[0]+" 资源不存在");e.sendFile(n)}exports.get=[{url:"/web-desktop/*/*",handle:handle}];