"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.get=exports.removeServerRoot=exports.setRootPath=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path");let rootMap={};function setRootPath(e){rootMap[path_1.basename(e)]=e}function removeServerRoot(e){delete rootMap[path_1.basename(e)]}async function handle(e,t,r){const o=path_1.join(Editor.Project.path,"build-templates","web-desktop"),s=e.params[1],a=rootMap[e.params[0]];if(!a)return r(new Error(`${e.params[0]} 未启动服务`));let n=path_1.join(o,s);if(fs_extra_1.existsSync(n)){fs_extra_1.statSync(n).isDirectory()&&(n=path_1.join(n,"index.html"),fs_extra_1.existsSync(n)&&t.sendFile(n))}if(n=path_1.join(a,s),!fs_extra_1.existsSync(n))return r(new Error(`${e.params[0]} 资源不存在`));if(fs_extra_1.statSync(n).isDirectory()&&(n=path_1.join(n,"index.html"),!fs_extra_1.existsSync(n)))return r(new Error(`${e.params[0]} 资源不存在`));t.sendFile(n)}exports.setRootPath=setRootPath,exports.removeServerRoot=removeServerRoot,exports.get=[{url:"/web-desktop/*/*",handle:handle}];