"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.template=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra"),options_1=require("./options"),lodash=require("lodash");let panel;exports.template=(0,fs_extra_1.readFileSync)((0,path_1.join)(__dirname,"../../static/builder/view.html"),"utf8");const methods={t(t,a){return Editor.I18n.t("openharony."+t,a)},getDefaultPackageName(){return options_1.defaultOptions.packageName},async onChange(t){var a=t.target.value,t=t.target.getAttribute("path");await this.onUpdateOptions(t,a)},async onUpdateOptions(t,a){var e;t&&(e=this,"apiLevel"===t&&(a=Number(a)),lodash.set(e.pkgOptions,t,a),a=await(0,options_1.verificationFunc)(t,a,panel.options),e.pkgErrorMap[t]=a.error,e.emitChange())},async onChangeJsEngine(){},async onChangeABI(t,a){var e=this,t=t.target.value;Array.isArray(e.pkgOptions.appABIs)||(e.pkgOptions.appABIs=[]),t?e.pkgOptions.appABIs.push(a):e.pkgOptions.appABIs.splice(e.pkgOptions.appABIs.indexOf(a),1),await e.onUpdateOptions("appABIs",e.pkgOptions.appABIs)},emitChange(){var t=this;panel.dispatch("update","packages."+t.pkgName,t.pkgOptions,t.pkgErrorMap)},async init(){var t=this;t.pkgOptions=lodash.get(panel.options,"packages."+panel.options.platform)||{};for(const e of Object.keys(options_1.defaultOptions)){var a=await(0,options_1.verificationFunc)(e,t.pkgOptions[e],panel.options);t.pkgErrorMap[e]=a.error}this.emitChange()}};async function update(t,a){panel=this,a&&!a.startsWith("packages."+panel.pkgName)||(panel.options=t,panel.vm.init())}function ready(t,a,e,p){panel=this;var o=BuildPanel.Vue;panel.options=t,panel.pkgName=e,panel.errorMap=p,panel.vm=new o({el:panel.$.root,data(){return{pkgName:e,type:a,pkgOptions:options_1.defaultOptions,pkgErrorMap:options_1.defaultOptions,appABIList:["arm64-v8a"]}},async mounted(){var t=this;"check"===t.type?(t.pkgOptions=lodash.get(panel.options,"packages."+panel.pkgName)||{},t.pkgErrorMap={}):t.init()},methods:methods})}exports.$={root:".harmonyos-next"},exports.update=update,exports.ready=ready;