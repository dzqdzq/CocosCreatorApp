"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.methods=exports.$=exports.style=exports.template=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),remote=require("@electron/remote"),Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1;const Pkg=require("../../package.json");let params,vm,panel=null;async function ready(e){params=e;const t={el:(panel=this).$.oauth,data:()=>({loading:!0,url:e.url,platform:e.platform,redirect:e.redirect}),methods:{clearCache(){const e=panel.$.webview.getWebContentsId(),t=remote.webContents.fromId(e);void 0!==t&&t.session.clearStorageData({storages:["appcache","cookies","filesystem","indexdb","localstorage","shadercache","websql","serviceworkers","cachestorage"]})},startLoading(e){this.loading=!0},finishLoading(e){this.$refs.webview.src.startsWith(this.redirect)&&(this.notifyLoginResult(),Editor.Panel.close(`${Pkg.name}.oauth`)),this.loading=!1},notifyLoginResult(){Editor.Message.send(`${Pkg.name}`,"loginResult",this.platform,"success")}}};vm=new Vue(t)}async function beforeClose(){}async function close(){Editor.Message.send(`${Pkg.name}`,"oAuthWindowClose",params.platform)}exports.template=fs_extra_1.readFileSync(path_1.join(__dirname,"../../static/oauth/index.html"),"utf-8"),exports.style=fs_extra_1.readFileSync(path_1.join(__dirname,"index.css"),"utf8"),exports.$={oauth:".channel-oauth",webview:"#webview"},exports.methods={},exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;