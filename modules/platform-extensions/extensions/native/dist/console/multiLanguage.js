"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCurrentString=exports.hasKey=exports.getString=exports.setCurrentLanguage=void 0;const path=require("path"),fs=require("fs"),cfgInfo=require("./strings"),DEFAULTLANGUAGE="en";let locale=null,curLangString=null,defaultLangString=null;function getEnvLocale(){const n={lang:"en"},t=process.env,e=t.LCALL||t.LCMESSAGES||t.LANG||t.LANGUAGE||Intl.DateTimeFormat().resolvedOptions().locale;return e?{lang:e.split(".")[0]||n.lang}:n}function getAvaiableLangs(){return cfgInfo?Object.keys(cfgInfo):[]}function getLangKey(n){const t=n.split("_");return"zh"===t[0]?1===t.length||"cn"===t[1]?"zh":"zhTr":t[0]}function doInit(){locale=getEnvLocale(),(curLangString=cfgInfo[getLangKey(locale.lang)])||(curLangString=cfgInfo[DEFAULTLANGUAGE]),defaultLangString=cfgInfo[DEFAULTLANGUAGE]}function setCurrentLanguage(n){const t=getLangKey(n);n in cfgInfo?(curLangString=cfgInfo[n],locale.lang=n):t in cfgInfo?(curLangString=cfgInfo[t],locale.lang=t):console.warn()}function getString(n,...t){if(curLangString){const e=curLangString[n];if(!e)return`[KEY "${n}" is not found! lang: ${locale.lang}]`;if(0===t.length)return e;const r=Array.from(e),g=[],a=r.length;let o=0,u=0,l=0;for(;o<a;)"%"===r[o]?("d"===r[o+1]||"f"===r[o+1]?(g.push(t[u++]+""),l++):"s"===r[o+1]?(g.push(t[u++]+""),l++):"%"===r[o+1]?g.push("%"):(g.push(t[u++]+""),l++),o+=2):(g.push(r[o]),o+=1);return l!==t.length&&console.error(`format argument mismatch: ${e} & ${t.join(", ")}`),g.join("")}return`[language ${locale.lang} not set, key ${n}]`}function hasKey(n,t){return!!t&&n in t}function getCurrentString(n){let t;return hasKey(n,curLangString)?t=curLangString[n]:hasKey(n,defaultLangString)&&(t=defaultLangString[n]),t||n}doInit(),exports.setCurrentLanguage=setCurrentLanguage,exports.getString=getString,exports.hasKey=hasKey,exports.getCurrentString=getCurrentString;