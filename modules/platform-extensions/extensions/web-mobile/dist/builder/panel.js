"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.data=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),qrcode=require("qrcode");async function getPreviewUrl(e){const t=await Editor.Message.request("server","query-port");return`http://${await Editor.Message.request("preview","get-preview-ip")}:${t}/web-mobile/${e}/index.html`}let panel;exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/view.html"),"utf8");const component={data:()=>({preview_url:""}),methods:{t(e,t=""){const r=`web-mobile.${t}${e}`;return Editor.I18n.t(r)},async preview(){const e=panel.options;let t=Editor.UI.File.resolveToRaw(e.buildPath);return t=path_1.join(t,e.outputName),await Editor.Message.request("web-mobile","preview",t)},async init(){this.preview_url=await getPreviewUrl(panel.options.outputName),qrcode.toCanvas(this.$refs.canvas,this.preview_url,{errorCorrectionLevel:"H",maskPattern:2,margin:1})}},mounted(){this.init()}};function update(e,t){panel=this,t&&!t.startsWith(`packages.${panel.pkgName}`)||(panel.options=e,panel.vm.init())}function ready(e,t,r){panel=this;const a=require("vue/dist/vue.js");panel.options=e,panel.pkgName=r,panel.vm=new a(Object.assign({el:panel.$.root},component))}exports.data={vm:null,options:{}},exports.$={root:".web-mobile"},exports.update=update,exports.ready=ready;