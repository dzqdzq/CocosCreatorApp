"use strict";const{join:join}=require("path"),{readdirSync:readdirSync,statSync:statSync}=require("fs-extra"),builder=require("@editor/build");function scan(e){readdirSync(e).forEach(n=>{const o=join(e,n);statSync(o).isDirectory()&&builder.addWorkspace(o)})}scan(join(__dirname,"../extensions")),builder.config({entry:".editor.js",config:join(__dirname,".build-cache.json")}),async function(){const e=await builder.executeTask(["tsc","lessc","file","compress"]);let n=[];for(let o in e){const i=e[o];for(let e of i)"error"===e.state&&n.push(e)}n.length&&(console.log(["================================================================================","没有正确完成构建任务，请查看日志，并根据建议尝试修复"].join("\n")),n.forEach(e=>{console.log(e)}),console.log(["================================================================================"].join("\n")),process.exit(-1))}();