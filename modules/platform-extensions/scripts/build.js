"use strict";const{join:join}=require("path"),{readdirSync:readdirSync,statSync:statSync}=require("fs-extra"),builder=require("@editor/build");function scan(n){readdirSync(n).forEach(o=>{const e=join(n,o);statSync(e).isDirectory()&&builder.addWorkspace(e)})}scan(join(__dirname,"../extensions")),builder.config({entry:".editor.js",config:join(__dirname,".build-cache.json")}),async function(){const n=await builder.executeTask(["tsc","lessc","file","compress"]),o=[];for(const e in n){const i=n[e];for(const n of i)"error"===n.state&&o.push(n)}o.length&&(console.log(["================================================================================","没有正确完成构建任务，请查看日志，并根据建议尝试修复"].join("\n")),o.forEach(n=>{console.log(n)}),console.log(["================================================================================"].join("\n")),process.exit(-1))}();