"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_extra_1 = require("fs-extra");
const path_1 = require("path");
const index_1 = require("../utils/index");
module.exports = Editor.Panel.define({
    template: `<div class="console-footer-left">
                <div class="console-error"></div>
             </div>`,
    style: (0, fs_extra_1.readFileSync)((0, path_1.join)(__dirname, '../../dist/left.css'), 'utf8'),
    $: {
        message: '.console-error',
    },
    methods: {
        record(item) {
            if (item.type !== 'error') {
                return;
            }
            if (this.$.message) {
                this.$.message.innerHTML = (0, index_1.transformText)(item.message);
                this.$.message.setAttribute('title', (0, index_1.transformText)(item.message));
            }
        },
        clear() {
            this.$.message && (this.$.message.innerHTML = '');
            this.$.message?.setAttribute('title', '');
        },
    },
    async ready() {
        // 为了下面的事件绑定可以获取真实的 this
        this.record = this.record.bind(this);
        this.clear = this.clear.bind(this);
        Editor.Logger.__protected__.on('record', this.record);
        // 按下清除日志按钮的时候，需要清空当前显示的文字
        Editor.Logger.__protected__.on('clear', this.clear);
    },
    async close() {
        Editor.Logger.__protected__.removeListener('record', this.record);
        Editor.Logger.__protected__.removeListener('clear', this.clear);
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGVmdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NvdXJjZS9mb290ZXIvbGVmdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVDQUF3QztBQUN4QywrQkFBNEI7QUFFNUIsMENBQStDO0FBRS9DLE1BQU0sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDakMsUUFBUSxFQUFFOztvQkFFTTtJQUNoQixLQUFLLEVBQUUsSUFBQSx1QkFBWSxFQUFDLElBQUEsV0FBSSxFQUFDLFNBQVMsRUFBRSxxQkFBcUIsQ0FBQyxFQUFFLE1BQU0sQ0FBQztJQUNuRSxDQUFDLEVBQUU7UUFDQyxPQUFPLEVBQUUsZ0JBQWdCO0tBQzVCO0lBQ0QsT0FBTyxFQUFFO1FBQ0wsTUFBTSxDQUFDLElBQWtCO1lBQ3JCLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUU7Z0JBQ3ZCLE9BQU87YUFDVjtZQUNELElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ2hCLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsR0FBRyxJQUFBLHFCQUFhLEVBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUN2RCxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLElBQUEscUJBQWEsRUFBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQzthQUNyRTtRQUVMLENBQUM7UUFDRCxLQUFLO1lBQ0QsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUM7WUFDbEQsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztRQUM5QyxDQUFDO0tBQ0o7SUFDRCxLQUFLLENBQUMsS0FBSztRQUNQLHdCQUF3QjtRQUN4QixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFdEQsMEJBQTBCO1FBQzFCLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFDRCxLQUFLLENBQUMsS0FBSztRQUNQLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2xFLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BFLENBQUM7Q0FDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWFkRmlsZVN5bmMgfSBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgeyBqb2luIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBJTWVzc2FnZUl0ZW0gfSBmcm9tICcuLi8uLi9AdHlwZXMvcHJpdmF0ZSc7XG5pbXBvcnQgeyB0cmFuc2Zvcm1UZXh0IH0gZnJvbSAnLi4vdXRpbHMvaW5kZXgnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvci5QYW5lbC5kZWZpbmUoe1xuICAgIHRlbXBsYXRlOiBgPGRpdiBjbGFzcz1cImNvbnNvbGUtZm9vdGVyLWxlZnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29uc29sZS1lcnJvclwiPjwvZGl2PlxuICAgICAgICAgICAgIDwvZGl2PmAsXG4gICAgc3R5bGU6IHJlYWRGaWxlU3luYyhqb2luKF9fZGlybmFtZSwgJy4uLy4uL2Rpc3QvbGVmdC5jc3MnKSwgJ3V0ZjgnKSxcbiAgICAkOiB7XG4gICAgICAgIG1lc3NhZ2U6ICcuY29uc29sZS1lcnJvcicsXG4gICAgfSxcbiAgICBtZXRob2RzOiB7XG4gICAgICAgIHJlY29yZChpdGVtOiBJTWVzc2FnZUl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgIT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy4kLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiQubWVzc2FnZS5pbm5lckhUTUwgPSB0cmFuc2Zvcm1UZXh0KGl0ZW0ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgdGhpcy4kLm1lc3NhZ2Uuc2V0QXR0cmlidXRlKCd0aXRsZScsIHRyYW5zZm9ybVRleHQoaXRlbS5tZXNzYWdlKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgY2xlYXIoKSB7XG4gICAgICAgICAgICB0aGlzLiQubWVzc2FnZSAmJiAodGhpcy4kLm1lc3NhZ2UuaW5uZXJIVE1MID0gJycpO1xuICAgICAgICAgICAgdGhpcy4kLm1lc3NhZ2U/LnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnJyk7XG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBhc3luYyByZWFkeSgpIHtcbiAgICAgICAgLy8g5Li65LqG5LiL6Z2i55qE5LqL5Lu257uR5a6a5Y+v5Lul6I635Y+W55yf5a6e55qEIHRoaXNcbiAgICAgICAgdGhpcy5yZWNvcmQgPSB0aGlzLnJlY29yZC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmNsZWFyID0gdGhpcy5jbGVhci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIEVkaXRvci5Mb2dnZXIuX19wcm90ZWN0ZWRfXy5vbigncmVjb3JkJywgdGhpcy5yZWNvcmQpO1xuXG4gICAgICAgIC8vIOaMieS4i+a4hemZpOaXpeW/l+aMiemSrueahOaXtuWAme+8jOmcgOimgea4heepuuW9k+WJjeaYvuekuueahOaWh+Wtl1xuICAgICAgICBFZGl0b3IuTG9nZ2VyLl9fcHJvdGVjdGVkX18ub24oJ2NsZWFyJywgdGhpcy5jbGVhcik7XG4gICAgfSxcbiAgICBhc3luYyBjbG9zZSgpIHtcbiAgICAgICAgRWRpdG9yLkxvZ2dlci5fX3Byb3RlY3RlZF9fLnJlbW92ZUxpc3RlbmVyKCdyZWNvcmQnLCB0aGlzLnJlY29yZCk7XG4gICAgICAgIEVkaXRvci5Mb2dnZXIuX19wcm90ZWN0ZWRfXy5yZW1vdmVMaXN0ZW5lcignY2xlYXInLCB0aGlzLmNsZWFyKTtcbiAgICB9LFxufSk7XG4iXX0=