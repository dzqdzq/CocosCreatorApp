"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.methods=void 0,exports.load=load,exports.unload=unload;const data_1=require("../data"),esm_require=require("esm")(module),uploadMgr=esm_require("../../dist/browser/upload")["uploadMgr"],crashReportArr=[];function load(){}function unload(){}exports.methods={async onCrashReport(r){var e=r&&r.details;if(!e||["crashed","oom"].includes(e.reason))if(await Editor.Network.__protected__.testConnectServer())try{if(r.param=await Editor.Metrics.__protected__._trackCrashEvent({category:"crash",value:r.value}),await uploadMgr.check()){const a=await(0,data_1.createCrashReport)(r);crashReportArr.find(r=>r.process===a.process)||crashReportArr.push(a),await Editor.Panel.has("crash-reporter")?Editor.Message.send("crash-reporter","refresh",a):Editor.Panel.open("crash-reporter",a)}}catch(r){console.debug(r)}else console.debug("[crash-report] Offline status, no reporting.")},queryCrashReportInfos(){return crashReportArr},async onUpload(r){0!==crashReportArr.length&&(await uploadMgr.packMultipleZipAndUpload(r,crashReportArr),crashReportArr.length=0)}};