"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const path_1=require("path"),fs_extra_1=require("fs-extra"),utils_1=require("../utils");let _this;exports.style=fs_extra_1.readFileSync(path_1.join(__dirname,"../../static","style.css"),"utf8"),exports.template=fs_extra_1.readFileSync(path_1.join(__dirname,"../../static","template.html"),"utf8"),exports.$={steps:".steps",cancel:".cancel",confirm:".confirm",content:".content"},exports.methods={onCancel(){_upload=!1,Editor.Panel.close("crash-reporter")},onSubmit(){_upload=!0,Editor.Panel.close("crash-reporter")},refresh(e){showUI(e)}};let _uiProcess,_uiGoneDetails,_uiTimeCrash,_upload=!1,_mustBeUpload=!1;exports.ready=async function(){_upload=!1,(_this=this).$.cancel.addEventListener("click",this.onCancel),_this.$.confirm.addEventListener("click",this.onSubmit),_mustBeUpload=await Editor.Profile.getConfig("utils","features.must-crash-report"),showUI(await Editor.Message.request("crash-reporter","query-crash-report-infos"))};const _uiSpan=[];let _uiTotalTime,_uiVersion,_uiUserAgent,_uiCID,_uiUID,_uiArch,_uiPlatform,_uiOSVersion,_uiTotalmem,_uiFreemem,_uiPackages,_uiCpus;function showUI(e){const t=e[0];let i="",s="";e.forEach(e=>{i+=`${e.process} `,s+=`${e.process} & reason: ${e.details.reason} & exitCode: ${e.details.exitCode} <br>`}),_uiProcess=utils_1.createUIProp("Process:",i,_this.$.content,_uiProcess),_uiGoneDetails=utils_1.createUIProp("Gone Details:",s,_this.$.content,_uiGoneDetails),_uiSpan[0]=utils_1.createSpan(_this.$.content,_uiSpan[0]),_uiTimeCrash=utils_1.createUIProp("Time Crash:",t.time+"",_this.$.content,_uiTimeCrash),_uiTotalTime=utils_1.createUIProp("Total Time:",t.uptime+"",_this.$.content,_uiTotalTime),_uiSpan[1]=utils_1.createSpan(_this.$.content,_uiSpan[1]),_uiVersion=utils_1.createUIProp("Version:",t.version,_this.$.content,_uiVersion),_uiUserAgent=utils_1.createUIProp("UserAgent:",t.userAgent,_this.$.content,_uiUserAgent),_uiCID=utils_1.createUIProp("Client ID:",t.cid,_this.$.content,_uiCID),_uiUID=utils_1.createUIProp("User ID:",t.uid,_this.$.content,_uiUID),_uiSpan[2]=utils_1.createSpan(_this.$.content,_uiSpan[2]),_uiArch=utils_1.createUIProp("Arch:",t.arch,_this.$.content,_uiArch),_uiPlatform=utils_1.createUIProp("Platform:",t.platform,_this.$.content,_uiPlatform),_uiOSVersion=utils_1.createUIProp("osVersion:",t.osVersion,_this.$.content,_uiOSVersion),_uiTotalmem=utils_1.createUIProp("Totalmem:",t.totalmem+"",_this.$.content,_uiTotalmem),_uiFreemem=utils_1.createUIProp("Freemem:",t.freemem+"",_this.$.content,_uiFreemem),_uiSpan[3]=utils_1.createSpan(_this.$.content,_uiSpan[3]),_uiPackages=utils_1.createUIProp("Packages:",JSON.stringify(t.packages),_this.$.content,_uiPackages),_uiSpan[4]=utils_1.createSpan(_this.$.content,_uiSpan[4]),_uiCpus=utils_1.createUIProp("Cpus:",JSON.stringify(t.cpus),_this.$.content,_uiCpus)}exports.beforeClose=function(){},exports.close=async function(){_this.$.cancel.removeEventListener("click",this.onCancel),_this.$.confirm.removeEventListener("click",this.onSubmit),(_upload||_mustBeUpload)&&Editor.Message.broadcast("crash-reporter:upload",_this.$.steps.value),_this=void 0,_upload=!1};