"use strict";const fs=require("fs"),{join:join}=require("path");let filesList=[];function convertTime(t){const e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")}async function readImageList(t,e=!1){e||(filesList=[]);const s=fs.readdirSync(t);return await Promise.all(s.map(async e=>{const s=join(t,e),i=fs.statSync(s);if(i.isDirectory())readImageList(s,!0);else if(e.endsWith(".png")){const t=await Editor.Message.request("asset-db","query-url",s);let r=null;t&&(r=await Editor.Message.request("asset-db","query-uuid",t));const a={path:s,filename:e,size:formatBytes(i.size),birthtime:convertTime(i.birthtime),uuid:r,mtime:convertTime(i.mtime)};filesList.push(a)}})),filesList}function formatBytes(t,e=2){if(0===t)return"0 Bytes";const s=e<0?0:e,i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]}exports.formatBytes=formatBytes,exports.readImageList=readImageList;