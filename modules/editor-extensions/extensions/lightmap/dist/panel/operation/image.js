"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatBytes=void 0;const fs=require("fs"),{join:join}=require("path");let filesList=[];function convertTime(e){const t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}async function readImageList(e,t=!1){t||(filesList=[]);const s=fs.readdirSync(e);return await Promise.all(s.map(async t=>{const s=join(e,t),i=fs.statSync(s);if(i.isDirectory())readImageList(s,!0);else if(t.endsWith(".png")){const e=await Editor.Message.request("asset-db","query-url",s);let r=null;e&&(r=await Editor.Message.request("asset-db","query-uuid",e));const o={path:s,filename:t,size:formatBytes(i.size),birthtime:convertTime(i.birthtime),uuid:r,mtime:convertTime(i.mtime)};filesList.push(o)}})),filesList}function formatBytes(e,t=2){if(0===e)return"0 Bytes";const s=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]}exports.default=readImageList,exports.formatBytes=formatBytes;