"use strict";var __decorate=this&&this.__decorate||function(e,t,r,s){var l,i=arguments.length,o=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(o=(i<3?l(o):i>3?l(t,r,o):l(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const CSVWriter_1=__importDefault(require("./CSVWriter")),tsyringe_1=require("tsyringe"),type_1=require("../type/type"),xlsx_1=require("xlsx");let XLSXWriter=class extends CSVWriter_1.default{constructor(){super(...arguments),this.type=type_1.TranslateFileType.XLSX}async write(e,t,r){const s=this.generateCsvTranslateItems(r,t),l=["key","sourceValue","targetValue"],i=xlsx_1.utils.json_to_sheet(s,{header:l}),o=xlsx_1.utils.book_new();xlsx_1.utils.book_append_sheet(o,i,t.locale);const n=l.map(e=>s.reduce((t,r)=>Math.max(t,r[e].length),e.length));i["!cols"]=n.map(e=>({wch:e})),(0,xlsx_1.writeFile)(o,e)}};XLSXWriter=__decorate([(0,tsyringe_1.singleton)()],XLSXWriter),exports.default=XLSXWriter;