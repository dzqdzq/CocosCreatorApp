"use strict";var __decorate=this&&this.__decorate||function(e,t,r,s){var a,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,s);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(n=(o<3?a(n):o>3?a(t,r,n):a(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const CSVReader_1=__importDefault(require("./CSVReader")),tsyringe_1=require("tsyringe"),xlsx_1=require("xlsx"),Errors_1=require("../error/Errors"),MainMessage_1=require("../entity/messages/MainMessage"),type_1=require("../type/type");let XLSXReader=class extends CSVReader_1.default{constructor(){super(...arguments),this.type=type_1.TranslateFileType.XLSX}async read(e){const t=(0,xlsx_1.readFile)(e);if(t.SheetNames.length<1)throw new Errors_1.CustomError(MainMessage_1.MessageCode.UNAVAILABLE_XLSX_FILE,"no worksheets");const r=t.Sheets[t.SheetNames[0]],s=xlsx_1.utils.sheet_to_json(r);return this.generateTranslateData(s)}};XLSXReader=__decorate([(0,tsyringe_1.singleton)()],XLSXReader),exports.default=XLSXReader;