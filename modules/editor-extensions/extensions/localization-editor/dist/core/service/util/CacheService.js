"use strict";var __decorate=this&&this.__decorate||function(e,t,r,a){var i,c=arguments.length,o=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(c<3?i(o):c>3?i(t,r,o):i(t,r))||o);return c>3&&o&&Object.defineProperty(t,r,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const tsyringe_1=require("tsyringe"),fs_1=require("fs"),path_1=require("path"),global_1=require("./global"),EditorMessageService_1=__importDefault(require("../EditorMessageService"));let CacheService=class{constructor(e){this.editorMessageService=e}clear(){if("win32"===process.platform||!Editor.App.dev)return;const e=(0,path_1.join)(Editor.App.path,"modules","editor-extensions","extensions",global_1.MainName);if((0,fs_1.existsSync)(e))try{const t=(0,path_1.join)((0,fs_1.realpathSync)(e),"dist");this.deleteRequireCache(t)}catch(e){}}deleteRequireCache(e){console.debug(`[${global_1.MainName}] clear cache`,e);for(const t in require.cache){(0,path_1.relative)(e,t).startsWith("..")||delete require.cache[t]}}};CacheService=__decorate([(0,tsyringe_1.singleton)(),__metadata("design:paramtypes",[EditorMessageService_1.default])],CacheService),exports.default=CacheService;