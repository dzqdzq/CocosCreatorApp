"use strict";var TrackService_1,__decorate=this&&this.__decorate||function(e,t,r,a){var c,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(c=e[o])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const tsyringe_1=require("tsyringe"),global_1=require("../util/global"),TranslateDataSourceService_1=__importDefault(require("../persistent/TranslateDataSourceService"));let TrackService=TrackService_1=class{constructor(e){this.translateDataSourceService=e,this.builderTaskSet=new Set}static BUILD_SUCCESS_FOR_LANGUAGE(e){return`B100001_${e}`}trackBuilder(e,t){var r;if(!t)return;const a=null===(r=t.options.packages)||void 0===r?void 0:r[global_1.MainName];if(1!==t.progress)this.builderTaskSet.add(e);else if(this.builderTaskSet.delete(e),"success"===t.state&&a){const e={};e[TrackService_1.BUILD_SUCCESS_WITH_L10N]=1,Editor.Metrics.trackEvent({sendToNewCocosAnalyticsOnly:!0,category:TrackService_1.EVENT_ID,value:e});const t=this.translateDataSourceService.getAllLanguageTags(),r=this.translateDataSourceService.getClonedIndexData(),c=Array.from(r.items.keys());c.length>0&&t.length>=2&&Object.keys(a.targetLanguageMap).forEach(e=>{const t={};t[TrackService_1.BUILD_SUCCESS_FOR_LANGUAGE(e)]=c.length,Editor.Metrics.trackEvent({sendToNewCocosAnalyticsOnly:!0,category:TrackService_1.EVENT_ID,value:t})})}}};TrackService.EVENT_ID="l10n",TrackService.BUILD_SUCCESS_WITH_L10N="A100000",TrackService=TrackService_1=__decorate([(0,tsyringe_1.singleton)(),__metadata("design:paramtypes",[TranslateDataSourceService_1.default])],TrackService),exports.default=TrackService;