"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__decorate=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,c=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(c=(s<3?n(c):s>3?n(t,r,c):n(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0});const path_1=require("path");module.paths.push((0,path_1.join)(Editor.App.path,"node_modules"));const cc=__importStar(require("cc")),tsyringe_1=require("tsyringe"),fs_1=require("fs"),fs_extra_1=require("fs-extra");let AssetSerializeService=class{deserializeFile(e){const t=(0,fs_1.readFileSync)(e,"utf-8"),r=EditorExtends.MissingReporter.classInstance,i=(e,t,i,n)=>{const s=r.classFinder(e,t,i,n);return s||cc.MissingScript};i.onDereferenced=r.classFinder.onDereferenced;const n=new cc.deserialize.Details;return n.reset(),cc.deserialize(t,n,{createAssetRefs:!0,classFinder:i})}serialize(e,t,r=!0){let i;return i=t instanceof cc.Prefab?cce.Prefab.generatePrefabDataFromNode(t.data):EditorExtends.serialize(t),r&&(0,fs_extra_1.writeFileSync)(e,i,"utf-8"),i}};AssetSerializeService=__decorate([(0,tsyringe_1.singleton)()],AssetSerializeService),exports.default=AssetSerializeService;