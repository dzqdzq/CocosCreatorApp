"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const path_1=require("path");module.paths.push((0,path_1.join)(Editor.App.path,"node_modules"));const tsyringe_1=require("tsyringe"),AssetSerializeService_1=__importDefault(require("../serialize/AssetSerializeService")),SceneProcessor_1=__importDefault(require("./SceneProcessor"));let ComponentUnLoader=class{constructor(e){this.assetSerializeService=e}process(e){let t,r=null;if(e.type.includes("Scene")){const o=this.assetSerializeService.deserializeFile(e.file);t=o,r=o.scene}else if(e.type.includes("Prefab")){const o=this.assetSerializeService.deserializeFile(e.file);t=o,r=o.data}if(!r)return;this.unloadComponent(r.walk)>0&&this.assetSerializeService.serialize(e.file,t)}unloadComponent(e){let t=0;return e(e=>{if(e instanceof cc.Node){const r=e.getComponent(SceneProcessor_1.default.L10nLabelComponentName);r&&(r.destroy(),t+=1);const o=e.getComponent(SceneProcessor_1.default.ICUComponentName);o&&(o.destroy(),t+=1)}}),cc.CCObject._deferredDestroy(),t}};ComponentUnLoader=__decorate([(0,tsyringe_1.autoInjectable)(),__metadata("design:paramtypes",[AssetSerializeService_1.default])],ComponentUnLoader),exports.default=ComponentUnLoader;