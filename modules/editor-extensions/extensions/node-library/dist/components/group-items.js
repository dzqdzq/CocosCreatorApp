"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.model=exports.mounted=exports.methods=exports.props=exports.template=exports.name=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),panel_1=require("../panel");exports.name="group-items",exports.template=fs_extra_1.readFileSync(path_1.join(__dirname,"../../static/template/group-items.html"),"utf8"),exports.props=["groups","active"];const MAX_NODE_ICON_SIZE=5242880;function mounted(){}exports.methods={getAdditional(e){const t=[];return t.push(Object.assign({value:e.assetUuid},e)),JSON.stringify(t)},popupMenu(e){const t=this;if("custom"!==t.active)return;const s=[{label:Editor.I18n.t("node-library.menu.delete"),click(){t.groups.forEach(t=>{for(let s=0;s<t.items.length;s++)t.items[s].assetUuid===e.assetUuid&&t.items.splice(s,1)}),Editor.Profile.setConfig("node-library","custom",t.groups)}},{label:Editor.I18n.t("node-library.menu.locate"),click(){Editor.Message.send("assets","twinkle",e.assetUuid)}},{label:Editor.I18n.t("node-library.menu.changeIcon"),async click(){const s=await Editor.Dialog.select({filters:[{name:"Images",extensions:["jpg","png"]}],multi:!1});if(s.canceled)return;const o=s.filePaths[0];if(fs_extra_1.existsSync(o)){if((await fs_extra_1.promises.stat(o)).size>5242880)return void Editor.Dialog.error(Editor.I18n.t("node-library.ImageSmallerThen5mb"));const s=path_1.basename(o),r=path_1.join(Editor.App.home,"user-static","node-library",s);await fs_extra_1.copy(o,r);const i=await Editor.Profile.getConfig("node-library","custom")||panel_1.defaultCustomData;i[0].items.find(t=>t.assetUuid===e.assetUuid).icon=r,t.$emit("change",i),Editor.Profile.setConfig("node-library","custom",i)}}}];Editor.Menu.popup({menu:s})}},exports.mounted=mounted,exports.model={prop:"groups",event:"change"};