"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.model=exports.methods=exports.mounted=exports.data=exports.components=exports.props=exports.template=exports.name=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),panel_1=require("../panel"),MAX_NODE_ICON_SIZE=5242880;function data(){return{}}function mounted(){}exports.name="groups",exports.template=(0,fs_extra_1.readFileSync)((0,path_1.join)(__dirname,"../../static/template/groups.html"),"utf8"),exports.props=["groups","active"],exports.components={"group-items":require("./group-items")},exports.data=data,exports.mounted=mounted,exports.methods={onDeLete(e){this.groups.forEach(t=>{for(let o=0;o<t.items.length;o++)t.items[o].assetUuid===e.assetUuid&&t.items.splice(o,1)}),Editor.Profile.setConfig("node-library","custom",this.groups)},async onChangeIcon(e){const t=this,o=await Editor.Dialog.select({filters:[{name:"Images",extensions:["jpg","png"]}],multi:!1});if(o.canceled)return;const s=o.filePaths[0];if((0,fs_extra_1.existsSync)(s)){if((await fs_extra_1.promises.stat(s)).size>5242880)return void Editor.Dialog.error(Editor.I18n.t("node-library.ImageSmallerThen5mb"));const o=(0,path_1.basename)(s),r=(0,path_1.join)(Editor.App.home,"user-static","node-library",o);await(0,fs_extra_1.copy)(s,r);const i=await Editor.Profile.getConfig("node-library","custom")||panel_1.defaultCustomData;i[0].items.find(t=>t.assetUuid===e.assetUuid).icon=r,t.$emit("change",i),Editor.Profile.setConfig("node-library","custom",i)}},async onRename(e){const t=this;if(e.name.trim())for(const o of t.groups){if(o.items.find(t=>t.name===e.name))return void Editor.Dialog.warn(Editor.I18n.t("node-library.tips.customNodeExist"));const s=o.items.find(t=>t.assetUuid===e.assetUuid);s&&(s.name=e.name,Editor.Profile.setConfig("node-library","custom",t.groups))}else Editor.Dialog.warn(Editor.I18n.t("node-library.tips.notEmpty"))}},exports.model={prop:"groups",event:"change"};