"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.closeProcessByPid=exports.openPanelDevTool=exports.queryProcessTree=exports.processNameMap=void 0;const electron_1=require("electron"),processManage_1=require("./processManage");exports.processNameMap={};const EXE_REG=/^.*[\\\/]([^\\\/]+)\.exe.*$/i,formatProcessInfo=(e,o)=>(o[e.pid]||(o[e.pid]=[]),{detail:{pid:e.pid,ppid:e.ppid,name:e.name,cmd:e.cmd,memory:e.memory,cpu:e.cpu,panel:e.panel},showArrow:!!o[e.pid].length,children:o[e.pid]});async function queryProcessTree(e){const o="darwin"===process.platform?await processManage_1.macProcess.getProcessList(e):await processManage_1.windowProcess.getProcessList(e),s={};let r=null;for(const n of o){const o=formatProcessInfo(n,s);n.pid===e&&(r=o,EXE_REG.test(r.detail.name)&&(r.detail.name=r.detail.name.replace(EXE_REG,"$1"))),s[n.ppid]?s[n.ppid].push(o):s[n.ppid]=[o]}return r}async function openPanelDevTool(e){const o=electron_1.BrowserWindow.getAllWindows().find(o=>o.webContents.getOSProcessId()===e);o&&o.webContents.openDevTools()}async function closeProcessByPid(e){const o=electron_1.BrowserWindow.getAllWindows().find(o=>o.webContents.getOSProcessId()===e);o&&o.close()}exports.queryProcessTree=queryProcessTree,exports.openPanelDevTool=openPanelDevTool,exports.closeProcessByPid=closeProcessByPid;