"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encode=exports.decode=void 0;const element_1=require("../../element"),htmlparser2_1=require("htmlparser2");function decode(e,t){if(t&&"inspector-root"!==t.tag)throw new Error("Not a legitimate root node");const r=new Map,n=t||new element_1.VirtualElement("inspector-root");let o=n;const c=new htmlparser2_1.Parser({onopentag(e,t){const n=r.get(o)||0;let c;r.set(o,n+1);for(let t=n;t<o.children.length;t++)if(o.children[t].tag===e){(c=o.children[t]).attrs={},c.text="";break}c||(c=new element_1.VirtualElement(e)),o.insertChild(c,n),o=c;for(const e in t)o.setAttribute(e,t[e])},ontext(e){o.text+=e},onclosetag(e){o=o.getParent()}});return c.write(e),c.end(),t&&function e(t){const n=r.get(t)||0;t.children.length=n,t.children.forEach(e)}(t),n}function encode(e){let t="";return function e(r){for(const n of r){let r="";for(const e in n.attrs)r+=` ${e}="${n.attrs[e]}"`;t+=`<${n.tag.toLowerCase()}${r}>`,e(n.children),t+=`${n.text}</${n.tag.toLowerCase()}>`}}(e.children),t}exports.decode=decode,exports.encode=encode;