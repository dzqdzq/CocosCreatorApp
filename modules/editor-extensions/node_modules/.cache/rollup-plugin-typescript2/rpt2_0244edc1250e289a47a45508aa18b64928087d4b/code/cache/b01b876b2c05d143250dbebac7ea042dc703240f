{"code":"'use strict';\r\nlet isStart = false;\r\nlet isFinish = false;\r\nlet isEnd = false;\r\nlet currProgress = 0;\r\nlet bakerSum = 20;\r\nlet progress = 0;\r\nlet logInfos = [];\r\nlet currPath;\r\nfunction initVal() {\r\n    currProgress = 0;\r\n    bakerSum = 20;\r\n    progress = 0;\r\n}\r\nfunction changeProgress(prog = null, halfPart = true) {\r\n    if (!prog) {\r\n        currProgress += 10;\r\n        if (currProgress >= (bakerSum - 10)) {\r\n            bakerSum += 10;\r\n        }\r\n        prog = currProgress / bakerSum * 100;\r\n        if (halfPart) {\r\n            prog /= 2;\r\n        }\r\n    }\r\n    progress = prog;\r\n}\r\nexport const methods = {\r\n    /**\r\n     * 打开偏好设置面板\r\n     */\r\n    async open() {\r\n        const bake_feature = await Editor.Profile.getConfig('lightmap', 'laboratory.bake_feature');\r\n        if (bake_feature) {\r\n            isStart = false;\r\n            logInfos = [];\r\n            Editor.Panel.open('lightmap.panel');\r\n        }\r\n        else {\r\n            Editor.Dialog.warn(Editor.I18n.t('lightmap.openWarn'));\r\n        }\r\n    },\r\n    async start() {\r\n        console.debug('= lightMap panel output info: start =');\r\n        isStart = true;\r\n        isFinish = false;\r\n        isEnd = false;\r\n        logInfos = [];\r\n        logInfos.push('Baking started' + '\\n');\r\n    },\r\n    cancel() {\r\n        initVal();\r\n    },\r\n    log(data) {\r\n        console.debug('= lightMap panel output info: log =', data);\r\n        logInfos.push(data + '\\n');\r\n        if (isFinish) {\r\n            changeProgress(null, false);\r\n        }\r\n    },\r\n    progress(data) {\r\n        console.debug('= lightMap panel output info: progress =', data);\r\n        logInfos.push(data + '\\n');\r\n        if (!isFinish) {\r\n            changeProgress();\r\n        }\r\n    },\r\n    // 烘焙库的任务结束,此时还未输出图片\r\n    finished() {\r\n        console.debug('= lightMap panel output info: finished =');\r\n        isFinish = true;\r\n        isEnd = false;\r\n        logInfos.push('The baking is ready to complete and begin generating images' + '\\n');\r\n        changeProgress(50);\r\n    },\r\n    // 烘焙全部结束,此时已输出图片\r\n    async end() {\r\n        console.debug('= lightMap panel output info: end =');\r\n        isEnd = true;\r\n        logInfos.push('End of the baking' + '\\n');\r\n        logInfos.push(Editor.I18n.t('lightmap.end') + '\\n');\r\n        initVal();\r\n    },\r\n    async clear() {\r\n        console.debug('= lightMap panel output info: clear =');\r\n        logInfos = [];\r\n        isStart = false;\r\n        isFinish = false;\r\n        isEnd = false;\r\n        initVal();\r\n        currPath = '';\r\n    },\r\n    async unstaging() {\r\n        return {\r\n            progress,\r\n            logInfos,\r\n            currPath,\r\n            isStart,\r\n            isFinish,\r\n            isEnd,\r\n        };\r\n    },\r\n    async savePicPath(path) {\r\n        currPath = path;\r\n    },\r\n};\r\nexport async function load() { }\r\nexport function unload() { }\r\n","references":[]}
