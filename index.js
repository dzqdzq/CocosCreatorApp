"use strict";require("./lib/require");const{existsSync:existsSync}=require("fs"),{join:join}=require("path"),setting=require("@editor/setting"),{app:app,crashReporter:crashReporter}=require("electron");app.disableDomainBlockingFor3DAPIs(),app.commandLine.appendSwitch("ignore-gpu-blacklist"),existsSync(join(__dirname,"./lib.asar"))?require("./lib.asar/dist"):require("./lib/dist");let _uncaughtExceptionFunc=e=>{global.Editor&&Editor.Metrics.trackException({code:-1,message:e.message}),process.send&&process.connected&&process.send({channel:"editor-error",message:e.message,stack:e.stack}),console.error(e)};process.on("uncaughtException",_uncaughtExceptionFunc),function(){if(setting.PATH.PROJECT){const e=join(setting.args.project,"temp/crash");app.setPath("crashDumps",e),crashReporter.start({uploadToServer:!1})}}(),async function(){if(!setting.PATH.PROJECT){const e=require("./dashboard/startup");return await e.app(),void await e.validation(setting.dev)}const e=existsSync(join(__dirname,"./lib.asar"))?require("./lib.asar/dist/startup").Startup:require("./lib/dist/startup").Startup;if(setting.args.build){await e.manager(!0),await e.package();const t={};setting.args.build.split(";").forEach(e=>{if(!e)return;const i=e.split("=");t[i[0].trim()]=i[1]});const i=await e.build(t,setting.args.dev);app.exit(i)}else await Promise.all([e.manager(!!setting.args.nologin),e.window()]),await e.package()}();