"use strict";const{existsSync:existsSync}=require("fs"),{join:join}=require("path"),{app:app,crashReporter:crashReporter}=require("electron");app.disableDomainBlockingFor3DAPIs(),app.commandLine.appendSwitch("ignore-gpu-blacklist"),app.allowRendererProcessReuse=!1,app.commandLine.appendSwitch("enable-webgl2-compute-context"),"win32"===require("os").platform()&&app.commandLine.appendSwitch("use-angle","OpenGL"),app.allowRendererProcessReuse=!1,process.env.BROWSERSLIST_IGNORE_OLD_DATA=!0;const _uncaughtExceptionFunc=e=>{global.Editor&&Editor.Metrics.trackException({code:-1,message:e.message}),process.send&&process.connected&&process.send({channel:"editor-error",message:e.message,stack:e.stack}),console.error(e)};process.on("uncaughtException",_uncaughtExceptionFunc),async function(){require("@editor/creator/dist/require");const e=require("@editor/creator/dist/startup/browser/init");await e.init(),require("@editor/creator");const r=require("@editor/setting");if(r.PATH.PROJECT){const e=join(r.PATH.PROJECT,"temp/crash");app.setPath("crashDumps",e),crashReporter.start({uploadToServer:!1})}if(!r.PATH.PROJECT){const e=require("./dashboard/startup");return await e.app(),void await e.validation(r.dev)}const t=require("@editor/creator/dist/startup").Startup;if(r.args.build){await t.manager(!0,!!r.args.metric),await t.package({disable:[]});const e={};r.args.build.split(";").forEach(r=>{if(!r)return;const t=r.split("=");e[t[0].trim()]=t[1]});const a=await t.build(e,r.args.dev);app.exit(a)}else await Editor.Profile.setConfig("scene","scene.native",!1),await Promise.all([t.manager(!!r.args.nologin,!!r.args.metric),t.window(e=>{const{initNativize:r,Nativize:t}=require("./nativize/dist");Editor.Nativize=t,r(e)})]),await t.package({disable:[]})}();