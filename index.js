"use strict";require("@editor/creator");const{existsSync:existsSync}=require("fs"),{join:join}=require("path"),setting=require("@editor/setting"),{app:app,crashReporter:crashReporter}=require("electron");app.disableDomainBlockingFor3DAPIs(),app.commandLine.appendSwitch("ignore-gpu-blacklist"),app.allowRendererProcessReuse=!1,app.commandLine.appendSwitch("enable-webgl2-compute-context"),"win32"===require("os").platform()&&app.commandLine.appendSwitch("use-angle","OpenGL"),app.allowRendererProcessReuse=!1;const _uncaughtExceptionFunc=e=>{global.Editor&&Editor.Metrics.trackException({code:-1,message:e.message}),process.send&&process.connected&&process.send({channel:"editor-error",message:e.message,stack:e.stack}),console.error(e)};process.on("uncaughtException",_uncaughtExceptionFunc),function(){if(setting.PATH.PROJECT){const e=join(setting.args.project,"temp/crash");app.setPath("crashDumps",e),crashReporter.start({uploadToServer:!1})}}(),async function(){if(!setting.PATH.PROJECT){const e=require("./dashboard/startup");return await e.app(),void await e.validation(setting.dev)}const e=require("@editor/creator/dist/startup").Startup;if(setting.args.build){await e.manager(!0),await e.package({disable:[]});const t={};setting.args.build.split(";").forEach(e=>{if(!e)return;const a=e.split("=");t[a[0].trim()]=a[1]});const a=await e.build(t,setting.args.dev);app.exit(a)}else await Promise.all([e.manager(!!setting.args.nologin),e.window(e=>{const{initNativize:t,Nativize:a}=require("./nativize/dist");Editor.Nativize=a,t(e)})]),await e.package({disable:[]})}();