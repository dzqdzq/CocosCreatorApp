"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCurrentString=exports.hasKey=exports.getString=exports.setCurrentLanguage=void 0;const path=require("path"),fs=require("fs"),cfgInfo=require("./strings"),DEFAULTLANGUAGE="en";let locale=null,curLangString=null,defaultLangString=null;function getEnvLocale(){const n={lang:"en"};let e=process.env,t=e.LCALL||e.LCMESSAGES||e.LANG||e.LANGUAGE||Intl.DateTimeFormat().resolvedOptions().locale;return t?{lang:t.split(".")[0]||n.lang}:n}function getAvaiableLangs(){return cfgInfo?Object.keys(cfgInfo):[]}function getLangKey(n){let e=n.split("_");return"zh"==e[0]?1==e.length||"cn"==e[1]?"zh":"zhTr":e[0]}function doInit(){locale=getEnvLocale(),(curLangString=cfgInfo[getLangKey(locale.lang)])||(curLangString=cfgInfo[DEFAULTLANGUAGE]),defaultLangString=cfgInfo[DEFAULTLANGUAGE]}function setCurrentLanguage(n){let e=getLangKey(n);n in cfgInfo?(curLangString=cfgInfo[n],locale.lang=n):e in cfgInfo?(curLangString=cfgInfo[e],locale.lang=e):console.warn()}function getString(n,...e){if(curLangString){let t=curLangString[n];if(!t)return`[KEY "${n}" is not found! lang: ${locale.lang}]`;if(0==e.length)return t;let r=Array.from(t),g=[],a=r.length,o=0,u=0,l=0;for(;o<a;)"%"==r[o]?("d"==r[o+1]||"f"==r[o+1]?(g.push(e[u++]+""),l++):"s"==r[o+1]?(g.push(e[u++]+""),l++):"%"==r[o+1]?g.push("%"):(g.push(e[u++]+""),l++),o+=2):(g.push(r[o]),o+=1);return l!=e.length&&console.error(`format argument mismatch: ${t} & ${e.join(", ")}`),g.join("")}return`[language ${locale.lang} not set, key ${n}]`}function hasKey(n,e){return!!e&&n in e}function getCurrentString(n){let e;return hasKey(n,curLangString)?e=curLangString[n]:hasKey(n,defaultLangString)&&(e=defaultLangString[n]),e||n}doInit(),exports.setCurrentLanguage=setCurrentLanguage,exports.getString=getString,exports.hasKey=hasKey,exports.getCurrentString=getCurrentString;