"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buttonConfig=exports.ready=exports.update=exports.$=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),options_1=require("./options"),lodash=require("lodash");let panel;exports.template=fs_1.readFileSync(path_1.join(__dirname,"../../static/builder/view.html"),"utf8");const methods={async onSetSDK(){Editor.Message.send("preferences","open-settings","program")},getDefaultPackageName:()=>options_1.defaultOptions.packageName,async onConfirm(e){const t=e.target.value,a=e.target.getAttribute("path");await this.onUpdateOptions(a,t),this.emitChange()},async onUpdateOptions(e,t){if(!e)return;lodash.set(this.pkgOptions,e,t);const a=await options_1.verificationFunc(e,t,this.options);this.$set(this.pkgErrorMap,e,a.error)},emitChange(){panel.dispatch("update",`packages.${this.pkgName}`,this.pkgOptions,this.pkgErrorMap)},async init(){const e=this;e.pkgOptions=lodash.get(panel.options,`packages.${panel.options.platform}`)||{},e.pkgErrorMap=lodash.get(panel.errorMap,`packages.${panel.options.platform}`)||{},e.apiLevels=await getOHOSAPILevels(),e.apiLevels.length||(e.pkgErrorMap.apiLevels="i18n.ohos.tips.apilevel_empty",e.emitChange())}};async function update(e,t){panel=this,t&&!t.startsWith(`packages.${panel.pkgName}`)||(panel.options=e,panel.vm.init())}function ready(e,t,a,o){panel=this;const p=require("vue/dist/vue.js");panel.options=e,panel.pkgName=a,panel.errorMap=o,panel.vm=new p({el:panel.$.root,methods:methods,data:()=>({pkgName:a,options:panel.options,errorMap:panel.errorMap,pkgOptions:{},pkgErrorMap:{},apiLevels:[],appABIList:["armeabi-v7a","arm64-v8a","x86"]}),mounted(){this.init()},components:{"build-prop":BuildPanel.vueComps.buildProp,"template-comp":BuildPanel.vueComps.templateComp}})}async function getOHOSAPILevels(){const e=await Editor.Profile.getConfig("program","ohos_sdk");return e&&fs_1.existsSync(e)?["4","5"]:[]}exports.$={root:".ohos"},exports.update=update,exports.ready=ready,exports.buttonConfig={configs:{make:{label:"i18n:ohos.make.label",hookHandle:"make"},run:{label:"i18n:ohos.run.label",hookHandle:"run"}}};