"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterInit=exports.throwError=void 0;const fs_1=require("fs"),path_1=require("path");async function generateOptions(e){var t,n,o,r,a,i,s,d,l,p,u,c;const k=e.packages.android;if(k.orientation=k.orientation||{},k.sdkPath=await Editor.Profile.getConfig("program","android_sdk")||"",k.ndkPath=await Editor.Profile.getConfig("program","android_ndk")||"",!k.sdkPath||!k.ndkPath)throw new Error(Editor.I18n.t("android.tips.android_sdk_error"));return{packageName:k.packageName||"",orientation:{landscapeRight:null===(t=k.orientation.landscapeRight)||void 0===t||t,landscapeLeft:null===(n=k.orientation.landscapeLeft)||void 0===n||n,portrait:null!==(o=k.orientation.portrait)&&void 0!==o&&o,upsideDown:null!==(r=k.orientation.upsideDown)&&void 0!==r&&r},apiLevel:k.apiLevel||"",appABIs:k.appABIs||[],useDebugKeystore:k.useDebugKeystore,keystorePath:k.keystorePath||"",keystorePassword:k.keystorePassword||"",keystoreAlias:k.keystoreAlias||"",keystoreAliasPassword:k.keystoreAliasPassword||"",appBundle:null!==(a=k.appBundle)&&void 0!==a&&a,androidInstant:null!==(i=k.androidInstant)&&void 0!==i&&i,remoteUrl:k.remoteUrl||"",sdkPath:k.sdkPath||"",ndkPath:k.ndkPath||"",renderBackEnd:{vulkan:null===(d=null===(s=k.renderBackEnd)||void 0===s?void 0:s.vulkan)||void 0===d||d,gles3:null===(p=null===(l=k.renderBackEnd)||void 0===l?void 0:l.gles3)||void 0===p||p,gles2:null===(c=null===(u=k.renderBackEnd)||void 0===u?void 0:u.gles2)||void 0===c||c}}}async function onAfterInit(e,t){var n,o,r;const a=(await generateOptions(e)).renderBackEnd;e.assetSerializeOptions["cc.EffectAsset"].glsl1=null===(n=a.gles2)||void 0===n||n,e.assetSerializeOptions["cc.EffectAsset"].glsl3=null===(o=a.gles3)||void 0===o||o,e.assetSerializeOptions["cc.EffectAsset"].glsl4=null===(r=a.vulkan)||void 0===r||r;const i=path_1.join(Editor.Project.path,"native","android","res","values","strings.xml");if(fs_1.existsSync(i)){fs_1.readFileSync(i,"utf8")}}exports.throwError=!0,exports.onAfterInit=onAfterInit;