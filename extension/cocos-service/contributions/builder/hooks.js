const _0x42dd=["services","stringify","get","use strict","shift","plugins","app_id","builder","service_component_name","has","cocos-service","cocos_uid","sdkhUbServiceIntegrationFailed","sdkhub$$","getUserData","sort","huaweiServiceIntegrationFailed","packages","csConfig","csAnalytics","Building Time","readServiceList","sdkHubConfig","throwError","csEditor","huaweiServiceIntegrationSuccess","test","path","service_id","service-sdkhub","packageName","onBeforeCompressSettings","onAfterBuild","readBindGame","clear","sdkhUbServiceIntegrationSuccess","checkCocosService","csFile","message","require","join","enable","find","../../utils","getProjectPath","substr","onAfterCompressSettings","length","updateConfigInfos","push","settings/agconnect-services.json","getPlatformID"];!function(e,c){!function(c){for(;--c;)e.push(e.shift())}(++c)}(_0x42dd,190);const _0x2560=function(e,c){return _0x42dd[e-=342]},_0x5d905c=_0x2560,_0x56cd=[_0x5d905c(344),_0x5d905c(370),_0x5d905c(367),_0x5d905c(354),_0x5d905c(350),_0x5d905c(389),_0x5d905c(358),_0x5d905c(375),_0x5d905c(360),_0x5d905c(383),_0x5d905c(386),_0x5d905c(384),_0x5d905c(365),"service_id",_0x5d905c(353),_0x5d905c(380),"existsSync",_0x5d905c(345),_0x5d905c(392),_0x5d905c(378),_0x5d905c(390),_0x5d905c(342),"serviceIntegrationFailed","processCommonNativeModule",_0x5d905c(372),_0x5d905c(391),_0x5d905c(351),"service_component_name",_0x5d905c(366),_0x5d905c(349),_0x5d905c(381),_0x5d905c(382),"readJson",_0x5d905c(371),_0x5d905c(359),_0x5d905c(374),"defineProperty",_0x5d905c(376),_0x5d905c(369),_0x5d905c(373),"csUtil","onBeforeBuild","serviceIntegrationSuccess","packages","__esModule",_0x5d905c(362),_0x5d905c(346),_0x5d905c(355),"client",_0x5d905c(379),"pUseType",_0x5d905c(347),_0x5d905c(343)];!function(e,c){!function(c){const s=_0x2560;for(;--c;)e[s(357)](e[s(364)]())}(++c)}(_0x56cd,348);const _0xfe62=function(e,c){return _0x56cd[e-=289]},_0x32722a=_0xfe62;_0x5d905c(363),Object[_0x32722a(295)](exports,_0x32722a(303),{value:!0}),exports[_0x32722a(330)]=exports[_0x32722a(315)]=exports[_0x32722a(337)]=exports[_0x32722a(300)]=exports[_0x32722a(321)]=void 0;const fs_extra_1=require("fs-extra"),path_1=require(_0x5d905c(387)),utils_1=require(_0x32722a(338)),common_1=require("./common");exports[_0x32722a(321)]=!0;let buildCache=new Map;function compareService(e,c){const s=_0x5d905c,t=_0x32722a;return e[s(349)]===c[t(341)]?0:c[s(349)]?-1:1}let processServiceHooks=async(e,c,s)=>{const t=_0x5d905c,o=_0x32722a;let i=e[t(377)][o(313)],r=common_1[o(293)](e);if(void 0===i||0===i[o(320)][o(306)])return;o(300)===s&&buildCache[o(333)]();const a=i[o(320)][o(319)](compareService);for(const i of a){if(!fs_extra_1[o(328)](i[o(314)]))break;let a=(await utils_1[o(331)][o(289)]())[o(316)](e=>e[t(388)]===i[o(325)]);buildCache[o(297)](i[o(339)])||buildCache.set(i[o(339)],utils_1[o(299)][o(310)](i[o(314)]));let n=buildCache[o(304)](i[o(339)]);if(void 0===n)break;try{switch(s){case o(300):n.onBeforeBuild&&await n[o(300)](e,c);break;case o(337):n[t(391)]&&await n[t(391)](e,c);break;case o(315):n[o(315)]&&await n[o(315)](e,c);break;case o(330):n[t(392)]&&await n[o(330)](e,c),a&&processServiceIntegration(r,a,e)}}catch(c){throw a&&processServiceIntegration(r,a,e,(c instanceof Error?c[o(305)]:JSON[t(361)](c))||""),c}}};async function onBeforeBuild(e,c){const s=_0x5d905c,t=_0x32722a;await common_1[s(344)](e)&&(await common_1[s(356)](e),await processServiceHooks(e,c,t(300)))}async function onBeforeCompressSettings(e,c){const s=_0x32722a;await common_1[s(312)](e)&&await processServiceHooks(e,c,s(337))}async function onAfterCompressSettings(e,c){const s=_0x32722a;await common_1[s(312)](e)&&(common_1[s(335)](c),await processServiceHooks(e,c,s(315)))}async function onAfterBuild(e,c){const s=_0x32722a;await common_1[s(312)](e)&&await processServiceHooks(e,c,s(330))}async function processServiceIntegration(e,c,s,t){const o=_0x5d905c,i=_0x32722a;let r=(await utils_1[i(323)][i(294)]())[i(292)],a=await utils_1[i(331)][o(393)](),n="",_=path_1[o(348)](utils_1[i(323)][o(352)](),i(318));/^service-(agc|hms|sdkhub)/[i(322)](c[i(339)])&&fs_extra_1[i(328)](_)&&(n=utils_1[i(329)][i(291)](_)[i(307)][i(340)]);let d="";if(i(317)===c[i(339)]){let e=s[i(302)][i(313)][i(290)];if(e&&"{}"!==JSON[o(361)](e))for(let c of e[i(324)])d+=","+c[i(332)]+":"+c[i(309)]}void 0===t?/^service-(agc|hms)/[o(386)](c[i(339)])?utils_1[i(308)][o(385)](r,a,c,e,n,o(380)):i(317)===c[o(368)]?utils_1[o(379)][i(311)](r,a,c,e,n,o(380),i(298)+d[o(353)](1)):utils_1[i(308)][i(301)](r,a,c,e,i(327)):/^service-(agc|hms)/[i(322)](c[i(339)])?utils_1[o(379)][i(296)](r,a,c,e,n,i(327),t):i(317)===c[o(368)]?utils_1[i(308)][i(336)](r,a,c,e,n,i(327),i(298)+d[i(326)](1),t):utils_1[i(308)][i(334)](r,a,c,e,i(327),t)}exports[_0x32722a(300)]=onBeforeBuild,exports[_0x32722a(337)]=onBeforeCompressSettings,exports[_0x32722a(315)]=onAfterCompressSettings,exports[_0x32722a(330)]=onAfterBuild;