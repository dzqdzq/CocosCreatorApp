"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.insertServiceCmakeToCmakeList=exports.generateServiceCamke=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path");function _insertCodeLine(e,r,i,t=!1){if(!fs_extra_1.existsSync(e))return;let n=fs_extra_1.readFileSync(e,"utf8");null!==n.match(r)&&fs_extra_1.writeFileSync(e,n.replace(r,t?`${i}$1`:`$1${i}`))}function _replaceContent(e,r,i){if(!fs_extra_1.existsSync(e))return;let t=fs_extra_1.readFileSync(e,"utf8");null!==t.match(r)&&fs_extra_1.writeFileSync(e,t.replace(r,i))}function _checkFileContent(e,r){if(!fs_extra_1.existsSync(e))return;return null!==fs_extra_1.readFileSync(e,"utf8").match(r)}function _insertServiceCmakeToCmakeList(e,r,i){do{if(!fs_extra_1.existsSync(e))break;_insertCodeLine(e,r,"\n# -------------- SRART ---------------\n# USED BY COCOS SERVICE, DON'T REMOVE!\nif(EXISTS ${RES_DIR}/proj/service.cmake)\n    set(SERVICE_NATIVE_DIR ${CMAKE_CURRENT_LIST_DIR})\n    include(${RES_DIR}/proj/service.cmake)\nendif()\n# --------------  END ----------------\n\n",!0),_insertCodeLine(e,i,"\n# -------------- SRART ---------------\n# USED BY COCOS SERVICE, DON'T REMOVE!\nif(COMMAND service_insert_library)\n    service_insert_library()\nendif()\n# --------------  END ----------------\n\n",!0)}while(0)}function generateServiceCamke(e){let r=path_1.join(e,"proj/service.cmake");if(!fs_extra_1.existsSync(path_1.dirname(r))||fs_extra_1.existsSync(r))return;fs_extra_1.createFileSync(r),fs_extra_1.writeFileSync(r,"# Supported for Cocos Service!\n# insert source files\n#_SRC_\n# insert library files\nFunction(service_insert_library)\n    #_LIB_\nendfunction(service_insert_library)")}function insertServiceCmakeToCmakeList(e){["android","huawei-agc","ios"].forEach(r=>{let i=path_1.join(e,`engine/${r}/CMakeLists.txt`);_checkFileContent(i,/proj\/service.cmake/)||_insertServiceCmakeToCmakeList(i,/(list\(APPEND PROJ_SOURCES)/,/(target_link_libraries\(\$\{LIB_NAME\})/)})}exports.generateServiceCamke=generateServiceCamke,exports.insertServiceCmakeToCmakeList=insertServiceCmakeToCmakeList;