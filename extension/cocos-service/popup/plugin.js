"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__importStar(require("../utils"));exports.default={pluginContainer:{},_initServicePluginInfo:function(e){var t;let n=utils_1.csPlugin.getServicePluginInfo(e);void 0!==n&&(this.pluginContainer.pluginInfo=n,(null===(t=n.contents)||void 0===t?void 0:t.popup)&&(this.pluginContainer.plugin=utils_1.csUtil.require(n.path,n.contents.popup.main)))},getServicePluginInfo:function(e){return this.pluginContainer.pluginInfo||this._initServicePluginInfo(e),this.pluginContainer.pluginInfo},getServicePlugin:function(e){return this.pluginContainer.pluginInfo||this._initServicePluginInfo(e),this.pluginContainer.plugin},createInnerHTML:function(e,t){t.innerHTML=e.template;let n=document.createElement("style");if(n.setAttribute("type","text/css"),n.textContent=utils_1.csFile.readFile(__dirname,"./panel.css"),t.insertBefore(n,t.firstChild),e.style){let i=document.createElement("style");i.setAttribute("type","text/css"),i.textContent=e.style,t.insertBefore(i,n.nextSibling)}if(e.$){let n=JSON.parse(JSON.stringify(e.$));for(let i of Object.keys(n)){if("string"!=typeof e.$[i])return;e.$[i]=t.querySelector(n[i])}}this.pluginContainer.plugin=e},loadPopup:async function(e){let t=this.getServicePlugin(e);if(t&&t.load&&await t.load(utils_1.default),t&&t.methods)for(let n in t.methods)utils_1.csEvent.on(`${e}:popup:${n}`,t.methods[n].bind(t))},unloadPopup:async function(e){let t=this.getServicePlugin(e);if(t&&t.unload&&await t.unload(),t&&t.methods)for(let n in t.methods)utils_1.csEvent.removeListener(`${e}:popup:${n}`,t.methods[n])}};