"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,a){void 0===a&&(a=i),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,a){void 0===a&&(a=i),e[a]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const vue_1=__importDefault(require("../../../vue")),core_1=__importDefault(require("../../core")),utils_1=__importStar(require("../../../utils"));exports.default=vue_1.default.extend({template:utils_1.csFile.readFile(__dirname,"./bind-game.html"),props:{islogin:{type:Boolean}},data(){return{isLogin:this.islogin,defaultSelected:"0",selected:"0",_games:[],games:{personGame:{type:utils_1.csEditor.tr("person_game"),list:[]},companyGame:{type:utils_1.csEditor.tr("company_game"),list:[]}},game:{name:utils_1.csEditor.tr("unknow_game"),app_id:"UNKNOW",c_id:"0"}}},async created(){this.defaultSelected="0",this.isLogin&&await this.computeGame()},methods:{async handleBindGame(){if("0"!==this.selected)this.$emit("bind-game",this.game);else{0===await utils_1.csEditor.dialogMsgBox("warn",utils_1.csEditor.tr("create_game_tips"),utils_1.csEditor.tr('"dialog_title'),[utils_1.csEditor.tr("btn_create"),utils_1.csEditor.tr("btn_know")],0)&&this.handleCreateGame()}},async handleCreateGame(){utils_1.default.openCocosUrl(await core_1.default.getUrl("cocos_game_create_url")),utils_1.csAnalytics.ctrateGame()},handleRefreshGame(){this.refreshGame()},handleSelectChange(e){if(this.selected=e.target.value,"0"===this.selected)return;let t=this._games.find(e=>e.app_id===this.selected);this.game={app_id:this.selected,c_id:`${t.corporation_id}`,name:t.game_name}},handleClose(){utils_1.csEvent.emit("hide-bind-game")},async refreshGame(){utils_1.csEvent.emit("show-loading",utils_1.csEditor.tr("reloading_data")),await this.computeGame(),this.isLogin=!1,this.$nextTick(()=>this.isLogin=!0),utils_1.csEvent.emit("hide-loading")},async computeGame(){this._games=await core_1.default.getGames(!0),this.games.personGame.list=[],this.games.companyGame.list=[];for(let e of this._games)0===e.corporation_id?this.games.personGame.list.push(e):this.games.companyGame.list.push(e)}}});