"use strict";var __importDefault=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(exports,"__esModule",{value:!0});const vue_1=__importDefault(require("../../../vue")),utils_1=require("../../../utils");exports.default=vue_1.default.extend({template:utils_1.csFile.readFile(__dirname,"./config-set.html"),props:{action:{type:String,default:()=>"add"},config:{type:Object},configs:{type:Array}},created(){this.title="add"===this.action?utils_1.csEditor.tr("add_config_set"):utils_1.csEditor.tr("edit_config_set"),this.configRemarks="add"===this.action?"":this.config.config_remarks,"copy"===this.act?this.configName=this.getCopedConfigName(this.config.config_name):"edit"===this.act&&(this.configName=this.config.config_name)},watch:{configName(i,t){this.enableConfirm=""!==i,"edit"==this.act&&(this.enableConfirm=i!==this.config.config_name)},configRemarks(i,t){this.enableConfirm=""!==i,"edit"==this.act&&(this.enableConfirm=i!==this.config.config_remarks)}},mounted(){},data(){return{show:!0,enableConfirm:!1,title:"",configName:"",configRemarks:"",act:this.action}},methods:{getCopedConfigName(i){let t=/-[1-9][0-9]*$/,e=1;if(t.test(i)){let n=i.match(t);null!==n&&(e=parseInt(n[0].substr(1))+1),i=i.replace(t,"")}let n="";for(;;){if(n=`${i}-${e}`,0===this.configs.filter(i=>i.config_name===n).length)break;e++}return n},handleClose(){utils_1.csEvent.emit("hide-config-set")},handleConfirm(){if(this.configName=this.configName.trim(),0===this.configName.length)return void utils_1.csLogger.warn(utils_1.csEditor.tr("config_set.name_empty"));if(/\\/.test(this.configName))return void utils_1.csLogger.warn(utils_1.csEditor.tr("config_set.name_rule"));if(utils_1.csUtil.getByteLength(this.configName)>40)return void utils_1.csLogger.warn(utils_1.csEditor.tr("config_set.name_length"));let i={};if("edit"===this.act){if(this.configs.filter(i=>i.config_name===this.configName&&i.config_id!==this.config.config_id).length>0)return void utils_1.csLogger.warn(utils_1.csEditor.tr("config_set.same_name"));i={config_id:this.config.config_id,config_name:this.configName,config_remarks:this.configRemarks}}else{if(this.configs.filter(i=>i.config_name===this.configName).length>0)return void utils_1.csLogger.warn(utils_1.csEditor.tr("config_set.same_name"));i=utils_1.csConfig.generateConfigSet(this.configName,this.configRemarks)}this.$emit("save-config",i,this.act),utils_1.csEvent.emit("hide-config-set")}}});