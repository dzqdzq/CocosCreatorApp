"use strict";const _0x49baa9=_0x5f48;function _0x1e19(e,t){const i=_0x5e25();return(_0x1e19=function(e,t){return i[e-=196]})(e,t)}!function(e,t){const i=_0x5f48,a=_0x15ba();for(;;)try{if(712167===-parseInt(i(162))/1+parseInt(i(135))/2+parseInt(i(107))/3+parseInt(i(186))/4*(parseInt(i(171))/5)+-parseInt(i(163))/6+-parseInt(i(139))/7*(-parseInt(i(132))/8)+-parseInt(i(153))/9)break;a.push(a.shift())}catch(e){a.push(a.shift())}}();const _0x3611ac=_0x1e19;function _0x5f48(e,t){const i=_0x15ba();return(_0x5f48=function(e,t){return i[e-=107]})(e,t)}function _0x15ba(){const e=["name","generateConfigSet","min","3941fEwgsh","1057788YGHouy","1592UgXWks","defineProperty","path","cid","readConfigSets","shift","44605RmaVPM","readServiceList","__esModule","1768CwLlPm","writeGlobalProfile","All","push","map","1008008xNpNEr","find","groups","1056730iKSjLG","default","Config file error! (copyConfigSet => appConfigMaps.find)","Config file error! (readEnableServices => readConfigSet)","21OQwevH","readConfigSet","Default","config_id","appid","Config file error! (copyConfigSet => configs.find)","readProjectProfile","readGlobalProfile","UNKNOW","lang","splice","2811HJtJBR","444fsabFU","Config file error! (wirteEnableService => config.find)","3457899MtVwbf","2.0.0","game","writeConfigSet","forEach","config_remarks","join","Config file error! (writeServiceParam => readConfigSet)","length","804919QAwpIN","3647016JYWtWH","__importDefault","appConfigMaps","findIndex","1805oXAfnF","filter","11207ddIUvK","compareVersion","654060CstrDE","service_id","getLang","param","writeProjectProfile","services","enable","filter.","1360euWMVA","generateID","app_id","configs","config_name","fs-extra","settings/service.json","28KOdCCk","test","2061243BzNTNt","writeBindGame","getProjectPath","Config file error! (wirteEnableService => readConfigSet)","game.app_id","Config file error! (deleteConfigSet => configs.findIndex)"];return(_0x15ba=function(){return e})()}!function(e,t){const i=_0x5f48,a=_0x1e19,r=_0x5e25();for(;;)try{if(324358===parseInt(a(240))/1*(-parseInt(a(261))/2)+parseInt(a(265))/3*(-parseInt(a(234))/4)+-parseInt(a(215))/5*(-parseInt(a(231))/6)+-parseInt(a(223))/7*(-parseInt(a(243))/8)+-parseInt(a(241))/9+parseInt(a(260))/10*(-parseInt(a(230))/11)+-parseInt(a(259))/12*(-parseInt(a(212))/13))break;r[i(130)](r[i(123)]())}catch(e){r[i(130)](r[i(123)]())}}();var __importDefault=this&&this[_0x3611ac(264)]||function(e){return e&&e[_0x3611ac(251)]?e:{default:e}};Object[_0x3611ac(246)](exports,_0x3611ac(251),{value:!0});const editor_1=__importDefault(require("./editor")),util_1=__importDefault(require(_0x3611ac(221))),path_1=require(_0x3611ac(225)),fs_extra_1=require(_0x3611ac(244));let generateConfigItem=(e,t,i=[])=>({app_id:e,config_id:t[_0x49baa9(142)],config_name:t[_0x3611ac(207)],config_remarks:t[_0x3611ac(217)],services:i}),getConfigSetByConfig=e=>({config_id:e[_0x3611ac(245)],config_name:e[_0x49baa9(183)],config_remarks:e[_0x3611ac(217)]});function _0x5e25(){const e=_0x49baa9,t=[e(157),e(138),e(125),e(124),"3858AxcDDE",e(115),e(111),e(118),e(136),e(178),e(168),e(129),e(121),e(116),e(117),e(170),e(127),e(184),e(142),e(119),e(114),e(177),e(130),e(141),e(126),e(147),e(128),e(122),e(148),e(182),e(180),e(144),e(151),e(179),"134DLfxOz",e(185),e(165),e(164),e(150),"app_id",e(108),"existsSync",e(149),"services",e(156),e(155),e(146),e(172),e(154),e(161),"max",e(166),e(134),e(183),e(174),e(159),e(160),e(110),"366951BJkYkd","Config file error! (readServiceParam => readConfigSet)","cscv",e(167),e(133),"config_remarks",e(112),e(140),e(175),"./util",e(173),e(169),e(187),e(120),"readProjectProfile"];return(_0x5e25=function(){return t})()}exports[_0x3611ac(235)]={updateConfigFile:async function(){return new Promise(async(e,t)=>{const i=_0x5f48,a=_0x1e19;let r=async e=>{const t=_0x5f48,i=_0x1e19;e[t(131)](e=>{const i=t,a=_0x1e19;if(void 0!==e[a(245)])return;let r=this[i(114)](a(250));e[a(245)]=r[a(245)],e[a(207)]=r[a(207)],e[a(217)]=r[a(217)]}),await editor_1[i(235)][i(220)](i(256),e)},n=async e=>{const t=_0x5f48,i=_0x1e19;if(null!=e){if(void 0!==e[i(256)]&&e[i(256)]instanceof Array&&await r(e[i(256)]),void 0!==e[i(199)]){let a=e.game;this[i(267)]({app_id:a[t(143)]||a[i(266)]||i(252),name:a[t(113)],c_id:a[i(239)]||"0"})}let a=await editor_1[i(235)][i(226)](i(233)),n=await this[i(254)](a);n[i(203)]>0&&await editor_1[i(235)][i(220)](t(165),[{app_id:a,config_id:n[0][i(245)]}]),await editor_1[i(235)][t(175)](i(214),i(202))}},o=await editor_1[a(235)][i(145)](a(214));if(void 0!==o&&0===util_1[a(235)][a(242)](o,i(154)))return e();let c=(0,path_1[a(209)])(editor_1[a(235)][i(109)](),a(262));if((0,fs_extra_1[a(268)])(c)&&(void 0===await editor_1[a(235)][i(145)](a(199))||null===await editor_1[a(235)][a(226)]("game")))try{n((0,fs_extra_1.readJsonSync)(c))}catch(t){return e()}e()})},generateConfigSet:function(e,t=""){const i=_0x3611ac;return{config_id:util_1[i(235)][i(257)](e),config_name:e,config_remarks:t}},copyConfigSet:async function(e,t="",i=""){return new Promise(async(a,r)=>{const n=_0x5f48,o=_0x1e19;if(""===i&&(i=await editor_1[o(235)][o(226)](n(111))),""===t){let e=(await editor_1[o(235)][o(226)]("appConfigMaps")||[])[n(133)](e=>e.app_id===i);if(void 0===e)return r(n(137));t=e[o(245)]}let c=await editor_1[o(235)][o(226)](o(256))||[],f=c[n(133)](e=>e[o(266)]==i&&e.config_id===t);if(void 0===f)return r(o(258));let s=generateConfigItem(i,e,f[o(197)]||[]);c[n(130)](s),await editor_1[o(235)][o(220)](o(256),c),a()})},deleteConfigSet:async function(e,t=""){return new Promise(async(i,a)=>{const r=_0x5f48,n=_0x1e19;""===t&&(t=await editor_1[n(235)][n(226)](n(233)));let o=await editor_1[n(235)][n(226)](n(256));o||(o=[]);let c=o[n(205)](i=>i[n(266)]==t&&i[r(142)]===e);if(c<0)return a(n(218));o[n(196)](c,1),await editor_1[n(235)][n(220)](n(256),o);let f=o[n(237)](e=>e[n(266)]===t);i(f[Math[n(204)](Math[n(232)](f[n(203)]-1,c-1),0)])})},readServiceList:async function(){const e=_0x3611ac;return await editor_1[e(235)][e(200)](e(197))||[]},writeServiceList:async function(e){const t=_0x49baa9,i=_0x3611ac;return await editor_1[i(235)][i(253)](i(255),editor_1[t(136)][t(173)]()),await editor_1[i(235)][t(128)](i(197),e)},readServiceGroupList:async function(){const e=_0x3611ac;return await editor_1[e(235)][e(200)](e(206))||[]},writeServiceGroupList:async function(e){const t=_0x49baa9,i=_0x3611ac;return await editor_1[t(136)][t(128)](t(148),editor_1[i(235)][i(222)]()),await editor_1[i(235)][i(253)](i(206),e)},readServiceFilter:async function(){const e=_0x49baa9,t=_0x3611ac;return await editor_1[t(235)][e(146)](t(236)+editor_1[t(235)][t(222)]())||{status:t(238),platforms:[t(238)]}},writeServiceFilter:async function(e){const t=_0x3611ac;return await editor_1[t(235)][t(253)](t(236)+editor_1[t(235)][t(222)](),e)},readBindGame:async function(){const e=_0x49baa9,t=_0x3611ac;return await editor_1.default[e(145)](t(199))},writeBindGame:async function(e){return new Promise(async(t,i)=>{const a=_0x1e19;await editor_1[a(235)][a(220)](a(199),e);let r=await this[a(219)](e[a(266)]);if(void 0===r){let t=await this[a(254)](e[a(266)]);t[a(203)]>0&&(r=t[0])}void 0===r&&(r=this[a(247)](a(250))),await this[a(198)](r,e[a(266)]),t()})},readConfigSet:async function(e=""){return new Promise(async(t,i)=>{const a=_0x5f48,r=_0x1e19;""===e&&(e=await editor_1[r(235)][r(226)](r(233)));let n,o=await editor_1[a(136)][a(145)](r(263))||[];do{let t=o[r(216)](t=>t[r(266)]===e),i=await editor_1[a(136)][r(226)](r(256));if(void 0===t||null===i)break;let c=i[a(133)](i=>i[r(266)]==e&&i[r(245)]==(null==t?void 0:t[r(245)]));if(void 0===c)break;n=getConfigSetByConfig(c)}while(0);t(n)})},writeConfigSet:async function(e,t=""){return new Promise(async(i,a)=>{const r=_0x5f48,n=_0x1e19;""===t&&(t=await editor_1[n(235)][r(145)]("game.app_id"));let o=await editor_1[n(235)][n(226)](n(263))||[],c=o[n(216)](e=>e[n(266)]===t);void 0===c?(c={app_id:t,config_id:e[n(245)]},o[n(249)](c)):c[n(245)]=e[n(245)],await editor_1.default[n(220)](r(165),o);let f=await editor_1[n(235)][n(226)](n(256));f||(f=[]);let s=f[n(216)](i=>i[n(266)]==t&&i[n(245)]===e[n(245)]);void 0===s?f[n(249)](generateConfigItem(t,e)):(s.config_id=e[n(245)],s[n(207)]=e[n(207)],s[n(217)]=e[r(158)]),await editor_1[n(235)][n(220)](n(256),f),i()})},readConfigSets:async function(e=""){return new Promise(async(t,i)=>{const a=_0x5f48,r=_0x1e19;""===e&&(e=await editor_1[a(136)][r(226)](a(111)));let n=await editor_1[r(235)].readProjectProfile("configs");n||(n=[]);let o=[];n[r(237)](t=>t[r(266)]===e)[r(227)](e=>e[a(142)]&&o[r(249)](getConfigSetByConfig(e))),t(o)})},readEnableServices:async function(e=""){return new Promise(async(t,i)=>{const a=_0x5f48,r=_0x1e19;let n=await editor_1[a(136)][a(145)](a(111));if(""===e){let t=await this[r(219)]();if(void 0===t)return i(r(228));e=t[a(142)]}let o=await editor_1[r(235)][r(226)](r(256));o||(o=[]);let c=[];do{let t=o[a(133)](t=>t.app_id==n&&t[r(245)]===e);if(void 0===t||void 0===t[r(197)]||0===t[r(197)][r(203)])break;t[r(197)][a(168)](e=>e[r(248)])[r(227)](e=>c[r(249)](e[a(172)]))}while(0);t(c)})},wirteEnableService:async function(e,t,i=""){return new Promise(async(a,r)=>{const n=_0x5f48,o=_0x1e19;let c=await editor_1[o(235)][n(145)](n(111));if(""===i){let e=await this[n(140)]();if(void 0===e)return r(o(211));i=e[o(245)]}let f=await editor_1[n(136)][o(226)](o(256));f||(f=[]);let s=f[o(216)](e=>e[n(181)]==c&&e[n(142)]===i);if(void 0===s)return r(n(152));void 0===s[o(197)]&&(s[o(197)]=[]);let _=s[o(197)][o(216)](t=>t[n(172)]===e);void 0===_?(_={service_id:e,enable:t,param:{}},s[o(197)][n(130)](_)):_[o(248)]=t,await editor_1[o(235)][o(220)](o(256),f),a()})},readServiceParam:async function(e,t=""){return new Promise(async(i,a)=>{const r=_0x5f48,n=_0x1e19;let o=await editor_1[n(235)].readProjectProfile("game.app_id");if(""===t){let e=await this[n(219)]();if(void 0===e)return a(n(213));t=e[n(245)]}let c=await editor_1[n(235)].readProjectProfile(n(256));c||(c=[]);let f={};do{let i=c[n(216)](e=>e[r(181)]==o&&e.config_id===t);if(void 0===i||void 0===i[n(197)]||0===i[n(197)][n(203)])break;let a=i[n(197)][n(216)](t=>t[n(201)]===e);void 0!==a&&void 0!==a[n(208)]&&null!==a[n(208)]&&(f=a[r(174)])}while(0);i(f)})},writeServiceParam:async function(e,t,i=""){return new Promise(async(a,r)=>{const n=_0x5f48,o=_0x1e19;let c=await editor_1[n(136)][o(226)]("game.app_id");if(""===i){let e=await this[o(219)]();if(void 0===e)return r(o(210));i=e[o(245)]}let f=await editor_1[o(235)][n(145)](o(256));f||(f=[]);let s=f[o(216)](e=>e[o(266)]==c&&e[o(245)]===i);if(void 0===s)return r(o(210));void 0===s[o(197)]&&(s[n(176)]=[]);let _=s[o(197)][o(216)](t=>t[o(201)]===e);void 0===_?(_={service_id:e,enable:!1,param:t},s[o(197)][n(130)](_)):_[o(208)]=t,await editor_1[o(235)][o(220)](o(256),f),a()})},readDevMode:async function(){const e=_0x3611ac;return 0!==(await this[e(229)]())[e(237)](t=>/service-cocosads/[e(224)](t.service_component_name))[e(203)]}};