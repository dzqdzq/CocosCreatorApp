const _0x3edd=["appid","writeGlobalProfile","readConfigSet","readConfigSets","name","appConfigMaps","app_id","min","writeProjectProfile","push","getLang","game.app_id","length","__importDefault","Config file error! (deleteConfigSet => configs.findIndex)","config_name","cscv","generateID","groups","filter","generateConfigSet","writeConfigSet","compareVersion","enable","existsSync","fs-extra","lang","Config file error! (wirteEnableService => readConfigSet)","Config file error! (readEnableServices => readConfigSet)","filter.","config_remarks","./util","__esModule","UNKNOW","Default","configs","join","find","splice","default","readGlobalProfile","shift","services","map","forEach","game","Config file error! (copyConfigSet => appConfigMaps.find)","config_id","readServiceList","Config file error! (wirteEnableService => config.find)","2.0.0","./editor","param","readProjectProfile","Config file error! (readServiceParam => readConfigSet)"];!function(e,i){!function(i){for(;--i;)e.push(e.shift())}(++i)}(_0x3edd,201);const _0x47aa=function(e,i){return _0x3edd[e-=357]},_0x4cb775=_0x47aa,_0x594b=[_0x4cb775(388),_0x4cb775(408),_0x4cb775(399),_0x4cb775(396),_0x4cb775(394),_0x4cb775(385),_0x4cb775(377),_0x4cb775(411),"game.app_id","app_id",_0x4cb775(380),_0x4cb775(361),"max","cid",_0x4cb775(403),"Config file error! (writeServiceParam => readConfigSet)",_0x4cb775(376),_0x4cb775(375),_0x4cb775(409),_0x4cb775(368),_0x4cb775(401),"settings/service.json",_0x4cb775(373),_0x4cb775(364),_0x4cb775(357),_0x4cb775(378),_0x4cb775(410),_0x4cb775(366),_0x4cb775(389),"service_component_name","readJsonSync",_0x4cb775(374),"All",_0x4cb775(358),"service_id",_0x4cb775(402),_0x4cb775(407),_0x4cb775(379),"config_remarks",_0x4cb775(404),"findIndex","getLang",_0x4cb775(398),_0x4cb775(381),_0x4cb775(405),_0x4cb775(369),_0x4cb775(395),"writeProjectProfile",_0x4cb775(391),_0x4cb775(363),_0x4cb775(383),"cscv",_0x4cb775(393),_0x4cb775(371),_0x4cb775(365),_0x4cb775(360)];!function(e,i){!function(i){const t=_0x47aa;for(;--i;)e[t(385)](e[t(362)]())}(++i)}(_0x594b,142);const _0xed47=function(e,i){return _0x594b[e-=376]},_0x25d0d8=_0xed47;var __importDefault=this&&this[_0x25d0d8(430)]||function(e){return e&&e[_0x25d0d8(403)]?e:{default:e}};Object.defineProperty(exports,_0x25d0d8(403),{value:!0});const editor_1=__importDefault(require(_0x4cb775(372))),util_1=__importDefault(require(_0x25d0d8(382))),path_1=require("path"),fs_extra_1=require(_0x25d0d8(422));let generateConfigItem=(e,i,t=[])=>({app_id:e,config_id:i[_0x25d0d8(421)],config_name:i[_0x4cb775(391)],config_remarks:i[_0x25d0d8(384)],services:t}),getConfigSetByConfig=e=>({config_id:e[_0x25d0d8(421)],config_name:e[_0x25d0d8(394)],config_remarks:e[_0x4cb775(406)]});exports[_0x25d0d8(401)]={updateConfigFile:async function(){return new Promise(async(e,i)=>{const t=_0x47aa,a=_0xed47;let r=async e=>{const i=_0x47aa,t=_0xed47;e[t(425)](e=>{const i=_0x47aa,a=t;if(void 0!==e[a(421)])return;let r=this[i(396)](a(428));e[a(421)]=r[i(368)],e[a(394)]=r[a(394)],e[a(384)]=r[a(384)]}),await editor_1.default[t(393)](i(411),e)},n=async e=>{const i=_0x47aa,t=_0xed47;if(null!=e){if(void 0!==e[t(409)]&&e[t(409)]instanceof Array&&await r(e[t(409)]),void 0!==e[t(429)]){let i=e[t(429)];this.writeBindGame({app_id:i[t(418)]||i[t(411)]||t(420),name:i[t(412)],c_id:i[t(415)]||"0"})}let a=await editor_1[t(401)][t(377)](t(410)),n=await this[t(383)](a);n[i(388)]>0&&await editor_1[t(401)][t(393)](t(389),[{app_id:a,config_id:n[0][i(368)]}]),await editor_1[t(401)][t(393)](t(397),t(399))}},o=await editor_1[t(360)][t(374)](t(392));if(void 0!==o&&0===util_1[a(401)][a(388)](o,t(371)))return e();let d=path_1[a(426)](editor_1[a(401)].getProjectPath(),a(423));if(fs_extra_1[t(400)](d)&&(void 0===await editor_1[a(401)][a(377)](a(429))||null===await editor_1[a(401)][a(377)](t(366))))try{n(fs_extra_1[a(376)](d))}catch(i){return e()}e()})},generateConfigSet:function(e,i=""){const t=_0x25d0d8;return{config_id:util_1[t(401)][t(398)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(e,i="",t=""){return new Promise(async(a,r)=>{const n=_0x47aa,o=_0xed47;if(""===t&&(t=await editor_1.default[o(377)](o(410))),""===i){let e=(await editor_1.default[o(377)](o(389))||[])[o(379)](e=>e[o(411)]===t);if(void 0===e)return r(n(367));i=e[o(421)]}let d=await editor_1[o(401)][o(377)](n(411))||[],c=d[o(379)](e=>e[o(411)]==t&&e[n(368)]===i);if(void 0===c)return r("Config file error! (copyConfigSet => configs.find)");let _=generateConfigItem(t,e,c[o(395)]||[]);d[o(407)](_),await editor_1[o(401)][o(393)](o(409),d),a()})},deleteConfigSet:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x47aa,n=_0xed47;""===i&&(i=await editor_1[n(401)][n(377)](n(410)));let o=await editor_1[n(401)][n(377)](n(409));o||(o=[]);let d=o[n(386)](t=>t[n(411)]==i&&t[n(421)]===e);if(d<0)return a(r(390));o[r(359)](d,1),await editor_1[n(401)][r(384)](n(409),o);let c=o[n(392)](e=>e[n(411)]===i);t(c[Math[n(414)](Math[n(396)](c[r(388)]-1,d-1),0)])})},readServiceList:async function(){const e=_0x25d0d8;return await editor_1[e(401)][e(413)](e(395))||[]},writeServiceList:async function(e){const i=_0x4cb775,t=_0x25d0d8;return await editor_1[t(401)][t(408)](t(381),editor_1[t(401)][t(387)]()),await editor_1[i(360)][t(408)](t(395),e)},readServiceGroupList:async function(){const e=_0x25d0d8;return await editor_1[e(401)][e(413)](e(406))||[]},writeServiceGroupList:async function(e){const i=_0x4cb775,t=_0x25d0d8;return await editor_1[t(401)][t(408)](i(402),editor_1[i(360)][i(386)]()),await editor_1[t(401)][i(377)](t(406),e)},readServiceFilter:async function(){const e=_0x4cb775,i=_0x25d0d8;return await editor_1[i(401)][e(361)](i(390)+editor_1[i(401)][e(386)]())||{status:i(378),platforms:[i(378)]}},writeServiceFilter:async function(e){const i=_0x4cb775,t=_0x25d0d8;return await editor_1[t(401)][t(408)](i(405)+editor_1[i(360)][i(386)](),e)},readBindGame:async function(){const e=_0x4cb775,i=_0x25d0d8;return await editor_1[e(360)][i(377)](i(429))},writeBindGame:async function(e){return new Promise(async(i,t)=>{const a=_0x47aa,r=_0xed47;await editor_1[r(401)][a(384)](r(429),e);let n=await this[r(427)](e[r(411)]);if(void 0===n){let i=await this[r(383)](e[r(411)]);i[a(388)]>0&&(n=i[0])}void 0===n&&(n=this[r(405)](r(428))),await this[a(397)](n,e[r(411)]),i()})},readConfigSet:async function(e=""){return new Promise(async(i,t)=>{const a=_0x47aa,r=_0xed47;""===e&&(e=await editor_1[a(360)][r(377)](r(410)));let n,o=await editor_1[r(401)][r(377)](r(389))||[];do{let i=o[r(379)](i=>i[r(411)]===e),t=await editor_1[r(401)][r(377)]("configs");if(void 0===i||null===t)break;let a=t[r(379)](t=>t[r(411)]==e&&t[r(421)]==(null==i?void 0:i[r(421)]));if(void 0===a)break;n=getConfigSetByConfig(a)}while(0);i(n)})},writeConfigSet:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x47aa,n=_0xed47;""===i&&(i=await editor_1[n(401)][r(374)](n(410)));let o=await editor_1[n(401)][n(377)](n(389))||[],d=o[n(379)](e=>e[n(411)]===i);void 0===d?(d={app_id:i,config_id:e[n(421)]},o[n(407)](d)):d[n(421)]=e[n(421)],await editor_1.default[n(393)](r(381),o);let c=await editor_1[r(360)][n(377)](n(409));c||(c=[]);let _=c[r(358)](t=>t[n(411)]==i&&t[n(421)]===e[r(368)]);void 0===_?c[n(407)](generateConfigItem(i,e)):(_[n(421)]=e[r(368)],_[n(394)]=e.config_name,_[n(384)]=e[n(384)]),await editor_1[n(401)][n(393)](n(409),c),t()})},readConfigSets:async function(e=""){return new Promise(async(i,t)=>{const a=_0x47aa,r=_0xed47;""===e&&(e=await editor_1[r(401)][r(377)](r(410)));let n=await editor_1[r(401)][r(377)](r(409));n||(n=[]);let o=[];n[a(395)](i=>i[a(382)]===e)[r(400)](e=>e[r(421)]&&o[a(385)](getConfigSetByConfig(e))),i(o)})},readEnableServices:async function(e=""){return new Promise(async(i,t)=>{const a=_0x47aa,r=_0xed47;let n=await editor_1[r(401)][r(377)](r(410));if(""===e){let i=await this.readConfigSet();if(void 0===i)return t(r(385));e=i[r(421)]}let o=await editor_1[r(401)][r(377)](r(409));o||(o=[]);let d=[];do{let i=o[a(358)](i=>i[r(411)]==n&&i[r(421)]===e);if(void 0===i||void 0===i[r(395)]||0===i[r(395)][r(402)])break;i[r(395)][r(392)](e=>e[r(404)])[r(400)](e=>d[r(407)](e[r(380)]))}while(0);i(d)})},wirteEnableService:async function(e,i,t=""){return new Promise(async(a,r)=>{const n=_0x47aa,o=_0xed47;let d=await editor_1[o(401)][o(377)](o(410));if(""===t){let e=await this[o(427)]();if(void 0===e)return r(o(416));t=e[n(368)]}let c=await editor_1[o(401)][o(377)](o(409));c||(c=[]);let _=c.find(e=>e[o(411)]==d&&e[o(421)]===t);if(void 0===_)return r(n(370));void 0===_[o(395)]&&(_[n(363)]=[]);let f=_[o(395)][n(358)](i=>i[o(380)]===e);void 0===f?(f={service_id:e,enable:i,param:{}},_[o(395)][o(407)](f)):f[n(399)]=i,await editor_1[o(401)][n(384)]("configs",c),a()})},readServiceParam:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x47aa,n=_0xed47;let o=await editor_1[n(401)][n(377)](r(387));if(""===i){let e=await this[n(427)]();if(void 0===e)return a(n(419));i=e[n(421)]}let d=await editor_1[n(401)][n(377)]("configs");d||(d=[]);let c={};do{let t=d[n(379)](e=>e[n(411)]==o&&e[n(421)]===i);if(void 0===t||void 0===t[n(395)]||0===t[n(395)][n(402)])break;let a=t[n(395)][n(379)](i=>i[n(380)]===e);void 0!==a&&void 0!==a[r(373)]&&null!==a[n(424)]&&(c=a[n(424)])}while(0);t(c)})},writeServiceParam:async function(e,i,t=""){return new Promise(async(a,r)=>{const n=_0x47aa,o=_0xed47;let d=await editor_1[n(360)][n(374)](n(387));if(""===t){let e=await this.readConfigSet();if(void 0===e)return r(o(417));t=e[o(421)]}let c=await editor_1[o(401)][o(377)](o(409));c||(c=[]);let _=c[o(379)](e=>e[o(411)]==d&&e[o(421)]===t);if(void 0===_)return r(o(417));void 0===_[o(395)]&&(_[n(363)]=[]);let f=_[n(363)][n(358)](i=>i[o(380)]===e);void 0===f?(f={service_id:e,enable:!1,param:i},_[o(395)][o(407)](f)):f[o(424)]=i,await editor_1[n(360)][o(393)](o(409),c),a()})},readDevMode:async function(){const e=_0x4cb775,i=_0x25d0d8;return 0!==(await this[i(391)]())[e(395)](e=>/service-cocosads/.test(e[i(431)]))[i(402)]}};