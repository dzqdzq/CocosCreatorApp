const _0x5887=["writeConfigSet","writeBindGame","min","use strict","Default","name","Config file error! (readEnableServices => readConfigSet)","Config file error! (wirteEnableService => config.find)","readConfigSet","filter","shift","getProjectPath","config_id","Config file error! (copyConfigSet => configs.find)","findIndex","enable","compareVersion","push","Config file error! (writeServiceParam => readConfigSet)","existsSync","UNKNOW","config_name","generateConfigSet","game","appid","lang","config_remarks","find","app_id","Config file error! (wirteEnableService => readConfigSet)","All","generateID","path","configs","groups","filter.","service_component_name","./util","readConfigSets","forEach","cscv","2.0.0","settings/service.json","readProjectProfile","Config file error! (readServiceParam => readConfigSet)","readServiceList","defineProperty","default","param","Config file error! (deleteConfigSet => configs.findIndex)","join","cid","services","writeGlobalProfile","writeProjectProfile","readGlobalProfile","length","game.app_id","Config file error! (copyConfigSet => appConfigMaps.find)"];!function(e,i){!function(i){for(;--i;)e.push(e.shift())}(++i)}(_0x5887,411);const _0x2a1c=function(e,i){return _0x5887[e-=225]},_0xae13da=_0x2a1c,_0xd2bd=["__importDefault",_0xae13da(279),_0xae13da(243),_0xae13da(253),_0xae13da(272),_0xae13da(249),_0xae13da(281),_0xae13da(227),_0xae13da(234),_0xae13da(239),"game.app_id",_0xae13da(269),"test",_0xae13da(283),_0xae13da(282),_0xae13da(280),_0xae13da(276),_0xae13da(245),_0xae13da(262),_0xae13da(251),_0xae13da(242),_0xae13da(259),"readConfigSet",_0xae13da(240),_0xae13da(271),_0xae13da(231),_0xae13da(258),"readJsonSync","getLang","find",_0xae13da(266),_0xae13da(260),_0xae13da(233),_0xae13da(236),"service_id",_0xae13da(274),"2.0.0","__esModule",_0xae13da(252),_0xae13da(250),_0xae13da(264),_0xae13da(228),_0xae13da(267),_0xae13da(270),"max",_0xae13da(263),_0xae13da(247),_0xae13da(248),_0xae13da(238),_0xae13da(246),"appConfigMaps",_0xae13da(273),_0xae13da(244),"splice",_0xae13da(261),_0xae13da(275),"app_id",_0xae13da(257),_0xae13da(265)];!function(e,i){!function(i){const a=_0x2a1c;for(;--i;)e[a(244)](e[a(237)]())}(++i)}(_0xd2bd,101);const _0x4951=function(e,i){return _0xd2bd[e-=260]},_0x1f07f0=_0x4951;_0xae13da(230);var __importDefault=this&&this[_0x1f07f0(277)]||function(e){return e&&e[_0x1f07f0(314)]?e:{default:e}};Object[_0x1f07f0(269)](exports,_0x1f07f0(314),{value:!0});const editor_1=__importDefault(require("./editor")),util_1=__importDefault(require(_0x1f07f0(317))),path_1=require(_0x1f07f0(298)),fs_extra_1=require("fs-extra");let generateConfigItem=(e,i,a=[])=>({app_id:e,config_id:i[_0x1f07f0(286)],config_name:i[_0x1f07f0(265)],config_remarks:i[_0x1f07f0(280)],services:a}),getConfigSetByConfig=e=>({config_id:e[_0x1f07f0(286)],config_name:e[_0x1f07f0(265)],config_remarks:e[_0x1f07f0(280)]});exports[_0x1f07f0(312)]={updateConfigFile:async function(){return new Promise(async(e,i)=>{const a=_0x2a1c,t=_0x4951;let r=async e=>{const i=_0x4951;e.map(e=>{const i=_0x4951;if(void 0!==e[i(286)])return;let a=this[i(282)](i(302));e.config_id=a[i(286)],e[i(265)]=a[i(265)],e[i(280)]=a[i(280)]}),await editor_1[i(312)][i(283)](i(308),e)},n=async e=>{const i=_0x2a1c,a=_0x4951;if(null!=e){if(void 0!==e[a(308)]&&e.configs instanceof Array&&await r(e[a(308)]),void 0!==e[i(250)]){let t=e[a(316)];this[a(318)]({app_id:t[a(296)]||t[a(274)]||a(264),name:t[i(232)],c_id:t[i(278)]||"0"})}let t=await editor_1[a(312)][i(270)](a(287)),n=await this[a(276)](t);n[a(290)]>0&&await editor_1[i(274)][a(283)](a(268),[{app_id:t,config_id:n[0][a(286)]}]),await editor_1[a(312)][a(283)](a(260),i(268))}},o=await editor_1[t(312)][t(261)](t(260));if(void 0!==o&&0===util_1[t(312)][t(279)](o,t(313)))return e();let _=path_1[a(277)](editor_1[a(274)][t(266)](),t(288));if(fs_extra_1[t(267)](_)&&(void 0===await editor_1[t(312)][t(261)](a(250))||null===await editor_1[t(312)][t(261)](t(316))))try{n(fs_extra_1[t(304)](_))}catch(i){return e()}e()})},generateConfigSet:function(e,i=""){const a=_0x1f07f0;return{config_id:util_1[a(312)][a(303)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(e,i="",a=""){return new Promise(async(t,r)=>{const n=_0x2a1c,o=_0x4951;if(""===a&&(a=await editor_1[n(274)].readProjectProfile(o(287))),""===i){let e=(await editor_1[n(274)][o(261)](o(268))||[])[o(306)](e=>e[o(274)]===a);if(void 0===e)return r(n(226));i=e[o(286)]}let _=await editor_1[o(312)][o(261)](o(308))||[],d=_[o(306)](e=>e[o(274)]==a&&e[o(286)]===i);if(void 0===d)return r(o(300));let f=generateConfigItem(a,e,d[o(278)]||[]);_[n(244)](f),await editor_1[o(312)][o(283)](n(260),_),t()})},deleteConfigSet:async function(e,i=""){return new Promise(async(a,t)=>{const r=_0x2a1c,n=_0x4951;""===i&&(i=await editor_1[n(312)][n(261)](n(287)));let o=await editor_1[n(312)][n(261)](n(308));o||(o=[]);let _=o[r(241)](a=>a[n(274)]==i&&a.config_id===e);if(_<0)return t(n(293));o[n(271)](_,1),await editor_1[n(312)][n(283)](n(308),o);let d=o[r(236)](e=>e[n(274)]===i);a(d[Math[n(262)](Math[r(229)](d[n(290)]-1,_-1),0)])})},readServiceList:async function(){const e=_0x1f07f0;return await editor_1[e(312)][e(291)](e(278))||[]},writeServiceList:async function(e){const i=_0x1f07f0;return await editor_1[i(312)].writeGlobalProfile(i(315),editor_1[i(312)][i(305)]()),await editor_1[i(312)][i(292)](i(278),e)},readServiceGroupList:async function(){const e=_0x1f07f0;return await editor_1[e(312)][e(291)](e(272))||[]},writeServiceGroupList:async function(e){const i=_0x1f07f0;return await editor_1[i(312)][i(292)](i(315),editor_1[i(312)][i(305)]()),await editor_1[i(312)][i(292)](i(272),e)},readServiceFilter:async function(){const e=_0x1f07f0;return await editor_1[e(312)][e(291)](e(295)+editor_1[e(312)][e(305)]())||{status:e(275),platforms:[e(275)]}},writeServiceFilter:async function(e){const i=_0xae13da,a=_0x1f07f0;return await editor_1[i(274)][a(292)](a(295)+editor_1[a(312)][a(305)](),e)},readBindGame:async function(){const e=_0x1f07f0;return await editor_1[e(312)][e(261)](e(316))},writeBindGame:async function(e){return new Promise(async(i,a)=>{const t=_0x2a1c,r=_0x4951;await editor_1[r(312)][t(281)](r(316),e);let n=await this[r(299)](e[r(274)]);if(void 0===n){let i=await this[r(276)](e[t(255)]);i[r(290)]>0&&(n=i[0])}void 0===n&&(n=this[r(282)](r(302))),await this[r(284)](n,e[t(255)]),i()})},readConfigSet:async function(e=""){return new Promise(async(i,a)=>{const t=_0x2a1c,r=_0x4951;""===e&&(e=await editor_1[r(312)][t(270)](r(287)));let n,o=await editor_1[r(312)][r(261)](r(268))||[];do{let i=o[r(306)](i=>i[r(274)]===e),a=await editor_1[r(312)][t(270)]("configs");if(void 0===i||null===a)break;let _=a[r(306)](a=>a[r(274)]==e&&a[r(286)]==(null==i?void 0:i[r(286)]));if(void 0===_)break;n=getConfigSetByConfig(_)}while(0);i(n)})},writeConfigSet:async function(e,i=""){return new Promise(async(a,t)=>{const r=_0x2a1c,n=_0x4951;""===i&&(i=await editor_1.default[n(261)](r(225)));let o=await editor_1[n(312)][n(261)](n(268))||[],_=o.find(e=>e[n(274)]===i);void 0===_?(_={app_id:i,config_id:e[n(286)]},o[n(270)](_)):_[r(239)]=e[r(239)],await editor_1[n(312)][n(283)](n(268),o);let d=await editor_1[r(274)][r(270)](n(308));d||(d=[]);let f=d[n(306)](a=>a[n(274)]==i&&a[n(286)]===e[n(286)]);void 0===f?d[n(270)](generateConfigItem(i,e)):(f[n(286)]=e[n(286)],f[n(265)]=e[n(265)],f[n(280)]=e[n(280)]),await editor_1[n(312)][n(283)](n(308),d),a()})},readConfigSets:async function(e=""){return new Promise(async(i,a)=>{const t=_0x2a1c,r=_0x4951;""===e&&(e=await editor_1[r(312)].readProjectProfile(t(225)));let n=await editor_1[r(312)][r(261)]("configs");n||(n=[]);let o=[];n[r(310)](i=>i[r(274)]===e)[r(307)](e=>e[r(286)]&&o[r(270)](getConfigSetByConfig(e))),i(o)})},readEnableServices:async function(e=""){return new Promise(async(i,a)=>{const t=_0x2a1c,r=_0x4951;let n=await editor_1[r(312)][t(270)]("game.app_id");if(""===e){let i=await this[r(299)]();if(void 0===i)return a(r(309));e=i[r(286)]}let o=await editor_1[r(312)][t(270)](r(308));o||(o=[]);let _=[];do{let i=o[r(306)](i=>i[r(274)]==n&&i[r(286)]===e);if(void 0===i||void 0===i[t(279)]||0===i[r(278)][r(290)])break;i[r(278)][r(310)](e=>e[r(297)])[r(307)](e=>_[r(270)](e.service_id))}while(0);i(_)})},wirteEnableService:async function(e,i,a=""){return new Promise(async(t,r)=>{const n=_0x2a1c,o=_0x4951;let _=await editor_1[n(274)][o(261)](o(287));if(""===a){let e=await this[o(299)]();if(void 0===e)return r(n(256));a=e[o(286)]}let d=await editor_1[o(312)][n(270)](o(308));d||(d=[]);let f=d[o(306)](e=>e[n(255)]==_&&e[o(286)]===a);if(void 0===f)return r(o(285));void 0===f[n(279)]&&(f[o(278)]=[]);let c=f[o(278)][o(306)](i=>i[o(311)]===e);void 0===c?(c={service_id:e,enable:i,param:{}},f[o(278)][n(244)](c)):c[n(242)]=i,await editor_1[o(312)][n(281)](o(308),d),t()})},readServiceParam:async function(e,i=""){return new Promise(async(a,t)=>{const r=_0x2a1c,n=_0x4951;let o=await editor_1[n(312)][n(261)](n(287));if(""===i){let e=await this[r(235)]();if(void 0===e)return t(n(301));i=e[r(239)]}let _=await editor_1[n(312)][n(261)](n(308));_||(_=[]);let d={};do{let a=_[r(254)](e=>e[r(255)]==o&&e[n(286)]===i);if(void 0===a||void 0===a[n(278)]||0===a[r(279)][n(290)])break;let t=a[n(278)][n(306)](i=>i[n(311)]===e);void 0!==t&&void 0!==t[n(273)]&&null!==t[r(275)]&&(d=t[n(273)])}while(0);a(d)})},writeServiceParam:async function(e,i,a=""){return new Promise(async(t,r)=>{const n=_0x2a1c,o=_0x4951;let _=await editor_1[n(274)][o(261)](o(287));if(""===a){let e=await this[o(299)]();if(void 0===e)return r(o(294));a=e[o(286)]}let d=await editor_1[o(312)][o(261)](o(308));d||(d=[]);let f=d[o(306)](e=>e[o(274)]==_&&e[o(286)]===a);if(void 0===f)return r(o(294));void 0===f[o(278)]&&(f[n(279)]=[]);let c=f[o(278)][o(306)](i=>i[o(311)]===e);void 0===c?(c={service_id:e,enable:!1,param:i},f[n(279)][o(270)](c)):c[o(273)]=i,await editor_1[o(312)][n(281)](o(308),d),t()})},readDevMode:async function(){const e=_0x1f07f0;return 0!==(await this[e(281)]())[e(310)](i=>/service-cocosads/[e(289)](i[e(263)])).length}};