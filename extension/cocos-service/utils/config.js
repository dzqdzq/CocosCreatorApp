"use strict";const _0x22ad84=_0x4aeb;function _0x3039(e,i){const t=_0x1819();return(_0x3039=function(e,i){return t[e-=255]})(e,i)}function _0x4aeb(e,i){const t=_0x592d();return(_0x4aeb=function(e,i){return t[e-=201]})(e,i)}function _0x592d(){const e=["filter","337610DikWxJ","find","254303HxTFPG","96harIFn","splice","readProjectProfile","Config file error! (copyConfigSet => configs.find)","Config file error! (readEnableServices => readConfigSet)","shift","appConfigMaps","app_id","52jfbTNH","join","settings/service.json","test","Default","configs","__esModule","appid","readGlobalProfile","readServiceList","enable","2794850Azjjgx","310IayPEq","service_id","__importDefault","Config file error! (deleteConfigSet => configs.findIndex)","6bKhypO","readJsonSync","map","findIndex","default","length","defineProperty","name","36taLfbT","All","Config file error! (writeServiceParam => readConfigSet)","3VqOHLV","385801dVUGnv","writeProjectProfile","push","writeBindGame","5308369TRBzgO","services","Config file error! (readServiceParam => readConfigSet)","272057MpNVcV","writeGlobalProfile","getLang","max","924665GhkbgO","param","551537GVIFlf","cid","244278kPBNjp","104hXcxvj","fs-extra","generateConfigSet","game.app_id","compareVersion","config_id","Config file error! (copyConfigSet => appConfigMaps.find)","config_name","min","config_remarks","224XmOJqg","1417980WwDHzP","2.0.0","readConfigSets","6078668KLIoLM","groups","path","23221dAJiXE","4juoimo","game","forEach","service_component_name","getProjectPath","lang","117sXqtOj","6UdUtsJ"];return(_0x592d=function(){return e})()}!function(e,i){const t=_0x4aeb,a=_0x592d();for(;;)try{if(803912===-parseInt(t(270))/1+-parseInt(t(246))/2*(-parseInt(t(262))/3)+parseInt(t(211))/4+parseInt(t(274))/5*(parseInt(t(251))/6)+-parseInt(t(226))/7*(parseInt(t(207))/8)+-parseInt(t(221))/9*(-parseInt(t(224))/10)+-parseInt(t(267))/11*(parseInt(t(259))/12))break;a.push(a.shift())}catch(e){a.push(a.shift())}}();const _0x2cd05a=_0x3039;!function(e,i){const t=_0x4aeb,a=_0x3039,r=_0x1819();for(;;)try{if(394816===parseInt(a(306))/1*(-parseInt(a(304))/2)+-parseInt(a(271))/3*(-parseInt(a(269))/4)+-parseInt(a(270))/5+parseInt(a(314))/6*(-parseInt(a(292))/7)+parseInt(a(273))/8*(parseInt(a(307))/9)+parseInt(a(301))/10*(parseInt(a(259))/11)+parseInt(a(294))/12*(parseInt(a(290))/13))break;r.push(r[t(232)]())}catch(e){r[t(265)](r[t(232)]())}}();var __importDefault=this&&this[_0x2cd05a(326)]||function(e){return e&&e.__esModule?e:{default:e}};function _0x1819(){const e=_0x4aeb,i=["./editor",e(222),e(252),"push",e(239),e(242),e(238),"find",e(256),e(282),e(269),e(271),e(218),e(249),"UNKNOW",e(203),"Config file error! (wirteEnableService => config.find)",e(281),e(233),e(228),"filter.",e(214),e(230),e(204),e(217),e(231),e(243),e(253),e(280),"config_remarks",e(219),e(215),e(208),"1515606FHPLrI",e(273),e(279),e(229),e(236),e(268),"cscv",e(260),e(216),e(223),e(255),e(220),e(201),e(237),e(234),e(264),e(241),e(213),e(258),e(263),e(202),e(276),"readConfigSet",e(227),e(257),e(277),"service_id","generateID",e(245),e(272),e(247),e(254),e(275),e(235),e(240),"15527FDMBpQ",e(278),"Config file error! (wirteEnableService => readConfigSet)",e(209),e(205),e(212),e(210)];return(_0x1819=function(){return i})()}Object[_0x2cd05a(295)](exports,_0x2cd05a(287),{value:!0});const editor_1=__importDefault(require(_0x2cd05a(313))),util_1=__importDefault(require("./util")),path_1=require(_0x2cd05a(288)),fs_extra_1=require(_0x2cd05a(266));let generateConfigItem=(e,i,t=[])=>({app_id:e,config_id:i[_0x2cd05a(291)],config_name:i[_0x2cd05a(261)],config_remarks:i[_0x22ad84(206)],services:t}),getConfigSetByConfig=e=>({config_id:e.config_id,config_name:e.config_name,config_remarks:e[_0x2cd05a(267)]});exports[_0x2cd05a(281)]={updateConfigFile:async function(){return new Promise(async(e,i)=>{const t=_0x4aeb,a=_0x3039;let r=async e=>{const i=_0x3039;e[i(265)](e=>{const t=_0x4aeb,a=i;if(void 0!==e[t(202)])return;let r=this[t(281)](a(317));e[a(291)]=r[t(202)],e[t(204)]=r[t(204)],e[a(267)]=r[a(267)]}),await editor_1[i(281)][i(286)](i(305),e)},n=async e=>{const i=_0x4aeb,t=_0x3039;if(null!=e){if(void 0!==e[t(305)]&&e[t(305)]instanceof Array&&await r(e[t(305)]),void 0!==e[t(279)]){let a=e[t(279)];this[i(266)]({app_id:a[t(318)]||a.app_id||t(327),name:a[t(289)],c_id:a[t(296)]||"0"})}let a=await editor_1[t(281)].readProjectProfile(t(322)),n=await this[i(210)](a);n[t(321)]>0&&await editor_1[i(255)][t(286)](t(256),[{app_id:a,config_id:n[0][t(291)]}]),await editor_1[t(281)][t(286)](t(277),t(309))}},o=await editor_1[a(281)][a(274)](a(277));if(void 0!==o&&0===util_1[a(281)][a(283)](o,a(309)))return e();let c=(0,path_1[a(275)])(editor_1[a(281)][a(268)](),a(284));if((0,fs_extra_1.existsSync)(c)&&(void 0===await editor_1[a(281)][a(274)](a(279))||null===await editor_1[t(255)][a(274)](a(279))))try{n((0,fs_extra_1[a(315)])(c))}catch(i){return e()}e()})},generateConfigSet:function(e,i=""){const t=_0x2cd05a;return{config_id:util_1[t(281)][t(298)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(e,i="",t=""){return new Promise(async(a,r)=>{const n=_0x4aeb,o=_0x3039;if(""===t&&(t=await editor_1[n(255)][n(229)](o(322))),""===i){let e=(await editor_1[o(281)][o(274)]("appConfigMaps")||[])[n(225)](e=>e[o(285)]===t);if(void 0===e)return r(o(328));i=e[n(202)]}let c=await editor_1.default[n(229)](o(305))||[],d=c[n(225)](e=>e[n(234)]==t&&e[o(291)]===i);if(void 0===d)return r(o(260));let s=generateConfigItem(t,e,d[o(276)]||[]);c[o(316)](s),await editor_1[o(281)][n(264)](o(305),c),a()})},deleteConfigSet:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x4aeb,n=_0x3039;""===i&&(i=await editor_1[n(281)][n(274)](r(282)));let o=await editor_1[r(255)][n(274)](n(305));o||(o=[]);let c=o[n(302)](t=>t[n(285)]==i&&t[n(291)]===e);if(c<0)return a(r(250));o[n(257)](c,1),await editor_1[n(281)][r(264)](n(305),o);let d=o[r(223)](e=>e[n(285)]===i);t(d[Math[n(272)](Math[n(310)](d[n(321)]-1,c-1),0)])})},readServiceList:async function(){const e=_0x2cd05a;return await editor_1[e(281)].readGlobalProfile(e(276))||[]},writeServiceList:async function(e){const i=_0x22ad84,t=_0x2cd05a;return await editor_1[i(255)][t(324)](t(282),editor_1[t(281)][t(300)]()),await editor_1[t(281)][t(324)](i(268),e)},readServiceGroupList:async function(){const e=_0x22ad84,i=_0x2cd05a;return await editor_1[i(281)][e(243)](i(311))||[]},writeServiceGroupList:async function(e){const i=_0x22ad84,t=_0x2cd05a;return await editor_1[t(281)][i(271)](t(282),editor_1[t(281)][t(300)]()),await editor_1[t(281)][t(324)](t(311),e)},readServiceFilter:async function(){const e=_0x2cd05a;return await editor_1[e(281)][e(264)](e(258)+editor_1[e(281)][e(300)]())||{status:e(278),platforms:[e(278)]}},writeServiceFilter:async function(e){const i=_0x22ad84,t=_0x2cd05a;return await editor_1[t(281)][i(271)](t(258)+editor_1[t(281)][t(300)](),e)},readBindGame:async function(){const e=_0x2cd05a;return await editor_1[e(281)][e(274)](e(279))},writeBindGame:async function(e){return new Promise(async(i,t)=>{const a=_0x4aeb,r=_0x3039;await editor_1.default[a(264)](r(279),e);let n=await this[r(293)](e[r(285)]);if(void 0===n){let i=await this[r(312)](e[r(285)]);i[r(321)]>0&&(n=i[0])}void 0===n&&(n=this[r(255)]("Default")),await this.writeConfigSet(n,e[r(285)]),i()})},readConfigSet:async function(e=""){return new Promise(async(i,t)=>{const a=_0x4aeb,r=_0x3039;""===e&&(e=await editor_1[r(281)][r(274)](r(322)));let n,o=await editor_1[r(281)][r(274)](r(256))||[];do{let i=o.find(i=>i[r(285)]===e),t=await editor_1[r(281)][r(274)](r(305));if(void 0===i||null===t)break;let c=t[r(320)](t=>t[r(285)]==e&&t[a(202)]==(null==i?void 0:i[a(202)]));if(void 0===c)break;n=getConfigSetByConfig(c)}while(0);i(n)})},writeConfigSet:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x4aeb,n=_0x3039;""===i&&(i=await editor_1[n(281)][n(274)](n(322)));let o=await editor_1[r(255)][n(274)](r(233))||[],c=o[n(320)](e=>e[n(285)]===i);void 0===c?(c={app_id:i,config_id:e[n(291)]},o[n(316)](c)):c[r(202)]=e[r(202)],await editor_1[n(281)][n(286)](n(256),o);let d=await editor_1[n(281)][n(274)](n(305));d||(d=[]);let s=d[n(320)](t=>t[n(285)]==i&&t[n(291)]===e.config_id);void 0===s?d[n(316)](generateConfigItem(i,e)):(s[n(291)]=e[n(291)],s[n(261)]=e[n(261)],s[r(206)]=e[n(267)]),await editor_1[n(281)][n(286)](n(305),d),t()})},readConfigSets:async function(e=""){return new Promise(async(i,t)=>{const a=_0x4aeb,r=_0x3039;""===e&&(e=await editor_1[r(281)][a(229)](r(322)));let n=await editor_1[a(255)][r(274)](r(305));n||(n=[]);let o=[];n[r(280)](i=>i[a(234)]===e)[a(217)](e=>e[r(291)]&&o[r(316)](getConfigSetByConfig(e))),i(o)})},readEnableServices:async function(e=""){return new Promise(async(i,t)=>{const a=_0x4aeb,r=_0x3039;let n=await editor_1[r(281)].readProjectProfile(r(322));if(""===e){let i=await this[r(293)]();if(void 0===i)return t(r(263));e=i[r(291)]}let o=await editor_1[r(281)][r(274)](r(305));o||(o=[]);let c=[];do{let i=o[r(320)](i=>i[r(285)]==n&&i[r(291)]===e);if(void 0===i||void 0===i[r(276)]||0===i[r(276)][r(321)])break;i[r(276)][r(280)](e=>e[r(299)])[r(262)](e=>c[a(265)](e.service_id))}while(0);i(c)})},wirteEnableService:async function(e,i,t=""){return new Promise(async(a,r)=>{const n=_0x4aeb,o=_0x3039;let c=await editor_1[o(281)][o(274)]("game.app_id");if(""===t){let e=await this.readConfigSet();if(void 0===e)return r(o(308));t=e[o(291)]}let d=await editor_1[n(255)][o(274)](n(240));d||(d=[]);let s=d[o(320)](e=>e[o(285)]==c&&e[n(202)]===t);if(void 0===s)return r(o(329));void 0===s.services&&(s[o(276)]=[]);let _=s[o(276)][o(320)](i=>i[n(248)]===e);void 0===_?(_={service_id:e,enable:i,param:{}},s[o(276)][o(316)](_)):_[o(299)]=i,await editor_1[o(281)][o(286)](o(305),d),a()})},readServiceParam:async function(e,i=""){return new Promise(async(t,a)=>{const r=_0x4aeb,n=_0x3039;let o=await editor_1[n(281)][n(274)]("game.app_id");if(""===i){let e=await this[n(293)]();if(void 0===e)return a(n(323));i=e[r(202)]}let c=await editor_1[n(281)][n(274)](n(305));c||(c=[]);let d={};do{let t=c[r(225)](e=>e[n(285)]==o&&e[n(291)]===i);if(void 0===t||void 0===t[n(276)]||0===t[n(276)][n(321)])break;let a=t[n(276)][r(225)](i=>i[r(248)]===e);void 0!==a&&void 0!==a[n(303)]&&null!==a[n(303)]&&(d=a[n(303)])}while(0);t(d)})},writeServiceParam:async function(e,i,t=""){return new Promise(async(a,r)=>{const n=_0x4aeb,o=_0x3039;let c=await editor_1[o(281)][n(229)](o(322));if(""===t){let e=await this[o(293)]();if(void 0===e)return r(n(261));t=e[o(291)]}let d=await editor_1[o(281)][o(274)](n(240));d||(d=[]);let s=d[o(320)](e=>e[o(285)]==c&&e[o(291)]===t);if(void 0===s)return r("Config file error! (writeServiceParam => readConfigSet)");void 0===s[o(276)]&&(s[o(276)]=[]);let _=s.services[n(225)](i=>i[o(297)]===e);void 0===_?(_={service_id:e,enable:!1,param:i},s[n(268)][o(316)](_)):_[o(303)]=i,await editor_1[o(281)][n(264)](o(305),d),a()})},readDevMode:async function(){const e=_0x22ad84,i=_0x2cd05a;return 0!==(await this[e(244)]())[i(280)](e=>/service-cocosads/[i(319)](e[i(325)]))[i(321)]}};