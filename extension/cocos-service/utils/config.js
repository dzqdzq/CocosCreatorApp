const _0x1ab6=["cid","readGlobalProfile","name","config_id","readConfigSet","Default","./util","min","splice","generateConfigSet","Config file error! (deleteConfigSet => configs.findIndex)","writeProjectProfile","compareVersion","join","findIndex","use strict","readConfigSets","find","filter","config_name","length","Config file error! (writeServiceParam => readConfigSet)","generateID","push","cscv","path","shift","readServiceList","map","writeGlobalProfile","configs","service_component_name","game.app_id","game","app_id","existsSync","Config file error! (readEnableServices => readConfigSet)","param","Config file error! (copyConfigSet => configs.find)","filter.","readProjectProfile","max","All","default","settings/service.json","UNKNOW","services","config_remarks","2.0.0","writeConfigSet","Config file error! (readServiceParam => readConfigSet)","Config file error! (wirteEnableService => readConfigSet)","getLang","appid"];!function(e,i){!function(i){for(;--i;)e.push(e.shift())}(++i)}(_0x1ab6,489);const _0x5da9=function(e,i){return _0x1ab6[e-=178]},_0x17e31c=_0x5da9,_0x5519=["test","Config file error! (wirteEnableService => config.find)",_0x17e31c(197),_0x17e31c(195),_0x17e31c(230),_0x17e31c(209),"enable","Config file error! (writeServiceParam => readConfigSet)",_0x17e31c(191),_0x17e31c(186),"lang",_0x17e31c(181),_0x17e31c(210),"writeBindGame",_0x17e31c(212),_0x17e31c(211),_0x17e31c(228),_0x17e31c(200),_0x17e31c(220),_0x17e31c(202),_0x17e31c(184),"fs-extra",_0x17e31c(203),"appConfigMaps",_0x17e31c(216),_0x17e31c(180),_0x17e31c(221),_0x17e31c(208),"readJsonSync",_0x17e31c(218),"groups",_0x17e31c(192),_0x17e31c(178),_0x17e31c(182),_0x17e31c(213),"__esModule",_0x17e31c(217),_0x17e31c(204),_0x17e31c(188),"getLang","Config file error! (copyConfigSet => appConfigMaps.find)","service_id",_0x17e31c(222),_0x17e31c(229),_0x17e31c(199),_0x17e31c(183),"defineProperty",_0x17e31c(189),_0x17e31c(198),"__importDefault","configs",_0x17e31c(215),"forEach",_0x17e31c(224),"getProjectPath",_0x17e31c(179),_0x17e31c(207),"config_name",_0x17e31c(193),_0x17e31c(187),_0x17e31c(225)];!function(e,i){!function(i){const t=_0x5da9;for(;--i;)e[t(198)](e[t(201)]())}(++i)}(_0x5519,150);const _0x3347=function(e,i){return _0x5519[e-=297]},_0x507043=_0x3347;_0x17e31c(190);var __importDefault=this&&this[_0x507043(318)]||function(e){return e&&e[_0x507043(304)]?e:{default:e}};Object[_0x507043(315)](exports,_0x507043(304),{value:!0});const editor_1=__importDefault(require("./editor")),util_1=__importDefault(require(_0x507043(341))),path_1=require(_0x507043(347)),fs_extra_1=require(_0x507043(351));let generateConfigItem=(e,i,t=[])=>({app_id:e,config_id:i[_0x507043(301)],config_name:i[_0x507043(326)],config_remarks:i[_0x507043(311)],services:t}),getConfigSetByConfig=e=>({config_id:e[_0x507043(301)],config_name:e[_0x17e31c(194)],config_remarks:e[_0x507043(311)]});exports[_0x507043(298)]={updateConfigFile:async function(){return new Promise(async(e,i)=>{const t=_0x5da9,r=_0x3347;let a=async e=>{const i=_0x3347;e[i(352)](e=>{const t=_0x5da9,r=i;if(void 0!==e[r(301)])return;let a=this[r(350)](r(355));e[r(301)]=a[t(178)],e[r(326)]=a[r(326)],e[r(311)]=a[r(311)]}),await editor_1[i(298)][i(339)](i(319),e)},n=async e=>{const i=_0x5da9,t=_0x3347;if(null!=e){if(void 0!==e[i(205)]&&e[t(319)]instanceof Array&&await a(e[t(319)]),void 0!==e[i(208)]){let r=e[t(357)];this[t(343)]({app_id:r[t(346)]||r[i(209)]||t(348),name:r[i(231)],c_id:r[t(312)]||"0"})}let r=await editor_1[t(298)][t(320)](t(325)),n=await this[t(338)](r);n[t(333)]>0&&await editor_1[i(218)][t(339)](t(353),[{app_id:r,config_id:n[0].config_id}]),await editor_1[t(298)][t(339)](i(199),i(223))}},o=await editor_1[r(298)][r(320)](r(313));if(void 0!==o&&0===util_1[r(298)][r(328)](o,t(223)))return e();let _=path_1[r(307)](editor_1[r(298)][r(323)](),t(219));if(fs_extra_1[r(342)](_)&&(void 0===await editor_1[r(298)][r(320)](r(357))||null===await editor_1[r(298)][r(320)](t(208))))try{n(fs_extra_1[r(297)](_))}catch(i){return e()}e()})},generateConfigSet:function(e,i=""){const t=_0x507043;return{config_id:util_1[t(298)][t(332)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(e,i="",t=""){return new Promise(async(r,a)=>{const n=_0x5da9,o=_0x3347;if(""===t&&(t=await editor_1[o(298)][o(320)](o(325))),""===i){let e=(await editor_1[o(298)][o(320)](o(353))||[])[o(300)](e=>e[o(335)]===t);if(void 0===e)return a(o(309));i=e[o(301)]}let _=await editor_1[o(298)][o(320)](o(319))||[],c=_[o(300)](e=>e[n(209)]==t&&e[n(178)]===i);if(void 0===c)return a(o(303));let d=generateConfigItem(t,e,c[o(356)]||[]);_[o(317)](d),await editor_1[o(298)][n(186)](o(319),_),r()})},deleteConfigSet:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x5da9,n=_0x3347;""===i&&(i=await editor_1[n(298)][n(320)](n(325)));let o=await editor_1[n(298)][a(215)](n(319));o||(o=[]);let _=o[n(316)](t=>t.app_id==i&&t[n(301)]===e);if(_<0)return r(a(185));o[n(314)](_,1),await editor_1[a(218)][n(339)](n(319),o);let c=o[n(327)](e=>e[n(335)]===i);t(c[Math[n(354)](Math[n(302)](c[a(195)]-1,_-1),0)])})},readServiceList:async function(){const e=_0x507043;return await editor_1[e(298)][e(334)](e(356))||[]},writeServiceList:async function(e){const i=_0x17e31c,t=_0x507043;return await editor_1[t(298)][t(306)](t(340),editor_1[t(298)][t(308)]()),await editor_1[t(298)][t(306)](i(221),e)},readServiceGroupList:async function(){const e=_0x507043;return await editor_1[e(298)][e(334)](e(299))||[]},writeServiceGroupList:async function(e){const i=_0x17e31c,t=_0x507043;return await editor_1[t(298)][t(306)](t(340),editor_1[t(298)][i(227)]()),await editor_1[t(298)][t(306)](t(299),e)},readServiceFilter:async function(){const e=_0x17e31c,i=_0x507043;return await editor_1[e(218)][i(334)](e(214)+editor_1[i(298)][i(308)]())||{status:i(305),platforms:[e(217)]}},writeServiceFilter:async function(e){const i=_0x507043;return await editor_1[i(298)][i(306)]("filter."+editor_1[i(298)][i(308)](),e)},readBindGame:async function(){const e=_0x17e31c,i=_0x507043;return await editor_1[i(298)][e(215)](i(357))},writeBindGame:async function(e){return new Promise(async(i,t)=>{const r=_0x5da9,a=_0x3347;await editor_1[r(218)][a(339)](a(357),e);let n=await this[a(324)](e[r(209)]);if(void 0===n){let i=await this[r(191)](e[a(335)]);i[r(195)]>0&&(n=i[0])}void 0===n&&(n=this[a(350)](a(355))),await this[a(322)](n,e.app_id),i()})},readConfigSet:async function(e=""){return new Promise(async(i,t)=>{const r=_0x5da9,a=_0x3347;""===e&&(e=await editor_1[a(298)][a(320)](r(207)));let n,o=await editor_1[a(298)][a(320)](a(353))||[];do{let i=o[r(192)](i=>i[a(335)]===e),t=await editor_1[a(298)][a(320)](a(319));if(void 0===i||null===t)break;let _=t[r(192)](t=>t[a(335)]==e&&t[a(301)]==(null==i?void 0:i[a(301)]));if(void 0===_)break;n=getConfigSetByConfig(_)}while(0);i(n)})},writeConfigSet:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x5da9,n=_0x3347;""===i&&(i=await editor_1.default[a(215)](a(207)));let o=await editor_1[n(298)][a(215)](n(353))||[],_=o[n(300)](e=>e[n(335)]===i);void 0===_?(_={app_id:i,config_id:e[n(301)]},o[a(198)](_)):_[n(301)]=e[n(301)],await editor_1[n(298)][n(339)](n(353),o);let c=await editor_1[n(298)][n(320)](n(319));c||(c=[]);let d=c[a(192)](t=>t.app_id==i&&t[n(301)]===e[n(301)]);void 0===d?c[n(317)](generateConfigItem(i,e)):(d[n(301)]=e.config_id,d[n(326)]=e[n(326)],d[n(311)]=e[n(311)]),await editor_1[n(298)][n(339)](n(319),c),t()})},readConfigSets:async function(e=""){return new Promise(async(i,t)=>{const r=_0x5da9,a=_0x3347;""===e&&(e=await editor_1[a(298)][a(320)](r(207)));let n=await editor_1[a(298)].readProjectProfile(a(319));n||(n=[]);let o=[];n[a(327)](i=>i[a(335)]===e)[a(321)](e=>e[a(301)]&&o[a(317)](getConfigSetByConfig(e))),i(o)})},readEnableServices:async function(e=""){return new Promise(async(i,t)=>{const r=_0x5da9,a=_0x3347;let n=await editor_1[a(298)][a(320)]("game.app_id");if(""===e){let i=await this[a(324)]();if(void 0===i)return t(a(345));e=i[a(301)]}let o=await editor_1[a(298)].readProjectProfile(a(319));o||(o=[]);let _=[];do{let i=o[a(300)](i=>i[a(335)]==n&&i[a(301)]===e);if(void 0===i||void 0===i[a(356)]||0===i[a(356)][r(195)])break;i[a(356)][a(327)](e=>e[a(336)])[a(321)](e=>_[a(317)](e[a(310)]))}while(0);i(_)})},wirteEnableService:async function(e,i,t=""){return new Promise(async(r,a)=>{const n=_0x5da9,o=_0x3347;let _=await editor_1.default[o(320)](o(325));if(""===t){let e=await this[o(324)]();if(void 0===e)return a(n(226));t=e[o(301)]}let c=await editor_1[o(298)][o(320)](o(319));c||(c=[]);let d=c[o(300)](e=>e[o(335)]==_&&e[o(301)]===t);if(void 0===d)return a(o(331));void 0===d[o(356)]&&(d[o(356)]=[]);let f=d[n(221)][n(192)](i=>i[o(310)]===e);void 0===f?(f={service_id:e,enable:i,param:{}},d[o(356)][o(317)](f)):f[o(336)]=i,await editor_1[o(298)][o(339)](n(205),c),r()})},readServiceParam:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x5da9,n=_0x3347;let o=await editor_1[n(298)][a(215)](n(325));if(""===i){let e=await this[n(324)]();if(void 0===e)return r(n(329));i=e[n(301)]}let _=await editor_1[n(298)].readProjectProfile(n(319));_||(_=[]);let c={};do{let t=_[n(300)](e=>e[n(335)]==o&&e[a(178)]===i);if(void 0===t||void 0===t[n(356)]||0===t[n(356)][n(333)])break;let r=t[n(356)][n(300)](i=>i[n(310)]===e);void 0!==r&&void 0!==r[n(344)]&&null!==r[n(344)]&&(c=r[n(344)])}while(0);t(c)})},writeServiceParam:async function(e,i,t=""){return new Promise(async(r,a)=>{const n=_0x5da9,o=_0x3347;let _=await editor_1[o(298)][n(215)](o(325));if(""===t){let e=await this[o(324)]();if(void 0===e)return a(o(337));t=e[n(178)]}let c=await editor_1[o(298)][o(320)]("configs");c||(c=[]);let d=c[o(300)](e=>e[o(335)]==_&&e.config_id===t);if(void 0===d)return a(n(196));void 0===d[o(356)]&&(d[o(356)]=[]);let f=d[o(356)][o(300)](i=>i[o(310)]===e);void 0===f?(f={service_id:e,enable:!1,param:i},d[o(356)][o(317)](f)):f[o(344)]=i,await editor_1[o(298)][n(186)](n(205),c),r()})},readDevMode:async function(){const e=_0x17e31c,i=_0x507043;return 0!==(await this[i(349)]())[i(327)](t=>/service-cocosads/[i(330)](t[e(206)]))[i(333)]}};