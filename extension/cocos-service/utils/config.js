const _0x4c4f=["game","fs-extra","getProjectPath","generateID","find","cid","default","forEach","writeProjectProfile","shift","__esModule","use strict","test","UNKNOW","game.app_id","param","generateConfigSet","filter.","services","Config file error! (readEnableServices => readConfigSet)","appid","config_name","readGlobalProfile","push","./editor","length","Config file error! (copyConfigSet => configs.find)","enable","Config file error! (wirteEnableService => readConfigSet)","./util","writeGlobalProfile","service_id","path","cscv","appConfigMaps","defineProperty","All","readConfigSet","2.0.0","name","min","config_id","Default","configs","Config file error! (writeServiceParam => readConfigSet)","readConfigSets","app_id","filter","splice","config_remarks","max","readProjectProfile"];!function(e,i){!function(i){for(;--i;)e.push(e.shift())}(++i)}(_0x4c4f,281);const _0x595f=function(e,i){return _0x4c4f[e-=244]},_0x3efc26=_0x595f,_0x4ad8=[_0x3efc26(280),_0x3efc26(270),_0x3efc26(292),_0x3efc26(256),_0x3efc26(285),_0x3efc26(261),"readServiceList",_0x3efc26(252),_0x3efc26(262),_0x3efc26(291),_0x3efc26(282),_0x3efc26(264),_0x3efc26(259),_0x3efc26(290),_0x3efc26(277),"Config file error! (readServiceParam => readConfigSet)","service_id","settings/service.json",_0x3efc26(289),_0x3efc26(257),_0x3efc26(293),_0x3efc26(267),_0x3efc26(273),_0x3efc26(279),_0x3efc26(260),"map","app_id","Config file error! (copyConfigSet => appConfigMaps.find)","getLang","game",_0x3efc26(268),_0x3efc26(250),"existsSync",_0x3efc26(251),_0x3efc26(283),"config_remarks",_0x3efc26(245),"Config file error! (wirteEnableService => config.find)","Default",_0x3efc26(247),_0x3efc26(263),"groups",_0x3efc26(244),"lang",_0x3efc26(249),_0x3efc26(274),"findIndex","configs",_0x3efc26(253),_0x3efc26(281),"Config file error! (deleteConfigSet => configs.findIndex)",_0x3efc26(246),_0x3efc26(255),_0x3efc26(248),_0x3efc26(258)];!function(e,i){!function(i){const t=_0x595f;for(;--i;)e[t(246)](e[t(284)]())}(++i)}(_0x4ad8,368);const _0xd0e7=function(e,i){return _0x4ad8[e-=452]},_0xb9793b=_0xd0e7;_0x3efc26(286);var __importDefault=this&&this.__importDefault||function(e){return e&&e[_0x3efc26(285)]?e:{default:e}};Object[_0xb9793b(468)](exports,_0xb9793b(473),{value:!0});const editor_1=__importDefault(require(_0xb9793b(453))),util_1=__importDefault(require(_0xb9793b(476))),path_1=require(_0xb9793b(466)),fs_extra_1=require(_0x3efc26(276));let generateConfigItem=(e,i,t=[])=>({app_id:e,config_id:i[_0x3efc26(264)],config_name:i[_0xb9793b(456)],config_remarks:i[_0xb9793b(504)],services:t}),getConfigSetByConfig=e=>({config_id:e[_0xb9793b(480)],config_name:e[_0x3efc26(244)],config_remarks:e[_0xb9793b(504)]});exports[_0xb9793b(463)]={updateConfigFile:async function(){return new Promise(async(e,i)=>{const t=_0x595f,r=_0xd0e7;let a=async e=>{const i=_0xd0e7;e[i(494)](e=>{const t=i;if(void 0!==e[t(480)])return;let r=this[t(478)](t(452));e[t(480)]=r.config_id,e[t(456)]=r[t(456)],e[t(504)]=r[t(504)]}),await editor_1.default[i(503)](i(461),e)},n=async e=>{const i=_0x595f,t=_0xd0e7;if(null!=e){if(void 0!==e.configs&&e[t(461)]instanceof Array&&await a(e[t(461)]),void 0!==e[t(498)]){let r=e[t(498)];this.writeBindGame({app_id:r[i(295)]||r[t(495)]||i(288),name:r[t(477)],c_id:r[t(469)]||"0"})}let r=await editor_1[t(463)][i(274)](t(487)),n=await this[t(499)](r);n[t(467)]>0&&await editor_1[t(463)][t(503)](t(488),[{app_id:r,config_id:n[0][t(480)]}]),await editor_1[t(463)][t(503)](t(472),i(261))}},o=await editor_1[t(281)][r(459)](r(472));if(void 0!==o&&0===util_1[r(463)].compareVersion(o,r(474)))return e();let f=path_1.join(editor_1[r(463)][r(483)](),r(486));if(fs_extra_1[r(501)](f)&&(void 0===await editor_1[r(463)].readProjectProfile(t(275))||null===await editor_1[r(463)][r(459)](t(275))))try{n(fs_extra_1.readJsonSync(f))}catch(i){return e()}e()})},generateConfigSet:function(e,i=""){const t=_0x3efc26;return{config_id:util_1.default[t(278)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(e,i="",t=""){return new Promise(async(r,a)=>{const n=_0x595f,o=_0xd0e7;if(""===t&&(t=await editor_1[n(281)][o(459)](o(487))),""===i){let e=(await editor_1[o(463)][o(459)](o(488))||[]).find(e=>e[o(495)]===t);if(void 0===e)return a(o(496));i=e[o(480)]}let f=await editor_1[n(281)][o(459)](o(461))||[],c=f[o(492)](e=>e[o(495)]==t&&e[n(264)]===i);if(void 0===c)return a(o(458));let _=generateConfigItem(t,e,c[o(489)]||[]);f[o(465)](_),await editor_1[o(463)][o(503)](o(461),f),r()})},deleteConfigSet:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x595f,n=_0xd0e7;""===i&&(i=await editor_1[n(463)][n(459)](a(289)));let o=await editor_1[n(463)][n(459)](a(266));o||(o=[]);let f=o[n(460)](t=>t[a(269)]==i&&t[a(264)]===e);if(f<0)return r(n(464));o[a(271)](f,1),await editor_1.default[n(503)](n(461),o);let c=o[n(470)](e=>e[n(495)]===i);t(c[Math[n(491)](Math[n(454)](c[a(248)]-1,f-1),0)])})},readServiceList:async function(){const e=_0xb9793b;return await editor_1[e(463)][e(505)](e(489))||[]},writeServiceList:async function(e){const i=_0x3efc26,t=_0xb9793b;return await editor_1[t(463)][i(253)](t(457),editor_1.default[t(497)]()),await editor_1[t(463)][t(462)](i(293),e)},readServiceGroupList:async function(){const e=_0x3efc26,i=_0xb9793b;return await editor_1[e(281)][i(505)](i(455))||[]},writeServiceGroupList:async function(e){const i=_0x3efc26,t=_0xb9793b;return await editor_1[t(463)][t(462)](t(457),editor_1[t(463)][t(497)]()),await editor_1[i(281)][t(462)](t(455),e)},readServiceFilter:async function(){const e=_0xb9793b;return await editor_1[e(463)].readGlobalProfile(e(471)+editor_1[e(463)][e(497)]())||{status:e(481),platforms:["All"]}},writeServiceFilter:async function(e){const i=_0x3efc26,t=_0xb9793b;return await editor_1[t(463)][t(462)](t(471)+editor_1[i(281)][t(497)](),e)},readBindGame:async function(){const e=_0xb9793b;return await editor_1[e(463)][e(459)](e(498))},writeBindGame:async function(e){return new Promise(async(i,t)=>{const r=_0x595f,a=_0xd0e7;await editor_1.default[r(283)](a(498),e);let n=await this[a(493)](e[a(495)]);if(void 0===n){let i=await this[r(268)](e[a(495)]);i[a(467)]>0&&(n=i[0])}void 0===n&&(n=this[a(478)](r(265))),await this.writeConfigSet(n,e[r(269)]),i()})},readConfigSet:async function(e=""){return new Promise(async(i,t)=>{const r=_0x595f,a=_0xd0e7;""===e&&(e=await editor_1[r(281)][a(459)](a(487)));let n,o=await editor_1[a(463)][a(459)](a(488))||[];do{let i=o[r(279)](i=>i.app_id===e),t=await editor_1[r(281)][a(459)](a(461));if(void 0===i||null===t)break;let f=t[r(279)](t=>t[a(495)]==e&&t.config_id==(null==i?void 0:i[a(480)]));if(void 0===f)break;n=getConfigSetByConfig(f)}while(0);i(n)})},writeConfigSet:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x595f,n=_0xd0e7;""===i&&(i=await editor_1[n(463)][n(459)](a(289)));let o=await editor_1[n(463)][n(459)](n(488))||[],f=o.find(e=>e[n(495)]===i);void 0===f?(f={app_id:i,config_id:e[n(480)]},o[n(465)](f)):f[n(480)]=e[a(264)],await editor_1[n(463)][n(503)](n(488),o);let c=await editor_1[a(281)][n(459)](n(461));c||(c=[]);let _=c[n(492)](t=>t[n(495)]==i&&t[n(480)]===e[n(480)]);void 0===_?c[a(246)](generateConfigItem(i,e)):(_[n(480)]=e[n(480)],_[n(456)]=e[n(456)],_[a(272)]=e[n(504)]),await editor_1.default[n(503)](n(461),c),t()})},readConfigSets:async function(e=""){return new Promise(async(i,t)=>{const r=_0x595f,a=_0xd0e7;""===e&&(e=await editor_1[r(281)].readProjectProfile(r(289)));let n=await editor_1[a(463)][r(274)](r(266));n||(n=[]);let o=[];n[a(470)](i=>i[r(269)]===e)[a(479)](e=>e[r(264)]&&o[r(246)](getConfigSetByConfig(e))),i(o)})},readEnableServices:async function(e=""){return new Promise(async(i,t)=>{const r=_0x595f,a=_0xd0e7;let n=await editor_1[a(463)][a(459)](a(487));if(""===e){let i=await this[a(493)]();if(void 0===i)return t(r(294));e=i[r(264)]}let o=await editor_1[a(463)][a(459)](a(461));o||(o=[]);let f=[];do{let i=o[a(492)](i=>i[a(495)]==n&&i[a(480)]===e);if(void 0===i||void 0===i[a(489)]||0===i[a(489)][r(248)])break;i[a(489)].filter(e=>e[a(500)])[a(479)](e=>f[a(465)](e[a(485)]))}while(0);i(f)})},wirteEnableService:async function(e,i,t=""){return new Promise(async(r,a)=>{const n=_0x595f,o=_0xd0e7;let f=await editor_1.default[n(274)](n(289));if(""===t){let e=await this[o(493)]();if(void 0===e)return a(o(502));t=e[o(480)]}let c=await editor_1.default[o(459)](o(461));c||(c=[]);let _=c[n(279)](e=>e[n(269)]==f&&e[n(264)]===t);if(void 0===_)return a(o(506));void 0===_[o(489)]&&(_[n(293)]=[]);let d=_[o(489)][o(492)](i=>i[n(254)]===e);void 0===d?(d={service_id:e,enable:i,param:{}},_[o(489)][o(465)](d)):d[o(500)]=i,await editor_1[n(281)][o(503)](n(266),c),r()})},readServiceParam:async function(e,i=""){return new Promise(async(t,r)=>{const a=_0x595f,n=_0xd0e7;let o=await editor_1[n(463)][n(459)](n(487));if(""===i){let e=await this[n(493)]();if(void 0===e)return r(n(484));i=e[n(480)]}let f=await editor_1[a(281)].readProjectProfile(n(461));f||(f=[]);let c={};do{let t=f[n(492)](e=>e[a(269)]==o&&e[a(264)]===i);if(void 0===t||void 0===t[n(489)]||0===t[n(489)][n(467)])break;let r=t[n(489)][n(492)](i=>i[n(485)]===e);void 0!==r&&void 0!==r[a(290)]&&null!==r[n(482)]&&(c=r[n(482)])}while(0);t(c)})},writeServiceParam:async function(e,i,t=""){return new Promise(async(r,a)=>{const n=_0x595f,o=_0xd0e7;let f=await editor_1.default[n(274)](o(487));if(""===t){let e=await this.readConfigSet();if(void 0===e)return a("Config file error! (writeServiceParam => readConfigSet)");t=e[o(480)]}let c=await editor_1[o(463)][o(459)](o(461));c||(c=[]);let _=c[n(279)](e=>e.app_id==f&&e[o(480)]===t);if(void 0===_)return a(o(490));void 0===_[o(489)]&&(_.services=[]);let d=_[o(489)][o(492)](i=>i[n(254)]===e);void 0===d?(d={service_id:e,enable:!1,param:i},_[o(489)][o(465)](d)):d[o(482)]=i,await editor_1[o(463)][o(503)](o(461),c),r()})},readDevMode:async function(){const e=_0x3efc26,i=_0xb9793b;return 0!==(await this[i(475)]())[i(470)](i=>/service-cocosads/[e(287)](i.service_component_name))[i(467)]}};