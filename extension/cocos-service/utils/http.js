"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_extra_1=require("fs-extra"),request_1=__importDefault(require("request")),agentOptions={ciphers:"ALL",secureProtocol:"TLSv1_method"};exports.default={post:function(t,e){return new Promise((r,n)=>{request_1.default.post({url:t,json:!0,form:e,agentOptions:agentOptions},(t,e,o)=>{try{t||200!==e.statusCode?n({status:e.statusCode,msg:t}):r(o)}catch(t){}})})},get:function(t,e){return new Promise((r,n)=>{request_1.default.get({url:t,json:!0,form:e,agentOptions:agentOptions},(t,e,o)=>{try{t||200!==e.statusCode?n({status:e.statusCode,msg:t}):r(o)}catch(t){}})})},download:function(t,e,r){if(!/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(t))return r&&r(new Error("Url is invalid!"),null);let n=0,o=0,s=0,a=request_1.default({method:"GET",uri:t,agentOptions:agentOptions}),u=fs_extra_1.createWriteStream(e);a.pipe(u),a.on("response",t=>{if(200!==t.statusCode)return r&&r(new Error(t.statusMessage),null);n=parseInt(t.headers["content-length"],10)}),a.on("data",t=>{var e=(o+=t.length)/n*100|0;s!==e&&(s=e,r&&r(null,{status:"downloading",progress:s}))}),a.on("complete",(t,e)=>r&&r(null,{status:"complete",progress:s})),a.on("error",t=>r&&r(t,null))},objectSortByKey:function(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e},paramEncode:function(t,e="",r=!1){let n="";if(null===t||void 0===t)return n;let o=typeof t;if("string"===o||"number"===o||"boolean"===o)n+=`&${e}=${r?encodeURIComponent(t):t}`;else for(var s in t){var a=""===e?s:e+(t instanceof Array?"["+s+"]":"."+s);n+=this.paramEncode(t[s],a,r)}return n}};