const _0xad66=["name","default","catch","downloading","i18n/zh.js","installed","./util","push","match","__esModule","basename","getCreatorHomePath",".zip","i18n/en.js","join","close-popup","getServicePluginInfo","existsSync","upgrade","progress","unzip","version","status","package.json","plugin","getServiceHomePath","contents","open-popup","readJson","unlinkSync","fs-extra","./http","path","download","../builtin","__importDefault","then","main","complete","sendMsg","fail","./file","./editor","defineProperty","getLang","mkdirs","service-","registerI18n","use strict","popup","builder"];!function(t,e){!function(e){for(;--e;)t.push(t.shift())}(++e)}(_0xad66,349);const _0x4867=function(t,e){return _0xad66[t-=369]},_0x597680=_0x4867,_0x8ae4=[_0x597680(406),_0x597680(410),_0x597680(391),"existsSync",_0x597680(382),_0x597680(379),_0x597680(419),"replace",_0x597680(370),_0x597680(415),_0x597680(393),_0x597680(405),_0x597680(388),_0x597680(407),_0x597680(404),_0x597680(397),_0x597680(401),"service-","i18n/zh.js",_0x597680(377),_0x597680(390),_0x597680(400),_0x597680(411),"upgrade","main",_0x597680(409),_0x597680(416),"getServiceHomePath",_0x597680(383),_0x597680(376),"require",_0x597680(418),_0x597680(412),_0x597680(385),"author",_0x597680(375),_0x597680(373),_0x597680(371),_0x597680(413),"default",_0x597680(396),_0x597680(387),_0x597680(403)];!function(t,e){!function(e){const _=_0x4867;for(;--e;)t[_(384)](t.shift())}(++e)}(_0x8ae4,208);const _0x2974=function(t,e){return _0x8ae4[t-=449]},_0x462fd7=_0x2974;_0x597680(374);var __importDefault=this&&this[_0x462fd7(488)]||function(t){return t&&t.__esModule?t:{default:t}};Object[_0x597680(369)](exports,_0x597680(386),{value:!0});const fs_extra_1=require(_0x462fd7(469)),path_1=require(_0x462fd7(481)),file_1=__importDefault(require(_0x462fd7(487))),editor_1=__importDefault(require(_0x462fd7(462))),util_1=__importDefault(require(_0x462fd7(484))),http_1=__importDefault(require(_0x597680(408)));exports[_0x462fd7(452)]={pluginExists:function(t){const e=_0x597680,_=_0x462fd7;return fs_extra_1[_(459)](path_1[_(458)](editor_1[_(452)][_(483)](),t[_(463)](e(372),"")))||fs_extra_1[_(459)](path_1[e(391)](_(478),t))},getServicePluginInfo:function(t){const e=_0x597680,_=_0x462fd7;let i=path_1[_(458)](editor_1[_(452)][e(402)](),t[_(463)](e(372),""));fs_extra_1[_(459)](i)||(i=path_1[_(458)](__dirname,e(411),t));let r=path_1.join(i,_(477));if(!fs_extra_1[_(459)](r))return;let n=file_1[_(452)][_(467)](r);if(n[_(475)]!==_(473)+path_1[_(454)](i)&&n[_(475)]!==path_1[_(454)](i))return;let o="";if(n[e(395)]&&fs_extra_1[e(394)](path_1[_(458)](i,n[_(479)]))){let t=util_1[_(452)][_(486)](i,n[_(479)]);o="zh"===editor_1[e(378)][_(464)]()?t.zh:t.en}return{path:i,name:n[e(377)],version:n[e(398)],author:n[_(490)],contents:n[_(455)],builder:n[_(485)],upgrade:o}},installPlugin:function(t,e,_){const i=_0x597680,r=_0x462fd7;let n=editor_1[r(452)][r(483)](),o=path_1[r(458)](editor_1[i(378)][r(468)](),r(457));!fs_extra_1[r(459)](n)&&file_1[r(452)][r(450)](n),!fs_extra_1[r(459)](o)&&file_1.default[r(450)](o);let x=path_1[r(458)](o,t+i(389)),u=0;return new Promise((t,o)=>{const a=i,s=r;let f=(t=a(417))=>{_&&_(t,!0),o(t)};if(!e[s(489)](/^(http|https):\/\/[^\s]*.zip$/))return f();http_1[s(452)][s(457)](e,x,(e,i)=>{const r=a,o=s;if(e||null===i)return f();let l=editor_1[r(378)].tr(r(380))+" "+i[o(453)]+"%";if(u!==i[o(453)]&&(u=i.progress,_&&_(l,!1)),o(465)===i[r(399)]){if(100!==i[o(453)])return f();file_1.default[o(471)](x,n)[o(451)](()=>{const e=o;fs_extra_1[r(394)](x)&&fs_extra_1[e(456)](x),_&&_(editor_1[e(452)].tr(e(460)),!0),t(!0)})[o(461)](()=>f())}})})},openPopup:function(t,e){const _=_0x597680,i=_0x462fd7;var r,n;let o=this[i(466)](t);void 0!==o&&(null===(n=null===(r=o[_(403)])||void 0===r?void 0:r[i(491)])||void 0===n?void 0:n[i(480)])&&editor_1[i(452)][i(482)](editor_1[i(452)][i(472)],i(470),t,e)},closePopup:function(t){const e=_0x597680,_=_0x462fd7;var i,r;let n=this[_(466)](t);void 0!==n&&(null===(r=null===(i=n[_(455)])||void 0===i?void 0:i[_(491)])||void 0===r?void 0:r[e(414)])&&editor_1[_(452)][_(482)](editor_1[_(452)][e(401)],e(392),t)},registerI18n:function(t){const e=_0x597680,_=_0x462fd7;let i=this[_(466)](t);void 0!==i&&(fs_extra_1[_(459)](path_1[_(458)](i[_(481)],e(381)))&&editor_1[_(452)][_(449)]("zh",t,util_1[_(452)][_(486)](i[_(481)],_(474))),fs_extra_1[_(459)](path_1[_(458)](i[_(481)],_(476)))&&editor_1[_(452)][e(373)]("en",t,util_1[_(452)][_(486)](i[_(481)],_(476))))}};