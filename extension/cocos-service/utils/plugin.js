const _0x4c9f=["use strict","contents","author","path",".zip","package.json","getLang","progress","builder","open-popup","./file","name","unlinkSync","download","catch","require","basename","./http","default","join","status","push","upgrade","downloading","service-","readJson","getServiceHomePath","i18n/zh.js","../builtin","match","__importDefault","popup","version","fail","i18n/en.js","__esModule","mkdirs","replace","complete","getServicePluginInfo","defineProperty","plugin","./util","existsSync"];!function(e,t){!function(t){for(;--t;)e.push(e.shift())}(++t)}(_0x4c9f,185);const _0x4c95=function(e,t){return _0x4c9f[e-=252]},_0x4ce21c=_0x4c95,_0x4423=[_0x4ce21c(285),_0x4ce21c(283),_0x4ce21c(263),_0x4ce21c(255),_0x4ce21c(257),_0x4ce21c(279),"unzip",_0x4ce21c(271),_0x4ce21c(288),_0x4ce21c(281),_0x4ce21c(270),_0x4ce21c(275),_0x4ce21c(289),"getCreatorHomePath",_0x4ce21c(290),_0x4ce21c(253),_0x4ce21c(252),"sendMsg",_0x4ce21c(262),"close-popup",_0x4ce21c(294),_0x4ce21c(291),_0x4ce21c(280),_0x4ce21c(259),_0x4ce21c(282),"installed",_0x4ce21c(267),"plugin",_0x4ce21c(292),_0x4ce21c(277),_0x4ce21c(278),"main",_0x4ce21c(286),_0x4ce21c(260),_0x4ce21c(274),"./editor",_0x4ce21c(256),_0x4ce21c(272),_0x4ce21c(258),_0x4ce21c(293),_0x4ce21c(295),"fs-extra",_0x4ce21c(269),_0x4ce21c(265),_0x4ce21c(254),_0x4ce21c(276),_0x4ce21c(261)];!function(e,t){!function(t){const _=_0x4c95;for(;--t;)e[_(264)](e.shift())}(++t)}(_0x4423,103);const _0x2999=function(e,t){return _0x4423[e-=469]},_0x460a56=_0x2999;_0x4ce21c(287);var __importDefault=this&&this[_0x4ce21c(273)]||function(e){return e&&e[_0x2999(490)]?e:{default:e}};Object[_0x460a56(508)](exports,_0x460a56(490),{value:!0});const fs_extra_1=require(_0x460a56(501)),path_1=require(_0x460a56(474)),file_1=__importDefault(require(_0x460a56(475))),editor_1=__importDefault(require(_0x460a56(495))),util_1=__importDefault(require(_0x460a56(507))),http_1=__importDefault(require(_0x460a56(493)));exports[_0x460a56(506)]={pluginExists:function(e){const t=_0x4ce21c,_=_0x460a56;return fs_extra_1[t(286)](path_1[_(478)](editor_1[t(261)][_(502)](),e[_(482)](_(486),"")))||fs_extra_1[_(492)](path_1[_(478)](_(514),e))},getServicePluginInfo:function(e){const t=_0x4ce21c,_=_0x460a56;let c=path_1[t(262)](editor_1[_(506)][_(502)](),e[_(482)](_(486),""));fs_extra_1[_(492)](c)||(c=path_1[_(478)](__dirname,_(514),e));let i=path_1[t(262)](c,_(488));if(!fs_extra_1[_(492)](i))return;let r=file_1[_(506)][t(268)](i);if(r[_(504)]!==_(486)+path_1[t(259)](c)&&r[t(254)]!==path_1[_(483)](c))return;let n="";if(r[_(503)]&&fs_extra_1[_(492)](path_1[t(262)](c,r[t(265)]))){let e=util_1[_(506)][_(498)](c,r[_(503)]);n="zh"===editor_1[_(506)][_(499)]()?e.zh:e.en}return{path:c,name:r[_(504)],version:r[_(471)],author:r[_(472)],contents:r[_(515)],builder:r[_(500)],upgrade:n}},installPlugin:function(e,t,_){const c=_0x4ce21c,i=_0x460a56;let r=editor_1.default[i(502)](),n=path_1[i(478)](editor_1[i(506)][i(473)](),c(256));!fs_extra_1[i(492)](r)&&file_1[i(506)][i(512)](r),!fs_extra_1[i(492)](n)&&file_1[i(506)][i(512)](n);let o=path_1[i(478)](n,e+i(481)),x=0;return new Promise((e,c)=>{const n=i;let a=(e=n(505))=>{_&&_(e,!0),c(e)};if(!t[n(497)](/^(http|https):\/\/[^\s]*.zip$/))return a();http_1.default[n(496)](t,o,(t,c)=>{const i=_0x4c95,u=n;if(t||null===c)return a();let s=editor_1[i(261)].tr(i(266))+" "+c[u(480)]+"%";if(x!==c[u(480)]&&(x=c[u(480)],_&&_(s,!1)),u(469)===c[u(509)]){if(100!==c[u(480)])return a();file_1[u(506)][u(513)](o,r).then(()=>{const t=u;fs_extra_1[t(492)](o)&&fs_extra_1[t(510)](o),_&&_(editor_1[t(506)].tr(t(485)),!0),e(!0)})[u(511)](()=>a())}})})},openPopup:function(e,t){const _=_0x4ce21c,c=_0x460a56;var i,r;let n=this[c(484)](e);void 0!==n&&(null===(r=null===(i=n[c(515)])||void 0===i?void 0:i[c(494)])||void 0===r?void 0:r[c(491)])&&editor_1[_(261)][c(477)](editor_1[c(506)][c(487)],c(476),e,t)},closePopup:function(e){const t=_0x4ce21c,_=_0x460a56;var c,i;let r=this[t(282)](e);void 0!==r&&(null===(i=null===(c=r[_(515)])||void 0===c?void 0:c[_(494)])||void 0===i?void 0:i[_(491)])&&editor_1[_(506)][_(477)](editor_1[_(506)][t(284)],_(479),e)},registerI18n:function(e){const t=_0x4ce21c,_=_0x460a56;let c=this[_(484)](e);void 0!==c&&(fs_extra_1[_(492)](path_1[_(478)](c.path,_(470)))&&editor_1[_(506)].registerI18n("zh",e,util_1[_(506)][_(498)](c[t(290)],_(470))),fs_extra_1[_(492)](path_1[_(478)](c[t(290)],_(489)))&&editor_1[t(261)].registerI18n("en",e,util_1[_(506)][_(498)](c[t(290)],_(489))))}};