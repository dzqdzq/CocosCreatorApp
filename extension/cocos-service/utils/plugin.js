const _0x2563=["default","open-popup","push","service-","unlinkSync","downloading","../builtin","then","sendMsg","existsSync","installed","match","main","upgrade","progress","getCreatorHomePath","download","popup","unzip","./file","getServiceHomePath","fail","contents","mkdirs","__importDefault","catch","package.json","replace","join","author","i18n/en.js","fs-extra","basename","i18n/zh.js","path","close-popup","getLang","require","defineProperty",".zip","version"];!function(t,a){!function(a){for(;--a;)t.push(t.shift())}(++a)}(_0x2563,237);const _0x2802=function(t,a){return _0x2563[t-=384]},_0x3a1a75=_0x2802,_0x2842=[_0x3a1a75(423),_0x3a1a75(401),_0x3a1a75(391),_0x3a1a75(399),_0x3a1a75(386),"registerI18n",_0x3a1a75(402),_0x3a1a75(420),_0x3a1a75(400),_0x3a1a75(387),_0x3a1a75(416),_0x3a1a75(411),_0x3a1a75(404),_0x3a1a75(396),"complete",_0x3a1a75(397),_0x3a1a75(392),_0x3a1a75(406),"default",_0x3a1a75(410),_0x3a1a75(422),_0x3a1a75(409),"__esModule",_0x3a1a75(424),_0x3a1a75(390),_0x3a1a75(418),_0x3a1a75(407),"./editor",_0x3a1a75(421),_0x3a1a75(403),_0x3a1a75(389),_0x3a1a75(417),"plugin",_0x3a1a75(415),_0x3a1a75(408),_0x3a1a75(405),_0x3a1a75(385),_0x3a1a75(414),_0x3a1a75(388),"name","getServicePluginInfo",_0x3a1a75(384),"getServiceHomePath"];!function(t,a){!function(a){const e=_0x2802;for(;--a;)t[e(395)](t.shift())}(++a)}(_0x2842,192);const _0x2a66=function(t,a){return _0x2842[t-=483]},_0x1f8044=_0x2a66;var __importDefault=this&&this[_0x1f8044(494)]||function(t){return t&&t[_0x1f8044(485)]?t:{default:t}};Object[_0x1f8044(487)](exports,_0x1f8044(485),{value:!0});const fs_extra_1=require(_0x1f8044(486)),path_1=require(_0x1f8044(510)),file_1=__importDefault(require(_0x3a1a75(412))),editor_1=__importDefault(require(_0x1f8044(490))),util_1=__importDefault(require("./util")),http_1=__importDefault(require("./http"));exports[_0x1f8044(524)]={pluginExists:function(t){const a=_0x3a1a75,e=_0x1f8044;return fs_extra_1[e(512)](path_1[e(491)](editor_1[a(393)][e(505)](),t[a(420)](e(519),"")))||fs_extra_1[e(512)](path_1[e(491)](e(509),t))},getServicePluginInfo:function(t){const a=_0x3a1a75,e=_0x1f8044;let _=path_1[e(491)](editor_1[a(393)][a(413)](),t[e(513)](e(519),""));fs_extra_1[e(512)](_)||(_=path_1[e(491)](__dirname,e(509),t));let i=path_1[e(491)](_,a(419));if(!fs_extra_1[e(512)](i))return;let r=file_1.default.readJson(i);if(r[e(502)]!==e(519)+path_1[a(384)](_)&&r[e(502)]!==path_1[e(504)](_))return;let n="";if(r.upgrade&&fs_extra_1[e(512)](path_1[e(491)](_,r[e(523)]))){let t=util_1[e(524)][e(493)](_,r[e(523)]);n="zh"===editor_1[e(524)][e(501)]()?t.zh:t.en}return{path:_,name:r[e(502)],version:r[e(522)],author:r[e(483)],contents:r.contents,builder:r.builder,upgrade:n}},installPlugin:function(t,a,e){const _=_0x3a1a75,i=_0x1f8044;let r=editor_1.default[_(413)](),n=path_1[_(421)](editor_1.default[i(497)](),i(484));!fs_extra_1[i(512)](r)&&file_1[i(524)][i(516)](r),!fs_extra_1[i(512)](n)&&file_1[_(393)][i(516)](n);let o=path_1[_(421)](n,t+i(508)),x=0;return new Promise((t,_)=>{const n=i;let u=(t=n(500))=>{e&&e(t,!0),_(t)};if(!a[n(518)](/^(http|https):\/\/[^\s]*.zip$/))return u();http_1[n(524)].download(a,o,(a,_)=>{const i=_0x2802,f=n;if(a||null===_)return u();let s=editor_1[i(393)].tr(i(398))+" "+_[f(489)]+"%";if(x!==_[f(489)]&&(x=_.progress,e&&e(s,!1)),f(520)===_.status){if(100!==_[f(489)])return u();file_1[i(393)][f(517)](o,r)[f(514)](()=>{const a=i,_=f;fs_extra_1[_(512)](o)&&fs_extra_1[_(521)](o),e&&e(editor_1[a(393)].tr(_(492)),!0),t(!0)})[f(488)](()=>u())}})})},openPopup:function(t,a){const e=_0x3a1a75,_=_0x1f8044;var i,r;let n=this.getServicePluginInfo(t);void 0!==n&&(null===(r=null===(i=n[_(496)])||void 0===i?void 0:i[_(525)])||void 0===r?void 0:r[_(498)])&&editor_1[_(524)][_(507)](editor_1[_(524)][_(495)],e(394),t,a)},closePopup:function(t){const a=_0x3a1a75,e=_0x1f8044;var _,i;let r=this[e(503)](t);void 0!==r&&(null===(i=null===(_=r[e(496)])||void 0===_?void 0:_[e(525)])||void 0===i?void 0:i[e(498)])&&editor_1[a(393)][e(507)](editor_1[e(524)][e(495)],e(515),t)},registerI18n:function(t){const a=_0x3a1a75,e=_0x1f8044;let _=this.getServicePluginInfo(t);void 0!==_&&(fs_extra_1[e(512)](path_1[a(421)](_[a(386)],e(499)))&&editor_1[e(524)][e(511)]("zh",t,util_1[e(524)][e(493)](_[a(386)],a(385))),fs_extra_1[e(512)](path_1[e(491)](_[a(386)],e(506)))&&editor_1.default[e(511)]("en",t,util_1[e(524)][e(493)](_[e(510)],e(506))))}};