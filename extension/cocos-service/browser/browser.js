const _0x32d0=["app_id","load","debug","scene","Project","__esModule","getRedirectUrl","sender","pluginName","open","csLogger","service:userChanged","info","fromWebContents","__importDefault","dialog_title","../utils","csPlugin","join","refresh-asset","query-uuid","service_name","plugin","defineProperty","cocos-service","plugin-msg","cloud-component:update-import","./protocol","close","cloud_json","readJSONSync","node","path","browser.updating_tips","methods","electron","remove","${name}","download_url","readConfigSet","install.js","Message","csUtil","getServicePluginInfo","service_name_error","cocos-service:service-data-change","target not exist!","assets","map","User","config_id","warn","silence_open_service","plugin-msg-service","has","service_id","dependency","create-node","package_download_url","startsWith","onServiceStatusChanged","service:handle-penetrate-param","fs-extra","existsSync","csProtocol","csEditor","readServiceList","all","service_component_name","cocos-service:popup-show","log","sendMsg","root","getGameDetail","asset-db","db://assets/cloud-component/","dialogMsgBox","main","push","compareVersion","includes","default","error","message","getProjectPath",".prefab","readServiceParam","focus","get","service-","use strict","getCustomPlugin","userChanged","name","import","replace","csHttp","package.json is not found.","require","csConfig","version","registerPluginsI18n","broadcast","shift","send","global","set","plugin-msg-popup","popupShow","find","catch","assets/cloud-component","getServiceVersion","pluginExists","cloud-function","Panel","params","delete","browser.update_tips","size","wirteEnableService","update-extension","apiPost","value","readBindGame","unload","removeListener","browser.cancel","redirect_url","service","then","UNKNOW","install","installed"];!function(e,t){!function(t){for(;--t;)e.push(e.shift())}(++t)}(_0x32d0,279);const _0x1d0f=function(e,t){return _0x32d0[e-=160]},_0x1ece85=_0x1d0f,_0x1331=["BrowserWindow","login",_0x1ece85(195),_0x1ece85(190),_0x1ece85(216),_0x1ece85(230),"stringify",_0x1ece85(217),"extension","builder",_0x1ece85(293),_0x1ece85(171),"openService",_0x1ece85(275),"popup","logout",_0x1ece85(242),_0x1ece85(186),_0x1ece85(197),"requestMsg",_0x1ece85(271),_0x1ece85(263),_0x1ece85(169),_0x1ece85(204),_0x1ece85(213),_0x1ece85(226),_0x1ece85(292),_0x1ece85(278),_0x1ece85(167),_0x1ece85(183),_0x1ece85(286),"values",_0x1ece85(219),_0x1ece85(272),"get","ipcMain",_0x1ece85(256),_0x1ece85(266),_0x1ece85(177),"enable",_0x1ece85(268),_0x1ece85(201),_0x1ece85(229),_0x1ece85(209),"broadcastMsg","writeBindGame","assets",_0x1ece85(191),"silenceCreateGame",_0x1ece85(250),_0x1ece85(241),_0x1ece85(261),_0x1ece85(206),_0x1ece85(251),_0x1ece85(162),"service:i18nChange",_0x1ece85(232),_0x1ece85(222),_0x1ece85(172),_0x1ece85(243),_0x1ece85(233),_0x1ece85(231),_0x1ece85(228),_0x1ece85(214),_0x1ece85(264),_0x1ece85(210),_0x1ece85(188),_0x1ece85(245),_0x1ece85(283),_0x1ece85(218),_0x1ece85(224),"install",_0x1ece85(258),_0x1ece85(180),"__esModule",_0x1ece85(247),_0x1ece85(280),"request",_0x1ece85(168),_0x1ece85(291),_0x1ece85(200),_0x1ece85(207),_0x1ece85(290),_0x1ece85(234),_0x1ece85(215),_0x1ece85(221),_0x1ece85(174),_0x1ece85(257),_0x1ece85(198),_0x1ece85(173),_0x1ece85(208),_0x1ece85(267),_0x1ece85(285),_0x1ece85(238),_0x1ece85(163),_0x1ece85(176),_0x1ece85(223),_0x1ece85(161),_0x1ece85(284),_0x1ece85(170),_0x1ece85(240),"success",_0x1ece85(187),_0x1ece85(181),_0x1ece85(260),"copy","target",_0x1ece85(160),_0x1ece85(276),_0x1ece85(246),"./plugin",_0x1ece85(287),"browser.update_now","../utils/_inner",_0x1ece85(274),_0x1ece85(192),"silence_disable_service",_0x1ece85(194),_0x1ece85(277),_0x1ece85(282),_0x1ece85(259),_0x1ece85(212),_0x1ece85(182),_0x1ece85(220),"package.json","csConfig",_0x1ece85(249)];!function(e,t){!function(t){const s=_0x1d0f;for(;--t;)e[s(227)](e[s(252)]())}(++t)}(_0x1331,486);const _0x5865=function(e,t){return _0x1331[e-=139]},_0x3df9e0=_0x5865;_0x1ece85(239);var __importDefault=this&&this[_0x3df9e0(255)]||function(e){return e&&e[_0x3df9e0(235)]?e:{default:e}};Object[_0x3df9e0(219)](exports,_0x1ece85(288),{value:!0}),exports[_0x3df9e0(148)]=exports[_0x1ece85(284)]=exports[_0x3df9e0(190)]=void 0;const electron_1=require(_0x1ece85(184)),utils_1=require(_0x1ece85(165)),plugin_1=__importDefault(require(_0x3df9e0(144))),protocol_1=__importDefault(require(_0x3df9e0(256))),_inner_1=require(_0x3df9e0(147)),fs_extra_1=require(_0x1ece85(211)),path_1=require("path");let popupWindows=new Map,firstRun=!0;async function load(){const e=_0x1ece85,t=_0x3df9e0;Editor[t(249)].on(t(162),exports[t(190)][t(211)]),Editor[e(198)].on("logout",exports[t(190)][t(211)]),electron_1[t(196)].on(t(230),exports[t(190)][e(257)]),await plugin_1.default[t(210)]()}function unload(){const e=_0x1ece85,t=_0x3df9e0;Editor[t(249)][t(174)](t(162),exports[e(183)][t(211)]),Editor.User[t(174)](t(176),exports[t(190)][t(211)]),electron_1[t(196)][t(174)](e(218),exports[t(190)][t(248)])}exports[_0x3df9e0(190)]={async openServicePanel(e){const t=_0x1ece85,s=_0x3df9e0;await Editor[s(225)][t(203)](s(250))?(await Editor[s(225)][t(236)](s(250)),utils_1[s(224)][s(157)](utils_1[s(224)].plugin,s(247),s(188),s(226),e)):await Editor[t(264)][s(187)](t(173),e)},openPopup(e,t,s){const _=_0x1ece85,c=_0x3df9e0;try{if(!popupWindows[_(203)](e))return void Editor[c(225)][_(292)]("cocos-service.simple",e,t);{let t=popupWindows[_(237)](e);null==t||t.focus()}}catch(t){popupWindows[c(198)](e)}},closePopup(e){const t=_0x1ece85,s=_0x3df9e0;try{if(popupWindows[t(203)](e)){let _=popupWindows[s(195)](e);null==_||_[t(177)](),popupWindows[s(198)](e)}}catch(s){popupWindows[t(266)](e)}},printLog(e,t){const s=_0x1ece85,_=_0x3df9e0;_(222)===e&&console[_(222)](t),_(258)===e&&console[_(258)](t),_(193)===e&&console[_(193)](t),s(200)===e&&console[_(241)](t)},popupShow(e,t){const s=_0x1ece85,_=_0x3df9e0;let c=electron_1[_(161)][_(215)](e[_(243)]),i=t[_(240)];null!==c&&i&&popupWindows[s(255)](i,c)},async userChanged(){const e=_0x1ece85,t=_0x3df9e0;await Editor[t(225)][e(203)](t(250))&&Editor[t(164)][e(253)](t(250),"plugin-msg",e(278),t(141))},apiRequest:async(e,t={})=>_0x3df9e0(152)===e?await protocol_1[_0x3df9e0(166)][_0x1ece85(289)](t[_0x3df9e0(152)]):new Promise((s,_)=>protocol_1[_0x3df9e0(166)][_0x3df9e0(181)](e,t)[_0x1ece85(279)](s)[_0x3df9e0(154)](e=>_(new Error(JSON[_0x3df9e0(167)](e))))),async enableService(e,t,s=""){const _=_0x1ece85,c=_0x3df9e0;e[c(251)](c(254))||(e=c(254)+e);let i=(await utils_1[_(248)][c(245)]())[c(233)](t=>t[c(168)]===e);if(void 0===i)throw new Error(utils_1[_(214)].tr(_(193)));let o=(await utils_1[_(248)][_(273)]()||{app_id:_(280)})[c(229)];if(c(237)===o)try{let e=await _inner_1[c(209)]();o=e[c(229)],await utils_1[c(159)][c(206)](e);let t=await utils_1[c(159)][c(227)]();t&&(s=t[_(199)])}catch(e){return e.message}try{let e=await utils_1.csProtocol[c(218)](o);t&&"0"!==i.service_type&&!e[c(188)][c(203)](i[c(184)])&&await utils_1[_(213)][c(173)](o,i[c(184)]),await utils_1[_(248)][_(269)](i[c(184)],t,s)[_(259)](utils_1[c(171)][c(253)]),utils_1[c(171)][_(161)](utils_1[c(224)].tr(c(t?202:150))[_(244)](c(178),i[c(260)]))}catch(e){return e[c(217)]}return plugin_1[c(166)][_(262)](e)||await plugin_1[_(230)].installPlugin(e,i[c(242)],(e,t)=>{const s=c;t&&utils_1[s(224)].tr(s(153))}),c(262)},pluginMsg:async(e,t,s={})=>_0x3df9e0(188)===e&&await Editor[_0x3df9e0(225)][_0x1ece85(203)](_0x1ece85(173))?await utils_1[_0x3df9e0(224)][_0x3df9e0(180)](utils_1[_0x3df9e0(224)][_0x3df9e0(172)],_0x1ece85(202),t,s):_0x3df9e0(175)===e&&popupWindows[_0x3df9e0(201)]>0?await utils_1[_0x3df9e0(224)][_0x3df9e0(180)](utils_1[_0x3df9e0(224)][_0x3df9e0(172)],_0x3df9e0(197),t,s):_0x3df9e0(163),serviceReady(){firstRun&&(firstRun=!1,setTimeout(async()=>{const e=_0x1d0f,t=_0x5865;let s=await utils_1[t(185)][t(261)]();if(1===utils_1.csUtil[t(223)](s[e(205)],utils_1[e(214)].getCreatorVersion()))return;if(1!==utils_1[t(208)][t(223)](s[t(160)],utils_1[e(214)][t(212)]()))return;if(0!==await utils_1[e(214)][e(225)](t(258),utils_1[t(224)].tr(t(252)),utils_1[e(214)].tr(e(164)),[utils_1[t(224)].tr(t(146)),utils_1[t(224)].tr(t(142))],0))return;let _=await utils_1[t(228)][t(195)](s[t(263)],{});utils_1[t(171)].info(utils_1[t(224)].tr(t(156))),utils_1[t(224)][t(157)](t(169),e(270),_[t(263)],utils_1[t(224)].plugin,e(254)),Editor[e(264)][t(199)](utils_1[t(224)][t(172)])},5e3))},async i18nChange(){const e=_0x1ece85,t=_0x3df9e0;utils_1[t(224)][t(205)](t(151)),await Editor[e(264)][e(203)](t(250))&&Editor[t(164)][e(253)](e(173),t(247),t(188),t(216))},async onServiceStatusChanged(e){const t=_0x1ece85,s=_0x3df9e0;var _;try{let c=utils_1[t(166)][s(149)](e[s(168)]);if(void 0===c||!(null===(_=c[s(170)])||void 0===_?void 0:_[s(186)]))return;let i={};i[s(184)]=e[s(184)],i[s(168)]=e[s(168)],i[s(200)]=e[s(200)]||!1,i[t(265)]=await utils_1[s(159)][t(235)](e[s(184)]);let o=utils_1[s(208)][s(236)](c[s(264)],c.builder[s(186)]);o[s(204)]&&await o[s(204)](utils_1[t(214)][s(221)](),i)}catch(e){utils_1[s(171)][s(253)](e)}},async dropScene(e,t,s){const _=_0x3df9e0;await Promise[_(165)](s[_(179)](async e=>{const s=_0x1d0f,c=_;await exports[c(190)][c(220)](e[c(194)]);const i=c(231)+e[c(177)]+"/"+e[c(177)]+".prefab",o=await Editor[c(164)][c(238)](c(257),c(183),i);utils_1[c(224)][c(157)](s(286),s(206),{position:t,assetUuid:o})}))},async dropHierarchy(e,t){const s=_0x3df9e0;t=t||e[s(192)],await Promise[s(165)](t[s(179)](async e=>{const t=_0x1d0f,_=s,c=e[_(140)]||e[_(234)]||e.to;await exports[_(190)][_(220)](e[_(194)]);const i=_(231)+e[_(177)]+"/"+e[_(177)]+_(244),o=await Editor[_(164)][_(238)](_(257),_(183),i);utils_1[t(214)][_(157)](_(191),_(213),{parent:c,assetUuid:o})}))},async dropAssets(e,t){const s=_0x1ece85,_=_0x3df9e0;t=t||e[_(192)],await Promise.all(t[s(197)](async e=>await exports[_(190)][s(243)](e[_(194)])))},async import(e){const t=_0x1ece85,s=_0x3df9e0;if(!fs_extra_1[s(155)](e))return;const _={cloud_json:path_1[s(189)](e,s(158)),assets:path_1[t(167)](e,t(196)),function:path_1.join(e,s(182)),install:path_1.join(e,t(189))};if(!fs_extra_1[s(155)](_.cloud_json))throw new Error(s(143));const c=fs_extra_1[t(179)](_[t(178)]),i={root:path_1[s(189)](Editor[t(287)][s(264)],t(260)),assets:path_1[s(189)](Editor[s(145)][s(264)],s(265),c[s(177)])};await fs_extra_1.ensureDir(i[s(246)]);try{fs_extra_1[s(155)](_[s(207)])&&!fs_extra_1[s(155)](i[t(196)])&&await fs_extra_1[s(139)](_[t(196)],i[t(196)]),fs_extra_1[s(155)](_[s(232)])&&(utils_1[s(208)].deleteCache(_[t(281)]),await require(_[s(232)])[s(186)]({assetsPath:i[s(207)]}))}catch(e){utils_1[s(171)][s(222)](e),fs_extra_1[s(155)](i[s(207)])&&await fs_extra_1[t(185)](i.assets)}await Editor[s(164)][s(238)](s(257),s(239),i[s(246)]),Editor[t(190)][s(214)](t(175))}},exports[_0x3df9e0(259)]=load,exports.unload=unload;