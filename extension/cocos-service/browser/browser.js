"use strict";const _0x552ec0=_0x7798;function _0x7798(e,t){const s=_0x1234();return(_0x7798=function(e,t){return s[e-=334]})(e,t)}!function(e,t){const s=_0x7798,a=_0x1234();for(;;)try{if(676237===parseInt(s(450))/1*(-parseInt(s(458))/2)+-parseInt(s(398))/3+parseInt(s(373))/4*(-parseInt(s(405))/5)+-parseInt(s(415))/6*(-parseInt(s(382))/7)+parseInt(s(383))/8*(-parseInt(s(437))/9)+-parseInt(s(457))/10+-parseInt(s(473))/11*(-parseInt(s(410))/12))break;a.push(a.shift())}catch(e){a.push(a.shift())}}();const _0x3ab855=_0x49de;!function(e,t){const s=_0x7798,a=_0x49de,i=_0x29ee();for(;;)try{if(523115===parseInt(a(310))/1+-parseInt(a(293))/2+parseInt(a(388))/3*(parseInt(a(299))/4)+-parseInt(a(278))/5*(-parseInt(a(386))/6)+parseInt(a(282))/7+-parseInt(a(267))/8+parseInt(a(287))/9*(-parseInt(a(341))/10))break;i[s(466)](i.shift())}catch(e){i[s(466)](i[s(446)]())}}();var __importDefault=this&&this[_0x552ec0(335)]||function(e){return e&&e[_0x49de(335)]?e:{default:e}};function _0x29ee(){const e=_0x552ec0,t=["userChanged",e(337),e(365),e(414),e(420),e(399),e(418),e(408),e(436),e(387),e(396),e(460),e(423),e(487),e(349),e(433),e(369),"service_type",e(344),"send",e(432),"db://assets/cloud-component/",e(484),e(463),e(424),"./plugin",e(449),e(375),e(417),e(402),e(376),e(346),e(380),"close","warn",e(479),e(407),e(359),e(401),"sender","params",e(342),"getProjectPath",e(348),e(429),e(435),"focus","asset-db",e(368),e(451),e(452),e(364),"methods","debug",e(339),e(422),e(456),e(355),e(393),e(428),e(454),e(459),e(360),e(378),"plugin-msg",e(468),"30tWUXvu",e(485),e(447),e(336),"346017umgLNU",e(388),e(340),"package.json","size",e(425),e(474),e(397),"all",e(406),e(480),e(430),e(444),"install","open","readBindGame","sendMsg",e(431),e(363),e(421),e(403),e(353),"root","service_id","getGameDetail",e(381),e(400),e(481),e(377),e(357),"getCreatorVersion",e(338),e(379),e(455),e(391),e(486),e(475),"installPlugin",e(442),e(386),"dialog_title",e(478),"create-node","startsWith",e(392),"silenceCreateGame",e(350),e(465),e(461),e(385),"target not exist!",e(370),e(409),e(384),e(440),e(416),e(352),"has","broadcastMsg",e(343),e(334),"deleteCache",e(470),e(371),e(347),e(419),e(448),e(361),e(469),e(464),"extension",e(389),e(477),e(354),e(471)];return(_0x29ee=function(){return t})()}function _0x1234(){const e=["main","browser.updating_tips","${name}","requestMsg","readConfigSet","__importDefault","login","service_name_error","install.js","service-","service_component_name","asset-db","service:i18nChange","530ZwPwnJ","assets","getServiceVersion","153eKvezD","pluginExists","load","pluginName","request","service_name","cocos-service:service-data-change","log","compareVersion","fs-extra","readJSONSync","cloud_json","csHttp","replace","package.json is not found.",".prefab","version","UNKNOW","map","query-uuid","getCustomPlugin","service_id","logout","success","Panel","Message","target","164NgtaHg","cloud-function","ensureDir","silence_open_service","748510yCzLXn","dependency","csPlugin","message","electron","49GXmbOA","48YrmiNT","__esModule","cocos-service","getRedirectUrl","redirect_url","cocos-service:popup-show","writeBindGame","all","global","User","values","fromWebContents","sendMsg","import","silence_disable_service","2556975CqBaim","onServiceStatusChanged","existsSync","installed","236142sDqTjX","service","./protocol","13565cqCEBI","value","csProtocol","remove","../utils","19928472UodYRf","BrowserWindow","find","browser.update_tips","csConfig","1045428tBfTQL","scene","download_url","dialogMsgBox","refresh-asset","enable","builder","5557304EiXeNv","csUtil","cocos-service.simple","76941hevBmY","wirteEnableService","package_download_url","getServicePluginInfo","name","362190PgHqNj","64148aiklXh","update-extension","cloud-component:update-import","has","readServiceParam","broadcast","1911285zoAyCc","popupShow","db://assets/cloud-component/","error","userChanged","default","service:handle-penetrate-param","browser.cancel","send","shift","assets/cloud-component","get","Project","55141BkWjna","app_id","join","defineProperty","csLogger","catch","delete","3588500kZmeCL","46nBjqKM","plugin","registerPluginsI18n","plugin-msg-popup","includes","require","copy","readServiceList","push","set","stringify","csEditor","removeListener","service:userChanged","methods","22hvBlbj","unload","path","node","ipcMain","then","popup","apiPost","info","debug","../utils/_inner"];return(_0x1234=function(){return e})()}Object[_0x552ec0(453)](exports,_0x3ab855(335),{value:!0}),exports[_0x3ab855(288)]=exports[_0x552ec0(348)]=exports[_0x3ab855(264)]=void 0;const electron_1=require(_0x3ab855(307)),utils_1=require(_0x3ab855(334)),plugin_1=__importDefault(require(_0x3ab855(382))),protocol_1=__importDefault(require(_0x552ec0(404))),_inner_1=require(_0x552ec0(483)),fs_extra_1=require(_0x3ab855(269)),path_1=require(_0x3ab855(318));let popupWindows=new Map,firstRun=!0;function _0x49de(e,t){const s=_0x29ee();return(_0x49de=function(e,t){return s[e-=264]})(e,t)}async function load(){const e=_0x552ec0,t=_0x3ab855;Editor[t(326)].on(t(281),exports[t(264)][t(357)]),Editor[t(326)].on("logout",exports[t(264)][t(357)]),electron_1[t(354)].on(t(283),exports.methods[e(438)]),await plugin_1[t(320)][t(368)]()}function unload(){const e=_0x552ec0,t=_0x3ab855;Editor[t(326)][t(344)](t(281),exports[t(264)][e(441)]),Editor.User[e(470)](t(405),exports.methods[t(357)]),electron_1[t(354)][t(344)](t(283),exports[t(264)][e(438)])}exports[_0x552ec0(472)]={async openServicePanel(e){const t=_0x552ec0,s=_0x3ab855;await Editor[s(333)][s(339)](s(331))?(await Editor[t(370)][s(403)](t(385)),utils_1[s(350)][t(395)](utils_1[s(350)][s(273)],s(276),s(302),t(443),e)):await Editor[s(333)][s(296)]("cocos-service",e)},openPopup(e,t,s){const a=_0x3ab855;try{if(!popupWindows[a(339)](e))return void Editor[a(333)][a(296)](a(381),e,t);{let t=popupWindows[a(348)](e);null==t||t[a(403)]()}}catch(t){popupWindows[a(268)](e)}},closePopup(e){const t=_0x552ec0,s=_0x3ab855;try{if(popupWindows[t(434)](e)){let t=popupWindows[s(348)](e);null==t||t[s(390)](),popupWindows[s(268)](e)}}catch(t){popupWindows[s(268)](e)}},printLog(e,t){const s=_0x3ab855;s(336)===e&&console[s(336)](t),s(309)===e&&console.info(t),s(303)===e&&console[s(303)](t),"warn"===e&&console[s(391)](t)},popupShow(e,t){const s=_0x552ec0,a=_0x3ab855;let i=electron_1[s(411)][s(394)](e[a(396)]),r=t[a(371)];null!==i&&r&&popupWindows[s(467)](r,i)},async userChanged(){const e=_0x552ec0,t=_0x3ab855;await Editor[e(370)][e(434)](t(331))&&Editor.Message[t(376)](t(331),t(276),e(403),t(356))},apiRequest:async(e,t={})=>_0x3ab855(366)===e?await protocol_1[_0x3ab855(320)][_0x3ab855(321)](t[_0x3ab855(366)]):new Promise((s,a)=>protocol_1[_0x3ab855(320)][_0x3ab855(292)](e,t)[_0x3ab855(323)](s)[_0x3ab855(315)](e=>a(new Error(JSON[_0x3ab855(277)](e))))),async enableService(e,t,s=""){const a=_0x552ec0,i=_0x3ab855;e[i(325)](i(266))||(e=a(339)+e);let r=(await utils_1.csConfig[i(329)]())[a(412)](t=>t[i(284)]===e);if(void 0===r)throw new Error(utils_1[i(350)].tr(i(358)));let o=(await utils_1.csConfig[i(297)]()||{app_id:a(363)})[i(406)];if(i(300)===o)try{let e=await(0,_inner_1[i(327)])();o=e[i(406)],await utils_1[a(414)][i(353)](e);let t=await utils_1[i(360)][i(342)]();t&&(s=t.config_id)}catch(e){return e.message}try{let e=await utils_1.csProtocol[i(306)](o);t&&"0"!==r[i(374)]&&!e[i(302)][a(462)](r[i(305)])&&await utils_1[i(393)].openService(o,r[i(305)]),await utils_1[i(360)][a(426)](r[a(367)],t,s)[i(315)](utils_1[i(272)][i(265)]),utils_1[a(454)][i(309)](utils_1[i(350)].tr(i(t?387:289))[i(394)](i(317),r[a(351)]))}catch(e){return e[i(389)]}return plugin_1[i(320)][i(346)](e)||await plugin_1[a(442)][i(319)](e,r[a(427)],(e,t)=>{const s=i;t&&utils_1[s(350)].tr(s(395))}),i(373)},pluginMsg:async(e,t,s={})=>_0x3ab855(302)===e&&await Editor[_0x3ab855(333)][_0x552ec0(434)](_0x3ab855(331))?await utils_1[_0x3ab855(350)][_0x3ab855(370)](utils_1[_0x552ec0(469)][_0x3ab855(273)],"plugin-msg-service",t,s):_0x3ab855(392)===e&&popupWindows[_0x3ab855(286)]>0?await utils_1.csEditor[_0x3ab855(370)](utils_1[_0x3ab855(350)][_0x552ec0(459)],_0x3ab855(330),t,s):_0x3ab855(332),serviceReady(){firstRun&&(firstRun=!1,setTimeout(async()=>{const e=_0x7798,t=_0x49de;let s=await utils_1[t(393)][e(366)]();if(1===utils_1[e(423)][t(355)](s[t(275)],utils_1.csEditor[t(312)]()))return;if(1!==utils_1[e(423)][t(355)](s[e(362)],utils_1[t(350)][e(345)]()))return;if(0!==await utils_1[t(350)][t(363)](t(309),utils_1[e(469)].tr(e(413)),utils_1[t(350)].tr(t(322)),[utils_1[t(350)].tr("browser.update_now"),utils_1[t(350)].tr(t(294))],0))return;let a=await utils_1[e(358)][t(348)](s[t(385)],{});utils_1[t(272)][t(309)](utils_1[t(350)].tr(t(279))),utils_1[e(469)][t(298)](t(352),t(377),a[t(385)],utils_1[t(350)][t(273)],t(316)),Editor[t(333)][t(390)](utils_1[t(350)][t(273)])},5e3))},async i18nChange(){const e=_0x552ec0,t=_0x3ab855;utils_1[t(350)][t(340)](t(338)),await Editor[t(333)][t(339)](t(331))&&Editor[e(371)][e(445)](e(385),t(276),t(302),t(398))},async onServiceStatusChanged(e){const t=_0x552ec0,s=_0x3ab855;var a;try{let i=utils_1[s(314)][s(271)](e[s(284)]);if(void 0===i||!(null===(a=i[s(301)])||void 0===a?void 0:a[s(379)]))return;let r={};r[s(305)]=e[s(305)],r[s(284)]=e[s(284)],r[t(420)]=e[s(361)]||!1,r[s(397)]=await utils_1[t(414)][s(402)](e.service_id);let o=utils_1[s(369)][s(380)](i.path,i[s(301)][s(379)]);o[s(362)]&&await o[s(362)](utils_1[s(350)][s(399)](),r)}catch(e){utils_1[s(272)][t(482)](e)}},async dropScene(e,t,s){const a=_0x552ec0,i=_0x3ab855;await Promise[i(290)](s[a(364)](async e=>{const s=a,r=i;await exports[r(264)][r(367)](e[s(406)]);const o=r(378)+e[r(401)]+"/"+e[r(401)]+s(361),n=await Editor[r(345)][r(328)](s(341),r(359),o);utils_1[r(350)][s(395)](r(337),r(324),{position:t,assetUuid:n})}))},async dropHierarchy(e,t){const s=_0x552ec0,a=_0x3ab855;t=t||e[a(270)],await Promise[s(390)](t[a(408)](async e=>{const t=s,i=a,r=e[t(372)]||e[t(476)]||e.to;await exports[t(472)][i(367)](e[i(291)]);const o=t(439)+e[i(401)]+"/"+e[i(401)]+i(349),n=await Editor[i(345)][i(328)](i(404),t(365),o);utils_1[t(469)][i(298)](i(337),i(324),{parent:r,assetUuid:n})}))},async dropAssets(e,t){const s=_0x552ec0,a=_0x3ab855;t=t||e[a(270)],await Promise[a(290)](t[a(408)](async e=>await exports[s(472)][a(367)](e[a(291)])))},async import(e){const t=_0x552ec0,s=_0x3ab855;if(!(0,fs_extra_1[t(400)])(e))return;const a={cloud_json:(0,path_1[s(407)])(e,s(285)),assets:(0,path_1[t(452)])(e,s(375)),function:(0,path_1[s(407)])(e,t(374)),install:(0,path_1.join)(e,s(313))};if(!(0,fs_extra_1[s(308)])(a[s(311)]))throw new Error(s(274));const i=(0,fs_extra_1[t(356)])(a[s(311)]),r={root:(0,path_1[t(452)])(Editor[t(449)][s(318)],s(280)),assets:(0,path_1[s(407)])(Editor[s(383)][s(318)],s(280),i[t(429)])};await(0,fs_extra_1[s(384)])(r[s(304)]);try{(0,fs_extra_1[t(400)])(a[s(375)])&&!(0,fs_extra_1[s(308)])(r[s(375)])&&await(0,fs_extra_1[s(351)])(a[s(375)],r[s(375)]),(0,fs_extra_1[s(308)])(a[s(295)])&&(utils_1[s(369)][s(343)](a[s(295)]),await require(a[s(295)])[s(379)]({assetsPath:r[s(375)]}))}catch(e){utils_1[s(272)][t(440)](e),(0,fs_extra_1[t(400)])(r[t(344)])&&await(0,fs_extra_1[s(364)])(r[t(344)])}await Editor[s(345)][s(328)](s(404),s(347),r[s(304)]),Editor[s(345)][s(365)](s(372))}},exports[_0x3ab855(400)]=load,exports[_0x552ec0(474)]=unload;