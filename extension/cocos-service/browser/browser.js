"use strict";const _0x1da4a1=_0x1cb0,_0x39d978=(!function(){for(var e=_0x1cb0,t=_0x51d8();;)try{if(645235==+parseInt(e(479))+-parseInt(e(412))/2*(-parseInt(e(512))/3)+parseInt(e(400))/4+parseInt(e(495))/5+-parseInt(e(488))/6*(parseInt(e(436))/7)+-parseInt(e(464))/8+-parseInt(e(451))/9)break;t.push(t.shift())}catch(e){t.push(t.shift())}}(),_0x1735);function _0x357a(){const e=_0x1cb0,t=[e(438),e(499),e(459),"cocos-service:service-data-change",e(448),"query-uuid",e(430),"all",e(462),e(524),e(492),e(465),e(477),e(513),e(497),e(399),e(518),e(527),"plugin",e(398),e(419),"focus","1367470VXGrrU",e(445),e(454),e(452),e(496),"removeListener",e(505),"25NpkDEh",e(531),"replace",e(402),e(441),e(440),e(473),"target",e(467),e(481),"defineProperty",e(523),e(526),e(447),"service:i18nChange",e(450),e(439),e(401),e(510),"set","download_url",e(480),e(422),"extension",e(457),e(485),e(409),e(405),"csLogger",e(472),e(434),e(489),e(493),e(506),e(536),e(500),"debug","install","package.json",e(466),e(538),e(455),e(428),"success",e(410),e(437),e(522),e(425),e(534),"readServiceParam",e(509),e(476),e(529),e(502),e(521),"cocos-service:popup-show","../utils",e(418),e(458),e(420),"requestMsg","main",e(530),e(508),e(408),"UNKNOW",e(490),e(514),e(443),"csEditor","get",e(469),e(471),e(395),e(446),e(427),e(501),"config_id",e(417),e(413),"cloud-component:update-import","ensureDir","cocos-service.simple",e(491),e(411),"fs-extra",e(517),e(532),e(435),e(474),e(487),e(520),e(424),e(456),"warn","asset-db",e(406),"package_download_url",e(404),e(468),"broadcast",e(396),e(403),"openService",e(431),"popupShow","open",e(504),e(407),e(494),e(515),e(461),e(482),"deleteCache",e(429),e(470),e(415),"delete",e(511),e(433),"fromWebContents",e(486),"Message",e(528),e(416),e(421)];return(_0x357a=function(){return t})()}!function(){for(var t=_0x1cb0,e=_0x1735,a=_0x357a();;)try{if(616025==-parseInt(e(465))*(-parseInt(e(434))/2)+parseInt(e(452))/3*(parseInt(e(419))/4)+parseInt(e(470))/5*(-parseInt(e(516))/6)+parseInt(e(492))/7+-parseInt(e(443))/8+parseInt(e(422))/9+-parseInt(e(463))/10)break;a[t(507)](a[t(478)]())}catch(e){a[t(507)](a[t(478)]())}}();var __importDefault=this&&this[_0x39d978(502)]||function(e){var t=_0x39d978;return e&&e[t(414)]?e:{default:e}};Object[_0x39d978(480)](exports,_0x39d978(414),{value:!0}),exports[_0x39d978(453)]=exports[_0x39d978(503)]=exports[_0x39d978(411)]=void 0;const electron_1=require(_0x39d978(383)),utils_1=require(_0x39d978(371)),plugin_1=__importDefault(require(_0x39d978(403))),protocol_1=__importDefault(require(_0x39d978(512))),_inner_1=require(_0x1da4a1(483)),fs_extra_1=require(_0x39d978(400)),path_1=require(_0x39d978(388));function _0x1735(e,t){const a=_0x357a();return(_0x1735=function(e,t){return e-=367,a[e]})(e,t)}function _0x51d8(){const e=["service:userChanged","refresh-asset","root","getProjectPath","__importDefault","sendMsg","1667335EXYRtT","assets/cloud-component","error","csEditor","Panel","value","getRedirectUrl","enable","delete","4436514SEwnCM","request","load","push","silenceCreateGame","3.7.0","BrowserWindow","close","1553529DwipEH","plugin-msg","catch","cloud_json","UNKNOW","logout","wirteEnableService","install","default","${name}","1276782VcpFIO","readJSONSync","import","plugin-msg-popup","assets","getCreatorVersion","update-extension","dialogMsgBox","then","installPlugin","startsWith","isLogin","readConfigSet","readBindGame","compareVersion","global","require","download_url","path","node","open","userChanged","getGameDetail","3833112EUApCC","User","info","service_component_name","service_name","csConfig","methods","has","browser.update_now","browser.cancel","service","ipcMain","4sjKOjW","join","sender","values","browser.updating_tips","version","getCustomPlugin","Project","cloud-function","create-node","4881051QRYreX","service_name_error","csUtil","service_id","plugin","service:handle-penetrate-param","./protocol","registerPluginsI18n","broadcastMsg","212AguGTw","includes","344vRWcQh","params","./plugin","41335hWkkWN","getServiceVersion","scene","install.js","remove","app_id","package.json is not found.","electron","size","dependency","service_type","writeBindGame","popup","send","redirect_url","11747538dMQXAp","csProtocol","onServiceStatusChanged","239MxfiyX","target not exist!","browser.update_tips","name","installed","2604856sHXJcd","plugin-msg-service","readServiceList","apiPost","stringify","5566256kpDsDE","51567jQpHWi","service-","db://assets/cloud-component/","__esModule","silence_open_service","builder","existsSync","login","copy","csPlugin","getServicePluginInfo",".prefab","unload","shift","738123nqQdfW","dialog_title","log","map","../utils/_inner","csLogger","cocos-service","message","pluginExists","426CgCOtq"];return(_0x51d8=function(){return e})()}let popupWindows=new Map,firstRun=!0;async function load(){var e=_0x1da4a1,t=_0x39d978;Editor.User.on(t(499),exports[e(406)][t(460)]),Editor.User.on(t(401),exports[t(411)][e(398)]),electron_1[t(399)].on(t(370),exports[t(411)][t(420)]),await plugin_1[e(520)][t(429)]()}function _0x1cb0(e,t){const a=_0x51d8();return(_0x1cb0=function(e,t){return e-=394,a[e]})(e,t)}function unload(){var e=_0x1da4a1,t=_0x39d978;Editor[e(401)][t(468)](t(499),exports[t(411)][e(398)]),Editor[t(487)][t(468)](t(401),exports[t(411)][t(460)]),electron_1[t(399)][t(468)](t(370),exports[t(411)][t(420)])}exports[_0x39d978(411)]={async openServicePanel(e){var t=_0x1da4a1,a=_0x39d978;await Editor[a(442)][a(423)](a(495))?(await Editor[a(442)][a(462)](a(495)),utils_1[a(384)][a(424)](utils_1[a(384)].plugin,a(454),a(514),a(390),e)):await Editor[t(499)][t(397)](a(495),e)},openPopup(t,e,a){var s,r=_0x1da4a1,i=_0x39d978;try{popupWindows[r(407)](t)?null!=(s=popupWindows[i(385)](t))&&s[i(462)]():Editor[i(442)][i(421)](i(397),t,e)}catch(e){popupWindows[r(503)](t)}},closePopup(t){var e,a=_0x1da4a1,s=_0x39d978;try{popupWindows[s(423)](t)&&(null!=(e=popupWindows[s(385)](t))&&e[a(511)](),popupWindows[s(432)](t))}catch(e){popupWindows[a(503)](t)}},printLog(e,t){var a=_0x1da4a1,s=_0x39d978;s(455)===e&&console[s(455)](t),a(402)===e&&console[s(473)](t),s(479)===e&&console[s(479)](t),s(409)===e&&console[s(409)](t)},popupShow(e,t){var a=_0x1da4a1,s=_0x39d978,e=electron_1[s(488)][s(435)](e[a(414)]),a=t.pluginName;null!==e&&a&&popupWindows[s(489)](a,e)},async userChanged(){var e=_0x1da4a1,t=_0x39d978;await Editor[e(499)][e(407)](e(485))&&Editor[t(437)][e(449)](e(485),t(454),e(410),t(501))},apiRequest:async(a,s={})=>_0x39d978(485)===a?await protocol_1[_0x39d978(406)][_0x39d978(391)](s[_0x39d978(485)]):new Promise((e,t)=>protocol_1[_0x39d978(406)][_0x39d978(449)](a,s)[_0x39d978(377)](e)[_0x39d978(382)](e=>t(new Error(JSON[_0x1da4a1(463)](e))))),async enableService(t,e,a=""){const s=_0x1da4a1,r=_0x39d978;t[r(402)](s(466))||(t=r(509)+t);var i=(await utils_1[r(497)][r(426)]()).find(e=>e[r(417)]===t);if(void 0===i)throw new Error(utils_1[s(498)].tr(s(423)));let o=(await utils_1[r(497)][s(535)]()||{app_id:s(516)})[r(474)];if(r(380)===o)try{var n=await(0,_inner_1[r(378)])(),_=(o=n[r(474)],await utils_1[r(497)][r(483)](n),await utils_1[s(405)][r(518)]());_&&(a=_[r(392)])}catch(e){return e[s(486)]}try{var d=await utils_1[s(452)][r(456)](o);e&&"0"!==i[r(389)]&&!d[s(410)][s(432)](i[r(517)])&&await utils_1[r(466)][r(418)](o,i[r(517)]),await utils_1[r(497)][r(457)](i[r(517)],e,a)[r(382)](utils_1[r(498)][r(506)]),utils_1[r(498)][r(473)](utils_1[r(384)].tr(e?r(386):"silence_disable_service")[r(472)](r(369),i[r(413)]))}catch(e){return e[r(436)]}return plugin_1[r(406)][r(405)](t)||await plugin_1[r(406)][r(471)](t,i[r(412)],(e,t)=>{var a=r;t&&utils_1[a(384)].tr(a(373))}),r(513)},pluginMsg:async(e,t,a={})=>_0x39d978(514)===e&&await Editor[_0x39d978(442)][_0x39d978(423)](_0x39d978(495))?await utils_1[_0x1da4a1(498)][_0x39d978(375)](utils_1[_0x39d978(384)][_0x39d978(459)],_0x1da4a1(460),t,a):_0x39d978(445)===e&&0<popupWindows[_0x1da4a1(444)]?await utils_1[_0x39d978(384)][_0x39d978(375)](utils_1[_0x39d978(384)][_0x1da4a1(426)],_0x1da4a1(525),t,a):_0x39d978(511),serviceReady(){firstRun&&(firstRun=!1,setTimeout(async()=>{var e,t=_0x1cb0,a=_0x1735;await utils_1[t(498)][t(533)]()&&(e=await utils_1[a(466)][a(372)](),-1===utils_1[t(424)][a(504)](utils_1[a(384)].getCreatorVersion(),a(520)))&&1!==utils_1[a(407)][a(504)](e[a(464)],utils_1[a(384)][a(458)]())&&1===utils_1[a(407)][t(536)](e[a(393)],utils_1[a(384)][a(515)]())&&0===await utils_1[t(498)][a(367)]("info",utils_1.csEditor.tr(a(408)),utils_1[a(384)].tr(a(491)),[utils_1[t(498)].tr(a(379)),utils_1[t(498)].tr(a(496))],0)&&(e=await utils_1.csHttp[a(385)](e[t(394)],{}),utils_1[t(484)][t(402)](utils_1[a(384)].tr(a(439))),utils_1[a(384)][a(424)](a(493),a(438),e[a(490)],utils_1[a(384)][a(459)],t(537)),Editor[a(442)][a(433)](utils_1[a(384)][a(459)]))},5e3))},async i18nChange(){var e=_0x1da4a1,t=_0x39d978;utils_1[t(384)][t(447)](t(444)),await Editor[t(442)][t(423)](t(495))&&Editor[t(437)][e(449)](t(495),t(454),t(514),t(484))},async onServiceStatusChanged(e){var t,a=_0x1da4a1,s=_0x39d978;try{var r,i,o=utils_1[s(404)][a(475)](e[s(417)]);void 0!==o&&null!=(t=o[s(430)])&&t[s(376)]&&((r={})[s(517)]=e[s(517)],r[s(417)]=e[s(417)],r[s(368)]=e[s(368)]||!1,r[s(500)]=await utils_1.csConfig[s(519)](e[s(517)]),(i=utils_1[a(424)][s(510)](o[a(395)],o.builder[s(376)]))[a(453)])&&await i[a(453)](utils_1[s(384)][s(451)](),r)}catch(e){utils_1[s(498)][s(506)](e)}},async dropScene(e,s,t){const r=_0x1da4a1,i=_0x39d978;await Promise[i(448)](t[r(482)](async e=>{var t=r,a=i,e=(await exports.methods[t(524)](e.value),"db://assets/cloud-component/"+e[a(494)]+"/"+e[a(494)]+a(521)),e=await Editor[a(437)].request(a(410),a(446),e);utils_1[a(384)][t(494)](a(441),a(440),{position:s,assetUuid:e})}))},async dropHierarchy(e,t){const r=_0x39d978;t=t||e[r(431)],await Promise[r(448)](t[r(427)](async e=>{var t=_0x1cb0,a=r,s=e[a(477)]||e[a(416)]||e.to,e=(await exports.methods[t(524)](e[t(500)]),a(478)+e[t(457)]+"/"+e[a(494)]+a(521)),e=await Editor[a(437)][a(469)](a(410),a(446),e);utils_1[a(384)][a(424)](t(438),a(440),{parent:s,assetUuid:e})}))},async dropAssets(e,t){const a=_0x39d978;t=t||e[a(431)],await Promise.all(t[a(427)](async e=>exports[a(411)][a(450)](e[a(505)])))},async import(e){var t=_0x1da4a1,a=_0x39d978;if((0,fs_extra_1[a(387)])(e)){e={cloud_json:(0,path_1[a(394)])(e,a(508)),assets:(0,path_1[a(394)])(e,t(526)),function:(0,path_1[a(394)])(e,a(374)),install:(0,path_1[a(394)])(e,a(486))};if(!(0,fs_extra_1[a(387)])(e[a(425)]))throw new Error(t(442));var s=(0,fs_extra_1[a(481)])(e[a(425)]),s={root:(0,path_1[t(413)])(Editor[a(461)][t(395)],t(496)),assets:(0,path_1[a(394)])(Editor[a(461)][a(388)],a(467),s[a(494)])};await(0,fs_extra_1[a(396)])(s[a(398)]);try{(0,fs_extra_1[a(387)])(e[a(482)])&&!(0,fs_extra_1[t(471)])(s[a(482)])&&await(0,fs_extra_1[a(476)])(e[a(482)],s[a(482)]),(0,fs_extra_1[t(471)])(e[a(507)])&&(utils_1[a(407)][a(428)](e.install),await require(e[t(519)])[a(376)]({assetsPath:s[a(482)]}))}catch(e){utils_1[a(498)][a(455)](e),(0,fs_extra_1[a(387)])(s[a(482)])&&await(0,fs_extra_1[a(475)])(s[a(482)])}await Editor[a(437)].request(a(410),a(381),s[a(398)]),Editor[a(437)][a(415)](a(395))}}},exports[_0x39d978(503)]=load,exports[_0x39d978(453)]=unload;