"use strict";function _0x1b8e(e,t){const r=_0x230e();return(_0x1b8e=function(e,t){return e-=251,r[e]})(e,t)}const _0x3b86d0=_0x1b8e;function _0x230e(){const e=["plugin-msg","config_id","logout","pluginName","cocos-service.simple","cloud-component:update-import","7gTdDeZ","update-extension","cocos-service:popup-show","dialogMsgBox","readConfigSet","includes","has","catch","cloud-function","deleteCache","readServiceList","version","11511GnGgKH","261770VMqcav","plugin-msg-service","request","close","load","value","81tisiBW","csEditor","openService","cocos-service","scene","service_id","ipcMain","popupShow","../utils/_inner","assets/cloud-component","values","plugin-msg-popup","5xEixMy","browser.update_tips","assets","csConfig","redirect_url","app_id","readServiceParam","all","asset-db","./protocol","default","info","cocos-service:service-data-change","browser.update_now","silence_disable_service","service_name_error","delete","userChanged","browser.cancel","builder","onServiceStatusChanged","service","message","shift","csPlugin","removeListener","getCreatorVersion","readBindGame","replace","methods","22TFJTHJ","map","service:i18nChange","pluginExists","silence_open_service","fromWebContents","1207240LnojKC","110kSDUBp","sendMsg","writeBindGame","query-uuid","wirteEnableService","unload","electron",".prefab","3064320OSwQYz","silenceCreateGame","main","1262948YdoOuL","node","3.7.0","stringify","BrowserWindow","service_name","fs-extra","broadcast","plugin","create-node","getRedirectUrl","login","644888AEWQqV","service_component_name","name","Message","cloud_json","2560McOcxH","require","UNKNOW","service-","path","3349524Slkkbz","import","db://assets/cloud-component/","Project","Panel","enable","39230mxlQXH","refresh-asset","getServiceVersion","registerPluginsI18n","install","../utils","342919KHRcCq","push","637478keYEGH","isLogin","requestMsg","log","57FSpgzZ","__esModule","service:userChanged","join","apiPost","ensureDir","__importDefault","startsWith","./plugin","installed","csHttp","readJSONSync","set","dependency","639756YncLHt","popup","service_type","target not exist!","csUtil","install.js","compareVersion","find","root","561900mRWihy","package.json","getCustomPlugin","installPlugin","error","existsSync","extension","focus","5TMycWJ","browser.updating_tips","get","7StkTCo","package.json is not found.","send"];return(_0x230e=function(){return e})()}!function(){for(var e=_0x1b8e,t=_0x230e();;)try{if(243663==+parseInt(e(412))+parseInt(e(352))/2+parseInt(e(356))/3*(parseInt(e(333))/4)+-parseInt(e(268))/5*(-parseInt(e(379))/6)+-parseInt(e(390))/7*(-parseInt(e(304))/8)+parseInt(e(256))/9*(-parseInt(e(344))/10)+parseInt(e(298))/11*(-parseInt(e(338))/12))break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const _0x3fccdd=_0x181e;function _0x181e(e,t){const r=_0x2508();return(_0x181e=function(e,t){return e-=192,r[e]})(e,t)}!function(){for(var t=_0x1b8e,e=_0x181e,r=_0x2508();;)try{if(383092==-parseInt(e(216))+parseInt(e(273))/2+-parseInt(e(220))/3+parseInt(e(194))/4*(parseInt(e(239))/5)+-parseInt(e(234))/6*(-parseInt(e(244))/7)+-parseInt(e(263))/8+parseInt(e(259))/9*(-parseInt(e(330))/10))break;r.push(r[t(291)]())}catch(e){r[t(351)](r[t(291)]())}}();var __importDefault=this&&this[_0x3b86d0(362)]||function(e){return e&&e[_0x181e(260)]?e:{default:e}};Object[_0x3fccdd(282)](exports,_0x3fccdd(260),{value:!0}),exports[_0x3b86d0(310)]=exports[_0x3fccdd(339)]=exports[_0x3fccdd(257)]=void 0;const electron_1=require(_0x3fccdd(295)),utils_1=require(_0x3fccdd(298)),plugin_1=__importDefault(require(_0x3fccdd(321))),protocol_1=__importDefault(require(_0x3b86d0(277))),_inner_1=require(_0x3fccdd(325)),fs_extra_1=require(_0x3fccdd(195)),path_1=require(_0x3b86d0(337));let popupWindows=new Map,firstRun=!0;function _0x2508(){const e=_0x3b86d0,t=["service:handle-penetrate-param",e(374),e(311),e(341),e(278),e(349),e(334),"${name}","getGameDetail",e(343),e(329),e(310),e(303),e(354),"existsSync",e(395),e(392),e(309),e(393),e(324),e(261),e(368),e(271),e(300),e(260),e(293),"then",e(386),e(364),e(403),e(280),"download_url",e(264),e(286),"params",e(302),"sender",e(305),e(262),e(406),"warn",e(287),e(366),e(377),e(405),e(301),e(254),e(391),e(402),e(266),"broadcastMsg",e(316),e(322),"csProtocol",e(255),e(401),e(383),"dialog_title",e(318),e(409),"open",e(397),e(369),e(273),e(269),e(263),e(295),e(296),e(283),e(346),e(398),e(330),e(340),e(350),e(382),e(380),e(325),e(370),e(396),"package_download_url",e(290),e(272),e(335),e(408),e(319),e(275),e(292),e(306),e(323),e(253),e(394),"4189146fxATnL",e(285),"main","debug","delete",e(387),e(257),e(365),"getCreatorVersion",e(337),e(399),e(265),e(339),e(353),e(259),e(355),"copy",e(388),e(307),e(332),e(381),e(363),"csLogger",e(297),e(347),e(411),e(357),e(410),e(252),e(313),e(308),e(281),e(372),e(360),"getProjectPath",e(358),"remove",e(299),e(376),e(328),e(321),e(385),e(389),"User",e(331),"success",e(312),e(373),"defineProperty",e(279),e(288),"join",e(342),e(375),e(276),"service",e(348),e(326),e(270)];return(_0x2508=function(){return t})()}async function load(){var e=_0x3b86d0,t=_0x3fccdd;Editor[t(277)].on(e(327),exports[t(257)][t(235)]),Editor[t(277)].on(t(308),exports[t(257)][e(285)]),electron_1[t(331)].on(t(198),exports[t(257)][t(208)]),await plugin_1[t(297)][t(258)]()}function unload(){var e=_0x3b86d0,t=_0x3fccdd;Editor[t(277)][t(318)](e(327),exports[e(297)][t(235)]),Editor[t(277)][t(318)]("logout",exports.methods[t(235)]),electron_1[e(262)][e(293)](e(401),exports[t(257)][t(208)])}exports[_0x3fccdd(257)]={async openServicePanel(e){var t=_0x3b86d0,r=_0x3fccdd;await Editor[r(286)][r(337)](r(248))?(await Editor[r(286)][r(320)](t(259)),utils_1[r(240)][r(230)](utils_1[r(240)][r(312)],r(311),r(289),r(293),e)):await Editor[r(286)][r(203)](r(248),e)},openPopup(t,e,r){var s,i=_0x3fccdd;try{popupWindows[i(337)](t)?null!=(s=popupWindows[i(276)](t))&&s[i(320)]():Editor[i(286)].open(i(204),t,e)}catch(e){popupWindows[i(238)](t)}},closePopup(t){var e,r=_0x3b86d0,s=_0x3fccdd;try{popupWindows[s(337)](t)&&(null!=(e=popupWindows[s(276)](t))&&e[s(232)](),popupWindows[r(284)](t))}catch(e){popupWindows[s(238)](t)}},printLog(e,t){var r=_0x3b86d0,s=_0x3fccdd;s(199)===e&&console[r(383)](t),s(283)===e&&console[s(283)](t),"log"===e&&console[s(249)](t),s(333)===e&&console[s(333)](t)},popupShow(e,t){var r=_0x3b86d0,s=_0x3fccdd,r=electron_1[r(320)][s(305)](e[s(329)]),e=t[s(221)];null!==r&&e&&popupWindows[s(314)](e,r)},async userChanged(){var e=_0x3b86d0,t=_0x3fccdd;await Editor[t(286)][t(337)](t(248))&&Editor[e(331)][t(309)](t(248),t(311),t(289),t(269))},apiRequest:async(r,s={})=>_0x3fccdd(224)===r?await protocol_1[_0x3fccdd(297)][_0x3fccdd(291)](s.redirect_url):new Promise((e,t)=>protocol_1[_0x3fccdd(297)][_0x3fccdd(267)](r,s)[_0x3fccdd(319)](e)[_0x3fccdd(332)](e=>t(new Error(JSON[_0x3fccdd(227)](e))))),async enableService(t,e,r=""){const s=_0x3b86d0,i=_0x3fccdd;t[i(255)]("service-")||(t=s(336)+t);var a=(await utils_1[s(271)][i(202)]())[i(336)](e=>e[s(329)]===t);if(void 0===a)throw new Error(utils_1[i(240)].tr(i(211)));let o=(await utils_1[i(315)][i(209)]()||{app_id:i(225)})[i(206)];if(s(335)===o)try{var c=await(0,_inner_1[s(314)])(),n=(o=c[i(206)],await utils_1[i(315)][i(252)](c),await utils_1[i(315)][i(322)]());n&&(r=n[i(233)])}catch(e){return e[i(223)]}try{var d=await utils_1[i(196)][i(301)](o);e&&"0"!==a[i(266)]&&!d[s(289)][s(404)](a[i(313)])&&await utils_1[i(196)][s(258)](o,a[i(313)]),await utils_1.csConfig[i(310)](a[i(313)],e,r)[i(332)](utils_1.csLogger[i(237)]),utils_1[i(256)][i(283)](utils_1[i(240)].tr(e?i(328):s(282))[i(210)](i(300),a[i(274)]))}catch(e){return e[i(223)]}return plugin_1[i(297)][i(338)](t)||await plugin_1[i(297)][i(217)](t,a[i(222)],(e,t)=>{var r=i;t&&utils_1[r(240)].tr(r(241))}),i(279)},pluginMsg:async(e,t,r={})=>_0x3fccdd(289)===e&&await Editor[_0x3fccdd(286)][_0x3fccdd(337)](_0x3b86d0(259))?await utils_1[_0x3b86d0(257)][_0x3fccdd(306)](utils_1[_0x3fccdd(240)][_0x3fccdd(312)],_0x3b86d0(251),t,r):_0x3b86d0(371)===e&&0<popupWindows.size?await utils_1[_0x3fccdd(240)][_0x3fccdd(306)](utils_1[_0x3fccdd(240)][_0x3fccdd(312)],_0x3b86d0(267),t,r):_0x3fccdd(281),serviceReady(){firstRun&&(firstRun=!1,setTimeout(async()=>{var e,t=_0x1b8e,r=_0x181e;await utils_1[t(257)][r(247)]()&&(e=await utils_1[r(196)][r(254)](),-1===utils_1[r(294)][r(272)](utils_1[t(257)][r(242)](),r(201)))&&1!==utils_1[t(374)][r(272)](e[r(205)],utils_1[t(257)][t(294)]())&&1===utils_1[t(374)][r(272)](e[r(261)],utils_1[r(240)][r(212)]())&&0===await utils_1[r(240)][r(341)](r(283),utils_1[t(257)].tr(r(207)),utils_1[t(257)].tr(r(200)),[utils_1[r(240)].tr(r(265)),utils_1[r(240)].tr(r(326))],0)&&(e=await utils_1[r(335)][r(276)](e[r(324)],{}),utils_1[r(256)][r(283)](utils_1[r(240)].tr(r(251))),utils_1[r(240)][t(306)](r(275),t(400),e[r(324)],utils_1[r(240)][r(312)],"global"),Editor[t(342)][t(253)](utils_1[r(240)][r(312)]))},5e3))},async i18nChange(){var e=_0x3b86d0,t=_0x3fccdd;utils_1[e(257)][t(193)](t(323)),await Editor[t(286)][t(337)](t(248))&&Editor[e(331)][e(392)](t(248),e(393),t(289),t(316))},async onServiceStatusChanged(e){var t,r=_0x3b86d0,s=_0x3fccdd;try{var i,a,o=utils_1[s(229)].getServicePluginInfo(e[s(303)]);void 0!==o&&null!=(t=o[s(334)])&&t[s(236)]&&((i={})[s(313)]=e[s(313)],i[r(329)]=e[s(303)],i[s(302)]=e.enable||!1,i[s(327)]=await utils_1[s(315)][r(274)](e[s(313)]),(a=utils_1[s(294)][s(299)](o[s(243)],o[r(287)][r(315)]))[s(284)])&&await a[s(284)](utils_1.csEditor[s(268)](),i)}catch(e){utils_1[s(256)][s(237)](e)}},async dropScene(e,s,t){const i=_0x3b86d0;await Promise[i(275)](t[i(299)](async e=>{var t=i,r=_0x181e,e=(await exports[r(257)].import(e[r(197)]),r(215)+e[t(330)]+"/"+e[r(214)]+r(280)),e=await Editor[t(331)][r(262)]("asset-db",r(264),e);utils_1[t(257)][r(230)](r(317),r(219),{position:s,assetUuid:e})}))},async dropHierarchy(e,t){const i=_0x3b86d0,a=_0x3fccdd;t=t||e[a(192)],await Promise[a(228)](t[i(299)](async e=>{var t=i,r=a,s=e.target||e[t(317)]||e.to,e=(await exports[r(257)][r(246)](e[r(197)]),r(215)+e[t(330)]+"/"+e[r(214)]+".prefab"),e=await Editor[r(278)][r(262)](r(288),r(264),e);utils_1[t(257)][r(230)](r(317),r(219),{parent:s,assetUuid:e})}))},async dropAssets(e,t){const r=_0x3b86d0,s=_0x3fccdd;t=t||e[r(266)],await Promise[s(228)](t[s(271)](async e=>exports[r(297)][s(246)](e[s(197)])))},async import(e){var t=_0x3b86d0,r=_0x3fccdd;if((0,fs_extra_1[t(384)])(e)){e={cloud_json:(0,path_1[r(285)])(e,r(218)),assets:(0,path_1[r(285)])(e,r(292)),function:(0,path_1[t(359)])(e,t(407)),install:(0,path_1[r(285)])(e,r(287))};if(!(0,fs_extra_1[r(307)])(e[t(332)]))throw new Error(r(340));var s=(0,fs_extra_1[t(367)])(e[r(253)]),s={root:(0,path_1[r(285)])(Editor[t(341)].path,r(245)),assets:(0,path_1[r(285)])(Editor[r(296)].path,r(245),s[r(214)])};await(0,fs_extra_1[t(361)])(s[t(378)]);try{(0,fs_extra_1[r(307)])(e[r(292)])&&!(0,fs_extra_1[r(307)])(s[t(270)])&&await(0,fs_extra_1[r(250)])(e[r(292)],s[r(292)]),(0,fs_extra_1[t(384)])(e[r(290)])&&(utils_1[r(294)][r(226)](e[r(290)]),await require(e[r(290)])[r(236)]({assetsPath:s[t(270)]}))}catch(e){utils_1[r(256)][r(199)](e),(0,fs_extra_1[r(307)])(s[t(270)])&&await(0,fs_extra_1[r(270)])(s[r(292)])}await Editor[r(278)][r(262)](r(288),t(345),s.root),Editor[t(331)][r(231)](r(213))}}},exports[_0x3fccdd(339)]=load,exports[_0x3fccdd(304)]=unload;