const _0x170a=["style","addBroadcastListener","readFileSync","contains","-hide","-non-vip-btn","-btn","path","toolbar","close","-non-vip-btn-double-digits-msgs","updateToolbar","utf8","default","openPanelBtn","get-saved-toolbar-info","request","newMsgCount","show-panel","_onUpdateToolbar","./toolbar.html","-msg-counter","isVip","__importDefault","-toolbar","template","__esModule","click","send","showToolbar","Message","innerText","msgCounter","classList","setAttribute","defineProperty","addEventListener","ready","call","join","./style-generator","-non-vip-btn-single-digit-msgs","-vip-btn","toString","remove","buttonTitle","add"];!function(e,t){!function(t){for(;--t;)e.push(e.shift())}(++t)}(_0x170a,167);const _0x557c=function(e,t){return _0x170a[e-=364]},_0x1c3b3a=_0x557c;var __importDefault=this&&this[_0x1c3b3a(408)]||function(e){return e&&e[_0x1c3b3a(364)]?e:{default:e}};Object[_0x1c3b3a(373)](exports,"__esModule",{value:!0}),exports[_0x1c3b3a(394)]=exports[_0x1c3b3a(375)]=exports.methods=exports.$=exports[_0x1c3b3a(385)]=exports[_0x1c3b3a(410)]=void 0;const fs_1=__importDefault(require("fs")),path_1=__importDefault(require(_0x1c3b3a(392))),style_generator_1=require(_0x1c3b3a(378)),namespace_1=require("../constant/namespace"),template=fs_1[_0x1c3b3a(398)][_0x1c3b3a(387)](path_1[_0x1c3b3a(398)][_0x1c3b3a(377)](__dirname,_0x1c3b3a(405)),_0x1c3b3a(397));exports[_0x1c3b3a(410)]=template;const style=style_generator_1.generateStyle();exports[_0x1c3b3a(385)]=style;const selector={toolbar:"."+namespace_1.ns+_0x1c3b3a(409),openPanelBtn:"."+namespace_1.ns+_0x1c3b3a(391),msgCounter:"."+namespace_1.ns+_0x1c3b3a(406)};exports.$=selector;const methods={updateToolbar(e={}){const t=_0x1c3b3a;void 0!==e[t(367)]&&setElementVisibility(this.$[t(393)],e.showToolbar),void 0!==e[t(383)]&&this.$[t(399)][t(372)]("title",e.buttonTitle),void 0!==e[t(407)]&&(e.isVip?(this.$[t(399)][t(371)].remove(namespace_1.ns+"-non-vip-btn"),this.$[t(399)][t(371)][t(384)](namespace_1.ns+t(380))):(this.$.openPanelBtn[t(371)][t(382)](namespace_1.ns+t(380)),this.$[t(399)].classList[t(384)](namespace_1.ns+t(390))));const s=e[t(402)];void 0!==s&&(this.$.toolbar.classList.remove(namespace_1.ns+t(379)),this.$.toolbar[t(371)][t(382)](namespace_1.ns+t(395)),0===s?(setElementVisibility(this.$[t(370)],!1),this.$.msgCounter[t(369)]="0"):(setElementVisibility(this.$[t(370)],!0),this.$[t(370)][t(369)]=s>99?"99":s[t(381)](),e[t(407)]||(s>=10?this.$[t(393)][t(371)][t(384)](namespace_1.ns+t(395)):this.$[t(393)][t(371)][t(384)](namespace_1.ns+t(379)))));const n={showToolbar:getElementVisibility(this.$.toolbar),isVip:this.$.openPanelBtn[t(371)].contains(namespace_1.ns+t(380)),newMsgCount:parseInt(this.$.msgCounter[t(369)])||0};Editor[t(368)].send(namespace_1.ns,"save-toolbar-info",n)}};async function ready(){const e=_0x1c3b3a;this._onUpdateToolbar=(e=>{const t=_0x557c;methods[t(396)][t(376)](this,e)}),Editor[e(368)][e(386)](namespace_1.ns+":update-toolbar",this[e(404)]),this.$[e(399)][e(374)](e(365),onClickShowPanel);const t=await Editor[e(368)][e(401)](namespace_1.ns,e(400));t&&this[e(404)](t)}function close(){const e=_0x1c3b3a;Editor[e(368)].removeBroadcastListener(namespace_1.ns+":update-toolbar",this[e(404)]),this.$[e(399)].removeEventListener(e(365),onClickShowPanel)}function setElementVisibility(e,t){const s=_0x1c3b3a;t?e[s(371)][s(382)](namespace_1.ns+s(389)):e.classList[s(384)](namespace_1.ns+"-hide")}function getElementVisibility(e){const t=_0x1c3b3a;return!e[t(371)][t(388)](namespace_1.ns+"-hide")}function onClickShowPanel(){const e=_0x1c3b3a;Editor.Message[e(366)](namespace_1.ns,e(403))}exports.methods=methods,exports[_0x1c3b3a(375)]=ready,exports[_0x1c3b3a(394)]=close;