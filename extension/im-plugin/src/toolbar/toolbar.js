"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.ready=exports.methods=exports.$=exports.style=exports.template=void 0;const fs_1=__importDefault(require("fs")),path_1=__importDefault(require("path")),style_generator_1=require("./style-generator"),namespace_1=require("../constant/namespace"),template=fs_1.default.readFileSync(path_1.default.join(__dirname,"./toolbar.html"),"utf8"),style=(exports.template=template,style_generator_1.generateStyle()),selector=(exports.style=style,{toolbar:`.${namespace_1.ns}-toolbar`,openPanelBtn:`.${namespace_1.ns}-btn`,msgCounter:`.${namespace_1.ns}-msg-counter`}),methods=(exports.$=selector,{updateToolbar(e={}){void 0!==e.showToolbar&&setElementVisibility(this.$.toolbar,e.showToolbar),void 0!==e.buttonTitle&&this.$.openPanelBtn.setAttribute("title",e.buttonTitle),void 0!==e.isVip&&(e.isVip?(this.$.openPanelBtn.classList.remove(namespace_1.ns+"-non-vip-btn"),this.$.openPanelBtn.classList.add(namespace_1.ns+"-vip-btn")):(this.$.openPanelBtn.classList.remove(namespace_1.ns+"-vip-btn"),this.$.openPanelBtn.classList.add(namespace_1.ns+"-non-vip-btn")));var t=e.newMsgCount,e=(void 0!==t&&(this.$.toolbar.classList.remove(namespace_1.ns+"-non-vip-btn-single-digit-msgs"),this.$.toolbar.classList.remove(namespace_1.ns+"-non-vip-btn-double-digits-msgs"),0===t?(setElementVisibility(this.$.msgCounter,!1),this.$.msgCounter.innerText="0"):(setElementVisibility(this.$.msgCounter,!0),this.$.msgCounter.innerText=99<t?"99":t.toString(),e.isVip||(10<=t?this.$.toolbar.classList.add(namespace_1.ns+"-non-vip-btn-double-digits-msgs"):this.$.toolbar.classList.add(namespace_1.ns+"-non-vip-btn-single-digit-msgs")))),{showToolbar:getElementVisibility(this.$.toolbar),isVip:this.$.openPanelBtn.classList.contains(namespace_1.ns+"-vip-btn"),newMsgCount:parseInt(this.$.msgCounter.innerText)||0});Editor.Message.send(namespace_1.ns,"save-toolbar-info",e)}});async function ready(){this._onUpdateToolbar=e=>{methods.updateToolbar.call(this,e)},Editor.Message.addBroadcastListener(namespace_1.ns+":update-toolbar",this._onUpdateToolbar),this.$.openPanelBtn.addEventListener("click",onClickShowPanel);var e=await Editor.Message.request(namespace_1.ns,"get-saved-toolbar-info");e&&this._onUpdateToolbar(e)}function close(){Editor.Message.removeBroadcastListener(namespace_1.ns+":update-toolbar",this._onUpdateToolbar),this.$.openPanelBtn.removeEventListener("click",onClickShowPanel)}function setElementVisibility(e,t){t?e.classList.remove(namespace_1.ns+"-hide"):e.classList.add(namespace_1.ns+"-hide")}function getElementVisibility(e){return!e.classList.contains(namespace_1.ns+"-hide")}function onClickShowPanel(){Editor.Message.send(namespace_1.ns,"show-panel")}exports.methods=methods,exports.ready=ready,exports.close=close;