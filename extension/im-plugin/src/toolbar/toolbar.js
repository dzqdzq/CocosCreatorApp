const _0x3b27=["_onUpdateToolbar","-btn","openPanelBtn","newMsgCount","updateToolbar","innerText","send","template","__esModule","-toolbar","methods","close","toolbar","showToolbar","generateStyle","classList","style","isVip","ready","default","-vip-btn",":update-toolbar","remove","msgCounter","-hide","call","./style-generator","title","add","-non-vip-btn-single-digit-msgs","path","get-saved-toolbar-info","save-toolbar-info","setAttribute","Message","buttonTitle","-non-vip-btn-double-digits-msgs","removeEventListener","toString","defineProperty","join","-msg-counter","utf8"];!function(e,t){!function(t){for(;--t;)e.push(e.shift())}(++t)}(_0x3b27,452);const _0x3bc9=function(e,t){return _0x3b27[e-=322]},_0x331c3f=_0x3bc9;var __importDefault=this&&this.__importDefault||function(e){return e&&e[_0x3bc9(351)]?e:{default:e}};Object[_0x331c3f(339)](exports,_0x331c3f(351),{value:!0}),exports[_0x331c3f(354)]=exports[_0x331c3f(361)]=exports[_0x331c3f(353)]=exports.$=exports.style=exports[_0x331c3f(350)]=void 0;const fs_1=__importDefault(require("fs")),path_1=__importDefault(require(_0x331c3f(330))),style_generator_1=require(_0x331c3f(326)),namespace_1=require("../constant/namespace"),template=fs_1.default.readFileSync(path_1[_0x331c3f(362)][_0x331c3f(340)](__dirname,"./toolbar.html"),_0x331c3f(342));exports[_0x331c3f(350)]=template;const style=style_generator_1[_0x331c3f(357)]();exports[_0x331c3f(359)]=style;const selector={toolbar:"."+namespace_1.ns+_0x331c3f(352),openPanelBtn:"."+namespace_1.ns+_0x331c3f(344),msgCounter:"."+namespace_1.ns+_0x331c3f(341)};exports.$=selector;const methods={updateToolbar(e={}){const t=_0x331c3f;void 0!==e[t(356)]&&setElementVisibility(this.$[t(355)],e.showToolbar),void 0!==e.buttonTitle&&this.$.openPanelBtn[t(333)](t(327),e[t(335)]),void 0!==e[t(360)]&&(e[t(360)]?(this.$[t(345)].classList[t(322)](namespace_1.ns+"-non-vip-btn"),this.$[t(345)][t(358)].add(namespace_1.ns+t(363))):(this.$[t(345)][t(358)][t(322)](namespace_1.ns+"-vip-btn"),this.$[t(345)][t(358)].add(namespace_1.ns+"-non-vip-btn")));const s=e[t(346)];void 0!==s&&(this.$[t(355)][t(358)][t(322)](namespace_1.ns+t(329)),this.$.toolbar.classList.remove(namespace_1.ns+t(336)),0===s?(setElementVisibility(this.$.msgCounter,!1),this.$.msgCounter[t(348)]="0"):(setElementVisibility(this.$[t(323)],!0),this.$[t(323)][t(348)]=s>99?"99":s[t(338)](),e.isVip||(s>=10?this.$.toolbar[t(358)][t(328)](namespace_1.ns+"-non-vip-btn-double-digits-msgs"):this.$[t(355)][t(358)][t(328)](namespace_1.ns+"-non-vip-btn-single-digit-msgs"))));const n={showToolbar:getElementVisibility(this.$[t(355)]),isVip:this.$[t(345)][t(358)].contains(namespace_1.ns+t(363)),newMsgCount:parseInt(this.$[t(323)][t(348)])||0};Editor.Message.send(namespace_1.ns,t(332),n)}};async function ready(){const e=_0x331c3f;this[e(343)]=(t=>{const s=e;methods[s(347)][s(325)](this,t)}),Editor[e(334)].addBroadcastListener(namespace_1.ns+":update-toolbar",this[e(343)]),this.$[e(345)].addEventListener("click",onClickShowPanel);const t=await Editor.Message.request(namespace_1.ns,e(331));t&&this[e(343)](t)}function close(){const e=_0x331c3f;Editor[e(334)].removeBroadcastListener(namespace_1.ns+e(364),this._onUpdateToolbar),this.$[e(345)][e(337)]("click",onClickShowPanel)}function setElementVisibility(e,t){const s=_0x331c3f;t?e.classList.remove(namespace_1.ns+s(324)):e[s(358)][s(328)](namespace_1.ns+s(324))}function getElementVisibility(e){return!e.classList.contains(namespace_1.ns+"-hide")}function onClickShowPanel(){const e=_0x331c3f;Editor[e(334)][e(349)](namespace_1.ns,"show-panel")}exports[_0x331c3f(353)]=methods,exports[_0x331c3f(361)]=ready,exports[_0x331c3f(354)]=close;