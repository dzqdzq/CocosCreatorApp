const _0x5b59=["download-with-progress","errorStr","download-canceled","progressCallback","basename","callId","now","hostAPI","canceled","download-progress","download-succeeded","fileName","once","function","transferred","file-selected","type","sendToHost","undefined","electron","readFile","__esModule","random","toString","../../constant/namespace","ipcRenderer","default","download-failed","download","off","is-ready","url",":panel-win-state-changed","defineProperty","promises",":get-version","floor","new-msg","total","percent","select-file","__importDefault","succeeded"];!function(e,n){!function(n){for(;--n;)e.push(e.shift())}(++n)}(_0x5b59,456);const _0x1544=function(e,n){return _0x5b59[e-=235]},_0x481b97=_0x1544;var __importDefault=this&&this[_0x481b97(250)]||function(e){return e&&e[_0x481b97(273)]?e:{default:e}};Object[_0x481b97(242)](exports,"__esModule",{value:!0});const fs_1=__importDefault(require("fs")),fsPromises=fs_1.default[_0x481b97(243)],path_1=__importDefault(require("path")),namespace_1=require(_0x481b97(276)),electron_1=require(_0x481b97(271)),pluginVersion=electron_1.ipcRenderer.sendSync(namespace_1.ns+_0x481b97(244)),globalAny=global;let panelWinStateChangedListener=null;function uuid(){const e=_0x481b97;let n=Date[e(258)]();return e(270)!=typeof performance&&e(265)==typeof performance[e(258)]&&(n+=performance[e(258)]()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const o=e;var r=(n+16*Math[o(274)]())%16|0;return n=Math[o(245)](n/16),("x"===t?r:3&r|8)[o(275)](16)})}electron_1.ipcRenderer.on(namespace_1.ns+_0x481b97(241),(e,n)=>{panelWinStateChangedListener&&panelWinStateChangedListener(n)}),globalAny[_0x481b97(259)]={imPluginVersion:pluginVersion,getData:async()=>new Promise(e=>{const n=_0x481b97;electron_1[n(277)][n(264)]("get-data",function(n,t){e(t)}),electron_1[n(277)][n(269)]("request-data")}),sendToHost:(e,n)=>{const t=_0x481b97;t(246)===e?electron_1.ipcRenderer.sendToHost(t(246),{newMsgCount:n}):t(237)===e&&electron_1[t(277)][t(269)](t(237),{url:n[t(240)],type:n.type,fileName:n.fileName})},isReady(e){const n=_0x481b97;electron_1[n(277)][n(269)](n(239),e)},setWindowListener(e){panelWinStateChangedListener=e},selectFile:async e=>new Promise((n,t)=>{const o=_0x481b97;electron_1[o(277)][o(264)](o(267),function(e,t){t?async function(e){const n=_0x1544,t=path_1[n(235)][n(256)](e),o=await fsPromises[n(272)](e);return new File([o],t)}(t).then(n):n("")}),electron_1[o(277)][o(269)](o(249),{type:e})}),downloadWithProgress:async e=>new Promise((n,t)=>{const o=_0x481b97,r=uuid();function s(n,t){const o=_0x1544;t[o(257)]===r&&(1==t[o(248)]&&t.transferred!==t[o(247)]||e[o(255)]&&e[o(255)]({percent:t.percent,transferred:t[o(266)],total:t[o(247)]}))}function a(e,n){n===r&&i({status:_0x1544(251)})}function c(e,n){const t=_0x1544;n[t(257)]===r&&i({status:"failed",errorStr:n[t(253)]})}function l(e,n){n===r&&i({status:_0x1544(260)})}function i(e){const t=_0x1544;n(e),electron_1[t(277)].off(t(261),s),electron_1[t(277)][t(238)](t(262),a),electron_1[t(277)][t(238)](t(236),c),electron_1[t(277)][t(238)](t(254),l)}electron_1[o(277)][o(269)](o(252),{url:e[o(240)],type:e[o(268)],fileName:e[o(263)],callId:r}),electron_1[o(277)].on(o(261),s),electron_1.ipcRenderer.on(o(262),a),electron_1[o(277)].on(o(236),c),electron_1[o(277)].on(o(254),l)})};