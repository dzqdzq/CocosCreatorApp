const _0xd233=["__importDefault","defineProperty","failed","then","floor","__esModule","sendToHost","canceled","ipcRenderer","off","download","hostAPI","function","now","fileName","is-ready","new-msg","progressCallback","readFile","sendSync",":panel-win-state-changed","url","callId","replace","download-canceled","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx","download-with-progress","download-progress","percent","path","basename",":get-version","transferred","download-failed","once","type","../../constant/namespace","toString","promises","total","default","electron","download-succeeded"];!function(e,n){!function(n){for(;--n;)e.push(e.shift())}(++n)}(_0xd233,430);const _0x59eb=function(e,n){return _0xd233[e-=128]},_0xa1cc9e=_0x59eb;var __importDefault=this&&this[_0xa1cc9e(128)]||function(e){return e&&e[_0xa1cc9e(133)]?e:{default:e}};Object[_0xa1cc9e(129)](exports,_0xa1cc9e(133),{value:!0});const fs_1=__importDefault(require("fs")),fsPromises=fs_1[_0xa1cc9e(168)][_0xa1cc9e(166)],path_1=__importDefault(require(_0xa1cc9e(157))),namespace_1=require(_0xa1cc9e(164)),electron_1=require(_0xa1cc9e(169)),pluginVersion=electron_1[_0xa1cc9e(136)][_0xa1cc9e(147)](namespace_1.ns+_0xa1cc9e(159)),globalAny=global;let panelWinStateChangedListener=null;function uuid(){const e=_0xa1cc9e;let n=Date[e(141)]();return"undefined"!=typeof performance&&e(140)==typeof performance[e(141)]&&(n+=performance[e(141)]()),e(153)[e(151)](/[xy]/g,function(t){const c=e;var o=(n+16*Math.random())%16|0;return n=Math[c(132)](n/16),("x"===t?o:3&o|8)[c(165)](16)})}electron_1[_0xa1cc9e(136)].on(namespace_1.ns+_0xa1cc9e(148),(e,n)=>{panelWinStateChangedListener&&panelWinStateChangedListener(n)}),globalAny[_0xa1cc9e(139)]={imPluginVersion:pluginVersion,sendToHost:(e,n)=>{const t=_0xa1cc9e;t(144)===e?electron_1.ipcRenderer[t(134)](t(144),{newMsgCount:n}):t(138)===e&&electron_1[t(136)].sendToHost(t(138),{url:n[t(149)],type:n[t(163)],fileName:n.fileName})},isReady(e){const n=_0xa1cc9e;electron_1[n(136)][n(134)](n(143),e)},setWindowListener(e){panelWinStateChangedListener=e},selectFile:async e=>new Promise((n,t)=>{const c=_0xa1cc9e;electron_1[c(136)][c(162)]("file-selected",function(e,t){const o=c;t?async function(e){const n=_0x59eb,t=path_1[n(168)][n(158)](e),c=await fsPromises[n(146)](e);return new File([c],t)}(t)[o(131)](n):n("")}),electron_1[c(136)][c(134)]("select-file",{type:e})}),downloadWithProgress:async e=>new Promise((n,t)=>{const c=_0xa1cc9e,o=uuid();function a(n,t){const c=_0x59eb;t[c(150)]===o&&(1==t[c(156)]&&t[c(160)]!==t[c(167)]||e.progressCallback&&e[c(145)]({percent:t[c(156)],transferred:t[c(160)],total:t.total}))}function r(e,n){n===o&&i({status:"succeeded"})}function s(e,n){const t=_0x59eb;n[t(150)]===o&&i({status:t(130),errorStr:n.errorStr})}function l(e,n){n===o&&i({status:_0x59eb(135)})}function i(e){const t=_0x59eb;n(e),electron_1[t(136)][t(137)]("download-progress",a),electron_1[t(136)][t(137)](t(170),r),electron_1[t(136)][t(137)](t(161),s),electron_1[t(136)][t(137)](t(152),l)}electron_1[c(136)][c(134)](c(154),{url:e[c(149)],type:e[c(163)],fileName:e[c(142)],callId:o}),electron_1[c(136)].on(c(155),a),electron_1.ipcRenderer.on("download-succeeded",r),electron_1[c(136)].on(c(161),s),electron_1[c(136)].on(c(152),l)})};