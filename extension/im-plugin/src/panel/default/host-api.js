const _0x23e3=["new-msg","__esModule","transferred","url","defineProperty",":panel-win-state-changed","ipcRenderer","progressCallback","percent","download-succeeded","is-ready","download-with-progress","download","replace","off","__importDefault","random","type","select-file","path","download-progress","download-failed","default","../../constant/namespace","toString","fileName","now","undefined","readFile","basename","function","electron","callId","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx","errorStr","total","sendToHost"];!function(e,n){!function(n){for(;--n;)e.push(e.shift())}(++n)}(_0x23e3,178);const _0x4f73=function(e,n){return _0x23e3[e-=430]},_0x4904e4=_0x4f73;var __importDefault=this&&this[_0x4904e4(452)]||function(e){return e&&e.__esModule?e:{default:e}};Object[_0x4904e4(441)](exports,_0x4904e4(438),{value:!0});const fs_1=__importDefault(require("fs")),fsPromises=fs_1[_0x4904e4(459)].promises,path_1=__importDefault(require(_0x4904e4(456))),namespace_1=require(_0x4904e4(460)),electron_1=require(_0x4904e4(431)),pluginVersion=electron_1[_0x4904e4(443)].sendSync(namespace_1.ns+":get-version"),globalAny=global;let panelWinStateChangedListener=null;function uuid(){const e=_0x4904e4;let n=Date.now();return e(464)!=typeof performance&&e(430)==typeof performance[e(463)]&&(n+=performance[e(463)]()),e(433)[e(450)](/[xy]/g,function(t){const o=e;var r=(n+16*Math[o(453)]())%16|0;return n=Math.floor(n/16),("x"===t?r:3&r|8)[o(461)](16)})}electron_1[_0x4904e4(443)].on(namespace_1.ns+_0x4904e4(442),(e,n)=>{panelWinStateChangedListener&&panelWinStateChangedListener(n)}),globalAny.hostAPI={imPluginVersion:pluginVersion,sendToHost:(e,n)=>{const t=_0x4904e4;t(437)===e?electron_1[t(443)].sendToHost(t(437),{newMsgCount:n}):"download"===e&&electron_1[t(443)][t(436)](t(449),{url:n[t(440)],type:n[t(454)],fileName:n[t(462)]})},isReady(e){const n=_0x4904e4;electron_1[n(443)][n(436)](n(447),e)},setWindowListener(e){panelWinStateChangedListener=e},selectFile:async e=>new Promise((n,t)=>{const o=_0x4904e4;electron_1[o(443)].once("file-selected",function(e,t){t?async function(e){const n=_0x4f73,t=path_1[n(459)][n(466)](e),o=await fsPromises[n(465)](e);return new File([o],t)}(t).then(n):n("")}),electron_1[o(443)][o(436)](o(455),{type:e})}),downloadWithProgress:async e=>new Promise((n,t)=>{const o=_0x4904e4,r=uuid();function s(n,t){const o=_0x4f73;t[o(432)]===r&&(1==t[o(445)]&&t[o(439)]!==t[o(435)]||e[o(444)]&&e[o(444)]({percent:t[o(445)],transferred:t[o(439)],total:t[o(435)]}))}function a(e,n){n===r&&i({status:"succeeded"})}function l(e,n){const t=_0x4f73;n[t(432)]===r&&i({status:"failed",errorStr:n[t(434)]})}function c(e,n){n===r&&i({status:"canceled"})}function i(e){const t=_0x4f73;n(e),electron_1[t(443)][t(451)](t(457),s),electron_1[t(443)].off(t(446),a),electron_1[t(443)][t(451)](t(458),l),electron_1[t(443)][t(451)]("download-canceled",c)}electron_1[o(443)][o(436)](o(448),{url:e.url,type:e.type,fileName:e[o(462)],callId:r}),electron_1[o(443)].on(o(457),s),electron_1[o(443)].on(o(446),a),electron_1[o(443)].on(o(458),l),electron_1[o(443)].on("download-canceled",c)})};