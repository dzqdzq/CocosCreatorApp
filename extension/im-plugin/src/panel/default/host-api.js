const _0x4488=["type","progressCallback","download-with-progress","total","download","hostAPI","promises","callId","once","../../constant/namespace","now","transferred","percent","off","download-progress","sendToHost","fileName","request-data","succeeded","function","floor","new-msg","default",":panel-win-state-changed","toString","path","download-canceled","failed","electron","canceled","defineProperty","url","is-ready","get-data","ipcRenderer","sendSync","select-file","download-succeeded","__importDefault","__esModule"];!function(e,n){!function(n){for(;--n;)e.push(e.shift())}(++n)}(_0x4488,104);const _0x26bd=function(e,n){return _0x4488[e-=344]},_0xa12377=_0x26bd;var __importDefault=this&&this[_0xa12377(358)]||function(e){return e&&e[_0xa12377(359)]?e:{default:e}};Object[_0xa12377(350)](exports,_0xa12377(359),{value:!0});const fs_1=__importDefault(require("fs")),fsPromises=fs_1[_0xa12377(382)][_0xa12377(366)],path_1=__importDefault(require(_0xa12377(345))),namespace_1=require(_0xa12377(369)),electron_1=require(_0xa12377(348)),pluginVersion=electron_1[_0xa12377(354)][_0xa12377(355)](namespace_1.ns+":get-version"),globalAny=global;let panelWinStateChangedListener=null;function uuid(){const e=_0xa12377;let n=Date[e(370)]();return"undefined"!=typeof performance&&e(379)==typeof performance.now&&(n+=performance[e(370)]()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const o=e;var r=(n+16*Math.random())%16|0;return n=Math[o(380)](n/16),("x"===t?r:3&r|8)[o(344)](16)})}electron_1[_0xa12377(354)].on(namespace_1.ns+_0xa12377(383),(e,n)=>{panelWinStateChangedListener&&panelWinStateChangedListener(n)}),globalAny[_0xa12377(365)]={imPluginVersion:pluginVersion,getData:async()=>new Promise(e=>{const n=_0xa12377;electron_1[n(354)][n(368)](n(353),function(n,t){e(t)}),electron_1[n(354)].sendToHost(n(377))}),sendToHost:(e,n)=>{const t=_0xa12377;"new-msg"===e?electron_1.ipcRenderer[t(375)](t(381),{newMsgCount:n}):t(364)===e&&electron_1.ipcRenderer[t(375)](t(364),{url:n.url,type:n[t(360)],fileName:n[t(376)]})},isReady(e){const n=_0xa12377;electron_1[n(354)].sendToHost(n(352),e)},setWindowListener(e){panelWinStateChangedListener=e},selectFile:async e=>new Promise((n,t)=>{const o=_0xa12377;electron_1.ipcRenderer[o(368)]("file-selected",function(e,t){t?async function(e){const n=path_1[_0x26bd(382)].basename(e),t=await fsPromises.readFile(e);return new File([t],n)}(t).then(n):n("")}),electron_1[o(354)][o(375)](o(356),{type:e})}),downloadWithProgress:async e=>new Promise((n,t)=>{const o=_0xa12377,r=uuid();function a(n,t){const o=_0x26bd;t[o(367)]===r&&(1==t[o(372)]&&t[o(371)]!==t.total||e[o(361)]&&e.progressCallback({percent:t[o(372)],transferred:t.transferred,total:t[o(363)]}))}function s(e,n){n===r&&i({status:_0x26bd(378)})}function c(e,n){const t=_0x26bd;n[t(367)]===r&&i({status:t(347),errorStr:n.errorStr})}function l(e,n){n===r&&i({status:_0x26bd(349)})}function i(e){const t=_0x26bd;n(e),electron_1.ipcRenderer[t(373)](t(374),a),electron_1.ipcRenderer[t(373)](t(357),s),electron_1[t(354)][t(373)]("download-failed",c),electron_1.ipcRenderer[t(373)](t(346),l)}electron_1[o(354)][o(375)](o(362),{url:e[o(351)],type:e[o(360)],fileName:e[o(376)],callId:r}),electron_1[o(354)].on(o(374),a),electron_1[o(354)].on(o(357),s),electron_1[o(354)].on("download-failed",c),electron_1[o(354)].on(o(346),l)})};