"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.postData=exports.encodeParams=void 0;const path_1=__importDefault(require("path")),request_1=__importDefault(require("request")),md5_1=(module.paths.push(path_1.default.join(Editor.App.path,"./node_modules")),__importDefault(require("md5"))),query_string_1=__importDefault(require("query-string")),translate_1=require("../common-lib/translate"),dialog_1=require("../common-lib/dialog");let sessionExpiredWarnShown=!1;function encodeParams(e){e=e,t={plugin_id:"1026",lang:Editor.I18n.getLanguage(),client_type:1,version:Editor.App.version,cc_version:Editor.App.version,cs_require:"3x"};var e=Object.assign({},e,t),t=query_string_1.default.stringify(e);return e.sign=(t=t,md5_1.default(t+"&fc81d0f39ca8157f9fb6324912aa2cf3573a5a41")),e}function postData(e,t){return new Promise((s,a)=>{try{request_1.default.post({url:e,json:!0,form:t,agentOptions:{ciphers:"ALL"}},(e,t,r)=>{e||200!==t.statusCode?a(e?{err:e}:{res:t,body:r}):(r.status&&(0===r.status?sessionExpiredWarnShown=!1:406!==r.status||sessionExpiredWarnShown||(dialog_1.info(translate_1.tr("session-expired"),{title:translate_1.tr("info-title")}),sessionExpiredWarnShown=!0)),s(r))})}catch(e){a({err:e})}})}exports.encodeParams=encodeParams,exports.postData=postData;