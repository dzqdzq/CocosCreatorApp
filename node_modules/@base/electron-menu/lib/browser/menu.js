"use strict";let parseHandler=null;class BaseMenu{static setParseHandler(e){"function"==typeof e&&(parseHandler=e)}constructor(e){this._name=e,this._type="button",this._level=0,this._group="default",this._click=function(){console.warn("There is no registered click event.")},this._options=Object.create(null),this._config=Object.create(null),this._groups=[],this._name2child=Object.create(null),this._name2group=Object.create(null),this.group("default",0)}get name(){return this._name}options(e){return e?(this._options=e,this._level=e.level||this._level,this._group=e.group||this._group,this._click=e.click||this._click,this):this}group(e,t){for(let s=0;s<this._groups.length;s++){let l=this._groups[s];if(l.name===e)return l.level=t,this}let s={name:e,level:t};return this._groups.push(s),this._name2group[e]=s,this}add(e,t){this._type="submenu";let s=this._name2child[e];return s||(s=new BaseMenu(e)),s.options(t),this._name2child[e]=s,this}remove(e){return delete this._name2child[e],this}isEmpty(){return 0===Object.keys(this._name2child).length}get(e){return this._name2child[e]||null}toJson(){let e={label:this._name};if(Object.keys(this._options).forEach(t=>{"level"!==t&&"group"!==t&&"click"!==t&&(e[t]=this._options[t])}),"submenu"!==this._type)return this._role?e.role=this._role:e.click=this._click,parseHandler&&parseHandler(this._options,e),e;e.submenu=[];let t={default:[]};return Object.keys(this._name2child).forEach(e=>{let s=this._name2child[e],l=s._group;this._name2group[l]||(l="default"),t[l]=t[l]||[],t[l].push(s)}),this._groups.sort((e,t)=>e.level-t.level),this._groups.forEach(s=>{let l=e.submenu[e.submenu.length-1];e.submenu.length>0&&l&&"separator"!==l.type&&e.submenu.push({type:"separator"});let i=s.name,n=t[i];n&&(n.sort((e,t)=>e._level-t._level),n.forEach(t=>{e.submenu.push(t.toJson())}))}),e}}module.exports=BaseMenu;