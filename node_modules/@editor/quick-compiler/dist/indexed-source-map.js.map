{"version":3,"file":"indexed-source-map.js","sourceRoot":"","sources":["../src/indexed-source-map.ts"],"names":[],"mappings":";;;AAGA,MAAa,gBAAgB;IACzB,YAAY,EACR,IAAI,EACJ,SAAS,GAIZ;QAwCO,eAAU,GAAgB;YAC9B,OAAO,EAAE,CAAC;YACV,QAAQ,EAAE,EAAE;SACf,CAAC;QAEM,UAAK,GAAG,EAAE,CAAC;QACX,WAAM,GAAG,CAAC,CAAC;QACX,aAAQ,GAAG,CAAC,CAAC;QACb,eAAU,GAAG,EAAE,CAAC;QA/CpB,IAAI,CAAC,UAAU,GAAG;YACd,OAAO,EAAE,CAAC;YACV,IAAI;YACJ,QAAQ,EAAE,EAAE;SACf,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,EAAE,CAAC;IACtC,CAAC;IAED,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC3C,CAAC;IAEM,GAAG,CAAC,IAAqB,EAAE,GAAkB;QAChD,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YACvB,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;SAC1B;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC;QACD,IAAI,GAAG,EAAE;YACL,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC;gBAC1B,MAAM,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE;gBACpD,GAAG;aACN,CAAC,CAAC;SACN;QACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;IAEO,QAAQ,CAAC,IAAY;QACzB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QACxC,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC;QAChD,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC;IACvB,CAAC;CAWJ;AAxDD,4CAwDC","sourcesContent":["\r\nimport { SourceMapGenerator, RawIndexMap, RawSourceMap } from 'source-map';\r\n\r\nexport class IndexedSourceMap {\r\n    constructor({\r\n        file,\r\n        separator,\r\n    }: {\r\n        file?: string,\r\n        separator?: string,\r\n    }) {\r\n        this._sourceMap = {\r\n            version: 3,\r\n            file,\r\n            sections: [],\r\n        };\r\n        this._separator = separator ?? '';\r\n    }\r\n\r\n    get code() {\r\n        return this._code;\r\n    }\r\n\r\n    get sourceMap() {\r\n        return JSON.stringify(this._sourceMap);\r\n    }\r\n\r\n    public add(code: string | Buffer, map?: RawSourceMap) {\r\n        if (Buffer.isBuffer(code)) {\r\n            code = code.toString();\r\n        }\r\n        if (this._separator) {\r\n            this._addCode(this._separator);\r\n        }\r\n        if (map) {\r\n            this._sourceMap.sections.push({\r\n                offset: { line: this._lines, column: this._columns },\r\n                map,\r\n            });\r\n        }\r\n        this._addCode(code);\r\n    }\r\n\r\n    private _addCode(code: string) {\r\n        const lines = code.split(/\\r\\n|\\r|\\n/g);\r\n        this._lines += lines.length - 1;\r\n        this._columns += lines[lines.length - 1].length;\r\n        this._code += code;\r\n    }\r\n\r\n    private _sourceMap: RawIndexMap = {\r\n        version: 3,\r\n        sections: [],\r\n    };\r\n\r\n    private _code = '';\r\n    private _lines = 0;\r\n    private _columns = 0;\r\n    private _separator = '';\r\n}\r\n"]}