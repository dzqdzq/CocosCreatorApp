"use strict";var __awaiter=this&&this.__awaiter||function(t,i,e,n){return new(e||(e=Promise))(function(r,s){function a(t){try{o(n.next(t))}catch(t){s(t)}}function p(t){try{o(n.throw(t))}catch(t){s(t)}}function o(t){var i;t.done?r(t.value):(i=t.value,i instanceof e?i:new e(function(t){t(i)})).then(a,p)}o((n=n.apply(t,i||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=exports.builtin=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),app_1=require("../../app"),setting=require("@editor/setting");function init(){return __awaiter(this,void 0,void 0,function*(){try{const t=(0,path_1.join)(app_1.App.path,"../builtin.js"),i=(0,path_1.join)(app_1.App.path,"../builtin.json");let e;if((0,fs_extra_1.existsSync)(t)){const i=require(t);i&&i.main&&(e=yield i.main())}else(0,fs_extra_1.existsSync)(i)&&(e=yield(0,fs_extra_1.readJSON)(i));e&&(Array.isArray(e.disableBuiltin)?exports.builtin.disableBuiltin=e.disableBuiltin:exports.builtin.disableBuiltin=[],Array.isArray(e.extensions)?exports.builtin.extensions=e.extensions.map(t=>(0,path_1.isAbsolute)(t)?t:(0,path_1.join)(app_1.App.path,"..",t)):exports.builtin.extensions=[],e.env&&(exports.builtin.env=e.env,e.env.PROJECT&&(exports.builtin.env.PROJECT=e.env.PROJECT,setting.PATH.PROJECT=e.env.PROJECT),e.env.MAIN_WINDOW_HOOK&&((0,path_1.isAbsolute)(e.env.MAIN_WINDOW_HOOK)?exports.builtin.env.MAIN_WINDOW_HOOK=e.env.MAIN_WINDOW_HOOK:exports.builtin.env.MAIN_WINDOW_HOOK=(0,path_1.join)(app_1.App.path,"..",e.env.MAIN_WINDOW_HOOK))))}catch(t){console.error(t),exports.builtin={}}})}exports.builtin={},exports.init=init;