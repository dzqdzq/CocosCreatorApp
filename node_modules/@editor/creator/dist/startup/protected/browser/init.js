"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=exports.builtin=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),app_1=require("../../../app"),setting=require("@editor/setting");async function init(i){try{var t,n=(0,path_1.join)(app_1.App.path,"../builtin.js"),r=(0,path_1.join)(app_1.App.path,"../builtin.json");let e;(0,fs_extra_1.existsSync)(n)?(t=require(n))&&t.main&&(e=await t.main()):(0,fs_extra_1.existsSync)(r)&&(e=await(0,fs_extra_1.readJSON)(r)),e=e||{},Array.isArray(e.disableBuiltin)?exports.builtin.disableBuiltin=e.disableBuiltin:exports.builtin.disableBuiltin=[],Array.isArray(e.extensions)?exports.builtin.extensions=e.extensions.map(e=>(0,path_1.isAbsolute)(e)?e:(0,path_1.join)(app_1.App.path,"..",e)):exports.builtin.extensions=[],e.env||(e.env={}),exports.builtin.env=e.env,i.env=i.env||{};var s=e.env.HOME||i.env.HOME,p=(s&&(exports.builtin.env.HOME=s,setting.PATH.HOME=s),e.env.PROJECT||i.env.PROJECT),a=(p&&(exports.builtin.env.PROJECT=p,setting.PATH.PROJECT=p),e.env.LANGUAGE||i.env.LANGUAGE),_=(a&&(exports.builtin.env.LANGUAGE=a,setting.PATH.LANGUAGE=a),e.env.LAYOUT||i.env.LAYOUT);_&&(exports.builtin.env.LAYOUT=normalizePATH(_)),e.env.MAIN_WINDOW_CUSTOM_HEADER&&(exports.builtin.env.MAIN_WINDOW_CUSTOM_HEADER=normalizePATH(e.env.MAIN_WINDOW_CUSTOM_HEADER)),e.env.MAIN_WINDOW_ORIGIN_HEADER&&(exports.builtin.env.MAIN_WINDOW_ORIGIN_HEADER=e.env.MAIN_WINDOW_ORIGIN_HEADER),e.env.MAIN_WINDOW_FOOTER&&(exports.builtin.env.MAIN_WINDOW_FOOTER=normalizePATH(e.env.MAIN_WINDOW_FOOTER))}catch(e){console.error(e),exports.builtin={}}}function normalizePATH(e){return(0,path_1.isAbsolute)(e)?e:(0,path_1.join)(app_1.App.path,"..",e)}exports.builtin={env:{}},exports.init=init;