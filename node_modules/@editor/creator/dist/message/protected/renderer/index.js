"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__eb__=exports.__unregister__=exports.__register__=exports.removeBroadcastListener=exports.addBroadcastListener=exports.broadcast=exports.send=exports.request=void 0;const ipc=require("@base/electron-base-ipc"),broadcastListenerMap={};async function request(e,s,...a){return new Promise((r,t)=>{ipc.send("editor-lib-message:call","request",e,s,...a).callback((e,s)=>e?t(e):r(s))})}function send(e,s,...r){ipc.send("editor-lib-message:call","send",e,s,...r)}function broadcast(e,...s){ipc.send("editor-lib-message:call","broadcast",e,...s)}function addBroadcastListener(e,s){ipc.send("editor-lib-message:add-broadcast-listener",e),broadcastListenerMap[e]=broadcastListenerMap[e]??[],broadcastListenerMap[e].push(s)}function removeBroadcastListener(e,s){broadcastListenerMap[e]&&-1!==(s=broadcastListenerMap[e].indexOf(s))&&(broadcastListenerMap[e].splice(s,1),0===broadcastListenerMap[e].length)&&ipc.send("editor-lib-message:remove-broadcast-listener",e)}function __register__(){console.warn("Please ise it(__register__) in the browser process")}function __unregister__(){console.warn("Please ise it(__unregister__) in the browser process")}exports.request=request,exports.send=send,exports.broadcast=broadcast,exports.addBroadcastListener=addBroadcastListener,exports.removeBroadcastListener=removeBroadcastListener,exports.__register__=__register__,exports.__unregister__=__unregister__,exports.__eb__=void 0,ipc.on("editor-lib-message:emit-broadcast-listener",async(e,s,...r)=>{if(broadcastListenerMap[s])for(const t of broadcastListenerMap[s])try{t(...r)}catch(e){console.error(e)}else ipc.send("editor-lib-message:remove-broadcast-listener",s)});