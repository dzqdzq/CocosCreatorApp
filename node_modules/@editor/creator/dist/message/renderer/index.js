"use strict";var __awaiter=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function n(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,n)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeBroadcastListener=exports.addBroadcastListener=exports.broadcast=exports.send=exports.request=void 0;const ipc=require("@base/electron-base-ipc"),broadcastListenerMap={};function request(e,t,...s){return __awaiter(this,void 0,void 0,function*(){return new Promise((r,a)=>{ipc.send("editor-lib-message:call","request",e,t,...s).callback((e,t)=>e?a(e):r(t))})})}function send(e,t,...s){ipc.send("editor-lib-message:call","send",e,t,...s)}function broadcast(e,...t){ipc.send("editor-lib-message:call","broadcast",e,...t)}function addBroadcastListener(e,t){var s;ipc.send("editor-lib-message:add-broadcast-listener",e),broadcastListenerMap[e]=null!==(s=broadcastListenerMap[e])&&void 0!==s?s:[],broadcastListenerMap[e].push(t)}function removeBroadcastListener(e,t){if(broadcastListenerMap[e]){const s=broadcastListenerMap[e].indexOf(t);-1!==s&&(broadcastListenerMap[e].splice(s,1),0===broadcastListenerMap[e].length&&ipc.send("editor-lib-message:remove-broadcast-listener",e))}}exports.request=request,exports.send=send,exports.broadcast=broadcast,exports.addBroadcastListener=addBroadcastListener,exports.removeBroadcastListener=removeBroadcastListener,ipc.on("editor-lib-message:emit-broadcast-listener",(e,t,...s)=>__awaiter(void 0,void 0,void 0,function*(){if(broadcastListenerMap[t]){const e=broadcastListenerMap[t];for(const t of e)try{t(...s)}catch(e){console.error(e)}}else ipc.send("editor-lib-message:remove-broadcast-listener",t)}));