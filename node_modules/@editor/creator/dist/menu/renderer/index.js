"use strict";var __awaiter=this&&this.__awaiter||function(e,n,i,t){return new(i||(i=Promise))(function(r,o){function c(e){try{p(t.next(e))}catch(e){o(e)}}function u(e){try{p(t.throw(e))}catch(e){o(e)}}function p(e){var n;e.done?r(e.value):(n=e.value,n instanceof i?n:new i(function(e){e(n)})).then(c,u)}p((t=t.apply(e,n||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.clickMain=exports.queryMain=exports.clickPopup=exports.queryPopup=exports.popup=void 0;const ipc=require("@base/electron-base-ipc"),find=function(e,n){for(let i=0;i<e.length;i++){const t=e[i];if(t.label===n)return t}return null};function popup(e){void 0!==e.y&&"darwin"===process.platform&&(e.y+=26),ipc.send("editor-lib-menu:popup",JSON.parse(JSON.stringify(e))).callback((n,i,t)=>__awaiter(this,void 0,void 0,function*(){if(n)console.warn(n);else if(t.__template__){const n=function(e){return __awaiter(this,void 0,void 0,function*(){if(e.template===t.__template__)return!(!e.click||!1!==(yield e.click(t)))||(t.target?(Editor.Message.send(t.target,t.message,...t.params||[]),!0):console.warn("The message cannot be sent, 'target' does not exist."));if(Array.isArray(e.submenu))for(const i of e.submenu){if(yield n(i))return!0}})};for(const i of e.menu){if(yield n(i))return}}else{const n=i.split("/");let t={label:"",submenu:e.menu};n.forEach(e=>{if(!t||!t.submenu)return null;t=find(t.submenu,e)}),t.click&&t.click()}}))}function queryPopup(){return new Promise(e=>{ipc.send("editor-lib-menu:query-popup").callback((n,i)=>{e(i)})})}function clickPopup(e){return new Promise(n=>{ipc.send("editor-lib-menu:click-popup",e).callback((e,i)=>{n(i)})})}function queryMain(){return new Promise(e=>{ipc.send("editor-lib-menu:query-main").callback((n,i)=>{e(i)})})}function clickMain(e){return new Promise(n=>{ipc.send("editor-lib-menu:click-main",e).callback((e,i)=>{n(i)})})}exports.popup=popup,exports.queryPopup=queryPopup,exports.clickPopup=clickPopup,exports.queryMain=queryMain,exports.clickMain=clickMain;