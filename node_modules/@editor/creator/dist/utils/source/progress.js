"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.quickSpawn=void 0;const child_process_1=require("child_process");function quickSpawn(o,r,e={downGradeLog:!0,onlyPrintWhenError:!0,prefix:""}){return new Promise((n,i)=>{e.prefix=e.prefix||"";const t=(0,child_process_1.spawn)(o,r,Object.assign({cwd:(null===e||void 0===e?void 0:e.cwd)||void 0,env:null===e||void 0===e?void 0:e.env},e));let d="";function s(o,r){e.onlyPrintWhenError?d+=r:("log"===o&&e.downGradeLog?o="debug":"warn"===o&&e.downGradeWaring?o="log":"error"===o&&e.downGradeError&&(o="warn"),console[o](e.prefix+r.toString()))}e.logLevel>=0&&t.stdout.on("data",o=>{s("log",o)}),e.logLevel>=1&&t.stderr.on("data",o=>{const r=o.toString();r&&"\n"!==r&&s("error",o)}),t.on("close",t=>{0!==t?i(e.prefix+`Child process exit width code ${t}: ${o} ${r.toString()}`):n(!0)}),t.on("error",n=>{d&&console.debug(e.prefix+"child process output: ",{outputData:d}),console.error(e.prefix+`child process error: ${o} ${r.toString()}`),i(n)}),t.on("exit",o=>{!e.onlyPrintWhenError&&console.debug(e.prefix+`Child process exit width code ${o}`)})})}exports.quickSpawn=quickSpawn;