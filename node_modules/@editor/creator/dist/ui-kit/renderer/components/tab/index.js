"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tab=void 0;const fs=require("fs"),path=require("path"),{nodeList:nodeList}=require("../../utils"),base_1=require("../base"),STYLE=`<style>${fs.readFileSync(path.join(__dirname,"./tab.css"),"utf8")}</style>`,CUSTOM_STYLE='<style id="custom-style"></style>',HTML=`${fs.readFileSync(path.join(__dirname,"./tab.html"),"utf8")}`,instanceArray=[];let customStyle="";class Tab extends base_1.Base{constructor(){super(),this._value=void 0,this.shadowRoot&&(this.shadowRoot.innerHTML=`${STYLE}${CUSTOM_STYLE}${HTML}`,this.$slot=this.shadowRoot.querySelector("slot"),this.$buttons=this.shadowRoot.querySelector(".buttons"),this.$slot.addEventListener("slotchange",this._slotChange.bind(this)),this._update())}static importStyle(t){fs.existsSync(t)&&(customStyle=fs.readFileSync(t,"utf8"),instanceArray.map(t=>{t.shadowRoot.querySelector("#custom-style").innerHTML=customStyle}))}static get observedAttributes(){return["value","readonly","disabled"]}attributeChangedCallback(t,e,s){switch(t){case"value":this._update()}}get value(){return this._value}set value(t){const e=void 0!==t?Number(t):NaN;isNaN(e),void 0!==t?this.setAttribute("value",String(e)):this.removeAttribute("value"),this._update()}connectedCallback(){if(super.connectedCallback(),nodeList.push(this),instanceArray.push(this),this.shadowRoot){const t=this.shadowRoot.querySelector("#custom-style");t&&(t.innerHTML=customStyle)}}disconnectedCallback(){super.disconnectedCallback();const t=instanceArray.indexOf(this),e=nodeList.indexOf(this);instanceArray.splice(t,1),nodeList.splice(e,1)}_slotChange(){this.$buttons.innerHTML=this.innerHTML,this.$buttons.querySelectorAll("ui-button").forEach((t,e)=>{t.removeEventListener("confirm",t.__ui_bind__),t.__ui_bind__=(()=>{this.value=e,this.dispatch("change"),this.dispatch("confirm")}),t.addEventListener("confirm",t.__ui_bind__),e===this._value?t.setAttribute("pressed",""):t.removeAttribute("pressed")})}_update(){let t=parseInt(this.getAttribute("value")||"");isNaN(t)?t=void 0:this._value=t,this.$buttons.querySelectorAll("ui-button").forEach((e,s)=>{s===t?e.setAttribute("pressed",""):e.removeAttribute("pressed")})}}exports.Tab=Tab;