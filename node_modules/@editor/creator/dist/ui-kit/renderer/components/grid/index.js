"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Grid=void 0;const grid_ctrl_1=require("./grid-ctrl"),fs=require("fs"),path=require("path"),STYLE=`<style>${fs.readFileSync(path.join(__dirname,"./grid.css"),"utf8")}</style>`,CUSTOM_STYLE='<style id="custom-style"></style>',HTML=`${fs.readFileSync(path.join(__dirname,"./grid.html"),"utf8")}`,customStyle="",defaultConfig={showX:!0,showY:!0,axisXConfig:{}};class Grid extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot&&(this.shadowRoot.innerHTML=`${STYLE}${CUSTOM_STYLE}${HTML}`,this.$curveLabelX=this.shadowRoot.querySelector(".x-axis"),this.$curveLabelY=this.shadowRoot.querySelector(".y-axis"),this.$ctrlCanvas=this.shadowRoot.querySelector("canvas"))}get disabled(){return null!==this.getAttribute("disabled")}set disabled(t){(t=!!t)?(this.setAttribute("disabled",""),this.setAttribute("tabindex","-1")):(this.removeAttribute("disabled"),this.setAttribute("tabindex","0"))}get readonly(){return null!==this.getAttribute("readonly")}set readonly(t){(t=!!t)?this.setAttribute("readonly",""):this.removeAttribute("readonly")}connectedCallback(){if(!this.shadowRoot)return;const t=this.shadowRoot.querySelector("#custom-style");if(t&&(t.innerHTML=customStyle),this.config)this.$ctrlCanvas.width=this.clientWidth,this.$ctrlCanvas.height=this.clientHeight,this.initGrid();else try{const t=JSON.parse(this.getAttribute("config"));this.setConfig(t),this.initGrid()}catch(t){this.setConfig(),this.initGrid()}this.gridCtrl.on("change",()=>{this.dispatch("change")})}static get observedAttributes(){return["focused","readonly","disabled","value"]}setConfig(t){this.$ctrlCanvas.width=this.clientWidth,this.$ctrlCanvas.height=this.clientHeight,this.$curveLabelX.innerHTML="",this.$curveLabelY.innerHTML="";const i={$container:this.$curveLabelX},e={$container:this.$curveLabelY},s={showX:!0,showY:!0,readonly:this.readonly,axisMargin:30,lineWidth:1};t?(Object.assign(s,t),!1!==t.showX&&(Object.assign(i,t.axisXConfig||{}),s.axisXConfig=i),!1!==t.showY&&(Object.assign(e,t.axisYConfig||{}),s.axisYConfig=e)):(s.axisXConfig=i,s.axisYConfig=e),this.config=s}valueToPixelX(t){return this.gridCtrl.valueToPixelX(t)}pixelToValueX(t){return this.gridCtrl.pixelToValueX(t)}move(t,i){this.gridCtrl.translate(t,i),this.gridCtrl.render()}initGrid(){this.gridCtrl?this.gridCtrl.resetConfig(this.config):(this.gridCtrl=new grid_ctrl_1.GridCtrl(this.$ctrlCanvas,this.config),this.gridCtrl.init())}scaleAt(t,i,e){return this.gridCtrl.scaleAt(t,i,e)}jumpToRang(t,i){const{start:e,end:s}=this.gridCtrl.getValueRang()}getValueRang(){return this.gridCtrl.getValueRang()}dispatch(t){const i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!0),this.dispatchEvent(i)}}exports.Grid=Grid;