"use strict";var __awaiter=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))(function(n,r){function l(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(l,a)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Link=void 0;const fs=require("fs"),path=require("path"),{shell:shell}=require("electron"),base_1=require("../base"),STYLE=`<style>${fs.readFileSync(path.join(__dirname,"./link.css"),"utf8")}</style>`,CUSTOM_STYLE='<style id="custom-style"></style>',HTML=`${fs.readFileSync(path.join(__dirname,"./link.html"),"utf8")}`,instanceArray=[];let linkHandle,customStyle="";class Link extends base_1.Base{static importStyle(t){fs.existsSync(t)&&(customStyle=fs.readFileSync(t,"utf8"),instanceArray.map(t=>{t.shadowRoot.querySelector("#custom-style").innerHTML=customStyle}))}static setLinkHandle(t){"function"==typeof t&&(linkHandle=t)}constructor(){super(),this.shadowRoot&&(this.shadowRoot.innerHTML=`${STYLE}${CUSTOM_STYLE}${HTML}`,this.addEventListener("click",this.onClick))}get value(){const t=this.getAttribute("value");return t?t.trim():this.innerHTML.trim()}set value(t){this.setAttribute("value",t)}get ctrl(){return!!this.hasAttribute("ctrl")}connectedCallback(){if(super.connectedCallback(),instanceArray.push(this),this.shadowRoot){const t=this.shadowRoot.querySelector("#custom-style");t&&(t.innerHTML=customStyle)}}disconnectedCallback(){super.disconnectedCallback();const t=instanceArray.indexOf(this);instanceArray.splice(t,1),this.removeEventListener("click",this.onClick)}static get observedAttributes(){return["readonly","disabled","value","ctrl"]}onClick(t){return __awaiter(this,void 0,void 0,function*(){if(this.disabled||!this.value||this.ctrl&&!t.ctrlKey)return;if(linkHandle){if(yield linkHandle(this.value,this.getAttribute("type")))return!0}/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|-)+)/g.test(this.value)?shell.openExternal(this.value):fs.existsSync(this.value)&&shell.showItemInFolder(this.value)})}}exports.Link=Link;