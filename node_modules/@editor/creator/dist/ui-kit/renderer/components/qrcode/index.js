"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QRCode=void 0;const base_1=require("../base"),fs=require("fs"),path=require("path"),STYLE=`<style>${fs.readFileSync(path.join(__dirname,"./qrcode.css"),"utf8")}</style>`,CUSTOM_STYLE='<style id="custom-style"></style>',HTML=`${fs.readFileSync(path.join(__dirname,"./qrcode.html"),"utf8")}`,instanceArray=[],qrcode=require("qrcode");let customStyle="";class QRCode extends base_1.Base{constructor(){super(),this.shadowRoot&&(this.shadowRoot.innerHTML=`${STYLE}${CUSTOM_STYLE}${HTML}`,this.$canvas=this.shadowRoot.querySelector("canvas"))}static importStyle(e){fs.existsSync(e)&&(customStyle=fs.readFileSync(e,"utf8"),instanceArray.map(e=>{e.shadowRoot.querySelector("#custom-style").innerHTML=customStyle}))}get value(){return this.getAttribute("value")}set value(e){e?this.setAttribute("value",e):this.removeAttribute("value")}get size(){return parseInt(this.getAttribute("size")||"")}set size(e){e?this.setAttribute("size",String(e)):this.removeAttribute("size")}connectedCallback(){if(super.connectedCallback(),instanceArray.push(this),!this.shadowRoot)return;const e=this.shadowRoot.querySelector("#custom-style");e&&(e.innerHTML=customStyle),this.size||(this.size=this.clientWidth||200)}disconnectedCallback(){super.disconnectedCallback();const e=instanceArray.indexOf(this);instanceArray.splice(e,1)}static get observedAttributes(){return["value","size"]}attributeChangedCallback(e,t,s){switch(e){case"value":case"size":this._updateCanvas()}}_updateCanvas(){this.value&&qrcode.toCanvas(this.$canvas,this.value,{errorCorrectionLevel:"H",maskPattern:2,margin:1,width:this.size})}}exports.QRCode=QRCode;