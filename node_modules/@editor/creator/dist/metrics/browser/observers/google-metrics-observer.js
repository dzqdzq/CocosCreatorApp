"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const metrics_observer_base_1=require("./metrics-observer-base"),request_1=require("./request"),TrackingID="UA-60734607-3";function sendData(e){(0,request_1.sendHttpRequest)({method:"POST",host:"www.google-analytics.com",path:"/collect",protocol:"https",data:e},function(e){e&&(console.debug("Metrics error"),console.debug(e))})}class GoogleMetricsObserver extends metrics_observer_base_1.MetricsObserverBase{constructor(){super(),this._trackID=TrackingID}trackEvent(e,t){if(e.sendToCocosAnalyticsOnly)return;if(!t.cid)return void console.warn("Metrics: no valid client ID");if(!e.category||!e.action)return void console.warn("Metrics: no valid info");const r={v:1,tid:this._trackID,cid:t.cid,uid:t.uid,t:"event",ec:e.category,ea:e.action};e.label&&(r.el=e.label),e.value&&(r.ev=e.value),sendData(r)}trackException(e,t){if(!t.cid)return void console.warn("Metrics: no valid client ID");sendData({v:1,tid:this._trackID,cid:t.cid,uid:t.uid,t:"exception",exd:e.code+"-"+e.message,exf:0})}sendAppInfo(e){sendData({v:1,tid:this._trackID,cid:e.cid,uid:e.uid,t:"screenView",an:"CocosCreator",aid:"com.cocos.creator",av:Editor.App.version,cd:"Home",sc:"start",sr:e.resolution||"unknown",cd1:e.scaleFactor||"1",ul:Editor.I18n.getLanguage()||"unknown",ua:Editor.App.userAgent})}}module.exports=new GoogleMetricsObserver;