"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Clipboard=void 0;const path_1=require("path"),electron_1=require("electron"),plist_1=require("plist"),macFileHandle={write(e){if(!Array.isArray(e)||e.some(e=>"string"!=typeof e))return console.warn("The clipboard requires data of type string[]."),!1;let r="";for(const a of e)r+=`<string>${a}</string>`;return electron_1.clipboard.writeBuffer("NSFilenamesPboardType",Buffer.from(`
              <?xml version="1.0" encoding="UTF-8"?>
              <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
              <plist version="1.0">
                <array>
                  ${r}
                </array>
              </plist>
            `))},read(){var e=electron_1.clipboard.readBuffer("NSFilenamesPboardType").toString();if(!e)return[];try{return(0,plist_1.parse)(e)}catch(e){return console.error(e),[]}},has(){return electron_1.clipboard.has("public.file-url")}},windowsFileHandle={write(e){if(!Array.isArray(e)||e.some(e=>"string"!=typeof e))return console.warn("The clipboard requires data of type string[]."),!1;customHandle.write("files",e)},read(){if(customHandle.has("files"))return customHandle.read("files");var r=electron_1.clipboard.readBuffer("FileGroupDescriptorW"),e=electron_1.clipboard.readBuffer("FileNameW").toString("ucs2");const a=(0,path_1.dirname)(e);var t=(r.length-4)/592,o=[];for(let e=0;e<t;e++){var n=4+592*e+72,i=[];for(let e=0;e<592;e+=2){var l=r[n+e],s=r[n+e+1];if(0===l&&0===s)break;i.push(l,s)}o.push(Buffer.from(i).toString("ucs2"))}return o.map(e=>(0,path_1.join)(a,e))},has(){return electron_1.clipboard.has("fileNameW")||customHandle.has("files")}},handleMap={files:"darwin"===process.platform?macFileHandle:windowsFileHandle,image:{write(e){return e instanceof electron_1.nativeImage?electron_1.clipboard.writeImage(e):(console.warn("The clipboard requires data of type nativeImage."),!1)},read(){return this.has()&&electron_1.clipboard.readImage()||null},has(){return electron_1.clipboard.readImage().isEmpty()}},text:{write(e){return"string"!=typeof e?(console.warn("The clipboard requires data of type string."),!1):electron_1.clipboard.writeText(e)},read(){return electron_1.clipboard.readText()},has(){return!!electron_1.clipboard.readText()}}},customHandle={write(e,r){if(void 0===r)return console.warn("The clipboard requires data of type string."),!1;try{electron_1.clipboard.writeBuffer("cocos."+e,Buffer.from(JSON.stringify(r)))}catch(e){return!1}return!0},read(e){if(!this.has(e))return null;try{return JSON.parse(electron_1.clipboard.read("cocos."+e))}catch(e){return console.error(e),null}},has(e){return!!electron_1.clipboard.has("cocos."+e)}};exports.Clipboard={read(e){return handleMap[e]?handleMap[e].read():customHandle.read(e)},write(e,r){return handleMap[e]?handleMap[e].write(r):customHandle.write(e,r)},has(e){return handleMap[e]?handleMap[e].has():customHandle.has(e)},clear(){return electron_1.clipboard.clear()}};