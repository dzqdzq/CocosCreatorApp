"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.queryNotice=exports.queryNotices=exports.removeNotice=exports.changeNoticeTimeout=exports.addNotice=void 0;const browser_1=require("../../protected/browser"),ipc=require("@base/electron-base-ipc"),utils_1=require("../../utils");let ID=0;const noticeTasks=[],noticeTaskMap={};function addNotice(e){void 0===e.timeout&&(e.timeout=-1),e.title=(0,utils_1.translationI18n)(e.title),e.message=(0,utils_1.translationI18n)(e.message),e.source=(0,utils_1.translationI18n)(e.source);const t=ID++;var o=Object.assign({id:t},e);return noticeTasks.push(o),noticeTaskMap[t]=o,(0,browser_1.emit)("add-notice",o),ipc.broadcast("editor-lib-task:emit","add-notice",o),0<e.timeout&&(o.timer=setTimeout(()=>{removeNotice(t)},e.timeout)),t}function changeNoticeTimeout(e,t){var o=noticeTaskMap[e];o&&(clearTimeout(o.timer),0<(t=t||0)?(o.timeout=t,o.timer=setTimeout(()=>{removeNotice(e)},o.timeout)):o.timeout=t=0)}function removeNotice(e){var t,o=noticeTaskMap[e];o&&(-1!==(t=noticeTasks.indexOf(o))&&noticeTasks.splice(t,1),delete noticeTaskMap[e],delete o.timer,(0,browser_1.emit)("remove-notice",o),ipc.broadcast("editor-lib-task:emit","remove-notice",o))}function queryNotices(){return noticeTasks}function queryNotice(e){return noticeTaskMap[e]}exports.addNotice=addNotice,exports.changeNoticeTimeout=changeNoticeTimeout,exports.removeNotice=removeNotice,exports.queryNotices=queryNotices,exports.queryNotice=queryNotice,ipc.on("editor-lib-task:call",async(t,e,...o)=>{try{var i=await exports[e](...o);return t.reply(null,i),i}catch(e){t.reply(e)}return null});