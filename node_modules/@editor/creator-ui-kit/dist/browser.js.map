{"version":3,"file":"browser.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;ACVa;AACb,QAAQ,yBAAyB,EAAE,mBAAO,CAAC,0BAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;;;;;ACjBY;AACqC;AAClD,QAAQ,uBAAuB,EAAE,mBAAO,CAAC,0BAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS,qBAAqB,SAAS;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI;AAC3B;AACA;AACA;AACA;AACA;AACA,qBAAqB,gDAAU;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8CAAQ;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACO;AACP;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;;;;;AClFY;AACb,QAAQ,iCAAiC,EAAE,mBAAO,CAAC,0BAAU;AAClB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,iFAAiF;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6DAAuB;AACtC;AACA;AACA,eAAe,+DAAyB;AACxC;AACA;AACA,eAAe,iEAA2B;AAC1C;AACA;AACA,eAAe,iEAA2B;AAC1C;AACA;AACA,oCAAoC,uEAAiC;AACrE;AACA;;;;;;;;;;;AChFA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;ACNa;AACb,aAAa,mBAAO,CAAC,0EAAsB;AACO;AAClC;AACA","sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/./source/browser/ipcComponents/drag/index.ts","webpack://[name]/./source/browser/ipcComponents/file/fileUrl.ts","webpack://[name]/./source/browser/ipcComponents/file/index.ts","webpack://[name]/external \"electron\"","webpack://[name]/external \"path\"","webpack://[name]/webpack/bootstrap","webpack://[name]/webpack/runtime/compat get default export","webpack://[name]/webpack/runtime/define property getters","webpack://[name]/webpack/runtime/hasOwnProperty shorthand","webpack://[name]/webpack/runtime/make namespace object","webpack://[name]/./source/browser/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"browser\"] = factory();\n\telse\n\t\troot[\"browser\"] = factory();\n})(global, function() {\nreturn ","'use strict';\r\nconst { ipcMain, BrowserWindow } = require('electron');\r\n// 主进程监听 drag 组件事件\r\nipcMain.on('ui-drag-item-start', (event, arg) => {\r\n    // @TODO 暂时先这么处理\r\n    const windows = BrowserWindow.getAllWindows() ?? [];\r\n    for (const win of windows) {\r\n        // @ts-ignore\r\n        win?.webContents.send('ui-drag-area-start', arg);\r\n    }\r\n});\r\nipcMain.on('ui-drag-item-end', (event, arg) => {\r\n    const windows = BrowserWindow.getAllWindows() ?? [];\r\n    for (const win of windows) {\r\n        // @ts-ignore\r\n        win?.webContents.send('ui-drag-area-end', arg);\r\n    }\r\n});\r\n","'use strict';\r\nimport { relative, join, isAbsolute } from 'path';\r\nconst { ipcMain, webContents } = require('electron');\r\nclass FileUrlManager {\r\n    /**\r\n     * 注册某个协议信息\r\n     * @param protocol\r\n     * @param protocolInfo\r\n     */\r\n    register(protocol, protocolInfo) {\r\n        if (!FileUrlManager.urlMap) {\r\n            FileUrlManager.urlMap = {};\r\n        }\r\n        if (FileUrlManager.urlMap[protocol] || protocol === 'file') {\r\n            console.warn(`[UI-File] Register protocol(${protocol}) failed! protocol(${protocol}) has exist!`);\r\n            return false;\r\n        }\r\n        FileUrlManager.urlMap[protocol] = protocolInfo;\r\n        this.emitChanges();\r\n        return true;\r\n    }\r\n    /**\r\n     * 反注册某个协议信息\r\n     * @param protocol 协议头\r\n     */\r\n    unregister(protocol) {\r\n        delete FileUrlManager.urlMap[protocol];\r\n        return true;\r\n    }\r\n    getAllFileProtocol() {\r\n        return Object.keys(FileUrlManager.urlMap).map((protocol) => {\r\n            return {\r\n                protocol,\r\n                label: FileUrlManager.urlMap[protocol].label,\r\n                path: FileUrlManager.urlMap[protocol].path,\r\n            };\r\n        });\r\n    }\r\n    resolveToRaw(url) {\r\n        const matchInfo = url.match(/^([a-zA-z]*):\\/\\/(.*)$/);\r\n        if (matchInfo) {\r\n            const relPath = matchInfo[2].replace(/\\\\/g, '/');\r\n            const info = this.getProtocalInfo(matchInfo[1]);\r\n            if (info) {\r\n                return join(info.path, relPath);\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n    resolveToUrl(raw, protocol) {\r\n        if (!raw || !isAbsolute(raw) || !protocol) {\r\n            return '';\r\n        }\r\n        const info = this.getProtocalInfo(protocol);\r\n        if (!info) {\r\n            return '';\r\n        }\r\n        return info.protocol + '://' + relative(info.path, raw).replace(/\\\\/g, '/');\r\n    }\r\n    getProtocalInfo(protocol) {\r\n        if (!FileUrlManager.urlMap[protocol]) {\r\n            return;\r\n        }\r\n        return {\r\n            protocol,\r\n            ...FileUrlManager.urlMap[protocol],\r\n        };\r\n    }\r\n    emitChanges() {\r\n        // 广播\r\n        const message = FileUrlManager.urlMap;\r\n        const windowsArr = webContents.getAllWebContents();\r\n        windowsArr.forEach((item) => {\r\n            item.send('main-protocols-change', message);\r\n        });\r\n    }\r\n}\r\nFileUrlManager.urlMap = {};\r\nexport const fileUrlManager = new FileUrlManager();\r\n// 监听 protocols 数据查询\r\nipcMain.on('ui-file-query-protocols', (event) => {\r\n    event.reply('main-query-protocols', FileUrlManager.urlMap);\r\n});\r\n","'use strict';\r\nconst { ipcMain, dialog, BrowserWindow } = require('electron');\r\nimport { fileUrlManager } from './fileUrl';\r\n// 监听 file 点击选择文件/目录事件\r\nipcMain.on('ui-file-select-file', (event, options) => {\r\n    options = options || {};\r\n    const win = BrowserWindow.fromWebContents(event.sender);\r\n    const config = {\r\n        defaultPath: options.defaultPath || '',\r\n        properties: ['openFile'],\r\n        buttonLabel: options.buttonLabel || '',\r\n    };\r\n    if (options.type === 'directory') {\r\n        config.properties = ['openDirectory'];\r\n    }\r\n    else if (options.type === 'app') {\r\n        config.filters = [\r\n            { name: 'Application', extensions: [process.platform === 'win32' ? 'exe' : 'app'] },\r\n        ];\r\n    }\r\n    if (options.multi) {\r\n        config.properties.push('multiSelections');\r\n    }\r\n    if (options.extensions) {\r\n        config.filters = [{\r\n                name: options.extensions,\r\n                extensions: options.extensions.split(',').filter(Boolean),\r\n            }];\r\n    }\r\n    // @ts-ignore\r\n    dialog.showOpenDialog(win, config).then((result) => {\r\n        if (!result.filePaths) {\r\n            return event.reply('main-select-file', undefined);\r\n        }\r\n        if (options.multi) {\r\n            event.reply('main-select-file', result.filePaths);\r\n        }\r\n        else {\r\n            event.reply('main-select-file', result.filePaths[0]);\r\n        }\r\n        return true;\r\n    });\r\n});\r\n// 监听 file 打开文件不存在提示\r\nipcMain.on('ui-file-not-exist', (event, options) => {\r\n    dialog.showMessageBox({\r\n        type: 'warning',\r\n        title: 'warning',\r\n        message: 'File does not exist.',\r\n    });\r\n});\r\n// //////////////////////////////////\r\nexport const defaultProtocol = {\r\n    label: 'file://',\r\n    path: '',\r\n    protocol: 'file',\r\n    description: '',\r\n    invalidInfo: '',\r\n};\r\nexport class File {\r\n    static registerProtocol(protocol, protocolInfo) {\r\n        if (protocol === 'file') {\r\n            Object.assign(defaultProtocol, protocolInfo);\r\n            return true;\r\n        }\r\n        protocolInfo.label = protocol + '://';\r\n        return fileUrlManager.register(protocol, protocolInfo);\r\n    }\r\n    static unregisterProtocol(protocol) {\r\n        return fileUrlManager.unregister(protocol);\r\n    }\r\n    static resolveToRaw(url) {\r\n        return fileUrlManager.resolveToRaw(url);\r\n    }\r\n    static resolveToUrl(raw, protocol) {\r\n        return fileUrlManager.resolveToUrl(raw, protocol);\r\n    }\r\n    static getAllProtocolInfos() {\r\n        return [defaultProtocol, ...fileUrlManager.getAllFileProtocol()];\r\n    }\r\n}\r\n","module.exports = require(\"electron\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","'use strict';\r\nconst Drag = require('./ipcComponents/drag');\r\nimport { File } from './ipcComponents/file/index';\r\nexport { File };\r\nexport { Drag };\r\n"],"names":[],"sourceRoot":""}