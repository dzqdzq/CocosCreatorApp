'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.isSubPath = exports.nameToId = exports.compareVersion = exports.absolutePath = void 0;
const path_1 = require("path");
const crypto_1 = require("crypto");
/**
 * 将一个 path 转成绝对地址
 * 如果传入数据不存在，则返回 ''
 * @param path
 */
function absolutePath(path) {
    if (!path) {
        return '';
    }
    if ((0, path_1.isAbsolute)(path) && /^[A-Za-z]:/.test(path)) {
        return (0, path_1.normalize)(path);
    }
    return (0, path_1.resolve)(path);
}
exports.absolutePath = absolutePath;
;
/**
 * 比对版本号
 * A > B => 1
 * A = B => 0
 * A < B => -1
 * @param versionA
 * @param versionB
 */
function compareVersion(versionA, versionB) {
    const a = versionA.split('.');
    const b = versionB.split('.');
    const length = Math.max(a.length, b.length);
    for (let i = 0; i < length; i++) {
        const an = a[i] || 0;
        const bn = b[i] || 0;
        if (Number(an) < Number(bn)) {
            return -1;
        }
        if (Number(an) > Number(bn)) {
            return 1;
        }
    }
    return 0;
}
exports.compareVersion = compareVersion;
;
const _extendIndex = [
    1, 2, 3, 4, 5,
    7, 8, 9, 10, 11, 12, 13, 14, 15,
    17, 18, 19, 20, 21, 22, 23, 24,
    26, 27, 28, 29, 30
];
/**
 * 从一个名字转换成一个 id
 * 这是个有损压缩，并不能够还原成原来的名字
 * @param id
 * @param extend
 */
function nameToId(name, extend) {
    if (!extend) {
        extend = 0;
    }
    const md5 = (0, crypto_1.createHash)('md5').update(name).digest('hex');
    let id = md5[0] + md5[6] + md5[16] + md5[25] + md5[31];
    for (let i = 0; i < extend; i++) {
        id += md5[_extendIndex[i]];
    }
    return id;
}
exports.nameToId = nameToId;
/**
 * 判断 path 是否是 root 内的文件夹
 * @param path
 * @param root
 */
function isSubPath(path, root) {
    // path = normalize(path);
    // root = normalize(root);
    if (path === root) {
        return false;
    }
    if (path.startsWith(root + path_1.sep)) {
        return true;
    }
    return false;
}
exports.isSubPath = isSubPath;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zb3VyY2UvbGlicy91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7OztBQUdiLCtCQUEyRTtBQUMzRSxtQ0FBb0M7QUFFcEM7Ozs7R0FJRztBQUNILFNBQWdCLFlBQVksQ0FBRSxJQUF3QjtJQUNsRCxJQUFJLENBQUMsSUFBSSxFQUFFO1FBQ1AsT0FBTyxFQUFFLENBQUM7S0FDYjtJQUNELElBQUksSUFBQSxpQkFBVSxFQUFDLElBQUksQ0FBQyxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDN0MsT0FBTyxJQUFBLGdCQUFTLEVBQUMsSUFBSSxDQUFDLENBQUM7S0FDMUI7SUFDRCxPQUFPLElBQUEsY0FBTyxFQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUFSRCxvQ0FRQztBQUFBLENBQUM7QUFFRjs7Ozs7OztHQU9HO0FBQ0gsU0FBZ0IsY0FBYyxDQUFFLFFBQVEsRUFBRSxRQUFRO0lBQzlDLE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDOUIsTUFBTSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUU5QixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRTVDLEtBQUssSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFFLENBQUMsR0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDekIsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyQixNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLElBQUksTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUN6QixPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQ2I7UUFFRCxJQUFJLE1BQU0sQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUU7WUFDekIsT0FBTyxDQUFDLENBQUM7U0FDWjtLQUNKO0lBRUQsT0FBTyxDQUFDLENBQUM7QUFDYixDQUFDO0FBbkJELHdDQW1CQztBQUFBLENBQUM7QUFFRixNQUFNLFlBQVksR0FBRztJQUNqQixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztJQUNiLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRTtJQUMvQixFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRTtJQUM5QixFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRTtDQUNyQixDQUFDO0FBRUY7Ozs7O0dBS0c7QUFDSCxTQUFnQixRQUFRLENBQUMsSUFBWSxFQUFFLE1BQWU7SUFDbEQsSUFBSSxDQUFDLE1BQU0sRUFBRTtRQUNULE1BQU0sR0FBRyxDQUFDLENBQUM7S0FDZDtJQUNELE1BQU0sR0FBRyxHQUFHLElBQUEsbUJBQVUsRUFBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pELElBQUksRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdkQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUM3QixFQUFFLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQzlCO0lBQ0QsT0FBTyxFQUFFLENBQUM7QUFDZCxDQUFDO0FBVkQsNEJBVUM7QUFFRDs7OztHQUlHO0FBQ0gsU0FBZ0IsU0FBUyxDQUFDLElBQVksRUFBRSxJQUFZO0lBQ2hELDBCQUEwQjtJQUMxQiwwQkFBMEI7SUFFMUIsSUFBSSxJQUFJLEtBQUssSUFBSSxFQUFFO1FBQ2YsT0FBTyxLQUFLLENBQUM7S0FDaEI7SUFFRCxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxHQUFHLFVBQUcsQ0FBQyxFQUFFO1FBQzdCLE9BQU8sSUFBSSxDQUFDO0tBQ2Y7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDO0FBYkQsOEJBYUMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7IHJlYWRkaXIsIHN0YXQsIGV4aXN0c1N5bmMsIFN0YXRzLCBzdGF0U3luYywgcmVhZGRpclN5bmMgfSBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgeyBpc0Fic29sdXRlLCByZXNvbHZlLCBub3JtYWxpemUsIGpvaW4sIHJlbGF0aXZlLCBzZXAgfSBmcm9tICdwYXRoJztcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdjcnlwdG8nO1xuXG4vKipcbiAqIOWwhuS4gOS4qiBwYXRoIOi9rOaIkOe7neWvueWcsOWdgFxuICog5aaC5p6c5Lyg5YWl5pWw5o2u5LiN5a2Y5Zyo77yM5YiZ6L+U5ZueICcnXG4gKiBAcGFyYW0gcGF0aCBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFic29sdXRlUGF0aCAocGF0aDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgaWYgKCFwYXRoKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgaWYgKGlzQWJzb2x1dGUocGF0aCkgJiYgL15bQS1aYS16XTovLnRlc3QocGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShwYXRoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmUocGF0aCk7XG59O1xuXG4vKipcbiAqIOavlOWvueeJiOacrOWPt1xuICogQSA+IEIgPT4gMVxuICogQSA9IEIgPT4gMFxuICogQSA8IEIgPT4gLTFcbiAqIEBwYXJhbSB2ZXJzaW9uQSBcbiAqIEBwYXJhbSB2ZXJzaW9uQiBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVWZXJzaW9uICh2ZXJzaW9uQSwgdmVyc2lvbkIpIHtcbiAgICBjb25zdCBhID0gdmVyc2lvbkEuc3BsaXQoJy4nKTtcbiAgICBjb25zdCBiID0gdmVyc2lvbkIuc3BsaXQoJy4nKTtcblxuICAgIGNvbnN0IGxlbmd0aCA9IE1hdGgubWF4KGEubGVuZ3RoLCBiLmxlbmd0aCk7XG5cbiAgICBmb3IgKGxldCBpPTA7IGk8bGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgYW4gPSBhW2ldIHx8IDA7XG4gICAgICAgIGNvbnN0IGJuID0gYltpXSB8fCAwO1xuICAgICAgICBpZiAoTnVtYmVyKGFuKSA8IE51bWJlcihibikpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICBpZiAoTnVtYmVyKGFuKSA+IE51bWJlcihibikpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIDA7XG59O1xuXG5jb25zdCBfZXh0ZW5kSW5kZXggPSBbXG4gICAgMSwgMiwgMywgNCwgNSxcbiAgICA3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LFxuICAgIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCxcbiAgICAyNiwgMjcsIDI4LCAyOSwgMzBcbl07XG5cbi8qKlxuICog5LuO5LiA5Liq5ZCN5a2X6L2s5o2i5oiQ5LiA5LiqIGlkXG4gKiDov5nmmK/kuKrmnInmjZ/ljovnvKnvvIzlubbkuI3og73lpJ/ov5jljp/miJDljp/mnaXnmoTlkI3lrZdcbiAqIEBwYXJhbSBpZFxuICogQHBhcmFtIGV4dGVuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gbmFtZVRvSWQobmFtZTogc3RyaW5nLCBleHRlbmQ/OiBudW1iZXIpIHtcbiAgICBpZiAoIWV4dGVuZCkge1xuICAgICAgICBleHRlbmQgPSAwO1xuICAgIH1cbiAgICBjb25zdCBtZDUgPSBjcmVhdGVIYXNoKCdtZDUnKS51cGRhdGUobmFtZSkuZGlnZXN0KCdoZXgnKTtcbiAgICBsZXQgaWQgPSBtZDVbMF0gKyBtZDVbNl0gKyBtZDVbMTZdICsgbWQ1WzI1XSArIG1kNVszMV07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBleHRlbmQ7IGkrKykge1xuICAgICAgICBpZCArPSBtZDVbX2V4dGVuZEluZGV4W2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIGlkO1xufVxuXG4vKipcbiAqIOWIpOaWrSBwYXRoIOaYr+WQpuaYryByb290IOWGheeahOaWh+S7tuWkuVxuICogQHBhcmFtIHBhdGggXG4gKiBAcGFyYW0gcm9vdCBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU3ViUGF0aChwYXRoOiBzdHJpbmcsIHJvb3Q6IHN0cmluZykge1xuICAgIC8vIHBhdGggPSBub3JtYWxpemUocGF0aCk7XG4gICAgLy8gcm9vdCA9IG5vcm1hbGl6ZShyb290KTtcblxuICAgIGlmIChwYXRoID09PSByb290KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKHJvb3QgKyBzZXApKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cbiJdfQ==