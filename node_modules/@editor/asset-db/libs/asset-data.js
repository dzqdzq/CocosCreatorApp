"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataManager=void 0;const fs_extra_1=require("fs-extra");class DataManager{constructor(){this.dataMap={},this._saveTimer=null}async setRecordJSON(a){if(this.file=a,(0,fs_extra_1.existsSync)(a))try{this.dataMap=(0,fs_extra_1.readJSONSync)(this.file)}catch(a){console.error(a),this.dataMap={}}else this.dataMap={}}save(){clearTimeout(this._saveTimer),this._saveTimer=setTimeout(()=>{this.saveImmediate()},400)}saveImmediate(){clearTimeout(this._saveTimer),this.file&&(0,fs_extra_1.outputJSONSync)(this.file,this.dataMap,{spaces:2})}get(a){return this.dataMap[a.uuid]||(this.dataMap[a.uuid]={url:a.url,value:{}}),this.dataMap[a.uuid].url=a.url,this.dataMap[a.uuid]}}exports.DataManager=DataManager;