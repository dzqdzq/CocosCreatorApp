# Creator Panel

The module responsible for rendering and logic processing within the Creator panel.

---

```typescript
// Template data for the panel
exports.template = `<h1 id="h1">Panel</h1>`;

// Built-in stylesheet for the panel
exports.style = `:host { display: flex; flex: 1; }`;

// Register custom fonts
exports.fonts = [
    {
        name: 'panel',
        file: 'xxx.woff',
    }
];

// Shortcut for accessing elements within the panel using CSS selectors
exports.$ = {
    h1: '#h1',
};

// Event listeners attached to elements
exports.listeners = Object.create(null);

// Messages sent to the panel
exports.messages = Object.create(null);

// Built-in methods accessible within the panel, which can be used directly within messages, listeners, and lifecycle functions using `this.xxx`
exports.methods = Object.create(null);

// Lifecycle hook called when the panel is ready
exports.ready = function () {};

// Lifecycle hook called before the panel is closed
// Can be a promise function; if it returns false, it interrupts the closing process
exports.beforeClose = function () {};

// Lifecycle hook called when the panel is closing
// Should ignore all existing data and unregister any events registered previously
exports.close = function () {};
```

---

## Browser Process & Renderer Process

---

### panel.send(name, message, ...args)

- `name`: (`string`) Panel name
- `message`: (`string`) Message name
- `...args`: (`string`) Arguments

Sends a message to a specific `panel`.

```typescript
panel.send('test', 'test-message', true);
```

---

### panel.broadcast(message, ...args)

- `message`: (`string`) Message name
- `...args`: (`string`) Arguments

Broadcasts a message to all panels in the current process.

```typescript
panel.broadcast('test-message', true);
```

---

### panel.queryInfo(name)

- `name`: (`string`) Panel name

Query the `info` of a specific `panel`.

```typescript
const info = panel.queryInfo('test');
console.log(info);
```

---

### panel.queryInfos();

Query the `info` data of all `panel`.

```typescript
const infos = panel.queryInfos();
console.log(infos);
```

---

## Browser Process

---

In the main process, panels are mainly responsible for managing registration, unregistration, and message sending.

---

### panel.register(name, path, userData)

- `name`: (`string`) Panel name
- `path`: (`string`) Path to the panel
- `userData`: (`object`) Custom data


Registers a `panel`.

```typescript
panel.register('test', '/test/test', { test: true });
```

---

### panel.unregister (name)

- `name`: (`string`) Panel name

Unregisters a `panel`.

```typescript
panel.unregister('test');
```

---

### panel.focus(name)

- `name`: (`string`) Panel name

Passes focus to a specific `panel`.

```typescript
panel.focus('test');
```

---

## Renderer 渲染进程

### panel.query(name)

- `name`: (`string`) Panel name

Checks if a specific `panel` exists on the current page.

```typescript
panel.query('test');
```

---

### panel.addLoadListener(handler)

- `handler`: (`object`) Handler function object

Handler called when each `panel` is loaded.

```typescript
panel.addLoadListener({
    onTestChange() {
        console.log('test');
    }
});
```

---

### panel.removeLoadListener(handler)

- `handler`: (`object`) Handler function object

Removes the handler for panel loading.

```typescript
panel.removeLoadListener({
    onTestChange() {
        console.log('test');
    }
});
```

---

## userData Mechanism

The `panel` defines parameters related only to page rendering.
If additional common parameters are needed, we provide a `userData` management mechanism.

---

### Define userData

When defining `userData`, it is an `object` that can be passed into the manager when registering the `panel`.

```typescript
Paenl.register('test', '/test/test', { test: true });
```

---

### Use userData

`userData` can be directly accessed from the `panel` element using the `getData` method.

```typescript
const value = panelElement.getData('key');
```

---
