"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const ipc=require("@base/electron-base-ipc"),panel=require("@editor/panel"),Mousetrap=require("mousetrap"),kitControl=require("./kit-control");class Panel{constructor(){this._kitControl=kitControl}async open(e,...l){return new Promise(n=>{ipc.send("editor-lib-panel:call","open",e,...l).callback(()=>{n()})})}close(e){ipc.send("editor-lib-panel:call","close",e)}focus(e){return new Promise(l=>{ipc.send("editor-lib-panel:call","focus",e).callback(()=>{l()})})}async has(e){return new Promise((l,n)=>{ipc.send("editor-lib-panel:call","has",e).callback((e,t)=>{if(e)return n();l(t)})})}}module.exports=new Panel,exports.default=module.exports,ipc.on("editor-lib-panel:close",async(e,l)=>{const n=panel.query(l);if(!n||!n[0])return e.reply(null,!0);const t=n[0];if(!t.parentElement||!t.parentElement.$groups)return e.reply(null,!0),window.close();const o=await t.parentElement.$groups.removePanel(l);return e.reply(null,!(!1===o))}),ipc.on("editor-lib-panel:query-selection-text",e=>{const l=(window.getSelection()||"").toString();e.reply(null,l)}),ipc.on("editor-lib-panel:query-active-element-tag",(e,l)=>{const n=function e(l){return l&&l.shadowRoot?e(l.shadowRoot.activeElement):l}(document.activeElement);e.reply(null,n?n.tagName.toLowerCase():"")});