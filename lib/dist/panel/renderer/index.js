"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const ipc=require("@base/electron-base-ipc"),panel=require("@editor/panel"),Mousetrap=require("mousetrap"),kitControl=require("./kit-control");class Panel{constructor(){this._kitControl=kitControl}async open(e,...l){return new Promise(r=>{ipc.send("editor-lib-panel:call","open",e,...l).callback(()=>{r()})})}close(e){ipc.send("editor-lib-panel:call","close",e)}focus(e){return new Promise(l=>{ipc.send("editor-lib-panel:call","focus",e).callback(()=>{l()})})}async has(e){return new Promise((l,r)=>{ipc.send("editor-lib-panel:call","has",e).callback((e,t)=>{if(e)return r();l(t)})})}async querySelector(e,l){return panel.query(e).map(e=>Array.from(e.shadowRoot.querySelectorAll(l)))}}module.exports=new Panel,exports.default=module.exports,ipc.on("editor-lib-panel:close",async(e,l)=>{const r=panel.query(l);if(!r||!r[0])return e.reply(null,!0);const t=r[0];if(!t.parentElement||!t.parentElement.$groups)return e.reply(null,!0),window.close();const n=await t.parentElement.$groups.removePanel(l);return e.reply(null,!(!1===n))}),ipc.on("editor-lib-panel:query-selection-text",e=>{const l=(window.getSelection()||"").toString();e.reply(null,l)}),ipc.on("editor-lib-panel:query-active-element-tag",(e,l)=>{const r=function e(l){return l&&l.shadowRoot?e(l.shadowRoot.activeElement):l}(document.activeElement);e.reply(null,r?r.tagName.toLowerCase():"")});