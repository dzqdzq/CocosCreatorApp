"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Base=void 0;class Base extends HTMLElement{constructor(t){super(),this.defaultTabIndex="0",void 0!==t&&!0!==t||this.attachShadow({mode:"open"}),this.addEventListener("focus",this._onFocus),this.addEventListener("blur",this._onBlur),this.addEventListener("mousedown",this._onMouseDown),this.addEventListener("keyup",this._onKeyUp),this.addEventListener("keydown",this._onKeyDown)}get focused(){return null!==this.getAttribute("focused")}set focused(t){(t=!!t)?this.setAttribute("focused",""):this.removeAttribute("focused"),this.dispatch("focus-changed")}get disabled(){return null!==this.getAttribute("disabled")}set disabled(t){(t=!!t)?(this.setAttribute("disabled",""),this.setAttribute("tabindex","-1")):(this.removeAttribute("disabled"),this.setAttribute("tabindex","0"))}get readonly(){return null!==this.getAttribute("readonly")}set readonly(t){(t=!!t)?this.setAttribute("readonly",""):this.removeAttribute("readonly")}get invalid(){return null!==this.getAttribute("invalid")}set invalid(t){(t=!!t)?this.setAttribute("invalid",""):this.removeAttribute("invalid")}set path(t){this.setAttribute("path",t),this.dispatch("path")}get path(){return this.getAttribute("path")||""}connectedCallback(){const t=null!==this.getAttribute("disabled"),e=this.getAttribute("tabindex")||this.defaultTabIndex;this.setAttribute("tabindex",t?"-1":e),this._onConnected(),this.path&&this.dispatch("path"),Tooltip.bind(this)}disconnectedCallback(){this._onDisconnected(),Tooltip.unbind(this)}dispatch(t,e){const i={bubbles:!0,cancelable:!0};e&&Object.assign(i,e);const o=new CustomEvent(t,i);this.dispatchEvent(o)}attributeChangedCallback(t,e,i){switch(t){case"path":this.dispatch("path");break;case"disabled":"false"===i&&(this.disabled=!1)}}_onFocus(t){this.disabled||(this.focused=!0)}_onBlur(t){this.focused=!1}_onMouseDown(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_onKeyDown(t){}_onKeyUp(t){}_onConnected(){}_onDisconnected(){}}exports.Base=Base;const Tooltip={$uiTooltip:null,$uiLabel:null,$el:null,animationId:null,bind(t){t._onTooltipShow||(t._onTooltipShow=this.show.bind(this),t._onTooltipHide=this.hide.bind(this),t.addEventListener("mouseover",t._onTooltipShow),t.addEventListener("mouseleave",t._onTooltipHide))},unbind(t){t._onTooltipShow&&(t.removeEventListener("mouseover",t._onTooltipShow),t.removeEventListener("mouseleave",t._onTooltipHide),delete t._onTooltipShow,t._onTooltipHide(),delete t._onTooltipHide)},show(t){const e=t.currentTarget.getAttribute("tooltip");if(null===e||""===e.trim())return;t.stopPropagation();const i=t.currentTarget;this.$uiTooltip?(i._onTooltipHide(),this.$uiTooltip.isConnected||document.body.append(this.$uiTooltip)):this.createGlobalElement.call(this),this.$uiLabel.setAttribute("value",e.replace(/\n/g,"<br>"));const o={x:t.clientX,y:t.clientY};window.cancelAnimationFrame(this.animationId),this.animationId=window.requestAnimationFrame(()=>{this.$el=i,this.autoPosition(o)})},autoPosition(t){if(!this.$el)return;const e=this.$el.getBoundingClientRect();let i=this.$uiTooltip.getBoundingClientRect();const o=window.document.body.clientWidth,s=window.document.body.clientHeight;let n="top";t.y<40&&(n="bottom"),o-e.left+e.width<100&&(n="left"),s-t.y<40&&(n="top");let l=!1;"top"!==n&&"bottom"!==n||i.width>o&&(l=!0),"left"===n&&e.left<i.width&&(l=!0),"right"===n&&i.width+e.left+e.width>o&&(l=!0),l&&(this.$uiTooltip.style.width=`${.5*i.width}px`,i=this.$uiTooltip.getBoundingClientRect());let h=t.y-i.height/2,d=t.x-i.width/2,a="",u="",r="";if("top"===n&&(h=e.top-i.height,a="bottom",r="center"),"bottom"===n&&(h=e.top+e.height,a="top",r="center"),"right"===n&&(d=e.left+e.width,a="left",r="middle"),"left"===n&&(d=e.left-i.width,a="right",r="middle"),h<0&&(u=h.toString(),h=0),h+i.height>s){const t=s-h-i.height;h+=t,u=(0-t).toString()}if(d<0&&(u=d.toString(),d=0),d+i.width>o){const t=o-d-i.width;d+=t,u=(0-t).toString()}this.$uiTooltip.style.top=`${h}px`,this.$uiTooltip.style.left=`${d}px`,this.$uiTooltip.style["animation-name"]=`fadein-from-${a}`,this.$uiTooltip.setAttribute("arrow",`${a} ${r}${u}`)},hide(){this.$uiTooltip&&this.$uiTooltip.isConnected&&(this.$uiTooltip.style.top=null,this.$uiTooltip.style.left=null,this.$uiTooltip.style.width=null,this.$uiTooltip.remove(),this.$el=null)},createGlobalElement(){this.$uiTooltip=document.createElement("ui-tooltip"),this.$uiTooltip.setAttribute("animation",""),this.$uiTooltip.style.position="fixed",this.$uiTooltip.style.zIndex="10000",this.$uiLabel=document.createElement("ui-label"),this.$uiLabel.style["line-height"]="20px",this.$uiLabel.style["word-break"]="break-word",this.$uiTooltip.append(this.$uiLabel)}};