"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Panel=void 0;const fs_1=require("fs"),path_1=require("path"),STYLE=`<style>${fs_1.readFileSync(path_1.join(__dirname,"./panel.css"),"utf8")}</style>`;class Panel extends HTMLElement{constructor(){super(),this.panel=null,this.panelObject=null,this.connected=!1,this.attachShadow({mode:"open"}),this.panel=null,this.panelObject=null}set config(e){this.panel=e,e?this._refresh():this.panelObject=null}connectedCallback(){this.connected=!0,this.panel&&this.panel.ready&&this.panel.ready.call(this.panelObject)}disconnectedCallback(){this.connected=!1,this.panel&&this.panel.close&&this.panel.close.call(this.panelObject)}static get observedAttributes(){return["src"]}attributeChangedCallback(e,t,s){switch(e){case"src":if(s)try{this.config=require(s)}catch(e){console.error(e),this.config=null}else this.config=null;break;default:return}}dispatch(e,...t){const s=document.createEvent("HTMLEvents");s.initEvent(e,!0,!0),s.args=t,this.dispatchEvent(s)}_refresh(){if(this.panel){if(this.shadowRoot.innerHTML=`${STYLE}<style>${this.panel.style||""}</style>${this.panel.template||""}`,this.panelObject={dispatch:this.dispatch.bind(this)},this.panel.$){const e={};for(const t in this.panel.$){const s=this.panel.$[t];"string"==typeof s&&(e[t]=this.shadowRoot.querySelector(s))}this.panelObject.$=e}if(this.panel.methods&&"object"==typeof this.panel.methods)for(const e in this.panel.methods)this.panelObject[e]=this.panel.methods[e];this.connected&&this.panel.ready&&this.panel.ready.call(this.panelObject)}else this.shadowRoot.innerHTML=""}}exports.Panel=Panel;