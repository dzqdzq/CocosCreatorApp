"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=require("./utils");class LinearTicks{constructor(){this.ticks=[],this.tickLods=[],this.tickRatios=[],this.minScale=.1,this.maxScale=1e3,this.minValueScale=1,this.maxValueScale=1,this.minValue=-500,this.maxValue=500,this.pixelRange=500,this.minSpacing=10,this.maxSpacing=80,this.minTickLevel=0,this.maxTickLevel=0}initTicks(i,t,s){t<=0&&(t=1),s<=0&&(s=1),s<t&&(s=t),this.tickLods=i,this.minScale=t,this.maxScale=s,this.ticks=[];let e=1,h=0;this.ticks.push(e);const a=t,c=s;let l=1,n=1;for(;e*this.tickLods[h]<=c;)e*=this.tickLods[h],h=h+1>this.tickLods.length-1?0:h+1,this.ticks.push(e),l=e;for(this.minValueScale=1/l*100,h=this.tickLods.length-1,e=1;e/this.tickLods[h]>=a;)e/=this.tickLods[h],h=h-1<0?this.tickLods.length-1:h-1,this.ticks.unshift(e),n=e;return this.maxValueScale=1/n*100,this}spacing(i,t){return this.minSpacing=i,this.maxSpacing=t,this}range(i,t,s){this.minValue=Math.fround(Math.min(i,t)),this.maxValue=Math.fround(Math.max(i,t)),this.pixelRange=s,this.minTickLevel=0,this.maxTickLevel=this.ticks.length-1;for(let i=this.ticks.length-1;i>=0;i--){const t=this.ticks[i]*this.pixelRange/(this.maxValue-this.minValue);if(this.tickRatios[i]=(t-this.minSpacing)/(this.maxSpacing-this.minSpacing),this.tickRatios[i]>=1&&(this.maxTickLevel=i),t<=this.minSpacing){this.minTickLevel=i;break}}for(let i=this.minTickLevel;i<=this.maxTickLevel;i++)this.tickRatios[i]=utils_1.clamp01(this.tickRatios[i]);return this}ticksAtLevel(i,t){const s=[],e=this.ticks[i],h=Math.floor(this.minValue/e),a=Math.ceil(this.maxValue/e);for(let c=h;c<=a;c++)(!t||i>=this.maxTickLevel||c%Math.round(this.ticks[i+1]/e)!=0)&&s.push(c*e);return s}levelForStep(i){for(let t=0;t<this.ticks.length;t++){if(this.ticks[t]*this.pixelRange/(this.maxValue-this.minValue)>=i)return t}return-1}}exports.default=LinearTicks;