"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tooltip=void 0;const fs=require("fs"),path=require("path"),base_1=require("../base"),STYLE=`<style>${fs.readFileSync(path.join(__dirname,"./tooltip.css"),"utf8")}</style>`,CUSTOM_STYLE='<style id="custom-style"></style>',HTML=`${fs.readFileSync(path.join(__dirname,"./tooltip.html"),"utf8")}`,instanceArray=[];let customStyle="";const defaultDirection="bottom",defaultAdjust="center",defaultAdjustPadding=6,defaultArrowBoxSize=9,legalDirections=["top","right","bottom","left"],legalAdjustDirections=["top","middle","bottom","left","center","right"];class Tooltip extends base_1.Base{constructor(){super(),this.shadowRoot&&(this.shadowRoot.innerHTML=`${STYLE}${CUSTOM_STYLE}${HTML}`,this.$content=this.shadowRoot.querySelector(".content"),this.resizeObserver=new window.ResizeObserver(()=>{this.getBoundingClientRect().height&&this.showArrow(this.getAttribute("arrow")||"")}))}static importStyle(t){fs.existsSync(t)&&(customStyle=fs.readFileSync(t,"utf8"),instanceArray.map(t=>{t.shadowRoot.querySelector("#custom-style").innerHTML=customStyle}))}connectedCallback(){if(super.connectedCallback(),instanceArray.push(this),this.shadowRoot){const t=this.shadowRoot.querySelector("#custom-style");t&&(t.innerHTML=customStyle)}this.showArrow(this.getAttribute("arrow")||""),this.resizeObserver.observe(this.$content)}disconnectedCallback(){super.disconnectedCallback();const t=instanceArray.indexOf(this);instanceArray.splice(t,1),this.resizeObserver.unobserve(this.$content)}static get observedAttributes(){return["arrow"]}attributeChangedCallback(t,e,s){switch(super.attributeChangedCallback(t,e,s),t){case"arrow":this.showArrow(s);break;default:return}}showArrow(t){const e=t.split(" ");let s=e[0]||defaultDirection;legalDirections.includes(s)||(s="bottom");let o=e[1]||("left"===s||"right"===s?"middle":defaultAdjust),i=defaultAdjustPadding;const r=o.match(/([a-z]+)([-+]?[\d.]+)?/);r&&(o=r[1]),legalAdjustDirections.includes(o)||(o="center");const a=this.$content.getBoundingClientRect();switch(o){case"center":i=a.width/2-defaultArrowBoxSize;break;case"right":i=a.width-defaultAdjustPadding-2*defaultArrowBoxSize;break;case"middle":i=a.height/2-defaultArrowBoxSize;break;case"bottom":i=a.height-defaultAdjustPadding-2*defaultArrowBoxSize}r&&void 0!==r[2]&&(i+=Number(r[2])),i<0&&(i=2),this.$content.setAttribute("direction",s),this.$content.style.setProperty("--direction-adjust",`${i}px`)}}exports.Tooltip=Tooltip;