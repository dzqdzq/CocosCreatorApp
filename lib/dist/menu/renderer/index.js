"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clickMain=exports.queryMain=exports.clickPopup=exports.queryPopup=exports.popup=void 0;const ipc=require("@base/electron-base-ipc"),find=function(e,n){for(let i=0;i<e.length;i++){const r=e[i];if(r.label===n)return r}return null};function popup(e){void 0!==e.y&&"darwin"===process.platform&&(e.y+=26),ipc.send("editor-lib-menu:popup",JSON.parse(JSON.stringify(e))).callback(async(n,i,r)=>{if(n)console.warn(n);else if(r.__template__){const n=async function(e){if(e.template===r.__template__)return!(!e.click||!1!==await e.click(r))||(r.target?(Editor.Message.send(r.target,r.message,...r.params||[]),!0):console.warn("The message cannot be sent, 'target' does not exist."));if(Array.isArray(e.submenu))for(const i of e.submenu){if(await n(i))return!0}};for(const i of e.menu){if(await n(i))return}}else{const n=i.split("/");let r={label:"",submenu:e.menu};n.forEach(e=>{if(!r||!r.submenu)return null;r=find(r.submenu,e)}),r.click&&r.click()}})}function queryPopup(){return new Promise(e=>{ipc.send("editor-lib-menu:query-popup").callback((n,i)=>{e(i)})})}function clickPopup(e){return new Promise(n=>{ipc.send("editor-lib-menu:click-popup",e).callback((e,i)=>{n(i)})})}function queryMain(){return new Promise(e=>{ipc.send("editor-lib-menu:query-main").callback((n,i)=>{e(i)})})}function clickMain(e){return new Promise(n=>{ipc.send("editor-lib-menu:click-main",e).callback((e,i)=>{n(i)})})}exports.popup=popup,exports.queryPopup=queryPopup,exports.clickPopup=clickPopup,exports.queryMain=queryMain,exports.clickMain=clickMain;