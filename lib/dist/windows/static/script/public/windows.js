"use strict";const{join:join}=require("path"),{Package:Package}=require("../../../../package"),name2module={};async function attach(e){if(e.enable&&e.info.windows&&!name2module[e.name])try{name2module[e.name]=require(join(e.path,e.info.windows)),await name2module[e.name].load()}catch(a){console.error(`Extension(${e.info.name}) execution error: [windows].load code failed to execute.`),console.error(a),name2module[e.name]=null}}async function detach(e){if(name2module[e.name])try{const a=name2module[e.name];await a.unload()}catch(a){console.error(`Extension(${e.info.name}) execution error: [windows].unload code failed to execute.`),console.error(a)}finally{delete name2module[e.name]}}window.__hasBindErrorHandler__||(window.__hasBindErrorHandler__=!0,window.addEventListener("error",e=>(console.error(e.error||e.message||e),!0)));const packages=Package.getPackages({enable:!0});packages.forEach(e=>{attach(e)}),Package.on("enable",attach),Package.on("disable",detach);