"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.error=exports.warn=exports.info=exports.save=exports.select=void 0;const electron_1=require("electron"),fs_1=require("fs"),path_1=require("path"),project_1=require("../../project"),path_2=require("../../utils/source/path"),ipc=require("@base/electron-base-ipc");async function select(e={},t=null){e.path&&fs_1.existsSync(e.path)||(e.path=project_1.Project.path);const o={defaultPath:e.path||"",properties:["directory"===e.type?"openDirectory":"openFile"],buttonLabel:e.button||""};e.multi&&(o.properties||(o.properties=[]),o.properties.push("multiSelections")),e.title&&(o.title=e.title),e.extensions&&(o.filters=[{name:e.extensions,extensions:e.extensions.split(",").filter(Boolean)}]),e.filters&&(o.filters=e.filters),t&&!t.isVisible()&&(t=null);const r=await electron_1.dialog.showOpenDialog(t,o);if(Array.isArray(r.filePaths))for(let e=0;e<r.filePaths.length;e++)r.filePaths[e]=path_2.normalize(r.filePaths[e]);return r}async function save(e={},t=null){e.path&&fs_1.existsSync(path_1.dirname(e.path))||(e.path=path_1.join(project_1.Project.path,e.path?path_1.basename(e.path):""));const o={defaultPath:e.path,properties:[],buttonLabel:e.button||void 0};e.title&&(o.title=e.title),e.filters&&(o.filters=e.filters),t&&!t.isVisible()&&(t=null);const r=await electron_1.dialog.showSaveDialog(t,o);return r.filePath&&(r.filePath=path_2.normalize(r.filePath)),r}function info(e,t={},o=null){if(!e)throw new Error("The dialog must input in the message");const r={title:t.title||"Info",message:e,detail:t.detail||"",type:"none",checkboxLabel:t.checkboxLabel||"",checkboxChecked:t.checkboxChecked||!1,defaultId:t.default,cancelId:t.cancel,buttons:t.buttons||["Cancel"]};return o&&!o.isVisible()&&(o=null),electron_1.dialog.showMessageBox(o,r)}function warn(e,t={},o=null){if(!e)throw new Error("The dialog must input in the message");const r={title:t.title||"Warn",message:e,detail:t.detail||"",type:"warning",checkboxLabel:t.checkboxLabel||"",checkboxChecked:t.checkboxChecked||!1,defaultId:t.default,cancelId:t.cancel,buttons:t.buttons||["Cancel"]};return o&&!o.isVisible()&&(o=null),electron_1.dialog.showMessageBox(o,r)}function error(e,t={},o=null){if(!e)throw new Error("The dialog must input in the message");const r={title:t.title||"Error",message:e,detail:t.detail||"",type:"error",checkboxLabel:t.checkboxLabel||"",checkboxChecked:t.checkboxChecked||!1,defaultId:t.default,cancelId:t.cancel,buttons:t.buttons||["Cancel"]};return o&&!o.isVisible()&&(o=null),electron_1.dialog.showMessageBox(o,r)}exports.select=select,exports.save=save,exports.info=info,exports.warn=warn,exports.error=error,ipc.on("editor-lib-dialog:call",async(e,t,...o)=>{try{const r=await module.exports[t](...o,e.sender?electron_1.BrowserWindow.fromWebContents(e.sender.hostWebContents||e.sender):null);return e.reply(null,r),r}catch(t){return e.reply(t),null}});