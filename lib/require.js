"use strict";const fs=require("fs"),ps=require("path"),vm=require("vm"),v8=require("v8"),path=require("path"),Module=require("module"),zlib=require("zlib");require("fix-electron-require");let compiler=null;try{compiler=process._linkedBinding("electron_common_compile")}catch(e){console.log(`(${process.pid}) Develop mode...`)}Module.prototype.__require=Module.prototype.require,Module.prototype.require=function(e){return"highlight.js"===e||"ipaddr.js"===e||"svg.js"===e?this.__require(e):(e=e.replace(/\.js$/,""),this.__require(e))},global.__vm__=vm,v8.setFlagsFromString("--no-lazy"),Number.parseInt(process.versions.node.split(".")[0],10)>=12&&v8.setFlagsFromString("--no-flush-bytecode");const readSourceHash=function(e){if(!Buffer.isBuffer(e))throw new Error("bytecodeBuffer must be a buffer object.");return process.version.startsWith("v8.8")||process.version.startsWith("v8.9")?e.slice(12,16).reduce((e,t,r)=>e+=t*Math.pow(256,r),0):e.slice(8,12).reduce((e,t,r)=>e+=t*Math.pow(256,r),0)},compileCode=function(e){if("string"!=typeof e)throw new Error(`javascriptCode must be string. ${typeof e} was given.`);let t=new vm.Script(e,{produceCachedData:!0});return t.createCachedData&&t.createCachedData.call?t.createCachedData():t.cachedData};function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}function fixBytecode(e){if(!Buffer.isBuffer(e))throw new Error("bytecodeBuffer must be a buffer object.");let t=compileCode('"c_c"');process.version.startsWith("v8.8")||process.version.startsWith("v8.9")?(t.slice(16,20).copy(e,16),t.slice(20,24).copy(e,20)):process.version.startsWith("v12")||process.version.startsWith("v13")?t.slice(12,16).copy(e,12):(t.slice(12,16).copy(e,12),t.slice(16,20).copy(e,16))}let extFunction=function(e,t){let r,i=path.basename(t,path.extname(t)),o=`${i}.jsc`,s=`${i}.js`,n=`${i}.cjs`,c=`${i}.ccc`,a=`${i}.ccd`,l=path.join(path.dirname(t),s),u=path.join(path.dirname(t),o),p=path.join(path.dirname(t),n),d=path.join(path.dirname(t),c),f=path.join(path.dirname(t),a);if(fs.existsSync(f))t=f,r=loadCCD.call(this,f);else if(fs.existsSync(d))t=d,r=loadCCC.call(this,d);else{if(fs.existsSync(l)){t=l;const r=fs.readFileSync(t,"utf8");return e._compile(stripBOM(r),t)}if(!fs.existsSync(u)){t=p;const r=fs.readFileSync(t,"utf8");return e._compile(stripBOM(r),t)}t=u,r=loadJSC.call(this,u)}function h(t){return e.require(t)}h.resolve=function(t,r){return"highlight.js"===t||"ipaddr.js"===t?Module._resolveFilename(t,e,!1,r):(t=t.replace(/\.js$/,""),Module._resolveFilename(t,e,!1,r))},h.main=process.mainModule,h.extensions=Module._extensions,h.cache=Module._cache;let m=path.dirname(t),_=[e.exports,h,e,t,m,process,global];return r.apply(e.exports,_)};function loadCCC(e){return compiler.test(e,["exports","require","module","__filename","__dirname"],{filename:e})}function loadCCD(e){let t=compiler.test2(e);return t=Buffer.from(t),_compileCode.call(this,t,e)}function loadJSC(e){return _compileCode(fs.readFileSync(e),e)}function _compileCode(e,t){fixBytecode(e);let r=readSourceHash(e),i="";r>1&&(i='"'+"â€‹".repeat(r-2)+'"');let o=new vm.Script(i,{filename:t,lineOffset:0,displayErrors:!0,cachedData:e});if(o.cachedDataRejected)throw new Error("Invalid or incompatible cached data (cachedDataRejected)");return o.runInThisContext({filename:t,lineOffset:0,columnOffset:0,displayErrors:!0})}function extGFunction(e,t){const r=fs.readFileSync(t),i=zlib.gunzipSync(r);e._compile(i.toString(),t)}Module._extensions[".js"]=extFunction,Module._extensions[".jsc"]=extFunction,Module._extensions[".jsg"]=extGFunction,Module._extensions[".ccd"]=extFunction,Module._extensions[".ccc"]=extFunction;