"use strict";const t=require("fire-fs"),{tmpdir:i}=require("os"),{join:r,resolve:e}=require("path"),{promisify:o}=require("util"),a=require("../../../share/project");module.exports=new class{constructor(){this.path="",this.name="",this.id="",Editor.argv._command?this.path=r(i(),"fireball-tmp-project"):Editor.argv._.length>0?this.path=e(Editor.argv._[0]):Editor.argv.path&&(this.path=e(Editor.argv.path))}async check(){t.existsSync(this.path)||(Editor.log("Create project %s",this.path),await o(a.create(this.path,null))),Editor.log("Check project %s",this.path);let i=await o(a.check)(this.path);return this.name=i.name,this.id=i.id,i}async init(){Editor.log("Initializing project %s",this.path),t.ensureDirSync(r(this.path,"settings")),Editor.Profile.register("project",r(this.path,"settings")),Editor.Profile.inherit("project","global"),t.ensureDirSync(r(this.path,"local")),Editor.Profile.register("local",r(this.path,"local")),Editor.Profile.inherit("local","project"),Editor.Package.addPath([r(Editor.App.home,"packages"),r(Editor.App.path,"editor","builtin"),r(Editor.App.path,Editor.dev?"":"..","builtin"),r(this.path,"packages")]);const i=require("../../../share/default-profiles/default-locals");Editor.Profile.load("default://local.json",i),Editor._projectLocalProfile=Editor.Profile.load("local://local.json",i);const e=require("../../../share/default-profiles/default-projects");Editor.Profile.load("default://project.json",e),Editor._projectProfile=Editor.Profile.load("project://project.json",e)}};