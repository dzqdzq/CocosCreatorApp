let e=require("path"),o=require("fs-extra"),i=(require("glob"),require("crypto"));let r,n,t,s,c,a,d,u,g=!1,m={cocos:{provider:"com.cocos.creator.engine2d",version:Editor.versions.CocosCreator,path:"cocos"}},p={main:"cocos2d-runtime.js"},j={provider:"com.cocos.creator.engine2d",signature:[{path:"cocos2d-runtime.js",md5:""}]};module.exports={gatherInfo(o){r=o.mainRpk,u=o.gameConfig,g=o.customConfig.separateEngineMode;let i=o.buildPath;n=e.join(i,"cocos"),t=e.join(i,"src","cocos2d-runtime.js"),s=e.join(n,"cocos2d-runtime.js"),d=e.join(i,"game.js"),c=e.join(n,"plugin.json"),a=e.join(n,"signature.json")},organizeResources(){if(!g)return;Editor.info(Editor.T("migu-runtime.separate_engine_begin_hint")),o.existsSync(n)||o.ensureDirSync(n),o.moveSync(t,s);let e=o.readFileSync(s);j.signature[0].md5=i.createHash("md5").update(e).digest("hex"),o.writeJSONSync(c,p),o.writeJSONSync(a,j),u.plugins=m,Editor.info(Editor.T("migu-runtime.separate_engine_end_hint"))},pack(){g&&r.directory(n,"cocos")}};