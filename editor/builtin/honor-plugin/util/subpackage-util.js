let e,s,n,t,i,r=require("path"),a=require("fs-extra");module.exports={gatherInfo(r){t=r.gameConfig,n=r.title,e=r.buildPath,i=r.options,s=[]},organizeResources(){let e=[];for(var n=0,o=i.bundles.length;n<o;n++){var c=i.bundles[n];if("subpackage"!==c.compressionType)continue;if(s.includes(c.scriptDest))break;let t=r.join(c.scriptDest,"index.js");a.existsSync(t)?(a.renameSync(t,r.join(c.scriptDest,"main.js")),s.push(c.scriptDest),e.push({name:"usr_"+c.name,root:c.name+"/"})):Editor.error("subpackage entry file does not exist, bundle.name: "+c.name)}e.length>0&&(t.subpackages=e)},async pack(){const s=r.join(e,"subpackages");if(a.existsSync(s)&&a.lstatSync(s).isDirectory()){a.readdirSync(s).forEach(n=>{const t=r.join(s,n),i=r.join(e,n);a.moveSync(t,i)}),a.rmdirSync(s)}}};