"use strict";const e=require("fire-fs");require("fire-path");Editor.Profile.load("project://openharmony.json");exports.name="openharmony",exports.data=function(){return 0===this.local.appABIs.length&&(this.local.appABIs=["arm64-v8a"]),{packageName:this.project.openharmony.packageName,armeabiV7a:this.local.appABIs.includes("armeabi-v7a"),arm64V8a:this.local.appABIs.includes("arm64-v8a"),portrait:this.project.orientation.portrait,upsideDown:this.project.orientation.upsideDown,landscapeLeft:this.project.orientation.landscapeLeft,landscapeRight:this.project.orientation.landscapeRight,templates:[],apiLevels:[],originEncryptJs:!1,originMd5Cache:!1,originNativeMd5Cache:!1,originSourceMaps:!1}},exports.computed={},exports.methods={_abiValueChanged:function(e,t){if(this.local.appABIs){var i=this.local.appABIs.indexOf(e);t?i<0&&this.local.appABIs.push(e):i>=0&&this.local.appABIs.splice(i,1)}},apiLevelsChange(){try{this.apiLevels=[];const t=Editor.Profile.load("global://settings.json").get("openharmony-sdk");if(t||Editor.warn(Editor.T("openharmony.tips.sdkNotSet")),!e.isDirSync(t))return;const i=e.readdirSync(t);for(const e of i)/^[0-9]+$/.test(e)&&this.apiLevels.push(e);this.apiLevels<=0?this.local.apiLevel="":this.apiLevels.includes(this.local.apiLevel)||(this.local.apiLevel=this.apiLevels[0])}catch(e){Editor.error(e),this.apiLevels=[]}}},exports.created=function(){this.originEncryptJs=this.project.encryptJs,this.originMd5Cache=this.project.md5Cache,this.originNativeMd5Cache=this.project.nativeMd5Cache,this.originSourceMaps=this.project.sourceMaps,this.project.encryptJs=!1,this.project.md5Cache=!1,this.project.nativeMd5Cache=!1,this.project.sourceMaps=!1,Editor.Ipc.sendToMain("app:query-cocos-templates",(e,t)=>{if(e)return Editor.warn(e);if(t.forEach(e=>{this.templates.push(e)}),this.local){var i=this.local.template;if(t.length<=0)return this.local.template="";-1===t.indexOf(i)&&(this.local.template=t[0])}}),Editor.Profile.load("global://settings.json").on("changed",this.apiLevelsChange),this.apiLevelsChange()},exports.beforeDestroy=function(){this.project.encryptJs=this.originEncryptJs,this.project.md5Cache=this.originMd5Cache,this.project.nativeMd5Cache=this.originNativeMd5Cache,this.project.sourceMaps=this.originSourceMaps},exports.destroy=function(){Editor.Profile.load("global://settings.json").off("changed",this.apiLevelsChange)},exports.watch={packageName:{handler(e){this.project&&(this.project.openharmony.packageName=e)}},portrait:{handler(e){this.project&&(this.project.orientation.portrait=e)}},upsideDown:{handler(e){this.project&&(this.project.orientation.upsideDown=e)}},landscapeLeft:{handler(e){this.project&&(this.project.orientation.landscapeLeft=e)}},landscapeRight:{handler(e){this.project&&(this.project.orientation.landscapeRight=e)}},armeabiV7a:{handler(e){this._abiValueChanged("armeabi-v7a",e)}},arm64V8a:{handler(e){this._abiValueChanged("arm64-v8a",e)}}},exports.template=`\n<ui-prop name="${Editor.T("BUILDER.template")}">\n    <ui-select class="flex-1" v-value="local.template">\n        <template v-for="item in templates">\n            <option v-bind:value="item">{{item}}</option>\n        </template>\n    </ui-select>\n</ui-prop>\n\n<ui-prop name="${Editor.T("openharmony.options.package_name")}">\n    <ui-input class="flex-1" v-value="packageName"></ui-input>\n</ui-prop>\n\n<ui-prop name="Target API Level">\n    <ui-select class="flex-1" v-value="local.apiLevel">\n        <template v-for="item in apiLevels">\n            <option v-bind:value="item">{{item}}</option>\n        </template>\n    </ui-select>\n</ui-prop>\n\n<ui-prop name="APP ABI" auto-height>\n    <div class="layout vertical">\n        <ui-checkbox class="item" v-value="arm64V8a">\n            arm64-v8a\n        </ui-checkbox>\n    </div>\n</ui-prop>\n\n<ui-prop name="${Editor.T("BUILDER.orientation")}" auto-height>\n    <div class="layout vertical">\n        <ui-checkbox class="item" v-value="portrait">\n            Portrait\n        </ui-checkbox>\n        <ui-checkbox class="item" v-value="upsideDown">\n            Upside Down\n        </ui-checkbox>\n        <ui-checkbox class="item" v-value="landscapeLeft">\n            Landscape Left\n        </ui-checkbox>\n        <ui-checkbox class="item" v-value="landscapeRight">\n            Landscape Right\n        </ui-checkbox>\n    </div>\n</ui-prop>\n\n\n`;